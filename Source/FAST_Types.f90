!STARTOFREGISTRYGENERATEDFILE './FAST_Types.f90'
!
! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
! FAST Registry (v2.05.00, 14-Jan-2015)
!*********************************************************************************************************************************
! FAST_Types
!.................................................................................................................................
! This file is part of FAST.
!
! Copyright (C) 2012-2015 National Renewable Energy Laboratory
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE FAST_Types
! This module contains all of the user-defined types needed in FAST. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE ElastoDyn_Types
USE TMD_Types
USE ServoDyn_Types
USE IfW_FFWind_Types
USE IfW_HHWind_Types
USE Lidar_Types
USE InflowWind_Types
USE DWM_Types
USE AeroDyn_Types
USE SubDyn_Types
USE Current_Types
USE Waves_Types
USE Waves2_Types
USE Conv_Radiation_Types
USE SS_Radiation_Types
USE WAMIT_Types
USE WAMIT2_Types
USE Morison_Types
USE HydroDyn_Types
USE IceFloe_Types
USE IceDyn_Types
USE FEAMooring_Types
USE MAP_Types
USE MoorDyn_Types
USE NWTC_Library
IMPLICIT NONE
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_Unknown = -1      ! Unknown [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_None = 0      ! No module selected [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_IfW = 1      ! InflowWind [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_ED = 2      ! ElastoDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_BD = 3      ! BeamDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_AD = 4      ! AeroDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_SrvD = 5      ! ServoDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_HD = 6      ! HydroDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_SD = 7      ! SubDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_MAP = 8      ! MAP (Mooring Analysis Program) [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_FEAM = 9      ! FEAMooring [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_MD = 10      ! MoorDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_IceF = 11      ! IceFloe [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: Module_IceD = 12      ! IceDyn [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: NumModules = 12      ! The number of modules available in FAST [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: MaxNBlades = 3      ! Maximum number of blades allowed on a turbine [-]
    INTEGER(IntKi), PUBLIC, PARAMETER  :: IceD_MaxLegs = 4      ! because I don't know how many legs there are before calling IceD_Init and I don't want to copy the data because of sibling mesh issues, I'm going to allocate IceD based on this number [-]
! =========  FAST_ParameterType  =======
  TYPE, PUBLIC :: FAST_ParameterType
    REAL(DbKi)  :: DT      ! Integration time step [global time] [s]
    REAL(DbKi) , DIMENSION(NumModules)  :: DT_module      ! Integration time step [global time] [s]
    INTEGER(IntKi) , DIMENSION(NumModules)  :: n_substeps      ! The number of module substeps for advancing states from t_global to t_global_next [-]
    REAL(DbKi)  :: TMax      ! Total run time [s]
    INTEGER(IntKi)  :: InterpOrder      ! Interpolation order {0,1,2} [-]
    INTEGER(IntKi)  :: NumCrctn      ! Number of correction iterations [-]
    INTEGER(IntKi)  :: KMax      ! Maximum number of input-output-solve iterations (KMax >= 1) [-]
    INTEGER(IntKi)  :: numIceLegs      ! number of suport-structure legs in contact with ice (IceDyn coupling) [-]
    LOGICAL , DIMENSION(NumModules)  :: ModuleInitialized      ! An array determining if the module has been initialized [-]
    REAL(DbKi)  :: DT_Ujac      ! Time between when we need to re-calculate these Jacobians [s]
    REAL(ReKi)  :: UJacSclFact      ! Scaling factor used to get similar magnitudes between accelerations, forces, and moments in Jacobians [-]
    INTEGER(IntKi) , DIMENSION(1:4)  :: SizeJac_ED_SD_HD      ! (1)=size of ED portion; (2)=size of SD portion [2 meshes]; (3)=size of HD portion; (4)=size of matrix [-]
    INTEGER(IntKi)  :: CompElast      ! Compute blade loads (switch) {Module_ED; Module_BD} [-]
    INTEGER(IntKi)  :: CompAero      ! Compute aerodynamic loads (switch) {Module_None; Module_AD} [-]
    INTEGER(IntKi)  :: CompServo      ! Compute control and electrical-drive dynamics (switch) {Module_None; Module_SrvD} [-]
    INTEGER(IntKi)  :: CompHydro      ! Compute hydrodynamic loads (switch) {Module_None; Module_HD} [-]
    INTEGER(IntKi)  :: CompSub      ! Compute sub-structural dynamics (switch) {Module_None; Module_HD} [-]
    INTEGER(IntKi)  :: CompMooring      ! Compute mooring system (switch) {Module_None; Module_MAP, Module_FEAM} [-]
    INTEGER(IntKi)  :: CompIce      ! Compute ice loading (switch) {Module_None; Module_IceF, Module_IceD} [-]
    LOGICAL  :: CompUserPtfmLd      ! Compute additional platform loading {false: none, true: user-defined from routine UserPtfmLd} (flag) [-]
    LOGICAL  :: CompUserTwrLd      ! Compute additional tower loading {false: none, true: user-defined from routine UserTwrLd} (flag) [-]
    LOGICAL  :: UseDWM      ! Use the DWM module in AeroDyn [-]
    CHARACTER(1024)  :: EDFile      ! The name of the ElastoDyn input file [-]
    CHARACTER(1024) , DIMENSION(NumModules)  :: BDBldFile      ! Name of files containing BeamDyn inputs for each blade [-]
    CHARACTER(1024)  :: AeroFile      ! Name of file containing aerodynamic input parameters [-]
    CHARACTER(1024)  :: ServoFile      ! Name of file containing control and electrical-drive input parameters [-]
    CHARACTER(1024)  :: HydroFile      ! Name of file containing hydrodynamic input parameters [-]
    CHARACTER(1024)  :: SubFile      ! Name of file containing sub-structural input parameters [-]
    CHARACTER(1024)  :: MooringFile      ! Name of file containing mooring system input parameters [-]
    CHARACTER(1024)  :: IceFile      ! Name of file containing ice loading input parameters [-]
    REAL(DbKi)  :: SttsTime      ! Amount of time between screen status messages [s]
    REAL(DbKi)  :: TStart      ! Time to begin tabular output [s]
    REAL(DbKi)  :: DT_Out      ! Time step for tabular output [s]
    INTEGER(IntKi)  :: n_SttsTime      ! Number of time steps between screen status messages [-]
    INTEGER(IntKi)  :: TurbineType      ! Type_LandBased, Type_Offshore_Fixed, or Type_Offshore_Floating [-]
    LOGICAL  :: WrBinOutFile      ! Write a binary output file? (.outb) [-]
    LOGICAL  :: WrTxtOutFile      ! Write a text (formatted) output file? (.out) [-]
    LOGICAL  :: SumPrint      ! Print summary data to file? (.sum) [-]
    LOGICAL  :: WrGraphics      ! Write binary output files with mesh grahpics information? (.gra, .bin) [-]
    CHARACTER(1)  :: Delim      ! Delimiter between columns of text output file (.out): space or tab [-]
    CHARACTER(20)  :: OutFmt      ! Format used for text tabular output (except time); resulting field should be 10 characters [-]
    CHARACTER(1024)  :: OutFileRoot      ! The rootname of the output files [-]
    CHARACTER(1024)  :: FTitle      ! The description line from the FAST (glue-code) input file [-]
  END TYPE FAST_ParameterType
! =======================
! =========  FAST_OutputFileType  =======
  TYPE, PUBLIC :: FAST_OutputFileType
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: TimeData      ! Array to contain the time output data for the binary file (first output time and a time [fixed] increment) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AllOutData      ! Array to contain all the output data (time history of all outputs); Index 1 is NumOuts, Index 2 is Time step [-]
    INTEGER(IntKi)  :: n_Out      ! Time index into the AllOutData array [-]
    INTEGER(IntKi)  :: NOutSteps      ! Maximum number of output steps [-]
    INTEGER(IntKi) , DIMENSION(NumModules)  :: numOuts      ! number of outputs to print from each module [-]
    INTEGER(IntKi)  :: UnOu = -1      ! I/O unit number for the tabular output file [-]
    INTEGER(IntKi)  :: UnSum = -1      ! I/O unit number for the summary file [-]
    INTEGER(IntKi)  :: UnGra = -1      ! I/O unit number for mesh graphics [-]
    CHARACTER(1024) , DIMENSION(1:3)  :: FileDescLines      ! Description lines to include in output files (header, time run, plus module names/versions) [-]
    CHARACTER(ChanLen) , DIMENSION(:), ALLOCATABLE  :: ChannelNames      ! Names of the output channels [-]
    CHARACTER(ChanLen) , DIMENSION(:), ALLOCATABLE  :: ChannelUnits      ! Units for the output channels [-]
    TYPE(ProgDesc) , DIMENSION(NumModules)  :: Module_Ver      ! version information from all modules [-]
  END TYPE FAST_OutputFileType
! =======================
! =========  IceDyn_Data  =======
  TYPE, PUBLIC :: IceDyn_Data
    TYPE(IceD_ContinuousStateType) , DIMENSION(:,:), ALLOCATABLE  :: x      ! Continuous states [-]
    TYPE(IceD_DiscreteStateType) , DIMENSION(:,:), ALLOCATABLE  :: xd      ! Discrete states [-]
    TYPE(IceD_ConstraintStateType) , DIMENSION(:,:), ALLOCATABLE  :: z      ! Constraint states [-]
    TYPE(IceD_OtherStateType) , DIMENSION(:), ALLOCATABLE  :: OtherSt      ! Other/optimization states [-]
    TYPE(IceD_ParameterType) , DIMENSION(:), ALLOCATABLE  :: p      ! Parameters [-]
    TYPE(IceD_InputType) , DIMENSION(:), ALLOCATABLE  :: u      ! System inputs [-]
    TYPE(IceD_OutputType) , DIMENSION(:), ALLOCATABLE  :: y      ! System outputs [-]
    TYPE(IceD_OtherStateType) , DIMENSION(:), ALLOCATABLE  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(IceD_InputType) , DIMENSION(:,:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE IceDyn_Data
! =======================
! =========  ElastoDyn_Data  =======
  TYPE, PUBLIC :: ElastoDyn_Data
    TYPE(ED_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(ED_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(ED_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(ED_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(ED_ParameterType)  :: p      ! Parameters [-]
    TYPE(ED_InputType)  :: u      ! System inputs [-]
    TYPE(ED_OutputType)  :: y      ! System outputs [-]
    TYPE(ED_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(ED_OutputType) , DIMENSION(:), ALLOCATABLE  :: Output      ! Array of outputs associated with InputTimes [-]
    TYPE(ED_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE ElastoDyn_Data
! =======================
! =========  ServoDyn_Data  =======
  TYPE, PUBLIC :: ServoDyn_Data
    TYPE(SrvD_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(SrvD_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(SrvD_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(SrvD_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(SrvD_ParameterType)  :: p      ! Parameters [-]
    TYPE(SrvD_InputType)  :: u      ! System inputs [-]
    TYPE(SrvD_OutputType)  :: y      ! System outputs [-]
    TYPE(SrvD_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(SrvD_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
    TYPE(SrvD_OutputType)  :: y_prev      ! previous outputs; a hack because this basically makes them states. Used in BladedDLL [-]
  END TYPE ServoDyn_Data
! =======================
! =========  AeroDyn_Data  =======
  TYPE, PUBLIC :: AeroDyn_Data
    TYPE(AD_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(AD_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(AD_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(AD_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(AD_ParameterType)  :: p      ! Parameters [-]
    TYPE(AD_InputType)  :: u      ! System inputs [-]
    TYPE(AD_OutputType)  :: y      ! System outputs [-]
    TYPE(AD_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(AD_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE AeroDyn_Data
! =======================
! =========  InflowWind_Data  =======
  TYPE, PUBLIC :: InflowWind_Data
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: WriteOutput      ! Temporary hack for getting wind-speed outputs from InflowWind [-]
  END TYPE InflowWind_Data
! =======================
! =========  SubDyn_Data  =======
  TYPE, PUBLIC :: SubDyn_Data
    TYPE(SD_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(SD_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(SD_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(SD_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(SD_ParameterType)  :: p      ! Parameters [-]
    TYPE(SD_InputType)  :: u      ! System inputs [-]
    TYPE(SD_OutputType)  :: y      ! System outputs [-]
    TYPE(SD_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(SD_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE SubDyn_Data
! =======================
! =========  HydroDyn_Data  =======
  TYPE, PUBLIC :: HydroDyn_Data
    TYPE(HydroDyn_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(HydroDyn_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(HydroDyn_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(HydroDyn_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(HydroDyn_ParameterType)  :: p      ! Parameters [-]
    TYPE(HydroDyn_InputType)  :: u      ! System inputs [-]
    TYPE(HydroDyn_OutputType)  :: y      ! System outputs [-]
    TYPE(HydroDyn_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(HydroDyn_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE HydroDyn_Data
! =======================
! =========  IceFloe_Data  =======
  TYPE, PUBLIC :: IceFloe_Data
    TYPE(IceFloe_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(IceFloe_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(IceFloe_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(IceFloe_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(IceFloe_ParameterType)  :: p      ! Parameters [-]
    TYPE(IceFloe_InputType)  :: u      ! System inputs [-]
    TYPE(IceFloe_OutputType)  :: y      ! System outputs [-]
    TYPE(IceFloe_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(IceFloe_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE IceFloe_Data
! =======================
! =========  MAP_Data  =======
  TYPE, PUBLIC :: MAP_Data
    TYPE(MAP_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(MAP_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(MAP_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(MAP_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(MAP_ParameterType)  :: p      ! Parameters [-]
    TYPE(MAP_InputType)  :: u      ! System inputs [-]
    TYPE(MAP_OutputType)  :: y      ! System outputs [-]
    TYPE(MAP_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(MAP_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE MAP_Data
! =======================
! =========  FEAMooring_Data  =======
  TYPE, PUBLIC :: FEAMooring_Data
    TYPE(FEAM_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(FEAM_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(FEAM_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(FEAM_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(FEAM_ParameterType)  :: p      ! Parameters [-]
    TYPE(FEAM_InputType)  :: u      ! System inputs [-]
    TYPE(FEAM_OutputType)  :: y      ! System outputs [-]
    TYPE(FEAM_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(FEAM_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE FEAMooring_Data
! =======================
! =========  MoorDyn_Data  =======
  TYPE, PUBLIC :: MoorDyn_Data
    TYPE(MD_ContinuousStateType) , DIMENSION(1:2)  :: x      ! Continuous states [-]
    TYPE(MD_DiscreteStateType) , DIMENSION(1:2)  :: xd      ! Discrete states [-]
    TYPE(MD_ConstraintStateType) , DIMENSION(1:2)  :: z      ! Constraint states [-]
    TYPE(MD_OtherStateType)  :: OtherSt      ! Other/optimization states [-]
    TYPE(MD_ParameterType)  :: p      ! Parameters [-]
    TYPE(MD_InputType)  :: u      ! System inputs [-]
    TYPE(MD_OutputType)  :: y      ! System outputs [-]
    TYPE(MD_OtherStateType)  :: OtherSt_old      ! Other/optimization states (copied for the case of subcycling) [-]
    TYPE(MD_InputType) , DIMENSION(:), ALLOCATABLE  :: Input      ! Array of inputs associated with InputTimes [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: InputTimes      ! Array of times associated with Input Array [-]
  END TYPE MoorDyn_Data
! =======================
! =========  FAST_ModuleMapType  =======
  TYPE, PUBLIC :: FAST_ModuleMapType
    TYPE(MeshMapType)  :: ED_P_2_HD_W_P      ! Map ElastoDyn PlatformPtMesh to HydroDyn WAMIT Point [-]
    TYPE(MeshMapType)  :: HD_W_P_2_ED_P      ! Map HydroDyn WAMIT Point (from either y%Mesh or y%AllHydroOrigin) to ElastoDyn PlatformPtMesh [-]
    TYPE(MeshMapType)  :: ED_P_2_HD_M_P      ! Map ElastoDyn PlatformPtMesh to HydroDyn Morison Point [-]
    TYPE(MeshMapType)  :: HD_M_P_2_ED_P      ! Map HydroDyn Morison Point to ElastoDyn PlatformPtMesh [-]
    TYPE(MeshMapType)  :: ED_P_2_HD_M_L      ! Map ElastoDyn PlatformPtMesh to HydroDyn Morison Line2 [-]
    TYPE(MeshMapType)  :: HD_M_L_2_ED_P      ! Map HydroDyn Morison Line2 to ElastoDyn PlatformPtMesh [-]
    TYPE(MeshMapType)  :: ED_P_2_Mooring_P      ! Map ElastoDyn PlatformPtMesh to MAP/FEAM/MoorDyn point mesh [-]
    TYPE(MeshMapType)  :: Mooring_P_2_ED_P      ! Map FEAM/MAP/MoorDyn point mesh to ElastoDyn PlatformPtMesh [-]
    TYPE(MeshMapType)  :: ED_P_2_SD_TP      ! Map ElastoDyn PlatformPtMesh to SubDyn transition-piece point mesh [-]
    TYPE(MeshMapType)  :: SD_TP_2_ED_P      ! Map SubDyn transition-piece point mesh to ElastoDyn PlatformPtMesh [-]
    TYPE(MeshMapType)  :: SD_P_2_HD_M_P      ! Map SubDyn y2Mesh Point to HydroDyn Morison Point [-]
    TYPE(MeshMapType)  :: HD_M_P_2_SD_P      ! Map HydroDyn Morison Point to SubDyn y2Mesh Point [-]
    TYPE(MeshMapType)  :: SD_P_2_HD_M_L      ! Map SubDyn y2Mesh Point to HydroDyn Morison Line2 [-]
    TYPE(MeshMapType)  :: HD_M_L_2_SD_P      ! Map HydroDyn Morison Line2 to SubDyn y2Mesh Point [-]
    TYPE(MeshMapType)  :: ED_P_2_SrvD_P_N      ! Map ElastoDyn Nacelle point mesh to ServoDyn/TMD point mesh [-]
    TYPE(MeshMapType)  :: SrvD_P_2_ED_P_N      ! Map ServoDyn nacelle point mesh to ElastoDyn point mesh on the nacelle [-]
    TYPE(MeshMapType) , DIMENSION(:), ALLOCATABLE  :: ED_L_2_AD_L_B      ! Map ElastoDyn BladeLn2Mesh line2 mesh to AeroDyn InputMarkers line2 mesh [-]
    TYPE(MeshMapType) , DIMENSION(:), ALLOCATABLE  :: AD_L_2_ED_L_B      ! Map AeroDyn InputMarkers line2 mesh to ElastoDyn BladeLn2Mesh line2 mesh [-]
    TYPE(MeshMapType)  :: ED_L_2_AD_L_T      ! Map ElastoDyn TowerLn2Mesh line2 mesh to AeroDyn Twr_InputMarkers line2 mesh [-]
    TYPE(MeshMapType)  :: AD_L_2_ED_L_T      ! Map AeroDyn Twr_InputMarkers line2 mesh to ElastoDyn TowerLn2Mesh line2 mesh [-]
    TYPE(MeshMapType)  :: IceF_P_2_SD_P      ! Map IceFloe point mesh to SubDyn y2Mesh point mesh [-]
    TYPE(MeshMapType)  :: SD_P_2_IceF_P      ! Map SubDyn y2Mesh point mesh to IceFloe point mesh [-]
    TYPE(MeshMapType) , DIMENSION(:), ALLOCATABLE  :: IceD_P_2_SD_P      ! Map IceDyn point mesh to SubDyn y2Mesh point mesh [-]
    TYPE(MeshMapType) , DIMENSION(:), ALLOCATABLE  :: SD_P_2_IceD_P      ! Map SubDyn y2Mesh point mesh to IceDyn point mesh [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: Jacobian_ED_SD_HD      ! Stored Jacobian in ED_HD_InputOutputSolve, ED_SD_InputOutputSolve, or ED_SD_HD_InputOutputSolve [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: Jacobian_pivot      ! Pivot array used for LU decomposition of Jacobian_ED_SD_HD [-]
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: Jac_u_indx      ! matrix to help fill/pack the u vector in computing the jacobian [-]
    TYPE(MeshType)  :: u_ED_PlatformPtMesh      ! copy of ED input mesh [-]
    TYPE(MeshType)  :: u_ED_PlatformPtMesh_2      ! copy of ED input mesh (used only for temporary storage) [-]
    TYPE(MeshType)  :: u_SD_TPMesh      ! copy of SD input mesh [-]
    TYPE(MeshType)  :: u_SD_LMesh      ! copy of SD input mesh [-]
    TYPE(MeshType)  :: u_SD_LMesh_2      ! copy of SD input mesh (used only for temporary storage) [-]
    TYPE(MeshType)  :: u_HD_M_LumpedMesh      ! copy of HD input mesh [-]
    TYPE(MeshType)  :: u_HD_M_DistribMesh      ! copy of HD input mesh [-]
    TYPE(MeshType)  :: u_HD_Mesh      ! copy of HD input mesh [-]
  END TYPE FAST_ModuleMapType
! =======================
! =========  FAST_ExternInputType  =======
  TYPE, PUBLIC :: FAST_ExternInputType
    REAL(ReKi)  :: GenTrq      ! generator torque input from Simulink/Labview [-]
    REAL(ReKi)  :: ElecPwr      ! electric poser input from Simulink/Labview [-]
    REAL(ReKi)  :: YawPosCom      ! yaw position command from Simulink/Labview [-]
    REAL(ReKi)  :: YawRateCom      ! yaw rate command from Simulink/Labview [-]
    REAL(ReKi) , DIMENSION(1:3)  :: BlPitchCom      ! blade pitch commands from Simulink/Labview [rad/s]
    REAL(ReKi)  :: HSSBrFrac      ! Fraction of full braking torque: 0 (off) <= HSSBrFrac <= 1 (full) from Simulink or LabVIEW [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LidarFocus      ! lidar focus (relative to lidar location) [m]
  END TYPE FAST_ExternInputType
! =======================
! =========  FAST_MiscVarType  =======
  TYPE, PUBLIC :: FAST_MiscVarType
    REAL(DbKi)  :: TiLstPrn      ! The simulation time of the last print (to file) [(s)]
    REAL(DbKi)  :: t_global      ! Current simulation time (for global/FAST simulation) [(s)]
    REAL(DbKi)  :: NextJacCalcTime      ! Time between calculating Jacobians in the HD-ED and SD-ED simulations [(s)]
    REAL(ReKi)  :: PrevClockTime      ! Clock time at start of simulation in seconds [(s)]
    REAL(ReKi)  :: UsrTime1      ! User CPU time for simulation initialization [(s)]
    REAL(ReKi)  :: UsrTime2      ! User CPU time for simulation (without intialization) [(s)]
    INTEGER(IntKi) , DIMENSION(1:8)  :: StrtTime      ! Start time of simulation (including intialization) [-]
    INTEGER(IntKi) , DIMENSION(1:8)  :: SimStrtTime      ! Start time of simulation (after initialization) [-]
    INTEGER(IntKi)  :: n_TMax_m1      ! The time step of TMax - dt (the end time of the simulation) [(-)]
    LOGICAL  :: calcJacobian      ! Should we calculate Jacobians in Option 1? [(flag)]
    TYPE(FAST_ExternInputType)  :: ExternInput      ! external input values [-]
  END TYPE FAST_MiscVarType
! =======================
! =========  FAST_ExternInitType  =======
  TYPE, PUBLIC :: FAST_ExternInitType
    REAL(DbKi)  :: Tmax = -1      ! External code specified Tmax [s]
    INTEGER(IntKi)  :: SensorType = SensorType_None      ! lidar sensor type, which should not be pulsed at the moment; this input should be replaced with a section in the InflowWind input file [-]
    LOGICAL  :: LidRadialVel      ! TRUE => return radial component, FALSE => return 'x' direction estimate [-]
  END TYPE FAST_ExternInitType
! =======================
CONTAINS
 SUBROUTINE FAST_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_ParameterType), INTENT(IN) :: SrcParamData
   TYPE(FAST_ParameterType), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%DT = SrcParamData%DT
   DstParamData%DT_module = SrcParamData%DT_module
   DstParamData%n_substeps = SrcParamData%n_substeps
   DstParamData%TMax = SrcParamData%TMax
   DstParamData%InterpOrder = SrcParamData%InterpOrder
   DstParamData%NumCrctn = SrcParamData%NumCrctn
   DstParamData%KMax = SrcParamData%KMax
   DstParamData%numIceLegs = SrcParamData%numIceLegs
   DstParamData%ModuleInitialized = SrcParamData%ModuleInitialized
   DstParamData%DT_Ujac = SrcParamData%DT_Ujac
   DstParamData%UJacSclFact = SrcParamData%UJacSclFact
   DstParamData%SizeJac_ED_SD_HD = SrcParamData%SizeJac_ED_SD_HD
   DstParamData%CompElast = SrcParamData%CompElast
   DstParamData%CompAero = SrcParamData%CompAero
   DstParamData%CompServo = SrcParamData%CompServo
   DstParamData%CompHydro = SrcParamData%CompHydro
   DstParamData%CompSub = SrcParamData%CompSub
   DstParamData%CompMooring = SrcParamData%CompMooring
   DstParamData%CompIce = SrcParamData%CompIce
   DstParamData%CompUserPtfmLd = SrcParamData%CompUserPtfmLd
   DstParamData%CompUserTwrLd = SrcParamData%CompUserTwrLd
   DstParamData%UseDWM = SrcParamData%UseDWM
   DstParamData%EDFile = SrcParamData%EDFile
   DstParamData%BDBldFile = SrcParamData%BDBldFile
   DstParamData%AeroFile = SrcParamData%AeroFile
   DstParamData%ServoFile = SrcParamData%ServoFile
   DstParamData%HydroFile = SrcParamData%HydroFile
   DstParamData%SubFile = SrcParamData%SubFile
   DstParamData%MooringFile = SrcParamData%MooringFile
   DstParamData%IceFile = SrcParamData%IceFile
   DstParamData%SttsTime = SrcParamData%SttsTime
   DstParamData%TStart = SrcParamData%TStart
   DstParamData%DT_Out = SrcParamData%DT_Out
   DstParamData%n_SttsTime = SrcParamData%n_SttsTime
   DstParamData%TurbineType = SrcParamData%TurbineType
   DstParamData%WrBinOutFile = SrcParamData%WrBinOutFile
   DstParamData%WrTxtOutFile = SrcParamData%WrTxtOutFile
   DstParamData%SumPrint = SrcParamData%SumPrint
   DstParamData%WrGraphics = SrcParamData%WrGraphics
   DstParamData%Delim = SrcParamData%Delim
   DstParamData%OutFmt = SrcParamData%OutFmt
   DstParamData%OutFileRoot = SrcParamData%OutFileRoot
   DstParamData%FTitle = SrcParamData%FTitle
 END SUBROUTINE FAST_CopyParam

 SUBROUTINE FAST_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(FAST_ParameterType), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE FAST_DestroyParam

 SUBROUTINE FAST_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_ParameterType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Db_BufSz    = Db_BufSz    + SIZE( InData%DT_module )  ! DT_module 
  Int_BufSz   = Int_BufSz   + SIZE( InData%n_substeps )  ! n_substeps 
  Db_BufSz   = Db_BufSz   + 1  ! TMax
  Int_BufSz  = Int_BufSz  + 1  ! InterpOrder
  Int_BufSz  = Int_BufSz  + 1  ! NumCrctn
  Int_BufSz  = Int_BufSz  + 1  ! KMax
  Int_BufSz  = Int_BufSz  + 1  ! numIceLegs
  Int_BufSz   = Int_BufSz   + SIZE( InData%ModuleInitialized )  ! ModuleInitialized 
  Db_BufSz   = Db_BufSz   + 1  ! DT_Ujac
  Re_BufSz   = Re_BufSz   + 1  ! UJacSclFact
  Int_BufSz   = Int_BufSz   + SIZE( InData%SizeJac_ED_SD_HD )  ! SizeJac_ED_SD_HD 
  Int_BufSz  = Int_BufSz  + 1  ! CompElast
  Int_BufSz  = Int_BufSz  + 1  ! CompAero
  Int_BufSz  = Int_BufSz  + 1  ! CompServo
  Int_BufSz  = Int_BufSz  + 1  ! CompHydro
  Int_BufSz  = Int_BufSz  + 1  ! CompSub
  Int_BufSz  = Int_BufSz  + 1  ! CompMooring
  Int_BufSz  = Int_BufSz  + 1  ! CompIce
  Int_BufSz  = Int_BufSz  + 1  ! CompUserPtfmLd
  Int_BufSz  = Int_BufSz  + 1  ! CompUserTwrLd
  Int_BufSz  = Int_BufSz  + 1  ! UseDWM
!  missing buffer for EDFile
!  missing buffer for BDBldFile
!  missing buffer for AeroFile
!  missing buffer for ServoFile
!  missing buffer for HydroFile
!  missing buffer for SubFile
!  missing buffer for MooringFile
!  missing buffer for IceFile
  Db_BufSz   = Db_BufSz   + 1  ! SttsTime
  Db_BufSz   = Db_BufSz   + 1  ! TStart
  Db_BufSz   = Db_BufSz   + 1  ! DT_Out
  Int_BufSz  = Int_BufSz  + 1  ! n_SttsTime
  Int_BufSz  = Int_BufSz  + 1  ! TurbineType
  Int_BufSz  = Int_BufSz  + 1  ! WrBinOutFile
  Int_BufSz  = Int_BufSz  + 1  ! WrTxtOutFile
  Int_BufSz  = Int_BufSz  + 1  ! SumPrint
  Int_BufSz  = Int_BufSz  + 1  ! WrGraphics
!  missing buffer for Delim
!  missing buffer for OutFmt
!  missing buffer for OutFileRoot
!  missing buffer for FTitle
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%DT_module))-1 ) =  PACK(InData%DT_module ,.TRUE.)
  Db_Xferred   = Db_Xferred   + SIZE(InData%DT_module)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%n_substeps))-1 ) = PACK(InData%n_substeps ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%n_substeps)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TMax )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%InterpOrder )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumCrctn )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%KMax )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%numIceLegs )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ModuleInitialized))-1 ) = TRANSFER( PACK(InData%ModuleInitialized ,.TRUE.), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + SIZE(InData%ModuleInitialized)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT_Ujac )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UJacSclFact )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SizeJac_ED_SD_HD))-1 ) = PACK(InData%SizeJac_ED_SD_HD ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%SizeJac_ED_SD_HD)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompElast )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompAero )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompServo )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompHydro )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompSub )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompMooring )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%CompIce )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%CompUserPtfmLd ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%CompUserTwrLd ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseDWM ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%SttsTime )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TStart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT_Out )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n_SttsTime )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TurbineType )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrBinOutFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrTxtOutFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SumPrint ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrGraphics ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE FAST_PackParam

 SUBROUTINE FAST_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_ParameterType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%DT_module,1)))
  mask1 = .TRUE.
  OutData%DT_module = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%DT_module))-1 ),mask1,OutData%DT_module)
  DEALLOCATE(mask1)
  Db_Xferred   = Db_Xferred   + SIZE(OutData%DT_module)
  ALLOCATE(mask1(SIZE(OutData%n_substeps,1)))
  mask1 = .TRUE.
  OutData%n_substeps = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%n_substeps))-1 ),mask1,OutData%n_substeps)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%n_substeps)
  OutData%TMax = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%InterpOrder = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NumCrctn = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%KMax = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%numIceLegs = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DT_Ujac = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%UJacSclFact = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%SizeJac_ED_SD_HD,1)))
  mask1 = .TRUE.
  OutData%SizeJac_ED_SD_HD = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SizeJac_ED_SD_HD))-1 ),mask1,OutData%SizeJac_ED_SD_HD)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%SizeJac_ED_SD_HD)
  OutData%CompElast = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompAero = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompServo = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompHydro = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompSub = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompMooring = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%CompIce = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%SttsTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%TStart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DT_Out = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%n_SttsTime = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TurbineType = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackParam

 SUBROUTINE FAST_CopyOutputFileType( SrcOutputFileTypeData, DstOutputFileTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_OutputFileType), INTENT(IN) :: SrcOutputFileTypeData
   TYPE(FAST_OutputFileType), INTENT(INOUT) :: DstOutputFileTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcOutputFileTypeData%TimeData)) THEN
   i1_l = LBOUND(SrcOutputFileTypeData%TimeData,1)
   i1_u = UBOUND(SrcOutputFileTypeData%TimeData,1)
   IF (.NOT. ALLOCATED(DstOutputFileTypeData%TimeData)) THEN 
      ALLOCATE(DstOutputFileTypeData%TimeData(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputFileTypeData%TimeData.', ErrStat, ErrMsg,'FAST_CopyOutputFileType')
         RETURN
      END IF
   END IF
   DstOutputFileTypeData%TimeData = SrcOutputFileTypeData%TimeData
ENDIF
IF (ALLOCATED(SrcOutputFileTypeData%AllOutData)) THEN
   i1_l = LBOUND(SrcOutputFileTypeData%AllOutData,1)
   i1_u = UBOUND(SrcOutputFileTypeData%AllOutData,1)
   i2_l = LBOUND(SrcOutputFileTypeData%AllOutData,2)
   i2_u = UBOUND(SrcOutputFileTypeData%AllOutData,2)
   IF (.NOT. ALLOCATED(DstOutputFileTypeData%AllOutData)) THEN 
      ALLOCATE(DstOutputFileTypeData%AllOutData(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputFileTypeData%AllOutData.', ErrStat, ErrMsg,'FAST_CopyOutputFileType')
         RETURN
      END IF
   END IF
   DstOutputFileTypeData%AllOutData = SrcOutputFileTypeData%AllOutData
ENDIF
   DstOutputFileTypeData%n_Out = SrcOutputFileTypeData%n_Out
   DstOutputFileTypeData%NOutSteps = SrcOutputFileTypeData%NOutSteps
   DstOutputFileTypeData%numOuts = SrcOutputFileTypeData%numOuts
   DstOutputFileTypeData%UnOu = SrcOutputFileTypeData%UnOu
   DstOutputFileTypeData%UnSum = SrcOutputFileTypeData%UnSum
   DstOutputFileTypeData%UnGra = SrcOutputFileTypeData%UnGra
   DstOutputFileTypeData%FileDescLines = SrcOutputFileTypeData%FileDescLines
IF (ALLOCATED(SrcOutputFileTypeData%ChannelNames)) THEN
   i1_l = LBOUND(SrcOutputFileTypeData%ChannelNames,1)
   i1_u = UBOUND(SrcOutputFileTypeData%ChannelNames,1)
   IF (.NOT. ALLOCATED(DstOutputFileTypeData%ChannelNames)) THEN 
      ALLOCATE(DstOutputFileTypeData%ChannelNames(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputFileTypeData%ChannelNames.', ErrStat, ErrMsg,'FAST_CopyOutputFileType')
         RETURN
      END IF
   END IF
   DstOutputFileTypeData%ChannelNames = SrcOutputFileTypeData%ChannelNames
ENDIF
IF (ALLOCATED(SrcOutputFileTypeData%ChannelUnits)) THEN
   i1_l = LBOUND(SrcOutputFileTypeData%ChannelUnits,1)
   i1_u = UBOUND(SrcOutputFileTypeData%ChannelUnits,1)
   IF (.NOT. ALLOCATED(DstOutputFileTypeData%ChannelUnits)) THEN 
      ALLOCATE(DstOutputFileTypeData%ChannelUnits(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputFileTypeData%ChannelUnits.', ErrStat, ErrMsg,'FAST_CopyOutputFileType')
         RETURN
      END IF
   END IF
   DstOutputFileTypeData%ChannelUnits = SrcOutputFileTypeData%ChannelUnits
ENDIF
   DO i1 = LBOUND(SrcOutputFileTypeData%Module_Ver,1), UBOUND(SrcOutputFileTypeData%Module_Ver,1)
      CALL NWTC_Library_Copyprogdesc( SrcOutputFileTypeData%Module_Ver(i1), DstOutputFileTypeData%Module_Ver(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyOutputFileType:Module_Ver(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
 END SUBROUTINE FAST_CopyOutputFileType

 SUBROUTINE FAST_DestroyOutputFileType( OutputFileTypeData, ErrStat, ErrMsg )
  TYPE(FAST_OutputFileType), INTENT(INOUT) :: OutputFileTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OutputFileTypeData%TimeData)) THEN
   DEALLOCATE(OutputFileTypeData%TimeData)
ENDIF
IF (ALLOCATED(OutputFileTypeData%AllOutData)) THEN
   DEALLOCATE(OutputFileTypeData%AllOutData)
ENDIF
IF (ALLOCATED(OutputFileTypeData%ChannelNames)) THEN
   DEALLOCATE(OutputFileTypeData%ChannelNames)
ENDIF
IF (ALLOCATED(OutputFileTypeData%ChannelUnits)) THEN
   DEALLOCATE(OutputFileTypeData%ChannelUnits)
ENDIF
DO i1 = LBOUND(OutputFileTypeData%Module_Ver,1), UBOUND(OutputFileTypeData%Module_Ver,1)
  CALL NWTC_Library_Destroyprogdesc( OutputFileTypeData%Module_Ver(i1), ErrStat, ErrMsg )
ENDDO
 END SUBROUTINE FAST_DestroyOutputFileType

 SUBROUTINE FAST_PackOutputFileType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_OutputFileType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Module_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Module_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Module_Ver_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%TimeData) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TimeData )  ! TimeData 
  IF ( ALLOCATED(InData%AllOutData) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AllOutData )  ! AllOutData 
  Int_BufSz  = Int_BufSz  + 1  ! n_Out
  Int_BufSz  = Int_BufSz  + 1  ! NOutSteps
  Int_BufSz   = Int_BufSz   + SIZE( InData%numOuts )  ! numOuts 
  Int_BufSz  = Int_BufSz  + 1  ! UnOu
  Int_BufSz  = Int_BufSz  + 1  ! UnSum
  Int_BufSz  = Int_BufSz  + 1  ! UnGra
!  missing buffer for FileDescLines
!  missing buffer for ChannelNames
!  missing buffer for ChannelUnits
DO i1 = LBOUND(InData%Module_Ver,1), UBOUND(InData%Module_Ver,1)
  CALL NWTC_Library_Packprogdesc( Re_Module_Ver_Buf, Db_Module_Ver_Buf, Int_Module_Ver_Buf, InData%Module_Ver(i1), ErrStat, ErrMsg, .TRUE. ) ! Module_Ver 
  IF(ALLOCATED(Re_Module_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Module_Ver_Buf  ) ! Module_Ver
  IF(ALLOCATED(Db_Module_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Module_Ver_Buf  ) ! Module_Ver
  IF(ALLOCATED(Int_Module_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Module_Ver_Buf ) ! Module_Ver
  IF(ALLOCATED(Re_Module_Ver_Buf))  DEALLOCATE(Re_Module_Ver_Buf)
  IF(ALLOCATED(Db_Module_Ver_Buf))  DEALLOCATE(Db_Module_Ver_Buf)
  IF(ALLOCATED(Int_Module_Ver_Buf)) DEALLOCATE(Int_Module_Ver_Buf)
ENDDO
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%TimeData) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TimeData))-1 ) =  PACK(InData%TimeData ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TimeData)
  ENDIF
  IF ( ALLOCATED(InData%AllOutData) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AllOutData))-1 ) =  PACK(InData%AllOutData ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AllOutData)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n_Out )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NOutSteps )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%numOuts))-1 ) = PACK(InData%numOuts ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%numOuts)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnOu )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnSum )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnGra )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(InData%Module_Ver,1), UBOUND(InData%Module_Ver,1)
  CALL NWTC_Library_Packprogdesc( Re_Module_Ver_Buf, Db_Module_Ver_Buf, Int_Module_Ver_Buf, InData%Module_Ver(i1), ErrStat, ErrMsg, OnlySize ) ! Module_Ver 
  IF(ALLOCATED(Re_Module_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Module_Ver_Buf)-1 ) = Re_Module_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Module_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Module_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Module_Ver_Buf)-1 ) = Db_Module_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Module_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Module_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Module_Ver_Buf)-1 ) = Int_Module_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Module_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Module_Ver_Buf) )  DEALLOCATE(Re_Module_Ver_Buf)
  IF( ALLOCATED(Db_Module_Ver_Buf) )  DEALLOCATE(Db_Module_Ver_Buf)
  IF( ALLOCATED(Int_Module_Ver_Buf) ) DEALLOCATE(Int_Module_Ver_Buf)
ENDDO
 END SUBROUTINE FAST_PackOutputFileType

 SUBROUTINE FAST_UnPackOutputFileType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_OutputFileType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Module_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Module_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Module_Ver_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%TimeData) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TimeData,1)))
  mask1 = .TRUE.
    OutData%TimeData = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TimeData))-1 ),mask1,OutData%TimeData)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TimeData)
  ENDIF
  IF ( ALLOCATED(OutData%AllOutData) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AllOutData,1),SIZE(OutData%AllOutData,2)))
  mask2 = .TRUE.
    OutData%AllOutData = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AllOutData))-1 ),mask2,OutData%AllOutData)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AllOutData)
  ENDIF
  OutData%n_Out = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NOutSteps = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%numOuts,1)))
  mask1 = .TRUE.
  OutData%numOuts = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%numOuts))-1 ),mask1,OutData%numOuts)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%numOuts)
  OutData%UnOu = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnSum = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnGra = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(OutData%Module_Ver,1), UBOUND(OutData%Module_Ver,1)
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Module_Ver_Buf, Db_Module_Ver_Buf, Int_Module_Ver_Buf, OutData%Module_Ver(i1), ErrStat, ErrMsg, .TRUE. ) ! Module_Ver 
  IF(ALLOCATED(Re_Module_Ver_Buf)) THEN
    Re_Module_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Module_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Module_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Module_Ver_Buf)) THEN
    Db_Module_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Module_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Module_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Module_Ver_Buf)) THEN
    Int_Module_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Module_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Module_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Module_Ver_Buf, Db_Module_Ver_Buf, Int_Module_Ver_Buf, OutData%Module_Ver(i1), ErrStat, ErrMsg ) ! Module_Ver 
ENDDO
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackOutputFileType

 SUBROUTINE FAST_CopyIceDyn_Data( SrcIceDyn_DataData, DstIceDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(IceDyn_Data), INTENT(INOUT) :: SrcIceDyn_DataData
   TYPE(IceDyn_Data), INTENT(INOUT) :: DstIceDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcIceDyn_DataData%x)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%x,1)
   i1_u = UBOUND(SrcIceDyn_DataData%x,1)
   i2_l = LBOUND(SrcIceDyn_DataData%x,2)
   i2_u = UBOUND(SrcIceDyn_DataData%x,2)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%x)) THEN 
      ALLOCATE(DstIceDyn_DataData%x(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%x.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i2 = LBOUND(SrcIceDyn_DataData%x,2), UBOUND(SrcIceDyn_DataData%x,2)
   DO i1 = LBOUND(SrcIceDyn_DataData%x,1), UBOUND(SrcIceDyn_DataData%x,1)
      CALL IceD_CopyContState( SrcIceDyn_DataData%x(i1,i2), DstIceDyn_DataData%x(i1,i2), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:x(i1,i2)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%xd)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%xd,1)
   i1_u = UBOUND(SrcIceDyn_DataData%xd,1)
   i2_l = LBOUND(SrcIceDyn_DataData%xd,2)
   i2_u = UBOUND(SrcIceDyn_DataData%xd,2)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%xd)) THEN 
      ALLOCATE(DstIceDyn_DataData%xd(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%xd.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i2 = LBOUND(SrcIceDyn_DataData%xd,2), UBOUND(SrcIceDyn_DataData%xd,2)
   DO i1 = LBOUND(SrcIceDyn_DataData%xd,1), UBOUND(SrcIceDyn_DataData%xd,1)
      CALL IceD_CopyDiscState( SrcIceDyn_DataData%xd(i1,i2), DstIceDyn_DataData%xd(i1,i2), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:xd(i1,i2)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%z)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%z,1)
   i1_u = UBOUND(SrcIceDyn_DataData%z,1)
   i2_l = LBOUND(SrcIceDyn_DataData%z,2)
   i2_u = UBOUND(SrcIceDyn_DataData%z,2)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%z)) THEN 
      ALLOCATE(DstIceDyn_DataData%z(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%z.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i2 = LBOUND(SrcIceDyn_DataData%z,2), UBOUND(SrcIceDyn_DataData%z,2)
   DO i1 = LBOUND(SrcIceDyn_DataData%z,1), UBOUND(SrcIceDyn_DataData%z,1)
      CALL IceD_CopyConstrState( SrcIceDyn_DataData%z(i1,i2), DstIceDyn_DataData%z(i1,i2), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:z(i1,i2)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%OtherSt)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%OtherSt,1)
   i1_u = UBOUND(SrcIceDyn_DataData%OtherSt,1)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%OtherSt)) THEN 
      ALLOCATE(DstIceDyn_DataData%OtherSt(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%OtherSt.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceDyn_DataData%OtherSt,1), UBOUND(SrcIceDyn_DataData%OtherSt,1)
      CALL IceD_CopyOtherState( SrcIceDyn_DataData%OtherSt(i1), DstIceDyn_DataData%OtherSt(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:OtherSt(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%p)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%p,1)
   i1_u = UBOUND(SrcIceDyn_DataData%p,1)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%p)) THEN 
      ALLOCATE(DstIceDyn_DataData%p(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%p.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceDyn_DataData%p,1), UBOUND(SrcIceDyn_DataData%p,1)
      CALL IceD_CopyParam( SrcIceDyn_DataData%p(i1), DstIceDyn_DataData%p(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:p(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%u)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%u,1)
   i1_u = UBOUND(SrcIceDyn_DataData%u,1)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%u)) THEN 
      ALLOCATE(DstIceDyn_DataData%u(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%u.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceDyn_DataData%u,1), UBOUND(SrcIceDyn_DataData%u,1)
      CALL IceD_CopyInput( SrcIceDyn_DataData%u(i1), DstIceDyn_DataData%u(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:u(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%y)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%y,1)
   i1_u = UBOUND(SrcIceDyn_DataData%y,1)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%y)) THEN 
      ALLOCATE(DstIceDyn_DataData%y(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%y.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceDyn_DataData%y,1), UBOUND(SrcIceDyn_DataData%y,1)
      CALL IceD_CopyOutput( SrcIceDyn_DataData%y(i1), DstIceDyn_DataData%y(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:y(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%OtherSt_old)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%OtherSt_old,1)
   i1_u = UBOUND(SrcIceDyn_DataData%OtherSt_old,1)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%OtherSt_old)) THEN 
      ALLOCATE(DstIceDyn_DataData%OtherSt_old(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%OtherSt_old.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceDyn_DataData%OtherSt_old,1), UBOUND(SrcIceDyn_DataData%OtherSt_old,1)
      CALL IceD_CopyOtherState( SrcIceDyn_DataData%OtherSt_old(i1), DstIceDyn_DataData%OtherSt_old(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:OtherSt_old(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%Input,1)
   i1_u = UBOUND(SrcIceDyn_DataData%Input,1)
   i2_l = LBOUND(SrcIceDyn_DataData%Input,2)
   i2_u = UBOUND(SrcIceDyn_DataData%Input,2)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%Input)) THEN 
      ALLOCATE(DstIceDyn_DataData%Input(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DO i2 = LBOUND(SrcIceDyn_DataData%Input,2), UBOUND(SrcIceDyn_DataData%Input,2)
   DO i1 = LBOUND(SrcIceDyn_DataData%Input,1), UBOUND(SrcIceDyn_DataData%Input,1)
      CALL IceD_CopyInput( SrcIceDyn_DataData%Input(i1,i2), DstIceDyn_DataData%Input(i1,i2), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceDyn_Data:Input(i1,i2)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcIceDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcIceDyn_DataData%InputTimes,1)
   i2_l = LBOUND(SrcIceDyn_DataData%InputTimes,2)
   i2_u = UBOUND(SrcIceDyn_DataData%InputTimes,2)
   IF (.NOT. ALLOCATED(DstIceDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstIceDyn_DataData%InputTimes(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyIceDyn_Data')
         RETURN
      END IF
   END IF
   DstIceDyn_DataData%InputTimes = SrcIceDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyIceDyn_Data

 SUBROUTINE FAST_DestroyIceDyn_Data( IceDyn_DataData, ErrStat, ErrMsg )
  TYPE(IceDyn_Data), INTENT(INOUT) :: IceDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(IceDyn_DataData%x)) THEN
DO i2 = LBOUND(IceDyn_DataData%x,2), UBOUND(IceDyn_DataData%x,2)
DO i1 = LBOUND(IceDyn_DataData%x,1), UBOUND(IceDyn_DataData%x,1)
  CALL IceD_DestroyContState( IceDyn_DataData%x(i1,i2), ErrStat, ErrMsg )
ENDDO
ENDDO
   DEALLOCATE(IceDyn_DataData%x)
ENDIF
IF (ALLOCATED(IceDyn_DataData%xd)) THEN
DO i2 = LBOUND(IceDyn_DataData%xd,2), UBOUND(IceDyn_DataData%xd,2)
DO i1 = LBOUND(IceDyn_DataData%xd,1), UBOUND(IceDyn_DataData%xd,1)
  CALL IceD_DestroyDiscState( IceDyn_DataData%xd(i1,i2), ErrStat, ErrMsg )
ENDDO
ENDDO
   DEALLOCATE(IceDyn_DataData%xd)
ENDIF
IF (ALLOCATED(IceDyn_DataData%z)) THEN
DO i2 = LBOUND(IceDyn_DataData%z,2), UBOUND(IceDyn_DataData%z,2)
DO i1 = LBOUND(IceDyn_DataData%z,1), UBOUND(IceDyn_DataData%z,1)
  CALL IceD_DestroyConstrState( IceDyn_DataData%z(i1,i2), ErrStat, ErrMsg )
ENDDO
ENDDO
   DEALLOCATE(IceDyn_DataData%z)
ENDIF
IF (ALLOCATED(IceDyn_DataData%OtherSt)) THEN
DO i1 = LBOUND(IceDyn_DataData%OtherSt,1), UBOUND(IceDyn_DataData%OtherSt,1)
  CALL IceD_DestroyOtherState( IceDyn_DataData%OtherSt(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceDyn_DataData%OtherSt)
ENDIF
IF (ALLOCATED(IceDyn_DataData%p)) THEN
DO i1 = LBOUND(IceDyn_DataData%p,1), UBOUND(IceDyn_DataData%p,1)
  CALL IceD_DestroyParam( IceDyn_DataData%p(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceDyn_DataData%p)
ENDIF
IF (ALLOCATED(IceDyn_DataData%u)) THEN
DO i1 = LBOUND(IceDyn_DataData%u,1), UBOUND(IceDyn_DataData%u,1)
  CALL IceD_DestroyInput( IceDyn_DataData%u(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceDyn_DataData%u)
ENDIF
IF (ALLOCATED(IceDyn_DataData%y)) THEN
DO i1 = LBOUND(IceDyn_DataData%y,1), UBOUND(IceDyn_DataData%y,1)
  CALL IceD_DestroyOutput( IceDyn_DataData%y(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceDyn_DataData%y)
ENDIF
IF (ALLOCATED(IceDyn_DataData%OtherSt_old)) THEN
DO i1 = LBOUND(IceDyn_DataData%OtherSt_old,1), UBOUND(IceDyn_DataData%OtherSt_old,1)
  CALL IceD_DestroyOtherState( IceDyn_DataData%OtherSt_old(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceDyn_DataData%OtherSt_old)
ENDIF
IF (ALLOCATED(IceDyn_DataData%Input)) THEN
DO i2 = LBOUND(IceDyn_DataData%Input,2), UBOUND(IceDyn_DataData%Input,2)
DO i1 = LBOUND(IceDyn_DataData%Input,1), UBOUND(IceDyn_DataData%Input,1)
  CALL IceD_DestroyInput( IceDyn_DataData%Input(i1,i2), ErrStat, ErrMsg )
ENDDO
ENDDO
   DEALLOCATE(IceDyn_DataData%Input)
ENDIF
IF (ALLOCATED(IceDyn_DataData%InputTimes)) THEN
   DEALLOCATE(IceDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyIceDyn_Data

 SUBROUTINE FAST_PackIceDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(IceDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i2 = LBOUND(InData%x,2), UBOUND(InData%x,2)
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL IceD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
ENDDO
DO i2 = LBOUND(InData%xd,2), UBOUND(InData%xd,2)
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL IceD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
ENDDO
DO i2 = LBOUND(InData%z,2), UBOUND(InData%z,2)
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL IceD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
ENDDO
DO i1 = LBOUND(InData%OtherSt,1), UBOUND(InData%OtherSt,1)
  CALL IceD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt(i1), ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
ENDDO
DO i1 = LBOUND(InData%p,1), UBOUND(InData%p,1)
  CALL IceD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p(i1), ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
ENDDO
DO i1 = LBOUND(InData%u,1), UBOUND(InData%u,1)
  CALL IceD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u(i1), ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
ENDDO
DO i1 = LBOUND(InData%y,1), UBOUND(InData%y,1)
  CALL IceD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y(i1), ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
ENDDO
DO i1 = LBOUND(InData%OtherSt_old,1), UBOUND(InData%OtherSt_old,1)
  CALL IceD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old(i1), ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
ENDDO
DO i2 = LBOUND(InData%Input,2), UBOUND(InData%Input,2)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL IceD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i2 = LBOUND(InData%x,2), UBOUND(InData%x,2)
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL IceD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1,i2), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
ENDDO
DO i2 = LBOUND(InData%xd,2), UBOUND(InData%xd,2)
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL IceD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1,i2), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
ENDDO
DO i2 = LBOUND(InData%z,2), UBOUND(InData%z,2)
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL IceD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1,i2), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
ENDDO
DO i1 = LBOUND(InData%OtherSt,1), UBOUND(InData%OtherSt,1)
  CALL IceD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt(i1), ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
ENDDO
DO i1 = LBOUND(InData%p,1), UBOUND(InData%p,1)
  CALL IceD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p(i1), ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
ENDDO
DO i1 = LBOUND(InData%u,1), UBOUND(InData%u,1)
  CALL IceD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u(i1), ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
ENDDO
DO i1 = LBOUND(InData%y,1), UBOUND(InData%y,1)
  CALL IceD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y(i1), ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
ENDDO
DO i1 = LBOUND(InData%OtherSt_old,1), UBOUND(InData%OtherSt_old,1)
  CALL IceD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old(i1), ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
ENDDO
DO i2 = LBOUND(InData%Input,2), UBOUND(InData%Input,2)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL IceD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1,i2), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackIceDyn_Data

 SUBROUTINE FAST_UnPackIceDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(IceDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i2 = LBOUND(OutData%x,2), UBOUND(OutData%x,2)
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call IceD_PackContState to get correctly sized buffers for unpacking
  CALL IceD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL IceD_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1,i2), ErrStat, ErrMsg ) ! x 
ENDDO
ENDDO
DO i2 = LBOUND(OutData%xd,2), UBOUND(OutData%xd,2)
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call IceD_PackDiscState to get correctly sized buffers for unpacking
  CALL IceD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL IceD_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1,i2), ErrStat, ErrMsg ) ! xd 
ENDDO
ENDDO
DO i2 = LBOUND(OutData%z,2), UBOUND(OutData%z,2)
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call IceD_PackConstrState to get correctly sized buffers for unpacking
  CALL IceD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL IceD_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1,i2), ErrStat, ErrMsg ) ! z 
ENDDO
ENDDO
DO i1 = LBOUND(OutData%OtherSt,1), UBOUND(OutData%OtherSt,1)
 ! first call IceD_PackOtherState to get correctly sized buffers for unpacking
  CALL IceD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt(i1), ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL IceD_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt(i1), ErrStat, ErrMsg ) ! OtherSt 
ENDDO
DO i1 = LBOUND(OutData%p,1), UBOUND(OutData%p,1)
 ! first call IceD_PackParam to get correctly sized buffers for unpacking
  CALL IceD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p(i1), ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL IceD_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p(i1), ErrStat, ErrMsg ) ! p 
ENDDO
DO i1 = LBOUND(OutData%u,1), UBOUND(OutData%u,1)
 ! first call IceD_PackInput to get correctly sized buffers for unpacking
  CALL IceD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u(i1), ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL IceD_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u(i1), ErrStat, ErrMsg ) ! u 
ENDDO
DO i1 = LBOUND(OutData%y,1), UBOUND(OutData%y,1)
 ! first call IceD_PackOutput to get correctly sized buffers for unpacking
  CALL IceD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y(i1), ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL IceD_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y(i1), ErrStat, ErrMsg ) ! y 
ENDDO
DO i1 = LBOUND(OutData%OtherSt_old,1), UBOUND(OutData%OtherSt_old,1)
 ! first call IceD_PackOtherState to get correctly sized buffers for unpacking
  CALL IceD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old(i1), ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL IceD_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old(i1), ErrStat, ErrMsg ) ! OtherSt_old 
ENDDO
DO i2 = LBOUND(OutData%Input,2), UBOUND(OutData%Input,2)
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call IceD_PackInput to get correctly sized buffers for unpacking
  CALL IceD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1,i2), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL IceD_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1,i2), ErrStat, ErrMsg ) ! Input 
ENDDO
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask2(SIZE(OutData%InputTimes,1),SIZE(OutData%InputTimes,2)))
  mask2 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask2,OutData%InputTimes)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackIceDyn_Data

 SUBROUTINE FAST_CopyElastoDyn_Data( SrcElastoDyn_DataData, DstElastoDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ElastoDyn_Data), INTENT(INOUT) :: SrcElastoDyn_DataData
   TYPE(ElastoDyn_Data), INTENT(INOUT) :: DstElastoDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcElastoDyn_DataData%x,1), UBOUND(SrcElastoDyn_DataData%x,1)
      CALL ED_CopyContState( SrcElastoDyn_DataData%x(i1), DstElastoDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcElastoDyn_DataData%xd,1), UBOUND(SrcElastoDyn_DataData%xd,1)
      CALL ED_CopyDiscState( SrcElastoDyn_DataData%xd(i1), DstElastoDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcElastoDyn_DataData%z,1), UBOUND(SrcElastoDyn_DataData%z,1)
      CALL ED_CopyConstrState( SrcElastoDyn_DataData%z(i1), DstElastoDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL ED_CopyOtherState( SrcElastoDyn_DataData%OtherSt, DstElastoDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL ED_CopyParam( SrcElastoDyn_DataData%p, DstElastoDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL ED_CopyInput( SrcElastoDyn_DataData%u, DstElastoDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL ED_CopyOutput( SrcElastoDyn_DataData%y, DstElastoDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL ED_CopyOtherState( SrcElastoDyn_DataData%OtherSt_old, DstElastoDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcElastoDyn_DataData%Output)) THEN
   i1_l = LBOUND(SrcElastoDyn_DataData%Output,1)
   i1_u = UBOUND(SrcElastoDyn_DataData%Output,1)
   IF (.NOT. ALLOCATED(DstElastoDyn_DataData%Output)) THEN 
      ALLOCATE(DstElastoDyn_DataData%Output(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElastoDyn_DataData%Output.', ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcElastoDyn_DataData%Output,1), UBOUND(SrcElastoDyn_DataData%Output,1)
      CALL ED_CopyOutput( SrcElastoDyn_DataData%Output(i1), DstElastoDyn_DataData%Output(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:Output(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcElastoDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcElastoDyn_DataData%Input,1)
   i1_u = UBOUND(SrcElastoDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstElastoDyn_DataData%Input)) THEN 
      ALLOCATE(DstElastoDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElastoDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcElastoDyn_DataData%Input,1), UBOUND(SrcElastoDyn_DataData%Input,1)
      CALL ED_CopyInput( SrcElastoDyn_DataData%Input(i1), DstElastoDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcElastoDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcElastoDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcElastoDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstElastoDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstElastoDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElastoDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyElastoDyn_Data')
         RETURN
      END IF
   END IF
   DstElastoDyn_DataData%InputTimes = SrcElastoDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyElastoDyn_Data

 SUBROUTINE FAST_DestroyElastoDyn_Data( ElastoDyn_DataData, ErrStat, ErrMsg )
  TYPE(ElastoDyn_Data), INTENT(INOUT) :: ElastoDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(ElastoDyn_DataData%x,1), UBOUND(ElastoDyn_DataData%x,1)
  CALL ED_DestroyContState( ElastoDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(ElastoDyn_DataData%xd,1), UBOUND(ElastoDyn_DataData%xd,1)
  CALL ED_DestroyDiscState( ElastoDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(ElastoDyn_DataData%z,1), UBOUND(ElastoDyn_DataData%z,1)
  CALL ED_DestroyConstrState( ElastoDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL ED_DestroyOtherState( ElastoDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL ED_DestroyParam( ElastoDyn_DataData%p, ErrStat, ErrMsg )
  CALL ED_DestroyInput( ElastoDyn_DataData%u, ErrStat, ErrMsg )
  CALL ED_DestroyOutput( ElastoDyn_DataData%y, ErrStat, ErrMsg )
  CALL ED_DestroyOtherState( ElastoDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(ElastoDyn_DataData%Output)) THEN
DO i1 = LBOUND(ElastoDyn_DataData%Output,1), UBOUND(ElastoDyn_DataData%Output,1)
  CALL ED_DestroyOutput( ElastoDyn_DataData%Output(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ElastoDyn_DataData%Output)
ENDIF
IF (ALLOCATED(ElastoDyn_DataData%Input)) THEN
DO i1 = LBOUND(ElastoDyn_DataData%Input,1), UBOUND(ElastoDyn_DataData%Input,1)
  CALL ED_DestroyInput( ElastoDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ElastoDyn_DataData%Input)
ENDIF
IF (ALLOCATED(ElastoDyn_DataData%InputTimes)) THEN
   DEALLOCATE(ElastoDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyElastoDyn_Data

 SUBROUTINE FAST_PackElastoDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ElastoDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Output_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Output_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Output_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL ED_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL ED_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL ED_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL ED_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL ED_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL ED_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL ED_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL ED_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Output,1), UBOUND(InData%Output,1)
  CALL ED_PackOutput( Re_Output_Buf, Db_Output_Buf, Int_Output_Buf, InData%Output(i1), ErrStat, ErrMsg, .TRUE. ) ! Output 
  IF(ALLOCATED(Re_Output_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Output_Buf  ) ! Output
  IF(ALLOCATED(Db_Output_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Output_Buf  ) ! Output
  IF(ALLOCATED(Int_Output_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Output_Buf ) ! Output
  IF(ALLOCATED(Re_Output_Buf))  DEALLOCATE(Re_Output_Buf)
  IF(ALLOCATED(Db_Output_Buf))  DEALLOCATE(Db_Output_Buf)
  IF(ALLOCATED(Int_Output_Buf)) DEALLOCATE(Int_Output_Buf)
ENDDO
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL ED_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL ED_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL ED_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL ED_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL ED_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL ED_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL ED_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL ED_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL ED_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Output,1), UBOUND(InData%Output,1)
  CALL ED_PackOutput( Re_Output_Buf, Db_Output_Buf, Int_Output_Buf, InData%Output(i1), ErrStat, ErrMsg, OnlySize ) ! Output 
  IF(ALLOCATED(Re_Output_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Output_Buf)-1 ) = Re_Output_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Output_Buf)
  ENDIF
  IF(ALLOCATED(Db_Output_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Output_Buf)-1 ) = Db_Output_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Output_Buf)
  ENDIF
  IF(ALLOCATED(Int_Output_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Output_Buf)-1 ) = Int_Output_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Output_Buf)
  ENDIF
  IF( ALLOCATED(Re_Output_Buf) )  DEALLOCATE(Re_Output_Buf)
  IF( ALLOCATED(Db_Output_Buf) )  DEALLOCATE(Db_Output_Buf)
  IF( ALLOCATED(Int_Output_Buf) ) DEALLOCATE(Int_Output_Buf)
ENDDO
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL ED_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackElastoDyn_Data

 SUBROUTINE FAST_UnPackElastoDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ElastoDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Output_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Output_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Output_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call ED_PackContState to get correctly sized buffers for unpacking
  CALL ED_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL ED_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call ED_PackDiscState to get correctly sized buffers for unpacking
  CALL ED_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL ED_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call ED_PackConstrState to get correctly sized buffers for unpacking
  CALL ED_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL ED_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call ED_PackOtherState to get correctly sized buffers for unpacking
  CALL ED_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL ED_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call ED_PackParam to get correctly sized buffers for unpacking
  CALL ED_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL ED_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call ED_PackInput to get correctly sized buffers for unpacking
  CALL ED_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL ED_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call ED_PackOutput to get correctly sized buffers for unpacking
  CALL ED_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL ED_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call ED_PackOtherState to get correctly sized buffers for unpacking
  CALL ED_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL ED_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Output,1), UBOUND(OutData%Output,1)
 ! first call ED_PackOutput to get correctly sized buffers for unpacking
  CALL ED_PackOutput( Re_Output_Buf, Db_Output_Buf, Int_Output_Buf, OutData%Output(i1), ErrStat, ErrMsg, .TRUE. ) ! Output 
  IF(ALLOCATED(Re_Output_Buf)) THEN
    Re_Output_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Output_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Output_Buf)
  ENDIF
  IF(ALLOCATED(Db_Output_Buf)) THEN
    Db_Output_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Output_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Output_Buf)
  ENDIF
  IF(ALLOCATED(Int_Output_Buf)) THEN
    Int_Output_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Output_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Output_Buf)
  ENDIF
  CALL ED_UnPackOutput( Re_Output_Buf, Db_Output_Buf, Int_Output_Buf, OutData%Output(i1), ErrStat, ErrMsg ) ! Output 
ENDDO
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call ED_PackInput to get correctly sized buffers for unpacking
  CALL ED_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL ED_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackElastoDyn_Data

 SUBROUTINE FAST_CopyServoDyn_Data( SrcServoDyn_DataData, DstServoDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ServoDyn_Data), INTENT(INOUT) :: SrcServoDyn_DataData
   TYPE(ServoDyn_Data), INTENT(INOUT) :: DstServoDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcServoDyn_DataData%x,1), UBOUND(SrcServoDyn_DataData%x,1)
      CALL SrvD_CopyContState( SrcServoDyn_DataData%x(i1), DstServoDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcServoDyn_DataData%xd,1), UBOUND(SrcServoDyn_DataData%xd,1)
      CALL SrvD_CopyDiscState( SrcServoDyn_DataData%xd(i1), DstServoDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcServoDyn_DataData%z,1), UBOUND(SrcServoDyn_DataData%z,1)
      CALL SrvD_CopyConstrState( SrcServoDyn_DataData%z(i1), DstServoDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL SrvD_CopyOtherState( SrcServoDyn_DataData%OtherSt, DstServoDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SrvD_CopyParam( SrcServoDyn_DataData%p, DstServoDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SrvD_CopyInput( SrcServoDyn_DataData%u, DstServoDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SrvD_CopyOutput( SrcServoDyn_DataData%y, DstServoDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SrvD_CopyOtherState( SrcServoDyn_DataData%OtherSt_old, DstServoDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcServoDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcServoDyn_DataData%Input,1)
   i1_u = UBOUND(SrcServoDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstServoDyn_DataData%Input)) THEN 
      ALLOCATE(DstServoDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstServoDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyServoDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcServoDyn_DataData%Input,1), UBOUND(SrcServoDyn_DataData%Input,1)
      CALL SrvD_CopyInput( SrcServoDyn_DataData%Input(i1), DstServoDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcServoDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcServoDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcServoDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstServoDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstServoDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstServoDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyServoDyn_Data')
         RETURN
      END IF
   END IF
   DstServoDyn_DataData%InputTimes = SrcServoDyn_DataData%InputTimes
ENDIF
      CALL SrvD_CopyOutput( SrcServoDyn_DataData%y_prev, DstServoDyn_DataData%y_prev, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyServoDyn_Data:y_prev')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE FAST_CopyServoDyn_Data

 SUBROUTINE FAST_DestroyServoDyn_Data( ServoDyn_DataData, ErrStat, ErrMsg )
  TYPE(ServoDyn_Data), INTENT(INOUT) :: ServoDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(ServoDyn_DataData%x,1), UBOUND(ServoDyn_DataData%x,1)
  CALL SrvD_DestroyContState( ServoDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(ServoDyn_DataData%xd,1), UBOUND(ServoDyn_DataData%xd,1)
  CALL SrvD_DestroyDiscState( ServoDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(ServoDyn_DataData%z,1), UBOUND(ServoDyn_DataData%z,1)
  CALL SrvD_DestroyConstrState( ServoDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL SrvD_DestroyOtherState( ServoDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL SrvD_DestroyParam( ServoDyn_DataData%p, ErrStat, ErrMsg )
  CALL SrvD_DestroyInput( ServoDyn_DataData%u, ErrStat, ErrMsg )
  CALL SrvD_DestroyOutput( ServoDyn_DataData%y, ErrStat, ErrMsg )
  CALL SrvD_DestroyOtherState( ServoDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(ServoDyn_DataData%Input)) THEN
DO i1 = LBOUND(ServoDyn_DataData%Input,1), UBOUND(ServoDyn_DataData%Input,1)
  CALL SrvD_DestroyInput( ServoDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ServoDyn_DataData%Input)
ENDIF
IF (ALLOCATED(ServoDyn_DataData%InputTimes)) THEN
   DEALLOCATE(ServoDyn_DataData%InputTimes)
ENDIF
  CALL SrvD_DestroyOutput( ServoDyn_DataData%y_prev, ErrStat, ErrMsg )
 END SUBROUTINE FAST_DestroyServoDyn_Data

 SUBROUTINE FAST_PackServoDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ServoDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_prev_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_prev_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_prev_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL SrvD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL SrvD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL SrvD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL SrvD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL SrvD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL SrvD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL SrvD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL SrvD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL SrvD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  CALL SrvD_PackOutput( Re_y_prev_Buf, Db_y_prev_Buf, Int_y_prev_Buf, InData%y_prev, ErrStat, ErrMsg, .TRUE. ) ! y_prev 
  IF(ALLOCATED(Re_y_prev_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_prev_Buf  ) ! y_prev
  IF(ALLOCATED(Db_y_prev_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_prev_Buf  ) ! y_prev
  IF(ALLOCATED(Int_y_prev_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_prev_Buf ) ! y_prev
  IF(ALLOCATED(Re_y_prev_Buf))  DEALLOCATE(Re_y_prev_Buf)
  IF(ALLOCATED(Db_y_prev_Buf))  DEALLOCATE(Db_y_prev_Buf)
  IF(ALLOCATED(Int_y_prev_Buf)) DEALLOCATE(Int_y_prev_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL SrvD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL SrvD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL SrvD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL SrvD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL SrvD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL SrvD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL SrvD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL SrvD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL SrvD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
  CALL SrvD_PackOutput( Re_y_prev_Buf, Db_y_prev_Buf, Int_y_prev_Buf, InData%y_prev, ErrStat, ErrMsg, OnlySize ) ! y_prev 
  IF(ALLOCATED(Re_y_prev_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_prev_Buf)-1 ) = Re_y_prev_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_prev_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_prev_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_prev_Buf)-1 ) = Db_y_prev_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_prev_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_prev_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_prev_Buf)-1 ) = Int_y_prev_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_prev_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_prev_Buf) )  DEALLOCATE(Re_y_prev_Buf)
  IF( ALLOCATED(Db_y_prev_Buf) )  DEALLOCATE(Db_y_prev_Buf)
  IF( ALLOCATED(Int_y_prev_Buf) ) DEALLOCATE(Int_y_prev_Buf)
 END SUBROUTINE FAST_PackServoDyn_Data

 SUBROUTINE FAST_UnPackServoDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ServoDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_prev_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_prev_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_prev_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call SrvD_PackContState to get correctly sized buffers for unpacking
  CALL SrvD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL SrvD_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call SrvD_PackDiscState to get correctly sized buffers for unpacking
  CALL SrvD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL SrvD_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call SrvD_PackConstrState to get correctly sized buffers for unpacking
  CALL SrvD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL SrvD_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call SrvD_PackOtherState to get correctly sized buffers for unpacking
  CALL SrvD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL SrvD_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call SrvD_PackParam to get correctly sized buffers for unpacking
  CALL SrvD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL SrvD_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call SrvD_PackInput to get correctly sized buffers for unpacking
  CALL SrvD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL SrvD_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call SrvD_PackOutput to get correctly sized buffers for unpacking
  CALL SrvD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL SrvD_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call SrvD_PackOtherState to get correctly sized buffers for unpacking
  CALL SrvD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL SrvD_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call SrvD_PackInput to get correctly sized buffers for unpacking
  CALL SrvD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL SrvD_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
 ! first call SrvD_PackOutput to get correctly sized buffers for unpacking
  CALL SrvD_PackOutput( Re_y_prev_Buf, Db_y_prev_Buf, Int_y_prev_Buf, OutData%y_prev, ErrStat, ErrMsg, .TRUE. ) ! y_prev 
  IF(ALLOCATED(Re_y_prev_Buf)) THEN
    Re_y_prev_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_prev_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_prev_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_prev_Buf)) THEN
    Db_y_prev_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_prev_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_prev_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_prev_Buf)) THEN
    Int_y_prev_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_prev_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_prev_Buf)
  ENDIF
  CALL SrvD_UnPackOutput( Re_y_prev_Buf, Db_y_prev_Buf, Int_y_prev_Buf, OutData%y_prev, ErrStat, ErrMsg ) ! y_prev 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackServoDyn_Data

 SUBROUTINE FAST_CopyAeroDyn_Data( SrcAeroDyn_DataData, DstAeroDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AeroDyn_Data), INTENT(INOUT) :: SrcAeroDyn_DataData
   TYPE(AeroDyn_Data), INTENT(INOUT) :: DstAeroDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcAeroDyn_DataData%x,1), UBOUND(SrcAeroDyn_DataData%x,1)
      CALL AD_CopyContState( SrcAeroDyn_DataData%x(i1), DstAeroDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcAeroDyn_DataData%xd,1), UBOUND(SrcAeroDyn_DataData%xd,1)
      CALL AD_CopyDiscState( SrcAeroDyn_DataData%xd(i1), DstAeroDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcAeroDyn_DataData%z,1), UBOUND(SrcAeroDyn_DataData%z,1)
      CALL AD_CopyConstrState( SrcAeroDyn_DataData%z(i1), DstAeroDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL AD_CopyOtherState( SrcAeroDyn_DataData%OtherSt, DstAeroDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_CopyParam( SrcAeroDyn_DataData%p, DstAeroDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_CopyInput( SrcAeroDyn_DataData%u, DstAeroDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_CopyOutput( SrcAeroDyn_DataData%y, DstAeroDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_CopyOtherState( SrcAeroDyn_DataData%OtherSt_old, DstAeroDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcAeroDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcAeroDyn_DataData%Input,1)
   i1_u = UBOUND(SrcAeroDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstAeroDyn_DataData%Input)) THEN 
      ALLOCATE(DstAeroDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAeroDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcAeroDyn_DataData%Input,1), UBOUND(SrcAeroDyn_DataData%Input,1)
      CALL AD_CopyInput( SrcAeroDyn_DataData%Input(i1), DstAeroDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcAeroDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcAeroDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcAeroDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstAeroDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstAeroDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAeroDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyAeroDyn_Data')
         RETURN
      END IF
   END IF
   DstAeroDyn_DataData%InputTimes = SrcAeroDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyAeroDyn_Data

 SUBROUTINE FAST_DestroyAeroDyn_Data( AeroDyn_DataData, ErrStat, ErrMsg )
  TYPE(AeroDyn_Data), INTENT(INOUT) :: AeroDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(AeroDyn_DataData%x,1), UBOUND(AeroDyn_DataData%x,1)
  CALL AD_DestroyContState( AeroDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(AeroDyn_DataData%xd,1), UBOUND(AeroDyn_DataData%xd,1)
  CALL AD_DestroyDiscState( AeroDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(AeroDyn_DataData%z,1), UBOUND(AeroDyn_DataData%z,1)
  CALL AD_DestroyConstrState( AeroDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL AD_DestroyOtherState( AeroDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL AD_DestroyParam( AeroDyn_DataData%p, ErrStat, ErrMsg )
  CALL AD_DestroyInput( AeroDyn_DataData%u, ErrStat, ErrMsg )
  CALL AD_DestroyOutput( AeroDyn_DataData%y, ErrStat, ErrMsg )
  CALL AD_DestroyOtherState( AeroDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(AeroDyn_DataData%Input)) THEN
DO i1 = LBOUND(AeroDyn_DataData%Input,1), UBOUND(AeroDyn_DataData%Input,1)
  CALL AD_DestroyInput( AeroDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(AeroDyn_DataData%Input)
ENDIF
IF (ALLOCATED(AeroDyn_DataData%InputTimes)) THEN
   DEALLOCATE(AeroDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyAeroDyn_Data

 SUBROUTINE FAST_PackAeroDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AeroDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL AD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL AD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL AD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL AD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL AD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL AD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL AD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL AD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL AD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL AD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL AD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL AD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL AD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL AD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL AD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL AD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL AD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL AD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackAeroDyn_Data

 SUBROUTINE FAST_UnPackAeroDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AeroDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call AD_PackContState to get correctly sized buffers for unpacking
  CALL AD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL AD_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call AD_PackDiscState to get correctly sized buffers for unpacking
  CALL AD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL AD_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call AD_PackConstrState to get correctly sized buffers for unpacking
  CALL AD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL AD_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call AD_PackOtherState to get correctly sized buffers for unpacking
  CALL AD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL AD_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call AD_PackParam to get correctly sized buffers for unpacking
  CALL AD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL AD_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call AD_PackInput to get correctly sized buffers for unpacking
  CALL AD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL AD_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call AD_PackOutput to get correctly sized buffers for unpacking
  CALL AD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL AD_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call AD_PackOtherState to get correctly sized buffers for unpacking
  CALL AD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL AD_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call AD_PackInput to get correctly sized buffers for unpacking
  CALL AD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL AD_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackAeroDyn_Data

 SUBROUTINE FAST_CopyInflowWind_Data( SrcInflowWind_DataData, DstInflowWind_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(InflowWind_Data), INTENT(IN) :: SrcInflowWind_DataData
   TYPE(InflowWind_Data), INTENT(INOUT) :: DstInflowWind_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInflowWind_DataData%WriteOutput)) THEN
   i1_l = LBOUND(SrcInflowWind_DataData%WriteOutput,1)
   i1_u = UBOUND(SrcInflowWind_DataData%WriteOutput,1)
   IF (.NOT. ALLOCATED(DstInflowWind_DataData%WriteOutput)) THEN 
      ALLOCATE(DstInflowWind_DataData%WriteOutput(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInflowWind_DataData%WriteOutput.', ErrStat, ErrMsg,'FAST_CopyInflowWind_Data')
         RETURN
      END IF
   END IF
   DstInflowWind_DataData%WriteOutput = SrcInflowWind_DataData%WriteOutput
ENDIF
 END SUBROUTINE FAST_CopyInflowWind_Data

 SUBROUTINE FAST_DestroyInflowWind_Data( InflowWind_DataData, ErrStat, ErrMsg )
  TYPE(InflowWind_Data), INTENT(INOUT) :: InflowWind_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InflowWind_DataData%WriteOutput)) THEN
   DEALLOCATE(InflowWind_DataData%WriteOutput)
ENDIF
 END SUBROUTINE FAST_DestroyInflowWind_Data

 SUBROUTINE FAST_PackInflowWind_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(InflowWind_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%WriteOutput) )   Re_BufSz    = Re_BufSz    + SIZE( InData%WriteOutput )  ! WriteOutput 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%WriteOutput) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%WriteOutput))-1 ) =  PACK(InData%WriteOutput ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%WriteOutput)
  ENDIF
 END SUBROUTINE FAST_PackInflowWind_Data

 SUBROUTINE FAST_UnPackInflowWind_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(InflowWind_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%WriteOutput) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WriteOutput,1)))
  mask1 = .TRUE.
    OutData%WriteOutput = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%WriteOutput))-1 ),mask1,OutData%WriteOutput)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%WriteOutput)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackInflowWind_Data

 SUBROUTINE FAST_CopySubDyn_Data( SrcSubDyn_DataData, DstSubDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(SubDyn_Data), INTENT(INOUT) :: SrcSubDyn_DataData
   TYPE(SubDyn_Data), INTENT(INOUT) :: DstSubDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcSubDyn_DataData%x,1), UBOUND(SrcSubDyn_DataData%x,1)
      CALL SD_CopyContState( SrcSubDyn_DataData%x(i1), DstSubDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcSubDyn_DataData%xd,1), UBOUND(SrcSubDyn_DataData%xd,1)
      CALL SD_CopyDiscState( SrcSubDyn_DataData%xd(i1), DstSubDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcSubDyn_DataData%z,1), UBOUND(SrcSubDyn_DataData%z,1)
      CALL SD_CopyConstrState( SrcSubDyn_DataData%z(i1), DstSubDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL SD_CopyOtherState( SrcSubDyn_DataData%OtherSt, DstSubDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SD_CopyParam( SrcSubDyn_DataData%p, DstSubDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SD_CopyInput( SrcSubDyn_DataData%u, DstSubDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SD_CopyOutput( SrcSubDyn_DataData%y, DstSubDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL SD_CopyOtherState( SrcSubDyn_DataData%OtherSt_old, DstSubDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcSubDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcSubDyn_DataData%Input,1)
   i1_u = UBOUND(SrcSubDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstSubDyn_DataData%Input)) THEN 
      ALLOCATE(DstSubDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstSubDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopySubDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcSubDyn_DataData%Input,1), UBOUND(SrcSubDyn_DataData%Input,1)
      CALL SD_CopyInput( SrcSubDyn_DataData%Input(i1), DstSubDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopySubDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcSubDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcSubDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcSubDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstSubDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstSubDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstSubDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopySubDyn_Data')
         RETURN
      END IF
   END IF
   DstSubDyn_DataData%InputTimes = SrcSubDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopySubDyn_Data

 SUBROUTINE FAST_DestroySubDyn_Data( SubDyn_DataData, ErrStat, ErrMsg )
  TYPE(SubDyn_Data), INTENT(INOUT) :: SubDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(SubDyn_DataData%x,1), UBOUND(SubDyn_DataData%x,1)
  CALL SD_DestroyContState( SubDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(SubDyn_DataData%xd,1), UBOUND(SubDyn_DataData%xd,1)
  CALL SD_DestroyDiscState( SubDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(SubDyn_DataData%z,1), UBOUND(SubDyn_DataData%z,1)
  CALL SD_DestroyConstrState( SubDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL SD_DestroyOtherState( SubDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL SD_DestroyParam( SubDyn_DataData%p, ErrStat, ErrMsg )
  CALL SD_DestroyInput( SubDyn_DataData%u, ErrStat, ErrMsg )
  CALL SD_DestroyOutput( SubDyn_DataData%y, ErrStat, ErrMsg )
  CALL SD_DestroyOtherState( SubDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(SubDyn_DataData%Input)) THEN
DO i1 = LBOUND(SubDyn_DataData%Input,1), UBOUND(SubDyn_DataData%Input,1)
  CALL SD_DestroyInput( SubDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(SubDyn_DataData%Input)
ENDIF
IF (ALLOCATED(SubDyn_DataData%InputTimes)) THEN
   DEALLOCATE(SubDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroySubDyn_Data

 SUBROUTINE FAST_PackSubDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(SubDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL SD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL SD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL SD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL SD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL SD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL SD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL SD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL SD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL SD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL SD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL SD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL SD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL SD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL SD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL SD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL SD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL SD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL SD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackSubDyn_Data

 SUBROUTINE FAST_UnPackSubDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(SubDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call SD_PackContState to get correctly sized buffers for unpacking
  CALL SD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL SD_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call SD_PackDiscState to get correctly sized buffers for unpacking
  CALL SD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL SD_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call SD_PackConstrState to get correctly sized buffers for unpacking
  CALL SD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL SD_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call SD_PackOtherState to get correctly sized buffers for unpacking
  CALL SD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL SD_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call SD_PackParam to get correctly sized buffers for unpacking
  CALL SD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL SD_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call SD_PackInput to get correctly sized buffers for unpacking
  CALL SD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL SD_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call SD_PackOutput to get correctly sized buffers for unpacking
  CALL SD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL SD_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call SD_PackOtherState to get correctly sized buffers for unpacking
  CALL SD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL SD_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call SD_PackInput to get correctly sized buffers for unpacking
  CALL SD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL SD_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackSubDyn_Data

 SUBROUTINE FAST_CopyHydroDyn_Data( SrcHydroDyn_DataData, DstHydroDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(HydroDyn_Data), INTENT(INOUT) :: SrcHydroDyn_DataData
   TYPE(HydroDyn_Data), INTENT(INOUT) :: DstHydroDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcHydroDyn_DataData%x,1), UBOUND(SrcHydroDyn_DataData%x,1)
      CALL HydroDyn_CopyContState( SrcHydroDyn_DataData%x(i1), DstHydroDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcHydroDyn_DataData%xd,1), UBOUND(SrcHydroDyn_DataData%xd,1)
      CALL HydroDyn_CopyDiscState( SrcHydroDyn_DataData%xd(i1), DstHydroDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcHydroDyn_DataData%z,1), UBOUND(SrcHydroDyn_DataData%z,1)
      CALL HydroDyn_CopyConstrState( SrcHydroDyn_DataData%z(i1), DstHydroDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL HydroDyn_CopyOtherState( SrcHydroDyn_DataData%OtherSt, DstHydroDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL HydroDyn_CopyParam( SrcHydroDyn_DataData%p, DstHydroDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL HydroDyn_CopyInput( SrcHydroDyn_DataData%u, DstHydroDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL HydroDyn_CopyOutput( SrcHydroDyn_DataData%y, DstHydroDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL HydroDyn_CopyOtherState( SrcHydroDyn_DataData%OtherSt_old, DstHydroDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcHydroDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcHydroDyn_DataData%Input,1)
   i1_u = UBOUND(SrcHydroDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstHydroDyn_DataData%Input)) THEN 
      ALLOCATE(DstHydroDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstHydroDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcHydroDyn_DataData%Input,1), UBOUND(SrcHydroDyn_DataData%Input,1)
      CALL HydroDyn_CopyInput( SrcHydroDyn_DataData%Input(i1), DstHydroDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcHydroDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcHydroDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcHydroDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstHydroDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstHydroDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstHydroDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyHydroDyn_Data')
         RETURN
      END IF
   END IF
   DstHydroDyn_DataData%InputTimes = SrcHydroDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyHydroDyn_Data

 SUBROUTINE FAST_DestroyHydroDyn_Data( HydroDyn_DataData, ErrStat, ErrMsg )
  TYPE(HydroDyn_Data), INTENT(INOUT) :: HydroDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(HydroDyn_DataData%x,1), UBOUND(HydroDyn_DataData%x,1)
  CALL HydroDyn_DestroyContState( HydroDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(HydroDyn_DataData%xd,1), UBOUND(HydroDyn_DataData%xd,1)
  CALL HydroDyn_DestroyDiscState( HydroDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(HydroDyn_DataData%z,1), UBOUND(HydroDyn_DataData%z,1)
  CALL HydroDyn_DestroyConstrState( HydroDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL HydroDyn_DestroyOtherState( HydroDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL HydroDyn_DestroyParam( HydroDyn_DataData%p, ErrStat, ErrMsg )
  CALL HydroDyn_DestroyInput( HydroDyn_DataData%u, ErrStat, ErrMsg )
  CALL HydroDyn_DestroyOutput( HydroDyn_DataData%y, ErrStat, ErrMsg )
  CALL HydroDyn_DestroyOtherState( HydroDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(HydroDyn_DataData%Input)) THEN
DO i1 = LBOUND(HydroDyn_DataData%Input,1), UBOUND(HydroDyn_DataData%Input,1)
  CALL HydroDyn_DestroyInput( HydroDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(HydroDyn_DataData%Input)
ENDIF
IF (ALLOCATED(HydroDyn_DataData%InputTimes)) THEN
   DEALLOCATE(HydroDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyHydroDyn_Data

 SUBROUTINE FAST_PackHydroDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(HydroDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL HydroDyn_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL HydroDyn_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL HydroDyn_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL HydroDyn_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL HydroDyn_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL HydroDyn_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL HydroDyn_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL HydroDyn_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL HydroDyn_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL HydroDyn_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL HydroDyn_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL HydroDyn_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL HydroDyn_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL HydroDyn_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL HydroDyn_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL HydroDyn_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL HydroDyn_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL HydroDyn_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackHydroDyn_Data

 SUBROUTINE FAST_UnPackHydroDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(HydroDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call HydroDyn_PackContState to get correctly sized buffers for unpacking
  CALL HydroDyn_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL HydroDyn_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call HydroDyn_PackDiscState to get correctly sized buffers for unpacking
  CALL HydroDyn_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL HydroDyn_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call HydroDyn_PackConstrState to get correctly sized buffers for unpacking
  CALL HydroDyn_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL HydroDyn_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call HydroDyn_PackOtherState to get correctly sized buffers for unpacking
  CALL HydroDyn_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL HydroDyn_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call HydroDyn_PackParam to get correctly sized buffers for unpacking
  CALL HydroDyn_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL HydroDyn_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call HydroDyn_PackInput to get correctly sized buffers for unpacking
  CALL HydroDyn_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL HydroDyn_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call HydroDyn_PackOutput to get correctly sized buffers for unpacking
  CALL HydroDyn_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL HydroDyn_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call HydroDyn_PackOtherState to get correctly sized buffers for unpacking
  CALL HydroDyn_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL HydroDyn_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call HydroDyn_PackInput to get correctly sized buffers for unpacking
  CALL HydroDyn_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL HydroDyn_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackHydroDyn_Data

 SUBROUTINE FAST_CopyIceFloe_Data( SrcIceFloe_DataData, DstIceFloe_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(IceFloe_Data), INTENT(INOUT) :: SrcIceFloe_DataData
   TYPE(IceFloe_Data), INTENT(INOUT) :: DstIceFloe_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcIceFloe_DataData%x,1), UBOUND(SrcIceFloe_DataData%x,1)
      CALL IceFloe_CopyContState( SrcIceFloe_DataData%x(i1), DstIceFloe_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcIceFloe_DataData%xd,1), UBOUND(SrcIceFloe_DataData%xd,1)
      CALL IceFloe_CopyDiscState( SrcIceFloe_DataData%xd(i1), DstIceFloe_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcIceFloe_DataData%z,1), UBOUND(SrcIceFloe_DataData%z,1)
      CALL IceFloe_CopyConstrState( SrcIceFloe_DataData%z(i1), DstIceFloe_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL IceFloe_CopyOtherState( SrcIceFloe_DataData%OtherSt, DstIceFloe_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IceFloe_CopyParam( SrcIceFloe_DataData%p, DstIceFloe_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IceFloe_CopyInput( SrcIceFloe_DataData%u, DstIceFloe_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IceFloe_CopyOutput( SrcIceFloe_DataData%y, DstIceFloe_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IceFloe_CopyOtherState( SrcIceFloe_DataData%OtherSt_old, DstIceFloe_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcIceFloe_DataData%Input)) THEN
   i1_l = LBOUND(SrcIceFloe_DataData%Input,1)
   i1_u = UBOUND(SrcIceFloe_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstIceFloe_DataData%Input)) THEN 
      ALLOCATE(DstIceFloe_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceFloe_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyIceFloe_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcIceFloe_DataData%Input,1), UBOUND(SrcIceFloe_DataData%Input,1)
      CALL IceFloe_CopyInput( SrcIceFloe_DataData%Input(i1), DstIceFloe_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyIceFloe_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcIceFloe_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcIceFloe_DataData%InputTimes,1)
   i1_u = UBOUND(SrcIceFloe_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstIceFloe_DataData%InputTimes)) THEN 
      ALLOCATE(DstIceFloe_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstIceFloe_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyIceFloe_Data')
         RETURN
      END IF
   END IF
   DstIceFloe_DataData%InputTimes = SrcIceFloe_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyIceFloe_Data

 SUBROUTINE FAST_DestroyIceFloe_Data( IceFloe_DataData, ErrStat, ErrMsg )
  TYPE(IceFloe_Data), INTENT(INOUT) :: IceFloe_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(IceFloe_DataData%x,1), UBOUND(IceFloe_DataData%x,1)
  CALL IceFloe_DestroyContState( IceFloe_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(IceFloe_DataData%xd,1), UBOUND(IceFloe_DataData%xd,1)
  CALL IceFloe_DestroyDiscState( IceFloe_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(IceFloe_DataData%z,1), UBOUND(IceFloe_DataData%z,1)
  CALL IceFloe_DestroyConstrState( IceFloe_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL IceFloe_DestroyOtherState( IceFloe_DataData%OtherSt, ErrStat, ErrMsg )
  CALL IceFloe_DestroyParam( IceFloe_DataData%p, ErrStat, ErrMsg )
  CALL IceFloe_DestroyInput( IceFloe_DataData%u, ErrStat, ErrMsg )
  CALL IceFloe_DestroyOutput( IceFloe_DataData%y, ErrStat, ErrMsg )
  CALL IceFloe_DestroyOtherState( IceFloe_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(IceFloe_DataData%Input)) THEN
DO i1 = LBOUND(IceFloe_DataData%Input,1), UBOUND(IceFloe_DataData%Input,1)
  CALL IceFloe_DestroyInput( IceFloe_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(IceFloe_DataData%Input)
ENDIF
IF (ALLOCATED(IceFloe_DataData%InputTimes)) THEN
   DEALLOCATE(IceFloe_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyIceFloe_Data

 SUBROUTINE FAST_PackIceFloe_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(IceFloe_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL IceFloe_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL IceFloe_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL IceFloe_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL IceFloe_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL IceFloe_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL IceFloe_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL IceFloe_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL IceFloe_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL IceFloe_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL IceFloe_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL IceFloe_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL IceFloe_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL IceFloe_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL IceFloe_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL IceFloe_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL IceFloe_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL IceFloe_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL IceFloe_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackIceFloe_Data

 SUBROUTINE FAST_UnPackIceFloe_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(IceFloe_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call IceFloe_PackContState to get correctly sized buffers for unpacking
  CALL IceFloe_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL IceFloe_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call IceFloe_PackDiscState to get correctly sized buffers for unpacking
  CALL IceFloe_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL IceFloe_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call IceFloe_PackConstrState to get correctly sized buffers for unpacking
  CALL IceFloe_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL IceFloe_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call IceFloe_PackOtherState to get correctly sized buffers for unpacking
  CALL IceFloe_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL IceFloe_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call IceFloe_PackParam to get correctly sized buffers for unpacking
  CALL IceFloe_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL IceFloe_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call IceFloe_PackInput to get correctly sized buffers for unpacking
  CALL IceFloe_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL IceFloe_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call IceFloe_PackOutput to get correctly sized buffers for unpacking
  CALL IceFloe_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL IceFloe_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call IceFloe_PackOtherState to get correctly sized buffers for unpacking
  CALL IceFloe_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL IceFloe_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call IceFloe_PackInput to get correctly sized buffers for unpacking
  CALL IceFloe_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL IceFloe_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackIceFloe_Data

 SUBROUTINE FAST_CopyMAP_Data( SrcMAP_DataData, DstMAP_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(MAP_Data), INTENT(INOUT) :: SrcMAP_DataData
   TYPE(MAP_Data), INTENT(INOUT) :: DstMAP_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcMAP_DataData%x,1), UBOUND(SrcMAP_DataData%x,1)
      CALL MAP_CopyContState( SrcMAP_DataData%x(i1), DstMAP_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcMAP_DataData%xd,1), UBOUND(SrcMAP_DataData%xd,1)
      CALL MAP_CopyDiscState( SrcMAP_DataData%xd(i1), DstMAP_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcMAP_DataData%z,1), UBOUND(SrcMAP_DataData%z,1)
      CALL MAP_CopyConstrState( SrcMAP_DataData%z(i1), DstMAP_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL MAP_CopyOtherState( SrcMAP_DataData%OtherSt, DstMAP_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MAP_CopyParam( SrcMAP_DataData%p, DstMAP_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MAP_CopyInput( SrcMAP_DataData%u, DstMAP_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MAP_CopyOutput( SrcMAP_DataData%y, DstMAP_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MAP_CopyOtherState( SrcMAP_DataData%OtherSt_old, DstMAP_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcMAP_DataData%Input)) THEN
   i1_l = LBOUND(SrcMAP_DataData%Input,1)
   i1_u = UBOUND(SrcMAP_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstMAP_DataData%Input)) THEN 
      ALLOCATE(DstMAP_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstMAP_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyMAP_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcMAP_DataData%Input,1), UBOUND(SrcMAP_DataData%Input,1)
      CALL MAP_CopyInput( SrcMAP_DataData%Input(i1), DstMAP_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMAP_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcMAP_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcMAP_DataData%InputTimes,1)
   i1_u = UBOUND(SrcMAP_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstMAP_DataData%InputTimes)) THEN 
      ALLOCATE(DstMAP_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstMAP_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyMAP_Data')
         RETURN
      END IF
   END IF
   DstMAP_DataData%InputTimes = SrcMAP_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyMAP_Data

 SUBROUTINE FAST_DestroyMAP_Data( MAP_DataData, ErrStat, ErrMsg )
  TYPE(MAP_Data), INTENT(INOUT) :: MAP_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(MAP_DataData%x,1), UBOUND(MAP_DataData%x,1)
  CALL MAP_DestroyContState( MAP_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(MAP_DataData%xd,1), UBOUND(MAP_DataData%xd,1)
  CALL MAP_DestroyDiscState( MAP_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(MAP_DataData%z,1), UBOUND(MAP_DataData%z,1)
  CALL MAP_DestroyConstrState( MAP_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL MAP_DestroyOtherState( MAP_DataData%OtherSt, ErrStat, ErrMsg )
  CALL MAP_DestroyParam( MAP_DataData%p, ErrStat, ErrMsg )
  CALL MAP_DestroyInput( MAP_DataData%u, ErrStat, ErrMsg )
  CALL MAP_DestroyOutput( MAP_DataData%y, ErrStat, ErrMsg )
  CALL MAP_DestroyOtherState( MAP_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(MAP_DataData%Input)) THEN
DO i1 = LBOUND(MAP_DataData%Input,1), UBOUND(MAP_DataData%Input,1)
  CALL MAP_DestroyInput( MAP_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(MAP_DataData%Input)
ENDIF
IF (ALLOCATED(MAP_DataData%InputTimes)) THEN
   DEALLOCATE(MAP_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyMAP_Data

 SUBROUTINE FAST_PackMAP_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(MAP_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL MAP_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL MAP_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL MAP_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL MAP_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL MAP_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL MAP_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL MAP_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL MAP_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL MAP_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL MAP_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL MAP_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL MAP_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL MAP_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL MAP_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL MAP_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL MAP_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL MAP_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL MAP_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackMAP_Data

 SUBROUTINE FAST_UnPackMAP_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(MAP_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call MAP_PackContState to get correctly sized buffers for unpacking
  CALL MAP_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL MAP_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call MAP_PackDiscState to get correctly sized buffers for unpacking
  CALL MAP_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL MAP_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call MAP_PackConstrState to get correctly sized buffers for unpacking
  CALL MAP_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL MAP_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call MAP_PackOtherState to get correctly sized buffers for unpacking
  CALL MAP_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL MAP_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call MAP_PackParam to get correctly sized buffers for unpacking
  CALL MAP_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL MAP_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call MAP_PackInput to get correctly sized buffers for unpacking
  CALL MAP_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL MAP_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call MAP_PackOutput to get correctly sized buffers for unpacking
  CALL MAP_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL MAP_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call MAP_PackOtherState to get correctly sized buffers for unpacking
  CALL MAP_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL MAP_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call MAP_PackInput to get correctly sized buffers for unpacking
  CALL MAP_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL MAP_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackMAP_Data

 SUBROUTINE FAST_CopyFEAMooring_Data( SrcFEAMooring_DataData, DstFEAMooring_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FEAMooring_Data), INTENT(INOUT) :: SrcFEAMooring_DataData
   TYPE(FEAMooring_Data), INTENT(INOUT) :: DstFEAMooring_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcFEAMooring_DataData%x,1), UBOUND(SrcFEAMooring_DataData%x,1)
      CALL FEAM_CopyContState( SrcFEAMooring_DataData%x(i1), DstFEAMooring_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcFEAMooring_DataData%xd,1), UBOUND(SrcFEAMooring_DataData%xd,1)
      CALL FEAM_CopyDiscState( SrcFEAMooring_DataData%xd(i1), DstFEAMooring_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcFEAMooring_DataData%z,1), UBOUND(SrcFEAMooring_DataData%z,1)
      CALL FEAM_CopyConstrState( SrcFEAMooring_DataData%z(i1), DstFEAMooring_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL FEAM_CopyOtherState( SrcFEAMooring_DataData%OtherSt, DstFEAMooring_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL FEAM_CopyParam( SrcFEAMooring_DataData%p, DstFEAMooring_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL FEAM_CopyInput( SrcFEAMooring_DataData%u, DstFEAMooring_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL FEAM_CopyOutput( SrcFEAMooring_DataData%y, DstFEAMooring_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL FEAM_CopyOtherState( SrcFEAMooring_DataData%OtherSt_old, DstFEAMooring_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcFEAMooring_DataData%Input)) THEN
   i1_l = LBOUND(SrcFEAMooring_DataData%Input,1)
   i1_u = UBOUND(SrcFEAMooring_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstFEAMooring_DataData%Input)) THEN 
      ALLOCATE(DstFEAMooring_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFEAMooring_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcFEAMooring_DataData%Input,1), UBOUND(SrcFEAMooring_DataData%Input,1)
      CALL FEAM_CopyInput( SrcFEAMooring_DataData%Input(i1), DstFEAMooring_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcFEAMooring_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcFEAMooring_DataData%InputTimes,1)
   i1_u = UBOUND(SrcFEAMooring_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstFEAMooring_DataData%InputTimes)) THEN 
      ALLOCATE(DstFEAMooring_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFEAMooring_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyFEAMooring_Data')
         RETURN
      END IF
   END IF
   DstFEAMooring_DataData%InputTimes = SrcFEAMooring_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyFEAMooring_Data

 SUBROUTINE FAST_DestroyFEAMooring_Data( FEAMooring_DataData, ErrStat, ErrMsg )
  TYPE(FEAMooring_Data), INTENT(INOUT) :: FEAMooring_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(FEAMooring_DataData%x,1), UBOUND(FEAMooring_DataData%x,1)
  CALL FEAM_DestroyContState( FEAMooring_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(FEAMooring_DataData%xd,1), UBOUND(FEAMooring_DataData%xd,1)
  CALL FEAM_DestroyDiscState( FEAMooring_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(FEAMooring_DataData%z,1), UBOUND(FEAMooring_DataData%z,1)
  CALL FEAM_DestroyConstrState( FEAMooring_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL FEAM_DestroyOtherState( FEAMooring_DataData%OtherSt, ErrStat, ErrMsg )
  CALL FEAM_DestroyParam( FEAMooring_DataData%p, ErrStat, ErrMsg )
  CALL FEAM_DestroyInput( FEAMooring_DataData%u, ErrStat, ErrMsg )
  CALL FEAM_DestroyOutput( FEAMooring_DataData%y, ErrStat, ErrMsg )
  CALL FEAM_DestroyOtherState( FEAMooring_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(FEAMooring_DataData%Input)) THEN
DO i1 = LBOUND(FEAMooring_DataData%Input,1), UBOUND(FEAMooring_DataData%Input,1)
  CALL FEAM_DestroyInput( FEAMooring_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(FEAMooring_DataData%Input)
ENDIF
IF (ALLOCATED(FEAMooring_DataData%InputTimes)) THEN
   DEALLOCATE(FEAMooring_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyFEAMooring_Data

 SUBROUTINE FAST_PackFEAMooring_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FEAMooring_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL FEAM_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL FEAM_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL FEAM_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL FEAM_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL FEAM_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL FEAM_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL FEAM_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL FEAM_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL FEAM_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL FEAM_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL FEAM_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL FEAM_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL FEAM_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL FEAM_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL FEAM_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL FEAM_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL FEAM_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL FEAM_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackFEAMooring_Data

 SUBROUTINE FAST_UnPackFEAMooring_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FEAMooring_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call FEAM_PackContState to get correctly sized buffers for unpacking
  CALL FEAM_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL FEAM_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call FEAM_PackDiscState to get correctly sized buffers for unpacking
  CALL FEAM_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL FEAM_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call FEAM_PackConstrState to get correctly sized buffers for unpacking
  CALL FEAM_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL FEAM_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call FEAM_PackOtherState to get correctly sized buffers for unpacking
  CALL FEAM_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL FEAM_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call FEAM_PackParam to get correctly sized buffers for unpacking
  CALL FEAM_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL FEAM_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call FEAM_PackInput to get correctly sized buffers for unpacking
  CALL FEAM_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL FEAM_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call FEAM_PackOutput to get correctly sized buffers for unpacking
  CALL FEAM_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL FEAM_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call FEAM_PackOtherState to get correctly sized buffers for unpacking
  CALL FEAM_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL FEAM_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call FEAM_PackInput to get correctly sized buffers for unpacking
  CALL FEAM_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL FEAM_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackFEAMooring_Data

 SUBROUTINE FAST_CopyMoorDyn_Data( SrcMoorDyn_DataData, DstMoorDyn_DataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(MoorDyn_Data), INTENT(INOUT) :: SrcMoorDyn_DataData
   TYPE(MoorDyn_Data), INTENT(INOUT) :: DstMoorDyn_DataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DO i1 = LBOUND(SrcMoorDyn_DataData%x,1), UBOUND(SrcMoorDyn_DataData%x,1)
      CALL MD_CopyContState( SrcMoorDyn_DataData%x(i1), DstMoorDyn_DataData%x(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:x(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcMoorDyn_DataData%xd,1), UBOUND(SrcMoorDyn_DataData%xd,1)
      CALL MD_CopyDiscState( SrcMoorDyn_DataData%xd(i1), DstMoorDyn_DataData%xd(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:xd(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
   DO i1 = LBOUND(SrcMoorDyn_DataData%z,1), UBOUND(SrcMoorDyn_DataData%z,1)
      CALL MD_CopyConstrState( SrcMoorDyn_DataData%z(i1), DstMoorDyn_DataData%z(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:z(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
      CALL MD_CopyOtherState( SrcMoorDyn_DataData%OtherSt, DstMoorDyn_DataData%OtherSt, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:OtherSt')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MD_CopyParam( SrcMoorDyn_DataData%p, DstMoorDyn_DataData%p, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:p')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MD_CopyInput( SrcMoorDyn_DataData%u, DstMoorDyn_DataData%u, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:u')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MD_CopyOutput( SrcMoorDyn_DataData%y, DstMoorDyn_DataData%y, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:y')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL MD_CopyOtherState( SrcMoorDyn_DataData%OtherSt_old, DstMoorDyn_DataData%OtherSt_old, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:OtherSt_old')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcMoorDyn_DataData%Input)) THEN
   i1_l = LBOUND(SrcMoorDyn_DataData%Input,1)
   i1_u = UBOUND(SrcMoorDyn_DataData%Input,1)
   IF (.NOT. ALLOCATED(DstMoorDyn_DataData%Input)) THEN 
      ALLOCATE(DstMoorDyn_DataData%Input(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstMoorDyn_DataData%Input.', ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcMoorDyn_DataData%Input,1), UBOUND(SrcMoorDyn_DataData%Input,1)
      CALL MD_CopyInput( SrcMoorDyn_DataData%Input(i1), DstMoorDyn_DataData%Input(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data:Input(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcMoorDyn_DataData%InputTimes)) THEN
   i1_l = LBOUND(SrcMoorDyn_DataData%InputTimes,1)
   i1_u = UBOUND(SrcMoorDyn_DataData%InputTimes,1)
   IF (.NOT. ALLOCATED(DstMoorDyn_DataData%InputTimes)) THEN 
      ALLOCATE(DstMoorDyn_DataData%InputTimes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstMoorDyn_DataData%InputTimes.', ErrStat, ErrMsg,'FAST_CopyMoorDyn_Data')
         RETURN
      END IF
   END IF
   DstMoorDyn_DataData%InputTimes = SrcMoorDyn_DataData%InputTimes
ENDIF
 END SUBROUTINE FAST_CopyMoorDyn_Data

 SUBROUTINE FAST_DestroyMoorDyn_Data( MoorDyn_DataData, ErrStat, ErrMsg )
  TYPE(MoorDyn_Data), INTENT(INOUT) :: MoorDyn_DataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
DO i1 = LBOUND(MoorDyn_DataData%x,1), UBOUND(MoorDyn_DataData%x,1)
  CALL MD_DestroyContState( MoorDyn_DataData%x(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(MoorDyn_DataData%xd,1), UBOUND(MoorDyn_DataData%xd,1)
  CALL MD_DestroyDiscState( MoorDyn_DataData%xd(i1), ErrStat, ErrMsg )
ENDDO
DO i1 = LBOUND(MoorDyn_DataData%z,1), UBOUND(MoorDyn_DataData%z,1)
  CALL MD_DestroyConstrState( MoorDyn_DataData%z(i1), ErrStat, ErrMsg )
ENDDO
  CALL MD_DestroyOtherState( MoorDyn_DataData%OtherSt, ErrStat, ErrMsg )
  CALL MD_DestroyParam( MoorDyn_DataData%p, ErrStat, ErrMsg )
  CALL MD_DestroyInput( MoorDyn_DataData%u, ErrStat, ErrMsg )
  CALL MD_DestroyOutput( MoorDyn_DataData%y, ErrStat, ErrMsg )
  CALL MD_DestroyOtherState( MoorDyn_DataData%OtherSt_old, ErrStat, ErrMsg )
IF (ALLOCATED(MoorDyn_DataData%Input)) THEN
DO i1 = LBOUND(MoorDyn_DataData%Input,1), UBOUND(MoorDyn_DataData%Input,1)
  CALL MD_DestroyInput( MoorDyn_DataData%Input(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(MoorDyn_DataData%Input)
ENDIF
IF (ALLOCATED(MoorDyn_DataData%InputTimes)) THEN
   DEALLOCATE(MoorDyn_DataData%InputTimes)
ENDIF
 END SUBROUTINE FAST_DestroyMoorDyn_Data

 SUBROUTINE FAST_PackMoorDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(MoorDyn_Data),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Input_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL MD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_x_Buf  ) ! x
  IF(ALLOCATED(Db_x_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_x_Buf  ) ! x
  IF(ALLOCATED(Int_x_Buf))Int_BufSz = Int_BufSz + SIZE( Int_x_Buf ) ! x
  IF(ALLOCATED(Re_x_Buf))  DEALLOCATE(Re_x_Buf)
  IF(ALLOCATED(Db_x_Buf))  DEALLOCATE(Db_x_Buf)
  IF(ALLOCATED(Int_x_Buf)) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL MD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xd_Buf  ) ! xd
  IF(ALLOCATED(Db_xd_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xd_Buf  ) ! xd
  IF(ALLOCATED(Int_xd_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xd_Buf ) ! xd
  IF(ALLOCATED(Re_xd_Buf))  DEALLOCATE(Re_xd_Buf)
  IF(ALLOCATED(Db_xd_Buf))  DEALLOCATE(Db_xd_Buf)
  IF(ALLOCATED(Int_xd_Buf)) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL MD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_z_Buf  ) ! z
  IF(ALLOCATED(Db_z_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_z_Buf  ) ! z
  IF(ALLOCATED(Int_z_Buf))Int_BufSz = Int_BufSz + SIZE( Int_z_Buf ) ! z
  IF(ALLOCATED(Re_z_Buf))  DEALLOCATE(Re_z_Buf)
  IF(ALLOCATED(Db_z_Buf))  DEALLOCATE(Db_z_Buf)
  IF(ALLOCATED(Int_z_Buf)) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL MD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Db_OtherSt_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_Buf  ) ! OtherSt
  IF(ALLOCATED(Int_OtherSt_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_Buf ) ! OtherSt
  IF(ALLOCATED(Re_OtherSt_Buf))  DEALLOCATE(Re_OtherSt_Buf)
  IF(ALLOCATED(Db_OtherSt_Buf))  DEALLOCATE(Db_OtherSt_Buf)
  IF(ALLOCATED(Int_OtherSt_Buf)) DEALLOCATE(Int_OtherSt_Buf)
  CALL MD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_p_Buf  ) ! p
  IF(ALLOCATED(Db_p_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_p_Buf  ) ! p
  IF(ALLOCATED(Int_p_Buf))Int_BufSz = Int_BufSz + SIZE( Int_p_Buf ) ! p
  IF(ALLOCATED(Re_p_Buf))  DEALLOCATE(Re_p_Buf)
  IF(ALLOCATED(Db_p_Buf))  DEALLOCATE(Db_p_Buf)
  IF(ALLOCATED(Int_p_Buf)) DEALLOCATE(Int_p_Buf)
  CALL MD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_Buf  ) ! u
  IF(ALLOCATED(Db_u_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_Buf  ) ! u
  IF(ALLOCATED(Int_u_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_Buf ) ! u
  IF(ALLOCATED(Re_u_Buf))  DEALLOCATE(Re_u_Buf)
  IF(ALLOCATED(Db_u_Buf))  DEALLOCATE(Db_u_Buf)
  IF(ALLOCATED(Int_u_Buf)) DEALLOCATE(Int_u_Buf)
  CALL MD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_y_Buf  ) ! y
  IF(ALLOCATED(Db_y_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_y_Buf  ) ! y
  IF(ALLOCATED(Int_y_Buf))Int_BufSz = Int_BufSz + SIZE( Int_y_Buf ) ! y
  IF(ALLOCATED(Re_y_Buf))  DEALLOCATE(Re_y_Buf)
  IF(ALLOCATED(Db_y_Buf))  DEALLOCATE(Db_y_Buf)
  IF(ALLOCATED(Int_y_Buf)) DEALLOCATE(Int_y_Buf)
  CALL MD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Db_OtherSt_old_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OtherSt_old_Buf  ) ! OtherSt_old
  IF(ALLOCATED(Int_OtherSt_old_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OtherSt_old_Buf ) ! OtherSt_old
  IF(ALLOCATED(Re_OtherSt_old_Buf))  DEALLOCATE(Re_OtherSt_old_Buf)
  IF(ALLOCATED(Db_OtherSt_old_Buf))  DEALLOCATE(Db_OtherSt_old_Buf)
  IF(ALLOCATED(Int_OtherSt_old_Buf)) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL MD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Input_Buf  ) ! Input
  IF(ALLOCATED(Db_Input_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Input_Buf  ) ! Input
  IF(ALLOCATED(Int_Input_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Input_Buf ) ! Input
  IF(ALLOCATED(Re_Input_Buf))  DEALLOCATE(Re_Input_Buf)
  IF(ALLOCATED(Db_Input_Buf))  DEALLOCATE(Db_Input_Buf)
  IF(ALLOCATED(Int_Input_Buf)) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%InputTimes )  ! InputTimes 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%x,1), UBOUND(InData%x,1)
  CALL MD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, InData%x(i1), ErrStat, ErrMsg, OnlySize ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 ) = Re_x_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 ) = Db_x_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 ) = Int_x_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  IF( ALLOCATED(Re_x_Buf) )  DEALLOCATE(Re_x_Buf)
  IF( ALLOCATED(Db_x_Buf) )  DEALLOCATE(Db_x_Buf)
  IF( ALLOCATED(Int_x_Buf) ) DEALLOCATE(Int_x_Buf)
ENDDO
DO i1 = LBOUND(InData%xd,1), UBOUND(InData%xd,1)
  CALL MD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, InData%xd(i1), ErrStat, ErrMsg, OnlySize ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 ) = Re_xd_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 ) = Db_xd_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 ) = Int_xd_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  IF( ALLOCATED(Re_xd_Buf) )  DEALLOCATE(Re_xd_Buf)
  IF( ALLOCATED(Db_xd_Buf) )  DEALLOCATE(Db_xd_Buf)
  IF( ALLOCATED(Int_xd_Buf) ) DEALLOCATE(Int_xd_Buf)
ENDDO
DO i1 = LBOUND(InData%z,1), UBOUND(InData%z,1)
  CALL MD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, InData%z(i1), ErrStat, ErrMsg, OnlySize ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 ) = Re_z_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 ) = Db_z_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 ) = Int_z_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  IF( ALLOCATED(Re_z_Buf) )  DEALLOCATE(Re_z_Buf)
  IF( ALLOCATED(Db_z_Buf) )  DEALLOCATE(Db_z_Buf)
  IF( ALLOCATED(Int_z_Buf) ) DEALLOCATE(Int_z_Buf)
ENDDO
  CALL MD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, InData%OtherSt, ErrStat, ErrMsg, OnlySize ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 ) = Re_OtherSt_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 ) = Db_OtherSt_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 ) = Int_OtherSt_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_Buf) )  DEALLOCATE(Re_OtherSt_Buf)
  IF( ALLOCATED(Db_OtherSt_Buf) )  DEALLOCATE(Db_OtherSt_Buf)
  IF( ALLOCATED(Int_OtherSt_Buf) ) DEALLOCATE(Int_OtherSt_Buf)
  CALL MD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, InData%p, ErrStat, ErrMsg, OnlySize ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 ) = Re_p_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 ) = Db_p_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 ) = Int_p_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  IF( ALLOCATED(Re_p_Buf) )  DEALLOCATE(Re_p_Buf)
  IF( ALLOCATED(Db_p_Buf) )  DEALLOCATE(Db_p_Buf)
  IF( ALLOCATED(Int_p_Buf) ) DEALLOCATE(Int_p_Buf)
  CALL MD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, InData%u, ErrStat, ErrMsg, OnlySize ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 ) = Re_u_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 ) = Db_u_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 ) = Int_u_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_Buf) )  DEALLOCATE(Re_u_Buf)
  IF( ALLOCATED(Db_u_Buf) )  DEALLOCATE(Db_u_Buf)
  IF( ALLOCATED(Int_u_Buf) ) DEALLOCATE(Int_u_Buf)
  CALL MD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, InData%y, ErrStat, ErrMsg, OnlySize ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 ) = Re_y_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 ) = Db_y_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 ) = Int_y_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  IF( ALLOCATED(Re_y_Buf) )  DEALLOCATE(Re_y_Buf)
  IF( ALLOCATED(Db_y_Buf) )  DEALLOCATE(Db_y_Buf)
  IF( ALLOCATED(Int_y_Buf) ) DEALLOCATE(Int_y_Buf)
  CALL MD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, InData%OtherSt_old, ErrStat, ErrMsg, OnlySize ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 ) = Re_OtherSt_old_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 ) = Db_OtherSt_old_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 ) = Int_OtherSt_old_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  IF( ALLOCATED(Re_OtherSt_old_Buf) )  DEALLOCATE(Re_OtherSt_old_Buf)
  IF( ALLOCATED(Db_OtherSt_old_Buf) )  DEALLOCATE(Db_OtherSt_old_Buf)
  IF( ALLOCATED(Int_OtherSt_old_Buf) ) DEALLOCATE(Int_OtherSt_old_Buf)
DO i1 = LBOUND(InData%Input,1), UBOUND(InData%Input,1)
  CALL MD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, InData%Input(i1), ErrStat, ErrMsg, OnlySize ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 ) = Re_Input_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 ) = Db_Input_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 ) = Int_Input_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  IF( ALLOCATED(Re_Input_Buf) )  DEALLOCATE(Re_Input_Buf)
  IF( ALLOCATED(Db_Input_Buf) )  DEALLOCATE(Db_Input_Buf)
  IF( ALLOCATED(Int_Input_Buf) ) DEALLOCATE(Int_Input_Buf)
ENDDO
  IF ( ALLOCATED(InData%InputTimes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%InputTimes))-1 ) =  PACK(InData%InputTimes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%InputTimes)
  ENDIF
 END SUBROUTINE FAST_PackMoorDyn_Data

 SUBROUTINE FAST_UnPackMoorDyn_Data( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(MoorDyn_Data), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_x_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_x_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_x_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xd_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xd_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xd_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_z_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_z_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_z_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_p_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_p_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_p_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_y_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_y_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_y_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OtherSt_old_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OtherSt_old_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OtherSt_old_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Input_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Input_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Input_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%x,1), UBOUND(OutData%x,1)
 ! first call MD_PackContState to get correctly sized buffers for unpacking
  CALL MD_PackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg, .TRUE. ) ! x 
  IF(ALLOCATED(Re_x_Buf)) THEN
    Re_x_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_x_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_x_Buf)
  ENDIF
  IF(ALLOCATED(Db_x_Buf)) THEN
    Db_x_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_x_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_x_Buf)
  ENDIF
  IF(ALLOCATED(Int_x_Buf)) THEN
    Int_x_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_x_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_x_Buf)
  ENDIF
  CALL MD_UnPackContState( Re_x_Buf, Db_x_Buf, Int_x_Buf, OutData%x(i1), ErrStat, ErrMsg ) ! x 
ENDDO
DO i1 = LBOUND(OutData%xd,1), UBOUND(OutData%xd,1)
 ! first call MD_PackDiscState to get correctly sized buffers for unpacking
  CALL MD_PackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg, .TRUE. ) ! xd 
  IF(ALLOCATED(Re_xd_Buf)) THEN
    Re_xd_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xd_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xd_Buf)
  ENDIF
  IF(ALLOCATED(Db_xd_Buf)) THEN
    Db_xd_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xd_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xd_Buf)
  ENDIF
  IF(ALLOCATED(Int_xd_Buf)) THEN
    Int_xd_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xd_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xd_Buf)
  ENDIF
  CALL MD_UnPackDiscState( Re_xd_Buf, Db_xd_Buf, Int_xd_Buf, OutData%xd(i1), ErrStat, ErrMsg ) ! xd 
ENDDO
DO i1 = LBOUND(OutData%z,1), UBOUND(OutData%z,1)
 ! first call MD_PackConstrState to get correctly sized buffers for unpacking
  CALL MD_PackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg, .TRUE. ) ! z 
  IF(ALLOCATED(Re_z_Buf)) THEN
    Re_z_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_z_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_z_Buf)
  ENDIF
  IF(ALLOCATED(Db_z_Buf)) THEN
    Db_z_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_z_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_z_Buf)
  ENDIF
  IF(ALLOCATED(Int_z_Buf)) THEN
    Int_z_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_z_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_z_Buf)
  ENDIF
  CALL MD_UnPackConstrState( Re_z_Buf, Db_z_Buf, Int_z_Buf, OutData%z(i1), ErrStat, ErrMsg ) ! z 
ENDDO
 ! first call MD_PackOtherState to get correctly sized buffers for unpacking
  CALL MD_PackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg, .TRUE. ) ! OtherSt 
  IF(ALLOCATED(Re_OtherSt_Buf)) THEN
    Re_OtherSt_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_Buf)) THEN
    Db_OtherSt_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_Buf)) THEN
    Int_OtherSt_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_Buf)
  ENDIF
  CALL MD_UnPackOtherState( Re_OtherSt_Buf, Db_OtherSt_Buf, Int_OtherSt_Buf, OutData%OtherSt, ErrStat, ErrMsg ) ! OtherSt 
 ! first call MD_PackParam to get correctly sized buffers for unpacking
  CALL MD_PackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg, .TRUE. ) ! p 
  IF(ALLOCATED(Re_p_Buf)) THEN
    Re_p_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_p_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_p_Buf)
  ENDIF
  IF(ALLOCATED(Db_p_Buf)) THEN
    Db_p_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_p_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_p_Buf)
  ENDIF
  IF(ALLOCATED(Int_p_Buf)) THEN
    Int_p_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_p_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_p_Buf)
  ENDIF
  CALL MD_UnPackParam( Re_p_Buf, Db_p_Buf, Int_p_Buf, OutData%p, ErrStat, ErrMsg ) ! p 
 ! first call MD_PackInput to get correctly sized buffers for unpacking
  CALL MD_PackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg, .TRUE. ) ! u 
  IF(ALLOCATED(Re_u_Buf)) THEN
    Re_u_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_Buf)) THEN
    Db_u_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_Buf)) THEN
    Int_u_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_Buf)
  ENDIF
  CALL MD_UnPackInput( Re_u_Buf, Db_u_Buf, Int_u_Buf, OutData%u, ErrStat, ErrMsg ) ! u 
 ! first call MD_PackOutput to get correctly sized buffers for unpacking
  CALL MD_PackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg, .TRUE. ) ! y 
  IF(ALLOCATED(Re_y_Buf)) THEN
    Re_y_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_y_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_y_Buf)
  ENDIF
  IF(ALLOCATED(Db_y_Buf)) THEN
    Db_y_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_y_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_y_Buf)
  ENDIF
  IF(ALLOCATED(Int_y_Buf)) THEN
    Int_y_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_y_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_y_Buf)
  ENDIF
  CALL MD_UnPackOutput( Re_y_Buf, Db_y_Buf, Int_y_Buf, OutData%y, ErrStat, ErrMsg ) ! y 
 ! first call MD_PackOtherState to get correctly sized buffers for unpacking
  CALL MD_PackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg, .TRUE. ) ! OtherSt_old 
  IF(ALLOCATED(Re_OtherSt_old_Buf)) THEN
    Re_OtherSt_old_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OtherSt_old_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Db_OtherSt_old_Buf)) THEN
    Db_OtherSt_old_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OtherSt_old_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OtherSt_old_Buf)
  ENDIF
  IF(ALLOCATED(Int_OtherSt_old_Buf)) THEN
    Int_OtherSt_old_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OtherSt_old_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OtherSt_old_Buf)
  ENDIF
  CALL MD_UnPackOtherState( Re_OtherSt_old_Buf, Db_OtherSt_old_Buf, Int_OtherSt_old_Buf, OutData%OtherSt_old, ErrStat, ErrMsg ) ! OtherSt_old 
DO i1 = LBOUND(OutData%Input,1), UBOUND(OutData%Input,1)
 ! first call MD_PackInput to get correctly sized buffers for unpacking
  CALL MD_PackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg, .TRUE. ) ! Input 
  IF(ALLOCATED(Re_Input_Buf)) THEN
    Re_Input_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Input_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Input_Buf)
  ENDIF
  IF(ALLOCATED(Db_Input_Buf)) THEN
    Db_Input_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Input_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Input_Buf)
  ENDIF
  IF(ALLOCATED(Int_Input_Buf)) THEN
    Int_Input_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Input_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Input_Buf)
  ENDIF
  CALL MD_UnPackInput( Re_Input_Buf, Db_Input_Buf, Int_Input_Buf, OutData%Input(i1), ErrStat, ErrMsg ) ! Input 
ENDDO
  IF ( ALLOCATED(OutData%InputTimes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InputTimes,1)))
  mask1 = .TRUE.
    OutData%InputTimes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%InputTimes))-1 ),mask1,OutData%InputTimes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%InputTimes)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackMoorDyn_Data

 SUBROUTINE FAST_CopyModuleMapType( SrcModuleMapTypeData, DstModuleMapTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_ModuleMapType), INTENT(INOUT) :: SrcModuleMapTypeData
   TYPE(FAST_ModuleMapType), INTENT(INOUT) :: DstModuleMapTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_HD_W_P, DstModuleMapTypeData%ED_P_2_HD_W_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_HD_W_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%HD_W_P_2_ED_P, DstModuleMapTypeData%HD_W_P_2_ED_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:HD_W_P_2_ED_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_HD_M_P, DstModuleMapTypeData%ED_P_2_HD_M_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_HD_M_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%HD_M_P_2_ED_P, DstModuleMapTypeData%HD_M_P_2_ED_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:HD_M_P_2_ED_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_HD_M_L, DstModuleMapTypeData%ED_P_2_HD_M_L, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_HD_M_L')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%HD_M_L_2_ED_P, DstModuleMapTypeData%HD_M_L_2_ED_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:HD_M_L_2_ED_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_Mooring_P, DstModuleMapTypeData%ED_P_2_Mooring_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_Mooring_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%Mooring_P_2_ED_P, DstModuleMapTypeData%Mooring_P_2_ED_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:Mooring_P_2_ED_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_SD_TP, DstModuleMapTypeData%ED_P_2_SD_TP, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_SD_TP')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SD_TP_2_ED_P, DstModuleMapTypeData%SD_TP_2_ED_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SD_TP_2_ED_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SD_P_2_HD_M_P, DstModuleMapTypeData%SD_P_2_HD_M_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SD_P_2_HD_M_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%HD_M_P_2_SD_P, DstModuleMapTypeData%HD_M_P_2_SD_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:HD_M_P_2_SD_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SD_P_2_HD_M_L, DstModuleMapTypeData%SD_P_2_HD_M_L, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SD_P_2_HD_M_L')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%HD_M_L_2_SD_P, DstModuleMapTypeData%HD_M_L_2_SD_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:HD_M_L_2_SD_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_P_2_SrvD_P_N, DstModuleMapTypeData%ED_P_2_SrvD_P_N, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_P_2_SrvD_P_N')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SrvD_P_2_ED_P_N, DstModuleMapTypeData%SrvD_P_2_ED_P_N, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SrvD_P_2_ED_P_N')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcModuleMapTypeData%ED_L_2_AD_L_B)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%ED_L_2_AD_L_B,1)
   i1_u = UBOUND(SrcModuleMapTypeData%ED_L_2_AD_L_B,1)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%ED_L_2_AD_L_B)) THEN 
      ALLOCATE(DstModuleMapTypeData%ED_L_2_AD_L_B(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%ED_L_2_AD_L_B.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcModuleMapTypeData%ED_L_2_AD_L_B,1), UBOUND(SrcModuleMapTypeData%ED_L_2_AD_L_B,1)
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_L_2_AD_L_B(i1), DstModuleMapTypeData%ED_L_2_AD_L_B(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_L_2_AD_L_B(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcModuleMapTypeData%AD_L_2_ED_L_B)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%AD_L_2_ED_L_B,1)
   i1_u = UBOUND(SrcModuleMapTypeData%AD_L_2_ED_L_B,1)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%AD_L_2_ED_L_B)) THEN 
      ALLOCATE(DstModuleMapTypeData%AD_L_2_ED_L_B(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%AD_L_2_ED_L_B.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcModuleMapTypeData%AD_L_2_ED_L_B,1), UBOUND(SrcModuleMapTypeData%AD_L_2_ED_L_B,1)
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%AD_L_2_ED_L_B(i1), DstModuleMapTypeData%AD_L_2_ED_L_B(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:AD_L_2_ED_L_B(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%ED_L_2_AD_L_T, DstModuleMapTypeData%ED_L_2_AD_L_T, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:ED_L_2_AD_L_T')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%AD_L_2_ED_L_T, DstModuleMapTypeData%AD_L_2_ED_L_T, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:AD_L_2_ED_L_T')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%IceF_P_2_SD_P, DstModuleMapTypeData%IceF_P_2_SD_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:IceF_P_2_SD_P')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SD_P_2_IceF_P, DstModuleMapTypeData%SD_P_2_IceF_P, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SD_P_2_IceF_P')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcModuleMapTypeData%IceD_P_2_SD_P)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%IceD_P_2_SD_P,1)
   i1_u = UBOUND(SrcModuleMapTypeData%IceD_P_2_SD_P,1)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%IceD_P_2_SD_P)) THEN 
      ALLOCATE(DstModuleMapTypeData%IceD_P_2_SD_P(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%IceD_P_2_SD_P.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcModuleMapTypeData%IceD_P_2_SD_P,1), UBOUND(SrcModuleMapTypeData%IceD_P_2_SD_P,1)
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%IceD_P_2_SD_P(i1), DstModuleMapTypeData%IceD_P_2_SD_P(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:IceD_P_2_SD_P(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcModuleMapTypeData%SD_P_2_IceD_P)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%SD_P_2_IceD_P,1)
   i1_u = UBOUND(SrcModuleMapTypeData%SD_P_2_IceD_P,1)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%SD_P_2_IceD_P)) THEN 
      ALLOCATE(DstModuleMapTypeData%SD_P_2_IceD_P(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%SD_P_2_IceD_P.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcModuleMapTypeData%SD_P_2_IceD_P,1), UBOUND(SrcModuleMapTypeData%SD_P_2_IceD_P,1)
      CALL NWTC_Library_Copymeshmaptype( SrcModuleMapTypeData%SD_P_2_IceD_P(i1), DstModuleMapTypeData%SD_P_2_IceD_P(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:SD_P_2_IceD_P(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcModuleMapTypeData%Jacobian_ED_SD_HD)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%Jacobian_ED_SD_HD,1)
   i1_u = UBOUND(SrcModuleMapTypeData%Jacobian_ED_SD_HD,1)
   i2_l = LBOUND(SrcModuleMapTypeData%Jacobian_ED_SD_HD,2)
   i2_u = UBOUND(SrcModuleMapTypeData%Jacobian_ED_SD_HD,2)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%Jacobian_ED_SD_HD)) THEN 
      ALLOCATE(DstModuleMapTypeData%Jacobian_ED_SD_HD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%Jacobian_ED_SD_HD.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DstModuleMapTypeData%Jacobian_ED_SD_HD = SrcModuleMapTypeData%Jacobian_ED_SD_HD
ENDIF
IF (ALLOCATED(SrcModuleMapTypeData%Jacobian_pivot)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%Jacobian_pivot,1)
   i1_u = UBOUND(SrcModuleMapTypeData%Jacobian_pivot,1)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%Jacobian_pivot)) THEN 
      ALLOCATE(DstModuleMapTypeData%Jacobian_pivot(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%Jacobian_pivot.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DstModuleMapTypeData%Jacobian_pivot = SrcModuleMapTypeData%Jacobian_pivot
ENDIF
IF (ALLOCATED(SrcModuleMapTypeData%Jac_u_indx)) THEN
   i1_l = LBOUND(SrcModuleMapTypeData%Jac_u_indx,1)
   i1_u = UBOUND(SrcModuleMapTypeData%Jac_u_indx,1)
   i2_l = LBOUND(SrcModuleMapTypeData%Jac_u_indx,2)
   i2_u = UBOUND(SrcModuleMapTypeData%Jac_u_indx,2)
   IF (.NOT. ALLOCATED(DstModuleMapTypeData%Jac_u_indx)) THEN 
      ALLOCATE(DstModuleMapTypeData%Jac_u_indx(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstModuleMapTypeData%Jac_u_indx.', ErrStat, ErrMsg,'FAST_CopyModuleMapType')
         RETURN
      END IF
   END IF
   DstModuleMapTypeData%Jac_u_indx = SrcModuleMapTypeData%Jac_u_indx
ENDIF
     CALL MeshCopy( SrcModuleMapTypeData%u_ED_PlatformPtMesh, DstModuleMapTypeData%u_ED_PlatformPtMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_ED_PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_ED_PlatformPtMesh_2, DstModuleMapTypeData%u_ED_PlatformPtMesh_2, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_ED_PlatformPtMesh_2')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_SD_TPMesh, DstModuleMapTypeData%u_SD_TPMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_SD_TPMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_SD_LMesh, DstModuleMapTypeData%u_SD_LMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_SD_LMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_SD_LMesh_2, DstModuleMapTypeData%u_SD_LMesh_2, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_SD_LMesh_2')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_HD_M_LumpedMesh, DstModuleMapTypeData%u_HD_M_LumpedMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_HD_M_LumpedMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_HD_M_DistribMesh, DstModuleMapTypeData%u_HD_M_DistribMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_HD_M_DistribMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcModuleMapTypeData%u_HD_Mesh, DstModuleMapTypeData%u_HD_Mesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyModuleMapType:u_HD_Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE FAST_CopyModuleMapType

 SUBROUTINE FAST_DestroyModuleMapType( ModuleMapTypeData, ErrStat, ErrMsg )
  TYPE(FAST_ModuleMapType), INTENT(INOUT) :: ModuleMapTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_HD_W_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%HD_W_P_2_ED_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_HD_M_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%HD_M_P_2_ED_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_HD_M_L, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%HD_M_L_2_ED_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_Mooring_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%Mooring_P_2_ED_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_SD_TP, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SD_TP_2_ED_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SD_P_2_HD_M_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%HD_M_P_2_SD_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SD_P_2_HD_M_L, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%HD_M_L_2_SD_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_P_2_SrvD_P_N, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SrvD_P_2_ED_P_N, ErrStat, ErrMsg )
IF (ALLOCATED(ModuleMapTypeData%ED_L_2_AD_L_B)) THEN
DO i1 = LBOUND(ModuleMapTypeData%ED_L_2_AD_L_B,1), UBOUND(ModuleMapTypeData%ED_L_2_AD_L_B,1)
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_L_2_AD_L_B(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ModuleMapTypeData%ED_L_2_AD_L_B)
ENDIF
IF (ALLOCATED(ModuleMapTypeData%AD_L_2_ED_L_B)) THEN
DO i1 = LBOUND(ModuleMapTypeData%AD_L_2_ED_L_B,1), UBOUND(ModuleMapTypeData%AD_L_2_ED_L_B,1)
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%AD_L_2_ED_L_B(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ModuleMapTypeData%AD_L_2_ED_L_B)
ENDIF
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%ED_L_2_AD_L_T, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%AD_L_2_ED_L_T, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%IceF_P_2_SD_P, ErrStat, ErrMsg )
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SD_P_2_IceF_P, ErrStat, ErrMsg )
IF (ALLOCATED(ModuleMapTypeData%IceD_P_2_SD_P)) THEN
DO i1 = LBOUND(ModuleMapTypeData%IceD_P_2_SD_P,1), UBOUND(ModuleMapTypeData%IceD_P_2_SD_P,1)
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%IceD_P_2_SD_P(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ModuleMapTypeData%IceD_P_2_SD_P)
ENDIF
IF (ALLOCATED(ModuleMapTypeData%SD_P_2_IceD_P)) THEN
DO i1 = LBOUND(ModuleMapTypeData%SD_P_2_IceD_P,1), UBOUND(ModuleMapTypeData%SD_P_2_IceD_P,1)
  CALL NWTC_Library_Destroymeshmaptype( ModuleMapTypeData%SD_P_2_IceD_P(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ModuleMapTypeData%SD_P_2_IceD_P)
ENDIF
IF (ALLOCATED(ModuleMapTypeData%Jacobian_ED_SD_HD)) THEN
   DEALLOCATE(ModuleMapTypeData%Jacobian_ED_SD_HD)
ENDIF
IF (ALLOCATED(ModuleMapTypeData%Jacobian_pivot)) THEN
   DEALLOCATE(ModuleMapTypeData%Jacobian_pivot)
ENDIF
IF (ALLOCATED(ModuleMapTypeData%Jac_u_indx)) THEN
   DEALLOCATE(ModuleMapTypeData%Jac_u_indx)
ENDIF
  CALL MeshDestroy( ModuleMapTypeData%u_ED_PlatformPtMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_ED_PlatformPtMesh_2, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_SD_TPMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_SD_LMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_SD_LMesh_2, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_HD_M_LumpedMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_HD_M_DistribMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( ModuleMapTypeData%u_HD_Mesh, ErrStat, ErrMsg )
 END SUBROUTINE FAST_DestroyModuleMapType

 SUBROUTINE FAST_PackModuleMapType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_ModuleMapType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_HD_W_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_HD_W_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_HD_W_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HD_W_P_2_ED_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HD_W_P_2_ED_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HD_W_P_2_ED_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_HD_M_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_HD_M_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_HD_M_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HD_M_P_2_ED_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HD_M_P_2_ED_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HD_M_P_2_ED_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_HD_M_L_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_HD_M_L_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_HD_M_L_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HD_M_L_2_ED_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HD_M_L_2_ED_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HD_M_L_2_ED_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_Mooring_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_Mooring_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_Mooring_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Mooring_P_2_ED_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Mooring_P_2_ED_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Mooring_P_2_ED_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_SD_TP_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_SD_TP_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_SD_TP_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SD_TP_2_ED_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SD_TP_2_ED_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SD_TP_2_ED_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SD_P_2_HD_M_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SD_P_2_HD_M_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SD_P_2_HD_M_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HD_M_P_2_SD_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HD_M_P_2_SD_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HD_M_P_2_SD_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SD_P_2_HD_M_L_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SD_P_2_HD_M_L_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SD_P_2_HD_M_L_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HD_M_L_2_SD_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HD_M_L_2_SD_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HD_M_L_2_SD_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_P_2_SrvD_P_N_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_P_2_SrvD_P_N_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_P_2_SrvD_P_N_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SrvD_P_2_ED_P_N_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SrvD_P_2_ED_P_N_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SrvD_P_2_ED_P_N_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_L_2_AD_L_B_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_L_2_AD_L_B_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_L_2_AD_L_B_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_AD_L_2_ED_L_B_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AD_L_2_ED_L_B_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AD_L_2_ED_L_B_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ED_L_2_AD_L_T_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ED_L_2_AD_L_T_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ED_L_2_AD_L_T_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_AD_L_2_ED_L_T_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AD_L_2_ED_L_T_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AD_L_2_ED_L_T_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IceF_P_2_SD_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IceF_P_2_SD_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IceF_P_2_SD_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SD_P_2_IceF_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SD_P_2_IceF_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SD_P_2_IceF_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IceD_P_2_SD_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IceD_P_2_SD_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IceD_P_2_SD_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SD_P_2_IceD_P_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SD_P_2_IceD_P_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SD_P_2_IceD_P_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_ED_PlatformPtMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_ED_PlatformPtMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_ED_PlatformPtMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_ED_PlatformPtMesh_2_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_ED_PlatformPtMesh_2_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_ED_PlatformPtMesh_2_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_SD_TPMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_SD_TPMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_SD_TPMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_SD_LMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_SD_LMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_SD_LMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_SD_LMesh_2_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_SD_LMesh_2_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_SD_LMesh_2_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_HD_M_LumpedMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_HD_M_LumpedMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_HD_M_LumpedMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_HD_M_DistribMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_HD_M_DistribMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_HD_M_DistribMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_u_HD_Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_u_HD_Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_u_HD_Mesh_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_W_P_Buf, Db_ED_P_2_HD_W_P_Buf, Int_ED_P_2_HD_W_P_Buf, InData%ED_P_2_HD_W_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_W_P 
  IF(ALLOCATED(Re_ED_P_2_HD_W_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_HD_W_P_Buf  ) ! ED_P_2_HD_W_P
  IF(ALLOCATED(Db_ED_P_2_HD_W_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_HD_W_P_Buf  ) ! ED_P_2_HD_W_P
  IF(ALLOCATED(Int_ED_P_2_HD_W_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_HD_W_P_Buf ) ! ED_P_2_HD_W_P
  IF(ALLOCATED(Re_ED_P_2_HD_W_P_Buf))  DEALLOCATE(Re_ED_P_2_HD_W_P_Buf)
  IF(ALLOCATED(Db_ED_P_2_HD_W_P_Buf))  DEALLOCATE(Db_ED_P_2_HD_W_P_Buf)
  IF(ALLOCATED(Int_ED_P_2_HD_W_P_Buf)) DEALLOCATE(Int_ED_P_2_HD_W_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_W_P_2_ED_P_Buf, Db_HD_W_P_2_ED_P_Buf, Int_HD_W_P_2_ED_P_Buf, InData%HD_W_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_W_P_2_ED_P 
  IF(ALLOCATED(Re_HD_W_P_2_ED_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HD_W_P_2_ED_P_Buf  ) ! HD_W_P_2_ED_P
  IF(ALLOCATED(Db_HD_W_P_2_ED_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HD_W_P_2_ED_P_Buf  ) ! HD_W_P_2_ED_P
  IF(ALLOCATED(Int_HD_W_P_2_ED_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HD_W_P_2_ED_P_Buf ) ! HD_W_P_2_ED_P
  IF(ALLOCATED(Re_HD_W_P_2_ED_P_Buf))  DEALLOCATE(Re_HD_W_P_2_ED_P_Buf)
  IF(ALLOCATED(Db_HD_W_P_2_ED_P_Buf))  DEALLOCATE(Db_HD_W_P_2_ED_P_Buf)
  IF(ALLOCATED(Int_HD_W_P_2_ED_P_Buf)) DEALLOCATE(Int_HD_W_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_P_Buf, Db_ED_P_2_HD_M_P_Buf, Int_ED_P_2_HD_M_P_Buf, InData%ED_P_2_HD_M_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_M_P 
  IF(ALLOCATED(Re_ED_P_2_HD_M_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_HD_M_P_Buf  ) ! ED_P_2_HD_M_P
  IF(ALLOCATED(Db_ED_P_2_HD_M_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_HD_M_P_Buf  ) ! ED_P_2_HD_M_P
  IF(ALLOCATED(Int_ED_P_2_HD_M_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_HD_M_P_Buf ) ! ED_P_2_HD_M_P
  IF(ALLOCATED(Re_ED_P_2_HD_M_P_Buf))  DEALLOCATE(Re_ED_P_2_HD_M_P_Buf)
  IF(ALLOCATED(Db_ED_P_2_HD_M_P_Buf))  DEALLOCATE(Db_ED_P_2_HD_M_P_Buf)
  IF(ALLOCATED(Int_ED_P_2_HD_M_P_Buf)) DEALLOCATE(Int_ED_P_2_HD_M_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_ED_P_Buf, Db_HD_M_P_2_ED_P_Buf, Int_HD_M_P_2_ED_P_Buf, InData%HD_M_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_P_2_ED_P 
  IF(ALLOCATED(Re_HD_M_P_2_ED_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HD_M_P_2_ED_P_Buf  ) ! HD_M_P_2_ED_P
  IF(ALLOCATED(Db_HD_M_P_2_ED_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HD_M_P_2_ED_P_Buf  ) ! HD_M_P_2_ED_P
  IF(ALLOCATED(Int_HD_M_P_2_ED_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HD_M_P_2_ED_P_Buf ) ! HD_M_P_2_ED_P
  IF(ALLOCATED(Re_HD_M_P_2_ED_P_Buf))  DEALLOCATE(Re_HD_M_P_2_ED_P_Buf)
  IF(ALLOCATED(Db_HD_M_P_2_ED_P_Buf))  DEALLOCATE(Db_HD_M_P_2_ED_P_Buf)
  IF(ALLOCATED(Int_HD_M_P_2_ED_P_Buf)) DEALLOCATE(Int_HD_M_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_L_Buf, Db_ED_P_2_HD_M_L_Buf, Int_ED_P_2_HD_M_L_Buf, InData%ED_P_2_HD_M_L, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_M_L 
  IF(ALLOCATED(Re_ED_P_2_HD_M_L_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_HD_M_L_Buf  ) ! ED_P_2_HD_M_L
  IF(ALLOCATED(Db_ED_P_2_HD_M_L_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_HD_M_L_Buf  ) ! ED_P_2_HD_M_L
  IF(ALLOCATED(Int_ED_P_2_HD_M_L_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_HD_M_L_Buf ) ! ED_P_2_HD_M_L
  IF(ALLOCATED(Re_ED_P_2_HD_M_L_Buf))  DEALLOCATE(Re_ED_P_2_HD_M_L_Buf)
  IF(ALLOCATED(Db_ED_P_2_HD_M_L_Buf))  DEALLOCATE(Db_ED_P_2_HD_M_L_Buf)
  IF(ALLOCATED(Int_ED_P_2_HD_M_L_Buf)) DEALLOCATE(Int_ED_P_2_HD_M_L_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_ED_P_Buf, Db_HD_M_L_2_ED_P_Buf, Int_HD_M_L_2_ED_P_Buf, InData%HD_M_L_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_L_2_ED_P 
  IF(ALLOCATED(Re_HD_M_L_2_ED_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HD_M_L_2_ED_P_Buf  ) ! HD_M_L_2_ED_P
  IF(ALLOCATED(Db_HD_M_L_2_ED_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HD_M_L_2_ED_P_Buf  ) ! HD_M_L_2_ED_P
  IF(ALLOCATED(Int_HD_M_L_2_ED_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HD_M_L_2_ED_P_Buf ) ! HD_M_L_2_ED_P
  IF(ALLOCATED(Re_HD_M_L_2_ED_P_Buf))  DEALLOCATE(Re_HD_M_L_2_ED_P_Buf)
  IF(ALLOCATED(Db_HD_M_L_2_ED_P_Buf))  DEALLOCATE(Db_HD_M_L_2_ED_P_Buf)
  IF(ALLOCATED(Int_HD_M_L_2_ED_P_Buf)) DEALLOCATE(Int_HD_M_L_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_Mooring_P_Buf, Db_ED_P_2_Mooring_P_Buf, Int_ED_P_2_Mooring_P_Buf, InData%ED_P_2_Mooring_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_Mooring_P 
  IF(ALLOCATED(Re_ED_P_2_Mooring_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_Mooring_P_Buf  ) ! ED_P_2_Mooring_P
  IF(ALLOCATED(Db_ED_P_2_Mooring_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_Mooring_P_Buf  ) ! ED_P_2_Mooring_P
  IF(ALLOCATED(Int_ED_P_2_Mooring_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_Mooring_P_Buf ) ! ED_P_2_Mooring_P
  IF(ALLOCATED(Re_ED_P_2_Mooring_P_Buf))  DEALLOCATE(Re_ED_P_2_Mooring_P_Buf)
  IF(ALLOCATED(Db_ED_P_2_Mooring_P_Buf))  DEALLOCATE(Db_ED_P_2_Mooring_P_Buf)
  IF(ALLOCATED(Int_ED_P_2_Mooring_P_Buf)) DEALLOCATE(Int_ED_P_2_Mooring_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_Mooring_P_2_ED_P_Buf, Db_Mooring_P_2_ED_P_Buf, Int_Mooring_P_2_ED_P_Buf, InData%Mooring_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! Mooring_P_2_ED_P 
  IF(ALLOCATED(Re_Mooring_P_2_ED_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Mooring_P_2_ED_P_Buf  ) ! Mooring_P_2_ED_P
  IF(ALLOCATED(Db_Mooring_P_2_ED_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Mooring_P_2_ED_P_Buf  ) ! Mooring_P_2_ED_P
  IF(ALLOCATED(Int_Mooring_P_2_ED_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Mooring_P_2_ED_P_Buf ) ! Mooring_P_2_ED_P
  IF(ALLOCATED(Re_Mooring_P_2_ED_P_Buf))  DEALLOCATE(Re_Mooring_P_2_ED_P_Buf)
  IF(ALLOCATED(Db_Mooring_P_2_ED_P_Buf))  DEALLOCATE(Db_Mooring_P_2_ED_P_Buf)
  IF(ALLOCATED(Int_Mooring_P_2_ED_P_Buf)) DEALLOCATE(Int_Mooring_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SD_TP_Buf, Db_ED_P_2_SD_TP_Buf, Int_ED_P_2_SD_TP_Buf, InData%ED_P_2_SD_TP, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_SD_TP 
  IF(ALLOCATED(Re_ED_P_2_SD_TP_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_SD_TP_Buf  ) ! ED_P_2_SD_TP
  IF(ALLOCATED(Db_ED_P_2_SD_TP_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_SD_TP_Buf  ) ! ED_P_2_SD_TP
  IF(ALLOCATED(Int_ED_P_2_SD_TP_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_SD_TP_Buf ) ! ED_P_2_SD_TP
  IF(ALLOCATED(Re_ED_P_2_SD_TP_Buf))  DEALLOCATE(Re_ED_P_2_SD_TP_Buf)
  IF(ALLOCATED(Db_ED_P_2_SD_TP_Buf))  DEALLOCATE(Db_ED_P_2_SD_TP_Buf)
  IF(ALLOCATED(Int_ED_P_2_SD_TP_Buf)) DEALLOCATE(Int_ED_P_2_SD_TP_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_TP_2_ED_P_Buf, Db_SD_TP_2_ED_P_Buf, Int_SD_TP_2_ED_P_Buf, InData%SD_TP_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! SD_TP_2_ED_P 
  IF(ALLOCATED(Re_SD_TP_2_ED_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SD_TP_2_ED_P_Buf  ) ! SD_TP_2_ED_P
  IF(ALLOCATED(Db_SD_TP_2_ED_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SD_TP_2_ED_P_Buf  ) ! SD_TP_2_ED_P
  IF(ALLOCATED(Int_SD_TP_2_ED_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SD_TP_2_ED_P_Buf ) ! SD_TP_2_ED_P
  IF(ALLOCATED(Re_SD_TP_2_ED_P_Buf))  DEALLOCATE(Re_SD_TP_2_ED_P_Buf)
  IF(ALLOCATED(Db_SD_TP_2_ED_P_Buf))  DEALLOCATE(Db_SD_TP_2_ED_P_Buf)
  IF(ALLOCATED(Int_SD_TP_2_ED_P_Buf)) DEALLOCATE(Int_SD_TP_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_P_Buf, Db_SD_P_2_HD_M_P_Buf, Int_SD_P_2_HD_M_P_Buf, InData%SD_P_2_HD_M_P, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_HD_M_P 
  IF(ALLOCATED(Re_SD_P_2_HD_M_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SD_P_2_HD_M_P_Buf  ) ! SD_P_2_HD_M_P
  IF(ALLOCATED(Db_SD_P_2_HD_M_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SD_P_2_HD_M_P_Buf  ) ! SD_P_2_HD_M_P
  IF(ALLOCATED(Int_SD_P_2_HD_M_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SD_P_2_HD_M_P_Buf ) ! SD_P_2_HD_M_P
  IF(ALLOCATED(Re_SD_P_2_HD_M_P_Buf))  DEALLOCATE(Re_SD_P_2_HD_M_P_Buf)
  IF(ALLOCATED(Db_SD_P_2_HD_M_P_Buf))  DEALLOCATE(Db_SD_P_2_HD_M_P_Buf)
  IF(ALLOCATED(Int_SD_P_2_HD_M_P_Buf)) DEALLOCATE(Int_SD_P_2_HD_M_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_SD_P_Buf, Db_HD_M_P_2_SD_P_Buf, Int_HD_M_P_2_SD_P_Buf, InData%HD_M_P_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_P_2_SD_P 
  IF(ALLOCATED(Re_HD_M_P_2_SD_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HD_M_P_2_SD_P_Buf  ) ! HD_M_P_2_SD_P
  IF(ALLOCATED(Db_HD_M_P_2_SD_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HD_M_P_2_SD_P_Buf  ) ! HD_M_P_2_SD_P
  IF(ALLOCATED(Int_HD_M_P_2_SD_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HD_M_P_2_SD_P_Buf ) ! HD_M_P_2_SD_P
  IF(ALLOCATED(Re_HD_M_P_2_SD_P_Buf))  DEALLOCATE(Re_HD_M_P_2_SD_P_Buf)
  IF(ALLOCATED(Db_HD_M_P_2_SD_P_Buf))  DEALLOCATE(Db_HD_M_P_2_SD_P_Buf)
  IF(ALLOCATED(Int_HD_M_P_2_SD_P_Buf)) DEALLOCATE(Int_HD_M_P_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_L_Buf, Db_SD_P_2_HD_M_L_Buf, Int_SD_P_2_HD_M_L_Buf, InData%SD_P_2_HD_M_L, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_HD_M_L 
  IF(ALLOCATED(Re_SD_P_2_HD_M_L_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SD_P_2_HD_M_L_Buf  ) ! SD_P_2_HD_M_L
  IF(ALLOCATED(Db_SD_P_2_HD_M_L_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SD_P_2_HD_M_L_Buf  ) ! SD_P_2_HD_M_L
  IF(ALLOCATED(Int_SD_P_2_HD_M_L_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SD_P_2_HD_M_L_Buf ) ! SD_P_2_HD_M_L
  IF(ALLOCATED(Re_SD_P_2_HD_M_L_Buf))  DEALLOCATE(Re_SD_P_2_HD_M_L_Buf)
  IF(ALLOCATED(Db_SD_P_2_HD_M_L_Buf))  DEALLOCATE(Db_SD_P_2_HD_M_L_Buf)
  IF(ALLOCATED(Int_SD_P_2_HD_M_L_Buf)) DEALLOCATE(Int_SD_P_2_HD_M_L_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_SD_P_Buf, Db_HD_M_L_2_SD_P_Buf, Int_HD_M_L_2_SD_P_Buf, InData%HD_M_L_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_L_2_SD_P 
  IF(ALLOCATED(Re_HD_M_L_2_SD_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HD_M_L_2_SD_P_Buf  ) ! HD_M_L_2_SD_P
  IF(ALLOCATED(Db_HD_M_L_2_SD_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HD_M_L_2_SD_P_Buf  ) ! HD_M_L_2_SD_P
  IF(ALLOCATED(Int_HD_M_L_2_SD_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HD_M_L_2_SD_P_Buf ) ! HD_M_L_2_SD_P
  IF(ALLOCATED(Re_HD_M_L_2_SD_P_Buf))  DEALLOCATE(Re_HD_M_L_2_SD_P_Buf)
  IF(ALLOCATED(Db_HD_M_L_2_SD_P_Buf))  DEALLOCATE(Db_HD_M_L_2_SD_P_Buf)
  IF(ALLOCATED(Int_HD_M_L_2_SD_P_Buf)) DEALLOCATE(Int_HD_M_L_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SrvD_P_N_Buf, Db_ED_P_2_SrvD_P_N_Buf, Int_ED_P_2_SrvD_P_N_Buf, InData%ED_P_2_SrvD_P_N, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_SrvD_P_N 
  IF(ALLOCATED(Re_ED_P_2_SrvD_P_N_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_P_2_SrvD_P_N_Buf  ) ! ED_P_2_SrvD_P_N
  IF(ALLOCATED(Db_ED_P_2_SrvD_P_N_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_P_2_SrvD_P_N_Buf  ) ! ED_P_2_SrvD_P_N
  IF(ALLOCATED(Int_ED_P_2_SrvD_P_N_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_P_2_SrvD_P_N_Buf ) ! ED_P_2_SrvD_P_N
  IF(ALLOCATED(Re_ED_P_2_SrvD_P_N_Buf))  DEALLOCATE(Re_ED_P_2_SrvD_P_N_Buf)
  IF(ALLOCATED(Db_ED_P_2_SrvD_P_N_Buf))  DEALLOCATE(Db_ED_P_2_SrvD_P_N_Buf)
  IF(ALLOCATED(Int_ED_P_2_SrvD_P_N_Buf)) DEALLOCATE(Int_ED_P_2_SrvD_P_N_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SrvD_P_2_ED_P_N_Buf, Db_SrvD_P_2_ED_P_N_Buf, Int_SrvD_P_2_ED_P_N_Buf, InData%SrvD_P_2_ED_P_N, ErrStat, ErrMsg, .TRUE. ) ! SrvD_P_2_ED_P_N 
  IF(ALLOCATED(Re_SrvD_P_2_ED_P_N_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SrvD_P_2_ED_P_N_Buf  ) ! SrvD_P_2_ED_P_N
  IF(ALLOCATED(Db_SrvD_P_2_ED_P_N_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SrvD_P_2_ED_P_N_Buf  ) ! SrvD_P_2_ED_P_N
  IF(ALLOCATED(Int_SrvD_P_2_ED_P_N_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SrvD_P_2_ED_P_N_Buf ) ! SrvD_P_2_ED_P_N
  IF(ALLOCATED(Re_SrvD_P_2_ED_P_N_Buf))  DEALLOCATE(Re_SrvD_P_2_ED_P_N_Buf)
  IF(ALLOCATED(Db_SrvD_P_2_ED_P_N_Buf))  DEALLOCATE(Db_SrvD_P_2_ED_P_N_Buf)
  IF(ALLOCATED(Int_SrvD_P_2_ED_P_N_Buf)) DEALLOCATE(Int_SrvD_P_2_ED_P_N_Buf)
DO i1 = LBOUND(InData%ED_L_2_AD_L_B,1), UBOUND(InData%ED_L_2_AD_L_B,1)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_B_Buf, Db_ED_L_2_AD_L_B_Buf, Int_ED_L_2_AD_L_B_Buf, InData%ED_L_2_AD_L_B(i1), ErrStat, ErrMsg, .TRUE. ) ! ED_L_2_AD_L_B 
  IF(ALLOCATED(Re_ED_L_2_AD_L_B_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_L_2_AD_L_B_Buf  ) ! ED_L_2_AD_L_B
  IF(ALLOCATED(Db_ED_L_2_AD_L_B_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_L_2_AD_L_B_Buf  ) ! ED_L_2_AD_L_B
  IF(ALLOCATED(Int_ED_L_2_AD_L_B_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_L_2_AD_L_B_Buf ) ! ED_L_2_AD_L_B
  IF(ALLOCATED(Re_ED_L_2_AD_L_B_Buf))  DEALLOCATE(Re_ED_L_2_AD_L_B_Buf)
  IF(ALLOCATED(Db_ED_L_2_AD_L_B_Buf))  DEALLOCATE(Db_ED_L_2_AD_L_B_Buf)
  IF(ALLOCATED(Int_ED_L_2_AD_L_B_Buf)) DEALLOCATE(Int_ED_L_2_AD_L_B_Buf)
ENDDO
DO i1 = LBOUND(InData%AD_L_2_ED_L_B,1), UBOUND(InData%AD_L_2_ED_L_B,1)
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_B_Buf, Db_AD_L_2_ED_L_B_Buf, Int_AD_L_2_ED_L_B_Buf, InData%AD_L_2_ED_L_B(i1), ErrStat, ErrMsg, .TRUE. ) ! AD_L_2_ED_L_B 
  IF(ALLOCATED(Re_AD_L_2_ED_L_B_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AD_L_2_ED_L_B_Buf  ) ! AD_L_2_ED_L_B
  IF(ALLOCATED(Db_AD_L_2_ED_L_B_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AD_L_2_ED_L_B_Buf  ) ! AD_L_2_ED_L_B
  IF(ALLOCATED(Int_AD_L_2_ED_L_B_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AD_L_2_ED_L_B_Buf ) ! AD_L_2_ED_L_B
  IF(ALLOCATED(Re_AD_L_2_ED_L_B_Buf))  DEALLOCATE(Re_AD_L_2_ED_L_B_Buf)
  IF(ALLOCATED(Db_AD_L_2_ED_L_B_Buf))  DEALLOCATE(Db_AD_L_2_ED_L_B_Buf)
  IF(ALLOCATED(Int_AD_L_2_ED_L_B_Buf)) DEALLOCATE(Int_AD_L_2_ED_L_B_Buf)
ENDDO
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_T_Buf, Db_ED_L_2_AD_L_T_Buf, Int_ED_L_2_AD_L_T_Buf, InData%ED_L_2_AD_L_T, ErrStat, ErrMsg, .TRUE. ) ! ED_L_2_AD_L_T 
  IF(ALLOCATED(Re_ED_L_2_AD_L_T_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ED_L_2_AD_L_T_Buf  ) ! ED_L_2_AD_L_T
  IF(ALLOCATED(Db_ED_L_2_AD_L_T_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ED_L_2_AD_L_T_Buf  ) ! ED_L_2_AD_L_T
  IF(ALLOCATED(Int_ED_L_2_AD_L_T_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ED_L_2_AD_L_T_Buf ) ! ED_L_2_AD_L_T
  IF(ALLOCATED(Re_ED_L_2_AD_L_T_Buf))  DEALLOCATE(Re_ED_L_2_AD_L_T_Buf)
  IF(ALLOCATED(Db_ED_L_2_AD_L_T_Buf))  DEALLOCATE(Db_ED_L_2_AD_L_T_Buf)
  IF(ALLOCATED(Int_ED_L_2_AD_L_T_Buf)) DEALLOCATE(Int_ED_L_2_AD_L_T_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_T_Buf, Db_AD_L_2_ED_L_T_Buf, Int_AD_L_2_ED_L_T_Buf, InData%AD_L_2_ED_L_T, ErrStat, ErrMsg, .TRUE. ) ! AD_L_2_ED_L_T 
  IF(ALLOCATED(Re_AD_L_2_ED_L_T_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AD_L_2_ED_L_T_Buf  ) ! AD_L_2_ED_L_T
  IF(ALLOCATED(Db_AD_L_2_ED_L_T_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AD_L_2_ED_L_T_Buf  ) ! AD_L_2_ED_L_T
  IF(ALLOCATED(Int_AD_L_2_ED_L_T_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AD_L_2_ED_L_T_Buf ) ! AD_L_2_ED_L_T
  IF(ALLOCATED(Re_AD_L_2_ED_L_T_Buf))  DEALLOCATE(Re_AD_L_2_ED_L_T_Buf)
  IF(ALLOCATED(Db_AD_L_2_ED_L_T_Buf))  DEALLOCATE(Db_AD_L_2_ED_L_T_Buf)
  IF(ALLOCATED(Int_AD_L_2_ED_L_T_Buf)) DEALLOCATE(Int_AD_L_2_ED_L_T_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_IceF_P_2_SD_P_Buf, Db_IceF_P_2_SD_P_Buf, Int_IceF_P_2_SD_P_Buf, InData%IceF_P_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! IceF_P_2_SD_P 
  IF(ALLOCATED(Re_IceF_P_2_SD_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IceF_P_2_SD_P_Buf  ) ! IceF_P_2_SD_P
  IF(ALLOCATED(Db_IceF_P_2_SD_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IceF_P_2_SD_P_Buf  ) ! IceF_P_2_SD_P
  IF(ALLOCATED(Int_IceF_P_2_SD_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IceF_P_2_SD_P_Buf ) ! IceF_P_2_SD_P
  IF(ALLOCATED(Re_IceF_P_2_SD_P_Buf))  DEALLOCATE(Re_IceF_P_2_SD_P_Buf)
  IF(ALLOCATED(Db_IceF_P_2_SD_P_Buf))  DEALLOCATE(Db_IceF_P_2_SD_P_Buf)
  IF(ALLOCATED(Int_IceF_P_2_SD_P_Buf)) DEALLOCATE(Int_IceF_P_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceF_P_Buf, Db_SD_P_2_IceF_P_Buf, Int_SD_P_2_IceF_P_Buf, InData%SD_P_2_IceF_P, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_IceF_P 
  IF(ALLOCATED(Re_SD_P_2_IceF_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SD_P_2_IceF_P_Buf  ) ! SD_P_2_IceF_P
  IF(ALLOCATED(Db_SD_P_2_IceF_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SD_P_2_IceF_P_Buf  ) ! SD_P_2_IceF_P
  IF(ALLOCATED(Int_SD_P_2_IceF_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SD_P_2_IceF_P_Buf ) ! SD_P_2_IceF_P
  IF(ALLOCATED(Re_SD_P_2_IceF_P_Buf))  DEALLOCATE(Re_SD_P_2_IceF_P_Buf)
  IF(ALLOCATED(Db_SD_P_2_IceF_P_Buf))  DEALLOCATE(Db_SD_P_2_IceF_P_Buf)
  IF(ALLOCATED(Int_SD_P_2_IceF_P_Buf)) DEALLOCATE(Int_SD_P_2_IceF_P_Buf)
DO i1 = LBOUND(InData%IceD_P_2_SD_P,1), UBOUND(InData%IceD_P_2_SD_P,1)
  CALL NWTC_Library_Packmeshmaptype( Re_IceD_P_2_SD_P_Buf, Db_IceD_P_2_SD_P_Buf, Int_IceD_P_2_SD_P_Buf, InData%IceD_P_2_SD_P(i1), ErrStat, ErrMsg, .TRUE. ) ! IceD_P_2_SD_P 
  IF(ALLOCATED(Re_IceD_P_2_SD_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IceD_P_2_SD_P_Buf  ) ! IceD_P_2_SD_P
  IF(ALLOCATED(Db_IceD_P_2_SD_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IceD_P_2_SD_P_Buf  ) ! IceD_P_2_SD_P
  IF(ALLOCATED(Int_IceD_P_2_SD_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IceD_P_2_SD_P_Buf ) ! IceD_P_2_SD_P
  IF(ALLOCATED(Re_IceD_P_2_SD_P_Buf))  DEALLOCATE(Re_IceD_P_2_SD_P_Buf)
  IF(ALLOCATED(Db_IceD_P_2_SD_P_Buf))  DEALLOCATE(Db_IceD_P_2_SD_P_Buf)
  IF(ALLOCATED(Int_IceD_P_2_SD_P_Buf)) DEALLOCATE(Int_IceD_P_2_SD_P_Buf)
ENDDO
DO i1 = LBOUND(InData%SD_P_2_IceD_P,1), UBOUND(InData%SD_P_2_IceD_P,1)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceD_P_Buf, Db_SD_P_2_IceD_P_Buf, Int_SD_P_2_IceD_P_Buf, InData%SD_P_2_IceD_P(i1), ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_IceD_P 
  IF(ALLOCATED(Re_SD_P_2_IceD_P_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SD_P_2_IceD_P_Buf  ) ! SD_P_2_IceD_P
  IF(ALLOCATED(Db_SD_P_2_IceD_P_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SD_P_2_IceD_P_Buf  ) ! SD_P_2_IceD_P
  IF(ALLOCATED(Int_SD_P_2_IceD_P_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SD_P_2_IceD_P_Buf ) ! SD_P_2_IceD_P
  IF(ALLOCATED(Re_SD_P_2_IceD_P_Buf))  DEALLOCATE(Re_SD_P_2_IceD_P_Buf)
  IF(ALLOCATED(Db_SD_P_2_IceD_P_Buf))  DEALLOCATE(Db_SD_P_2_IceD_P_Buf)
  IF(ALLOCATED(Int_SD_P_2_IceD_P_Buf)) DEALLOCATE(Int_SD_P_2_IceD_P_Buf)
ENDDO
  IF ( ALLOCATED(InData%Jacobian_ED_SD_HD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%Jacobian_ED_SD_HD )  ! Jacobian_ED_SD_HD 
  IF ( ALLOCATED(InData%Jacobian_pivot) )   Int_BufSz   = Int_BufSz   + SIZE( InData%Jacobian_pivot )  ! Jacobian_pivot 
  IF ( ALLOCATED(InData%Jac_u_indx) )   Int_BufSz   = Int_BufSz   + SIZE( InData%Jac_u_indx )  ! Jac_u_indx 
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%u_ED_PlatformPtMesh, Re_u_ED_PlatformPtMesh_Buf, Db_u_ED_PlatformPtMesh_Buf, Int_u_ED_PlatformPtMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_ED_PlatformPtMesh 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_ED_PlatformPtMesh_Buf  ) ! u_ED_PlatformPtMesh
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_ED_PlatformPtMesh_Buf  ) ! u_ED_PlatformPtMesh
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_ED_PlatformPtMesh_Buf ) ! u_ED_PlatformPtMesh
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_Buf))  DEALLOCATE(Re_u_ED_PlatformPtMesh_Buf)
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_Buf))  DEALLOCATE(Db_u_ED_PlatformPtMesh_Buf)
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_Buf)) DEALLOCATE(Int_u_ED_PlatformPtMesh_Buf)
  CALL MeshPack( InData%u_ED_PlatformPtMesh_2, Re_u_ED_PlatformPtMesh_2_Buf, Db_u_ED_PlatformPtMesh_2_Buf, Int_u_ED_PlatformPtMesh_2_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_ED_PlatformPtMesh_2 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_ED_PlatformPtMesh_2_Buf  ) ! u_ED_PlatformPtMesh_2
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_ED_PlatformPtMesh_2_Buf  ) ! u_ED_PlatformPtMesh_2
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_ED_PlatformPtMesh_2_Buf ) ! u_ED_PlatformPtMesh_2
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf))  DEALLOCATE(Re_u_ED_PlatformPtMesh_2_Buf)
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf))  DEALLOCATE(Db_u_ED_PlatformPtMesh_2_Buf)
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf)) DEALLOCATE(Int_u_ED_PlatformPtMesh_2_Buf)
  CALL MeshPack( InData%u_SD_TPMesh, Re_u_SD_TPMesh_Buf, Db_u_SD_TPMesh_Buf, Int_u_SD_TPMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_SD_TPMesh 
  IF(ALLOCATED(Re_u_SD_TPMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_SD_TPMesh_Buf  ) ! u_SD_TPMesh
  IF(ALLOCATED(Db_u_SD_TPMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_SD_TPMesh_Buf  ) ! u_SD_TPMesh
  IF(ALLOCATED(Int_u_SD_TPMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_SD_TPMesh_Buf ) ! u_SD_TPMesh
  IF(ALLOCATED(Re_u_SD_TPMesh_Buf))  DEALLOCATE(Re_u_SD_TPMesh_Buf)
  IF(ALLOCATED(Db_u_SD_TPMesh_Buf))  DEALLOCATE(Db_u_SD_TPMesh_Buf)
  IF(ALLOCATED(Int_u_SD_TPMesh_Buf)) DEALLOCATE(Int_u_SD_TPMesh_Buf)
  CALL MeshPack( InData%u_SD_LMesh, Re_u_SD_LMesh_Buf, Db_u_SD_LMesh_Buf, Int_u_SD_LMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_SD_LMesh 
  IF(ALLOCATED(Re_u_SD_LMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_SD_LMesh_Buf  ) ! u_SD_LMesh
  IF(ALLOCATED(Db_u_SD_LMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_SD_LMesh_Buf  ) ! u_SD_LMesh
  IF(ALLOCATED(Int_u_SD_LMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_SD_LMesh_Buf ) ! u_SD_LMesh
  IF(ALLOCATED(Re_u_SD_LMesh_Buf))  DEALLOCATE(Re_u_SD_LMesh_Buf)
  IF(ALLOCATED(Db_u_SD_LMesh_Buf))  DEALLOCATE(Db_u_SD_LMesh_Buf)
  IF(ALLOCATED(Int_u_SD_LMesh_Buf)) DEALLOCATE(Int_u_SD_LMesh_Buf)
  CALL MeshPack( InData%u_SD_LMesh_2, Re_u_SD_LMesh_2_Buf, Db_u_SD_LMesh_2_Buf, Int_u_SD_LMesh_2_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_SD_LMesh_2 
  IF(ALLOCATED(Re_u_SD_LMesh_2_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_SD_LMesh_2_Buf  ) ! u_SD_LMesh_2
  IF(ALLOCATED(Db_u_SD_LMesh_2_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_SD_LMesh_2_Buf  ) ! u_SD_LMesh_2
  IF(ALLOCATED(Int_u_SD_LMesh_2_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_SD_LMesh_2_Buf ) ! u_SD_LMesh_2
  IF(ALLOCATED(Re_u_SD_LMesh_2_Buf))  DEALLOCATE(Re_u_SD_LMesh_2_Buf)
  IF(ALLOCATED(Db_u_SD_LMesh_2_Buf))  DEALLOCATE(Db_u_SD_LMesh_2_Buf)
  IF(ALLOCATED(Int_u_SD_LMesh_2_Buf)) DEALLOCATE(Int_u_SD_LMesh_2_Buf)
  CALL MeshPack( InData%u_HD_M_LumpedMesh, Re_u_HD_M_LumpedMesh_Buf, Db_u_HD_M_LumpedMesh_Buf, Int_u_HD_M_LumpedMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_HD_M_LumpedMesh 
  IF(ALLOCATED(Re_u_HD_M_LumpedMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_HD_M_LumpedMesh_Buf  ) ! u_HD_M_LumpedMesh
  IF(ALLOCATED(Db_u_HD_M_LumpedMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_HD_M_LumpedMesh_Buf  ) ! u_HD_M_LumpedMesh
  IF(ALLOCATED(Int_u_HD_M_LumpedMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_HD_M_LumpedMesh_Buf ) ! u_HD_M_LumpedMesh
  IF(ALLOCATED(Re_u_HD_M_LumpedMesh_Buf))  DEALLOCATE(Re_u_HD_M_LumpedMesh_Buf)
  IF(ALLOCATED(Db_u_HD_M_LumpedMesh_Buf))  DEALLOCATE(Db_u_HD_M_LumpedMesh_Buf)
  IF(ALLOCATED(Int_u_HD_M_LumpedMesh_Buf)) DEALLOCATE(Int_u_HD_M_LumpedMesh_Buf)
  CALL MeshPack( InData%u_HD_M_DistribMesh, Re_u_HD_M_DistribMesh_Buf, Db_u_HD_M_DistribMesh_Buf, Int_u_HD_M_DistribMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_HD_M_DistribMesh 
  IF(ALLOCATED(Re_u_HD_M_DistribMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_HD_M_DistribMesh_Buf  ) ! u_HD_M_DistribMesh
  IF(ALLOCATED(Db_u_HD_M_DistribMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_HD_M_DistribMesh_Buf  ) ! u_HD_M_DistribMesh
  IF(ALLOCATED(Int_u_HD_M_DistribMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_HD_M_DistribMesh_Buf ) ! u_HD_M_DistribMesh
  IF(ALLOCATED(Re_u_HD_M_DistribMesh_Buf))  DEALLOCATE(Re_u_HD_M_DistribMesh_Buf)
  IF(ALLOCATED(Db_u_HD_M_DistribMesh_Buf))  DEALLOCATE(Db_u_HD_M_DistribMesh_Buf)
  IF(ALLOCATED(Int_u_HD_M_DistribMesh_Buf)) DEALLOCATE(Int_u_HD_M_DistribMesh_Buf)
  CALL MeshPack( InData%u_HD_Mesh, Re_u_HD_Mesh_Buf, Db_u_HD_Mesh_Buf, Int_u_HD_Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! u_HD_Mesh 
  IF(ALLOCATED(Re_u_HD_Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_u_HD_Mesh_Buf  ) ! u_HD_Mesh
  IF(ALLOCATED(Db_u_HD_Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_u_HD_Mesh_Buf  ) ! u_HD_Mesh
  IF(ALLOCATED(Int_u_HD_Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_u_HD_Mesh_Buf ) ! u_HD_Mesh
  IF(ALLOCATED(Re_u_HD_Mesh_Buf))  DEALLOCATE(Re_u_HD_Mesh_Buf)
  IF(ALLOCATED(Db_u_HD_Mesh_Buf))  DEALLOCATE(Db_u_HD_Mesh_Buf)
  IF(ALLOCATED(Int_u_HD_Mesh_Buf)) DEALLOCATE(Int_u_HD_Mesh_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_W_P_Buf, Db_ED_P_2_HD_W_P_Buf, Int_ED_P_2_HD_W_P_Buf, InData%ED_P_2_HD_W_P, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_HD_W_P 
  IF(ALLOCATED(Re_ED_P_2_HD_W_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_W_P_Buf)-1 ) = Re_ED_P_2_HD_W_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_W_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_W_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_W_P_Buf)-1 ) = Db_ED_P_2_HD_W_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_W_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_W_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_W_P_Buf)-1 ) = Int_ED_P_2_HD_W_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_W_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_HD_W_P_Buf) )  DEALLOCATE(Re_ED_P_2_HD_W_P_Buf)
  IF( ALLOCATED(Db_ED_P_2_HD_W_P_Buf) )  DEALLOCATE(Db_ED_P_2_HD_W_P_Buf)
  IF( ALLOCATED(Int_ED_P_2_HD_W_P_Buf) ) DEALLOCATE(Int_ED_P_2_HD_W_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_W_P_2_ED_P_Buf, Db_HD_W_P_2_ED_P_Buf, Int_HD_W_P_2_ED_P_Buf, InData%HD_W_P_2_ED_P, ErrStat, ErrMsg, OnlySize ) ! HD_W_P_2_ED_P 
  IF(ALLOCATED(Re_HD_W_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_W_P_2_ED_P_Buf)-1 ) = Re_HD_W_P_2_ED_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HD_W_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_W_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_W_P_2_ED_P_Buf)-1 ) = Db_HD_W_P_2_ED_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HD_W_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_W_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_W_P_2_ED_P_Buf)-1 ) = Int_HD_W_P_2_ED_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HD_W_P_2_ED_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_HD_W_P_2_ED_P_Buf) )  DEALLOCATE(Re_HD_W_P_2_ED_P_Buf)
  IF( ALLOCATED(Db_HD_W_P_2_ED_P_Buf) )  DEALLOCATE(Db_HD_W_P_2_ED_P_Buf)
  IF( ALLOCATED(Int_HD_W_P_2_ED_P_Buf) ) DEALLOCATE(Int_HD_W_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_P_Buf, Db_ED_P_2_HD_M_P_Buf, Int_ED_P_2_HD_M_P_Buf, InData%ED_P_2_HD_M_P, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_HD_M_P 
  IF(ALLOCATED(Re_ED_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_M_P_Buf)-1 ) = Re_ED_P_2_HD_M_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_M_P_Buf)-1 ) = Db_ED_P_2_HD_M_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_M_P_Buf)-1 ) = Int_ED_P_2_HD_M_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_M_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_HD_M_P_Buf) )  DEALLOCATE(Re_ED_P_2_HD_M_P_Buf)
  IF( ALLOCATED(Db_ED_P_2_HD_M_P_Buf) )  DEALLOCATE(Db_ED_P_2_HD_M_P_Buf)
  IF( ALLOCATED(Int_ED_P_2_HD_M_P_Buf) ) DEALLOCATE(Int_ED_P_2_HD_M_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_ED_P_Buf, Db_HD_M_P_2_ED_P_Buf, Int_HD_M_P_2_ED_P_Buf, InData%HD_M_P_2_ED_P, ErrStat, ErrMsg, OnlySize ) ! HD_M_P_2_ED_P 
  IF(ALLOCATED(Re_HD_M_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_P_2_ED_P_Buf)-1 ) = Re_HD_M_P_2_ED_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_P_2_ED_P_Buf)-1 ) = Db_HD_M_P_2_ED_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_P_2_ED_P_Buf)-1 ) = Int_HD_M_P_2_ED_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_P_2_ED_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_HD_M_P_2_ED_P_Buf) )  DEALLOCATE(Re_HD_M_P_2_ED_P_Buf)
  IF( ALLOCATED(Db_HD_M_P_2_ED_P_Buf) )  DEALLOCATE(Db_HD_M_P_2_ED_P_Buf)
  IF( ALLOCATED(Int_HD_M_P_2_ED_P_Buf) ) DEALLOCATE(Int_HD_M_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_L_Buf, Db_ED_P_2_HD_M_L_Buf, Int_ED_P_2_HD_M_L_Buf, InData%ED_P_2_HD_M_L, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_HD_M_L 
  IF(ALLOCATED(Re_ED_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_M_L_Buf)-1 ) = Re_ED_P_2_HD_M_L_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_M_L_Buf)-1 ) = Db_ED_P_2_HD_M_L_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_M_L_Buf)-1 ) = Int_ED_P_2_HD_M_L_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_M_L_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_HD_M_L_Buf) )  DEALLOCATE(Re_ED_P_2_HD_M_L_Buf)
  IF( ALLOCATED(Db_ED_P_2_HD_M_L_Buf) )  DEALLOCATE(Db_ED_P_2_HD_M_L_Buf)
  IF( ALLOCATED(Int_ED_P_2_HD_M_L_Buf) ) DEALLOCATE(Int_ED_P_2_HD_M_L_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_ED_P_Buf, Db_HD_M_L_2_ED_P_Buf, Int_HD_M_L_2_ED_P_Buf, InData%HD_M_L_2_ED_P, ErrStat, ErrMsg, OnlySize ) ! HD_M_L_2_ED_P 
  IF(ALLOCATED(Re_HD_M_L_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_L_2_ED_P_Buf)-1 ) = Re_HD_M_L_2_ED_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_L_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_L_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_L_2_ED_P_Buf)-1 ) = Db_HD_M_L_2_ED_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_L_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_L_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_L_2_ED_P_Buf)-1 ) = Int_HD_M_L_2_ED_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_L_2_ED_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_HD_M_L_2_ED_P_Buf) )  DEALLOCATE(Re_HD_M_L_2_ED_P_Buf)
  IF( ALLOCATED(Db_HD_M_L_2_ED_P_Buf) )  DEALLOCATE(Db_HD_M_L_2_ED_P_Buf)
  IF( ALLOCATED(Int_HD_M_L_2_ED_P_Buf) ) DEALLOCATE(Int_HD_M_L_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_Mooring_P_Buf, Db_ED_P_2_Mooring_P_Buf, Int_ED_P_2_Mooring_P_Buf, InData%ED_P_2_Mooring_P, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_Mooring_P 
  IF(ALLOCATED(Re_ED_P_2_Mooring_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_Mooring_P_Buf)-1 ) = Re_ED_P_2_Mooring_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_Mooring_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_Mooring_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_Mooring_P_Buf)-1 ) = Db_ED_P_2_Mooring_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_Mooring_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_Mooring_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_Mooring_P_Buf)-1 ) = Int_ED_P_2_Mooring_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_Mooring_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_Mooring_P_Buf) )  DEALLOCATE(Re_ED_P_2_Mooring_P_Buf)
  IF( ALLOCATED(Db_ED_P_2_Mooring_P_Buf) )  DEALLOCATE(Db_ED_P_2_Mooring_P_Buf)
  IF( ALLOCATED(Int_ED_P_2_Mooring_P_Buf) ) DEALLOCATE(Int_ED_P_2_Mooring_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_Mooring_P_2_ED_P_Buf, Db_Mooring_P_2_ED_P_Buf, Int_Mooring_P_2_ED_P_Buf, InData%Mooring_P_2_ED_P, ErrStat, ErrMsg, OnlySize ) ! Mooring_P_2_ED_P 
  IF(ALLOCATED(Re_Mooring_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Mooring_P_2_ED_P_Buf)-1 ) = Re_Mooring_P_2_ED_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Mooring_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_Mooring_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Mooring_P_2_ED_P_Buf)-1 ) = Db_Mooring_P_2_ED_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Mooring_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_Mooring_P_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Mooring_P_2_ED_P_Buf)-1 ) = Int_Mooring_P_2_ED_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Mooring_P_2_ED_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_Mooring_P_2_ED_P_Buf) )  DEALLOCATE(Re_Mooring_P_2_ED_P_Buf)
  IF( ALLOCATED(Db_Mooring_P_2_ED_P_Buf) )  DEALLOCATE(Db_Mooring_P_2_ED_P_Buf)
  IF( ALLOCATED(Int_Mooring_P_2_ED_P_Buf) ) DEALLOCATE(Int_Mooring_P_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SD_TP_Buf, Db_ED_P_2_SD_TP_Buf, Int_ED_P_2_SD_TP_Buf, InData%ED_P_2_SD_TP, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_SD_TP 
  IF(ALLOCATED(Re_ED_P_2_SD_TP_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_SD_TP_Buf)-1 ) = Re_ED_P_2_SD_TP_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_SD_TP_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_SD_TP_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_SD_TP_Buf)-1 ) = Db_ED_P_2_SD_TP_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_SD_TP_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_SD_TP_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_SD_TP_Buf)-1 ) = Int_ED_P_2_SD_TP_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_SD_TP_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_SD_TP_Buf) )  DEALLOCATE(Re_ED_P_2_SD_TP_Buf)
  IF( ALLOCATED(Db_ED_P_2_SD_TP_Buf) )  DEALLOCATE(Db_ED_P_2_SD_TP_Buf)
  IF( ALLOCATED(Int_ED_P_2_SD_TP_Buf) ) DEALLOCATE(Int_ED_P_2_SD_TP_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_TP_2_ED_P_Buf, Db_SD_TP_2_ED_P_Buf, Int_SD_TP_2_ED_P_Buf, InData%SD_TP_2_ED_P, ErrStat, ErrMsg, OnlySize ) ! SD_TP_2_ED_P 
  IF(ALLOCATED(Re_SD_TP_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_TP_2_ED_P_Buf)-1 ) = Re_SD_TP_2_ED_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SD_TP_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_TP_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_TP_2_ED_P_Buf)-1 ) = Db_SD_TP_2_ED_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SD_TP_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_TP_2_ED_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_TP_2_ED_P_Buf)-1 ) = Int_SD_TP_2_ED_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SD_TP_2_ED_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_SD_TP_2_ED_P_Buf) )  DEALLOCATE(Re_SD_TP_2_ED_P_Buf)
  IF( ALLOCATED(Db_SD_TP_2_ED_P_Buf) )  DEALLOCATE(Db_SD_TP_2_ED_P_Buf)
  IF( ALLOCATED(Int_SD_TP_2_ED_P_Buf) ) DEALLOCATE(Int_SD_TP_2_ED_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_P_Buf, Db_SD_P_2_HD_M_P_Buf, Int_SD_P_2_HD_M_P_Buf, InData%SD_P_2_HD_M_P, ErrStat, ErrMsg, OnlySize ) ! SD_P_2_HD_M_P 
  IF(ALLOCATED(Re_SD_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_HD_M_P_Buf)-1 ) = Re_SD_P_2_HD_M_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_HD_M_P_Buf)-1 ) = Db_SD_P_2_HD_M_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_HD_M_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_HD_M_P_Buf)-1 ) = Int_SD_P_2_HD_M_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_HD_M_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_SD_P_2_HD_M_P_Buf) )  DEALLOCATE(Re_SD_P_2_HD_M_P_Buf)
  IF( ALLOCATED(Db_SD_P_2_HD_M_P_Buf) )  DEALLOCATE(Db_SD_P_2_HD_M_P_Buf)
  IF( ALLOCATED(Int_SD_P_2_HD_M_P_Buf) ) DEALLOCATE(Int_SD_P_2_HD_M_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_SD_P_Buf, Db_HD_M_P_2_SD_P_Buf, Int_HD_M_P_2_SD_P_Buf, InData%HD_M_P_2_SD_P, ErrStat, ErrMsg, OnlySize ) ! HD_M_P_2_SD_P 
  IF(ALLOCATED(Re_HD_M_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_P_2_SD_P_Buf)-1 ) = Re_HD_M_P_2_SD_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_P_2_SD_P_Buf)-1 ) = Db_HD_M_P_2_SD_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_P_2_SD_P_Buf)-1 ) = Int_HD_M_P_2_SD_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_P_2_SD_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_HD_M_P_2_SD_P_Buf) )  DEALLOCATE(Re_HD_M_P_2_SD_P_Buf)
  IF( ALLOCATED(Db_HD_M_P_2_SD_P_Buf) )  DEALLOCATE(Db_HD_M_P_2_SD_P_Buf)
  IF( ALLOCATED(Int_HD_M_P_2_SD_P_Buf) ) DEALLOCATE(Int_HD_M_P_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_L_Buf, Db_SD_P_2_HD_M_L_Buf, Int_SD_P_2_HD_M_L_Buf, InData%SD_P_2_HD_M_L, ErrStat, ErrMsg, OnlySize ) ! SD_P_2_HD_M_L 
  IF(ALLOCATED(Re_SD_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_HD_M_L_Buf)-1 ) = Re_SD_P_2_HD_M_L_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_HD_M_L_Buf)-1 ) = Db_SD_P_2_HD_M_L_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_HD_M_L_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_HD_M_L_Buf)-1 ) = Int_SD_P_2_HD_M_L_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_HD_M_L_Buf)
  ENDIF
  IF( ALLOCATED(Re_SD_P_2_HD_M_L_Buf) )  DEALLOCATE(Re_SD_P_2_HD_M_L_Buf)
  IF( ALLOCATED(Db_SD_P_2_HD_M_L_Buf) )  DEALLOCATE(Db_SD_P_2_HD_M_L_Buf)
  IF( ALLOCATED(Int_SD_P_2_HD_M_L_Buf) ) DEALLOCATE(Int_SD_P_2_HD_M_L_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_SD_P_Buf, Db_HD_M_L_2_SD_P_Buf, Int_HD_M_L_2_SD_P_Buf, InData%HD_M_L_2_SD_P, ErrStat, ErrMsg, OnlySize ) ! HD_M_L_2_SD_P 
  IF(ALLOCATED(Re_HD_M_L_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_L_2_SD_P_Buf)-1 ) = Re_HD_M_L_2_SD_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_L_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_L_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_L_2_SD_P_Buf)-1 ) = Db_HD_M_L_2_SD_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_L_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_L_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_L_2_SD_P_Buf)-1 ) = Int_HD_M_L_2_SD_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_L_2_SD_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_HD_M_L_2_SD_P_Buf) )  DEALLOCATE(Re_HD_M_L_2_SD_P_Buf)
  IF( ALLOCATED(Db_HD_M_L_2_SD_P_Buf) )  DEALLOCATE(Db_HD_M_L_2_SD_P_Buf)
  IF( ALLOCATED(Int_HD_M_L_2_SD_P_Buf) ) DEALLOCATE(Int_HD_M_L_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SrvD_P_N_Buf, Db_ED_P_2_SrvD_P_N_Buf, Int_ED_P_2_SrvD_P_N_Buf, InData%ED_P_2_SrvD_P_N, ErrStat, ErrMsg, OnlySize ) ! ED_P_2_SrvD_P_N 
  IF(ALLOCATED(Re_ED_P_2_SrvD_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_SrvD_P_N_Buf)-1 ) = Re_ED_P_2_SrvD_P_N_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_SrvD_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_SrvD_P_N_Buf)-1 ) = Db_ED_P_2_SrvD_P_N_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_SrvD_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_SrvD_P_N_Buf)-1 ) = Int_ED_P_2_SrvD_P_N_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_P_2_SrvD_P_N_Buf) )  DEALLOCATE(Re_ED_P_2_SrvD_P_N_Buf)
  IF( ALLOCATED(Db_ED_P_2_SrvD_P_N_Buf) )  DEALLOCATE(Db_ED_P_2_SrvD_P_N_Buf)
  IF( ALLOCATED(Int_ED_P_2_SrvD_P_N_Buf) ) DEALLOCATE(Int_ED_P_2_SrvD_P_N_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SrvD_P_2_ED_P_N_Buf, Db_SrvD_P_2_ED_P_N_Buf, Int_SrvD_P_2_ED_P_N_Buf, InData%SrvD_P_2_ED_P_N, ErrStat, ErrMsg, OnlySize ) ! SrvD_P_2_ED_P_N 
  IF(ALLOCATED(Re_SrvD_P_2_ED_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SrvD_P_2_ED_P_N_Buf)-1 ) = Re_SrvD_P_2_ED_P_N_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Db_SrvD_P_2_ED_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SrvD_P_2_ED_P_N_Buf)-1 ) = Db_SrvD_P_2_ED_P_N_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Int_SrvD_P_2_ED_P_N_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SrvD_P_2_ED_P_N_Buf)-1 ) = Int_SrvD_P_2_ED_P_N_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  IF( ALLOCATED(Re_SrvD_P_2_ED_P_N_Buf) )  DEALLOCATE(Re_SrvD_P_2_ED_P_N_Buf)
  IF( ALLOCATED(Db_SrvD_P_2_ED_P_N_Buf) )  DEALLOCATE(Db_SrvD_P_2_ED_P_N_Buf)
  IF( ALLOCATED(Int_SrvD_P_2_ED_P_N_Buf) ) DEALLOCATE(Int_SrvD_P_2_ED_P_N_Buf)
DO i1 = LBOUND(InData%ED_L_2_AD_L_B,1), UBOUND(InData%ED_L_2_AD_L_B,1)
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_B_Buf, Db_ED_L_2_AD_L_B_Buf, Int_ED_L_2_AD_L_B_Buf, InData%ED_L_2_AD_L_B(i1), ErrStat, ErrMsg, OnlySize ) ! ED_L_2_AD_L_B 
  IF(ALLOCATED(Re_ED_L_2_AD_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_L_2_AD_L_B_Buf)-1 ) = Re_ED_L_2_AD_L_B_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_L_2_AD_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_L_2_AD_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_L_2_AD_L_B_Buf)-1 ) = Db_ED_L_2_AD_L_B_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_L_2_AD_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_L_2_AD_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_L_2_AD_L_B_Buf)-1 ) = Int_ED_L_2_AD_L_B_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_L_2_AD_L_B_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_L_2_AD_L_B_Buf) )  DEALLOCATE(Re_ED_L_2_AD_L_B_Buf)
  IF( ALLOCATED(Db_ED_L_2_AD_L_B_Buf) )  DEALLOCATE(Db_ED_L_2_AD_L_B_Buf)
  IF( ALLOCATED(Int_ED_L_2_AD_L_B_Buf) ) DEALLOCATE(Int_ED_L_2_AD_L_B_Buf)
ENDDO
DO i1 = LBOUND(InData%AD_L_2_ED_L_B,1), UBOUND(InData%AD_L_2_ED_L_B,1)
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_B_Buf, Db_AD_L_2_ED_L_B_Buf, Int_AD_L_2_ED_L_B_Buf, InData%AD_L_2_ED_L_B(i1), ErrStat, ErrMsg, OnlySize ) ! AD_L_2_ED_L_B 
  IF(ALLOCATED(Re_AD_L_2_ED_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AD_L_2_ED_L_B_Buf)-1 ) = Re_AD_L_2_ED_L_B_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AD_L_2_ED_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Db_AD_L_2_ED_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AD_L_2_ED_L_B_Buf)-1 ) = Db_AD_L_2_ED_L_B_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AD_L_2_ED_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Int_AD_L_2_ED_L_B_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AD_L_2_ED_L_B_Buf)-1 ) = Int_AD_L_2_ED_L_B_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AD_L_2_ED_L_B_Buf)
  ENDIF
  IF( ALLOCATED(Re_AD_L_2_ED_L_B_Buf) )  DEALLOCATE(Re_AD_L_2_ED_L_B_Buf)
  IF( ALLOCATED(Db_AD_L_2_ED_L_B_Buf) )  DEALLOCATE(Db_AD_L_2_ED_L_B_Buf)
  IF( ALLOCATED(Int_AD_L_2_ED_L_B_Buf) ) DEALLOCATE(Int_AD_L_2_ED_L_B_Buf)
ENDDO
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_T_Buf, Db_ED_L_2_AD_L_T_Buf, Int_ED_L_2_AD_L_T_Buf, InData%ED_L_2_AD_L_T, ErrStat, ErrMsg, OnlySize ) ! ED_L_2_AD_L_T 
  IF(ALLOCATED(Re_ED_L_2_AD_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_L_2_AD_L_T_Buf)-1 ) = Re_ED_L_2_AD_L_T_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ED_L_2_AD_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_L_2_AD_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_L_2_AD_L_T_Buf)-1 ) = Db_ED_L_2_AD_L_T_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ED_L_2_AD_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_L_2_AD_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_L_2_AD_L_T_Buf)-1 ) = Int_ED_L_2_AD_L_T_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ED_L_2_AD_L_T_Buf)
  ENDIF
  IF( ALLOCATED(Re_ED_L_2_AD_L_T_Buf) )  DEALLOCATE(Re_ED_L_2_AD_L_T_Buf)
  IF( ALLOCATED(Db_ED_L_2_AD_L_T_Buf) )  DEALLOCATE(Db_ED_L_2_AD_L_T_Buf)
  IF( ALLOCATED(Int_ED_L_2_AD_L_T_Buf) ) DEALLOCATE(Int_ED_L_2_AD_L_T_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_T_Buf, Db_AD_L_2_ED_L_T_Buf, Int_AD_L_2_ED_L_T_Buf, InData%AD_L_2_ED_L_T, ErrStat, ErrMsg, OnlySize ) ! AD_L_2_ED_L_T 
  IF(ALLOCATED(Re_AD_L_2_ED_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AD_L_2_ED_L_T_Buf)-1 ) = Re_AD_L_2_ED_L_T_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AD_L_2_ED_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Db_AD_L_2_ED_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AD_L_2_ED_L_T_Buf)-1 ) = Db_AD_L_2_ED_L_T_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AD_L_2_ED_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Int_AD_L_2_ED_L_T_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AD_L_2_ED_L_T_Buf)-1 ) = Int_AD_L_2_ED_L_T_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AD_L_2_ED_L_T_Buf)
  ENDIF
  IF( ALLOCATED(Re_AD_L_2_ED_L_T_Buf) )  DEALLOCATE(Re_AD_L_2_ED_L_T_Buf)
  IF( ALLOCATED(Db_AD_L_2_ED_L_T_Buf) )  DEALLOCATE(Db_AD_L_2_ED_L_T_Buf)
  IF( ALLOCATED(Int_AD_L_2_ED_L_T_Buf) ) DEALLOCATE(Int_AD_L_2_ED_L_T_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_IceF_P_2_SD_P_Buf, Db_IceF_P_2_SD_P_Buf, Int_IceF_P_2_SD_P_Buf, InData%IceF_P_2_SD_P, ErrStat, ErrMsg, OnlySize ) ! IceF_P_2_SD_P 
  IF(ALLOCATED(Re_IceF_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IceF_P_2_SD_P_Buf)-1 ) = Re_IceF_P_2_SD_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IceF_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_IceF_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IceF_P_2_SD_P_Buf)-1 ) = Db_IceF_P_2_SD_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IceF_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_IceF_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IceF_P_2_SD_P_Buf)-1 ) = Int_IceF_P_2_SD_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IceF_P_2_SD_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_IceF_P_2_SD_P_Buf) )  DEALLOCATE(Re_IceF_P_2_SD_P_Buf)
  IF( ALLOCATED(Db_IceF_P_2_SD_P_Buf) )  DEALLOCATE(Db_IceF_P_2_SD_P_Buf)
  IF( ALLOCATED(Int_IceF_P_2_SD_P_Buf) ) DEALLOCATE(Int_IceF_P_2_SD_P_Buf)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceF_P_Buf, Db_SD_P_2_IceF_P_Buf, Int_SD_P_2_IceF_P_Buf, InData%SD_P_2_IceF_P, ErrStat, ErrMsg, OnlySize ) ! SD_P_2_IceF_P 
  IF(ALLOCATED(Re_SD_P_2_IceF_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_IceF_P_Buf)-1 ) = Re_SD_P_2_IceF_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_IceF_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_IceF_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_IceF_P_Buf)-1 ) = Db_SD_P_2_IceF_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_IceF_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_IceF_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_IceF_P_Buf)-1 ) = Int_SD_P_2_IceF_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_IceF_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_SD_P_2_IceF_P_Buf) )  DEALLOCATE(Re_SD_P_2_IceF_P_Buf)
  IF( ALLOCATED(Db_SD_P_2_IceF_P_Buf) )  DEALLOCATE(Db_SD_P_2_IceF_P_Buf)
  IF( ALLOCATED(Int_SD_P_2_IceF_P_Buf) ) DEALLOCATE(Int_SD_P_2_IceF_P_Buf)
DO i1 = LBOUND(InData%IceD_P_2_SD_P,1), UBOUND(InData%IceD_P_2_SD_P,1)
  CALL NWTC_Library_Packmeshmaptype( Re_IceD_P_2_SD_P_Buf, Db_IceD_P_2_SD_P_Buf, Int_IceD_P_2_SD_P_Buf, InData%IceD_P_2_SD_P(i1), ErrStat, ErrMsg, OnlySize ) ! IceD_P_2_SD_P 
  IF(ALLOCATED(Re_IceD_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IceD_P_2_SD_P_Buf)-1 ) = Re_IceD_P_2_SD_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IceD_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_IceD_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IceD_P_2_SD_P_Buf)-1 ) = Db_IceD_P_2_SD_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IceD_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_IceD_P_2_SD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IceD_P_2_SD_P_Buf)-1 ) = Int_IceD_P_2_SD_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IceD_P_2_SD_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_IceD_P_2_SD_P_Buf) )  DEALLOCATE(Re_IceD_P_2_SD_P_Buf)
  IF( ALLOCATED(Db_IceD_P_2_SD_P_Buf) )  DEALLOCATE(Db_IceD_P_2_SD_P_Buf)
  IF( ALLOCATED(Int_IceD_P_2_SD_P_Buf) ) DEALLOCATE(Int_IceD_P_2_SD_P_Buf)
ENDDO
DO i1 = LBOUND(InData%SD_P_2_IceD_P,1), UBOUND(InData%SD_P_2_IceD_P,1)
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceD_P_Buf, Db_SD_P_2_IceD_P_Buf, Int_SD_P_2_IceD_P_Buf, InData%SD_P_2_IceD_P(i1), ErrStat, ErrMsg, OnlySize ) ! SD_P_2_IceD_P 
  IF(ALLOCATED(Re_SD_P_2_IceD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_IceD_P_Buf)-1 ) = Re_SD_P_2_IceD_P_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_IceD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_IceD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_IceD_P_Buf)-1 ) = Db_SD_P_2_IceD_P_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_IceD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_IceD_P_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_IceD_P_Buf)-1 ) = Int_SD_P_2_IceD_P_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_IceD_P_Buf)
  ENDIF
  IF( ALLOCATED(Re_SD_P_2_IceD_P_Buf) )  DEALLOCATE(Re_SD_P_2_IceD_P_Buf)
  IF( ALLOCATED(Db_SD_P_2_IceD_P_Buf) )  DEALLOCATE(Db_SD_P_2_IceD_P_Buf)
  IF( ALLOCATED(Int_SD_P_2_IceD_P_Buf) ) DEALLOCATE(Int_SD_P_2_IceD_P_Buf)
ENDDO
  IF ( ALLOCATED(InData%Jacobian_ED_SD_HD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Jacobian_ED_SD_HD))-1 ) =  PACK(InData%Jacobian_ED_SD_HD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Jacobian_ED_SD_HD)
  ENDIF
  IF ( ALLOCATED(InData%Jacobian_pivot) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%Jacobian_pivot))-1 ) = PACK(InData%Jacobian_pivot ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%Jacobian_pivot)
  ENDIF
  IF ( ALLOCATED(InData%Jac_u_indx) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%Jac_u_indx))-1 ) = PACK(InData%Jac_u_indx ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%Jac_u_indx)
  ENDIF
  CALL MeshPack( InData%u_ED_PlatformPtMesh, Re_u_ED_PlatformPtMesh_Buf, Db_u_ED_PlatformPtMesh_Buf, Int_u_ED_PlatformPtMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_ED_PlatformPtMesh 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_ED_PlatformPtMesh_Buf)-1 ) = Re_u_ED_PlatformPtMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_ED_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_ED_PlatformPtMesh_Buf)-1 ) = Db_u_ED_PlatformPtMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_ED_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_ED_PlatformPtMesh_Buf)-1 ) = Int_u_ED_PlatformPtMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_ED_PlatformPtMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_ED_PlatformPtMesh_Buf) )  DEALLOCATE(Re_u_ED_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_u_ED_PlatformPtMesh_Buf) )  DEALLOCATE(Db_u_ED_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_u_ED_PlatformPtMesh_Buf) ) DEALLOCATE(Int_u_ED_PlatformPtMesh_Buf)
  CALL MeshPack( InData%u_ED_PlatformPtMesh_2, Re_u_ED_PlatformPtMesh_2_Buf, Db_u_ED_PlatformPtMesh_2_Buf, Int_u_ED_PlatformPtMesh_2_Buf, ErrStat, ErrMsg, OnlySize ) ! u_ED_PlatformPtMesh_2 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_ED_PlatformPtMesh_2_Buf)-1 ) = Re_u_ED_PlatformPtMesh_2_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_ED_PlatformPtMesh_2_Buf)-1 ) = Db_u_ED_PlatformPtMesh_2_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_ED_PlatformPtMesh_2_Buf)-1 ) = Int_u_ED_PlatformPtMesh_2_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf) )  DEALLOCATE(Re_u_ED_PlatformPtMesh_2_Buf)
  IF( ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf) )  DEALLOCATE(Db_u_ED_PlatformPtMesh_2_Buf)
  IF( ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf) ) DEALLOCATE(Int_u_ED_PlatformPtMesh_2_Buf)
  CALL MeshPack( InData%u_SD_TPMesh, Re_u_SD_TPMesh_Buf, Db_u_SD_TPMesh_Buf, Int_u_SD_TPMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_SD_TPMesh 
  IF(ALLOCATED(Re_u_SD_TPMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_TPMesh_Buf)-1 ) = Re_u_SD_TPMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_TPMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_TPMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_TPMesh_Buf)-1 ) = Db_u_SD_TPMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_TPMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_TPMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_TPMesh_Buf)-1 ) = Int_u_SD_TPMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_TPMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_SD_TPMesh_Buf) )  DEALLOCATE(Re_u_SD_TPMesh_Buf)
  IF( ALLOCATED(Db_u_SD_TPMesh_Buf) )  DEALLOCATE(Db_u_SD_TPMesh_Buf)
  IF( ALLOCATED(Int_u_SD_TPMesh_Buf) ) DEALLOCATE(Int_u_SD_TPMesh_Buf)
  CALL MeshPack( InData%u_SD_LMesh, Re_u_SD_LMesh_Buf, Db_u_SD_LMesh_Buf, Int_u_SD_LMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_SD_LMesh 
  IF(ALLOCATED(Re_u_SD_LMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_LMesh_Buf)-1 ) = Re_u_SD_LMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_LMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_LMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_LMesh_Buf)-1 ) = Db_u_SD_LMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_LMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_LMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_LMesh_Buf)-1 ) = Int_u_SD_LMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_LMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_SD_LMesh_Buf) )  DEALLOCATE(Re_u_SD_LMesh_Buf)
  IF( ALLOCATED(Db_u_SD_LMesh_Buf) )  DEALLOCATE(Db_u_SD_LMesh_Buf)
  IF( ALLOCATED(Int_u_SD_LMesh_Buf) ) DEALLOCATE(Int_u_SD_LMesh_Buf)
  CALL MeshPack( InData%u_SD_LMesh_2, Re_u_SD_LMesh_2_Buf, Db_u_SD_LMesh_2_Buf, Int_u_SD_LMesh_2_Buf, ErrStat, ErrMsg, OnlySize ) ! u_SD_LMesh_2 
  IF(ALLOCATED(Re_u_SD_LMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_LMesh_2_Buf)-1 ) = Re_u_SD_LMesh_2_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_LMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_LMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_LMesh_2_Buf)-1 ) = Db_u_SD_LMesh_2_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_LMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_LMesh_2_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_LMesh_2_Buf)-1 ) = Int_u_SD_LMesh_2_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_LMesh_2_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_SD_LMesh_2_Buf) )  DEALLOCATE(Re_u_SD_LMesh_2_Buf)
  IF( ALLOCATED(Db_u_SD_LMesh_2_Buf) )  DEALLOCATE(Db_u_SD_LMesh_2_Buf)
  IF( ALLOCATED(Int_u_SD_LMesh_2_Buf) ) DEALLOCATE(Int_u_SD_LMesh_2_Buf)
  CALL MeshPack( InData%u_HD_M_LumpedMesh, Re_u_HD_M_LumpedMesh_Buf, Db_u_HD_M_LumpedMesh_Buf, Int_u_HD_M_LumpedMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_HD_M_LumpedMesh 
  IF(ALLOCATED(Re_u_HD_M_LumpedMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_M_LumpedMesh_Buf)-1 ) = Re_u_HD_M_LumpedMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_M_LumpedMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_M_LumpedMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_M_LumpedMesh_Buf)-1 ) = Db_u_HD_M_LumpedMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_M_LumpedMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_M_LumpedMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_M_LumpedMesh_Buf)-1 ) = Int_u_HD_M_LumpedMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_M_LumpedMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_HD_M_LumpedMesh_Buf) )  DEALLOCATE(Re_u_HD_M_LumpedMesh_Buf)
  IF( ALLOCATED(Db_u_HD_M_LumpedMesh_Buf) )  DEALLOCATE(Db_u_HD_M_LumpedMesh_Buf)
  IF( ALLOCATED(Int_u_HD_M_LumpedMesh_Buf) ) DEALLOCATE(Int_u_HD_M_LumpedMesh_Buf)
  CALL MeshPack( InData%u_HD_M_DistribMesh, Re_u_HD_M_DistribMesh_Buf, Db_u_HD_M_DistribMesh_Buf, Int_u_HD_M_DistribMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_HD_M_DistribMesh 
  IF(ALLOCATED(Re_u_HD_M_DistribMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_M_DistribMesh_Buf)-1 ) = Re_u_HD_M_DistribMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_M_DistribMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_M_DistribMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_M_DistribMesh_Buf)-1 ) = Db_u_HD_M_DistribMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_M_DistribMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_M_DistribMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_M_DistribMesh_Buf)-1 ) = Int_u_HD_M_DistribMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_M_DistribMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_HD_M_DistribMesh_Buf) )  DEALLOCATE(Re_u_HD_M_DistribMesh_Buf)
  IF( ALLOCATED(Db_u_HD_M_DistribMesh_Buf) )  DEALLOCATE(Db_u_HD_M_DistribMesh_Buf)
  IF( ALLOCATED(Int_u_HD_M_DistribMesh_Buf) ) DEALLOCATE(Int_u_HD_M_DistribMesh_Buf)
  CALL MeshPack( InData%u_HD_Mesh, Re_u_HD_Mesh_Buf, Db_u_HD_Mesh_Buf, Int_u_HD_Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! u_HD_Mesh 
  IF(ALLOCATED(Re_u_HD_Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_Mesh_Buf)-1 ) = Re_u_HD_Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_Mesh_Buf)-1 ) = Db_u_HD_Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_Mesh_Buf)-1 ) = Int_u_HD_Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_u_HD_Mesh_Buf) )  DEALLOCATE(Re_u_HD_Mesh_Buf)
  IF( ALLOCATED(Db_u_HD_Mesh_Buf) )  DEALLOCATE(Db_u_HD_Mesh_Buf)
  IF( ALLOCATED(Int_u_HD_Mesh_Buf) ) DEALLOCATE(Int_u_HD_Mesh_Buf)
 END SUBROUTINE FAST_PackModuleMapType

 SUBROUTINE FAST_UnPackModuleMapType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_ModuleMapType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_HD_W_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_HD_W_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_HD_W_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HD_W_P_2_ED_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HD_W_P_2_ED_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HD_W_P_2_ED_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_HD_M_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_HD_M_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_HD_M_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HD_M_P_2_ED_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HD_M_P_2_ED_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HD_M_P_2_ED_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_HD_M_L_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_HD_M_L_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_HD_M_L_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HD_M_L_2_ED_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HD_M_L_2_ED_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HD_M_L_2_ED_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_Mooring_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_Mooring_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_Mooring_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Mooring_P_2_ED_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Mooring_P_2_ED_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Mooring_P_2_ED_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_SD_TP_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_SD_TP_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_SD_TP_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SD_TP_2_ED_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SD_TP_2_ED_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SD_TP_2_ED_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SD_P_2_HD_M_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SD_P_2_HD_M_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SD_P_2_HD_M_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HD_M_P_2_SD_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HD_M_P_2_SD_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HD_M_P_2_SD_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SD_P_2_HD_M_L_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SD_P_2_HD_M_L_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SD_P_2_HD_M_L_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HD_M_L_2_SD_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HD_M_L_2_SD_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HD_M_L_2_SD_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_P_2_SrvD_P_N_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_P_2_SrvD_P_N_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_P_2_SrvD_P_N_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SrvD_P_2_ED_P_N_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SrvD_P_2_ED_P_N_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SrvD_P_2_ED_P_N_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_L_2_AD_L_B_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_L_2_AD_L_B_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_L_2_AD_L_B_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_AD_L_2_ED_L_B_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AD_L_2_ED_L_B_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AD_L_2_ED_L_B_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ED_L_2_AD_L_T_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ED_L_2_AD_L_T_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ED_L_2_AD_L_T_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_AD_L_2_ED_L_T_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AD_L_2_ED_L_T_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AD_L_2_ED_L_T_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IceF_P_2_SD_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IceF_P_2_SD_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IceF_P_2_SD_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SD_P_2_IceF_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SD_P_2_IceF_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SD_P_2_IceF_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IceD_P_2_SD_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IceD_P_2_SD_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IceD_P_2_SD_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SD_P_2_IceD_P_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SD_P_2_IceD_P_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SD_P_2_IceD_P_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_ED_PlatformPtMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_ED_PlatformPtMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_ED_PlatformPtMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_ED_PlatformPtMesh_2_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_ED_PlatformPtMesh_2_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_ED_PlatformPtMesh_2_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_SD_TPMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_SD_TPMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_SD_TPMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_SD_LMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_SD_LMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_SD_LMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_SD_LMesh_2_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_SD_LMesh_2_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_SD_LMesh_2_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_HD_M_LumpedMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_HD_M_LumpedMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_HD_M_LumpedMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_HD_M_DistribMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_HD_M_DistribMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_HD_M_DistribMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_u_HD_Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_u_HD_Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_u_HD_Mesh_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_W_P_Buf, Db_ED_P_2_HD_W_P_Buf, Int_ED_P_2_HD_W_P_Buf, OutData%ED_P_2_HD_W_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_W_P 
  IF(ALLOCATED(Re_ED_P_2_HD_W_P_Buf)) THEN
    Re_ED_P_2_HD_W_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_W_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_W_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_W_P_Buf)) THEN
    Db_ED_P_2_HD_W_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_W_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_W_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_W_P_Buf)) THEN
    Int_ED_P_2_HD_W_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_W_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_W_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_HD_W_P_Buf, Db_ED_P_2_HD_W_P_Buf, Int_ED_P_2_HD_W_P_Buf, OutData%ED_P_2_HD_W_P, ErrStat, ErrMsg ) ! ED_P_2_HD_W_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_HD_W_P_2_ED_P_Buf, Db_HD_W_P_2_ED_P_Buf, Int_HD_W_P_2_ED_P_Buf, OutData%HD_W_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_W_P_2_ED_P 
  IF(ALLOCATED(Re_HD_W_P_2_ED_P_Buf)) THEN
    Re_HD_W_P_2_ED_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_W_P_2_ED_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HD_W_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_W_P_2_ED_P_Buf)) THEN
    Db_HD_W_P_2_ED_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_W_P_2_ED_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HD_W_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_W_P_2_ED_P_Buf)) THEN
    Int_HD_W_P_2_ED_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_W_P_2_ED_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HD_W_P_2_ED_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_HD_W_P_2_ED_P_Buf, Db_HD_W_P_2_ED_P_Buf, Int_HD_W_P_2_ED_P_Buf, OutData%HD_W_P_2_ED_P, ErrStat, ErrMsg ) ! HD_W_P_2_ED_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_P_Buf, Db_ED_P_2_HD_M_P_Buf, Int_ED_P_2_HD_M_P_Buf, OutData%ED_P_2_HD_M_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_M_P 
  IF(ALLOCATED(Re_ED_P_2_HD_M_P_Buf)) THEN
    Re_ED_P_2_HD_M_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_M_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_M_P_Buf)) THEN
    Db_ED_P_2_HD_M_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_M_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_M_P_Buf)) THEN
    Int_ED_P_2_HD_M_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_M_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_M_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_HD_M_P_Buf, Db_ED_P_2_HD_M_P_Buf, Int_ED_P_2_HD_M_P_Buf, OutData%ED_P_2_HD_M_P, ErrStat, ErrMsg ) ! ED_P_2_HD_M_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_ED_P_Buf, Db_HD_M_P_2_ED_P_Buf, Int_HD_M_P_2_ED_P_Buf, OutData%HD_M_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_P_2_ED_P 
  IF(ALLOCATED(Re_HD_M_P_2_ED_P_Buf)) THEN
    Re_HD_M_P_2_ED_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_P_2_ED_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_P_2_ED_P_Buf)) THEN
    Db_HD_M_P_2_ED_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_P_2_ED_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_P_2_ED_P_Buf)) THEN
    Int_HD_M_P_2_ED_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_P_2_ED_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_P_2_ED_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_HD_M_P_2_ED_P_Buf, Db_HD_M_P_2_ED_P_Buf, Int_HD_M_P_2_ED_P_Buf, OutData%HD_M_P_2_ED_P, ErrStat, ErrMsg ) ! HD_M_P_2_ED_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_HD_M_L_Buf, Db_ED_P_2_HD_M_L_Buf, Int_ED_P_2_HD_M_L_Buf, OutData%ED_P_2_HD_M_L, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_HD_M_L 
  IF(ALLOCATED(Re_ED_P_2_HD_M_L_Buf)) THEN
    Re_ED_P_2_HD_M_L_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_HD_M_L_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_HD_M_L_Buf)) THEN
    Db_ED_P_2_HD_M_L_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_HD_M_L_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_HD_M_L_Buf)) THEN
    Int_ED_P_2_HD_M_L_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_HD_M_L_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_HD_M_L_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_HD_M_L_Buf, Db_ED_P_2_HD_M_L_Buf, Int_ED_P_2_HD_M_L_Buf, OutData%ED_P_2_HD_M_L, ErrStat, ErrMsg ) ! ED_P_2_HD_M_L 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_ED_P_Buf, Db_HD_M_L_2_ED_P_Buf, Int_HD_M_L_2_ED_P_Buf, OutData%HD_M_L_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_L_2_ED_P 
  IF(ALLOCATED(Re_HD_M_L_2_ED_P_Buf)) THEN
    Re_HD_M_L_2_ED_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_L_2_ED_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_L_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_L_2_ED_P_Buf)) THEN
    Db_HD_M_L_2_ED_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_L_2_ED_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_L_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_L_2_ED_P_Buf)) THEN
    Int_HD_M_L_2_ED_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_L_2_ED_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_L_2_ED_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_HD_M_L_2_ED_P_Buf, Db_HD_M_L_2_ED_P_Buf, Int_HD_M_L_2_ED_P_Buf, OutData%HD_M_L_2_ED_P, ErrStat, ErrMsg ) ! HD_M_L_2_ED_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_Mooring_P_Buf, Db_ED_P_2_Mooring_P_Buf, Int_ED_P_2_Mooring_P_Buf, OutData%ED_P_2_Mooring_P, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_Mooring_P 
  IF(ALLOCATED(Re_ED_P_2_Mooring_P_Buf)) THEN
    Re_ED_P_2_Mooring_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_Mooring_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_Mooring_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_Mooring_P_Buf)) THEN
    Db_ED_P_2_Mooring_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_Mooring_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_Mooring_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_Mooring_P_Buf)) THEN
    Int_ED_P_2_Mooring_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_Mooring_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_Mooring_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_Mooring_P_Buf, Db_ED_P_2_Mooring_P_Buf, Int_ED_P_2_Mooring_P_Buf, OutData%ED_P_2_Mooring_P, ErrStat, ErrMsg ) ! ED_P_2_Mooring_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_Mooring_P_2_ED_P_Buf, Db_Mooring_P_2_ED_P_Buf, Int_Mooring_P_2_ED_P_Buf, OutData%Mooring_P_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! Mooring_P_2_ED_P 
  IF(ALLOCATED(Re_Mooring_P_2_ED_P_Buf)) THEN
    Re_Mooring_P_2_ED_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Mooring_P_2_ED_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Mooring_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_Mooring_P_2_ED_P_Buf)) THEN
    Db_Mooring_P_2_ED_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Mooring_P_2_ED_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Mooring_P_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_Mooring_P_2_ED_P_Buf)) THEN
    Int_Mooring_P_2_ED_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Mooring_P_2_ED_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Mooring_P_2_ED_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_Mooring_P_2_ED_P_Buf, Db_Mooring_P_2_ED_P_Buf, Int_Mooring_P_2_ED_P_Buf, OutData%Mooring_P_2_ED_P, ErrStat, ErrMsg ) ! Mooring_P_2_ED_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SD_TP_Buf, Db_ED_P_2_SD_TP_Buf, Int_ED_P_2_SD_TP_Buf, OutData%ED_P_2_SD_TP, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_SD_TP 
  IF(ALLOCATED(Re_ED_P_2_SD_TP_Buf)) THEN
    Re_ED_P_2_SD_TP_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_SD_TP_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_SD_TP_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_SD_TP_Buf)) THEN
    Db_ED_P_2_SD_TP_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_SD_TP_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_SD_TP_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_SD_TP_Buf)) THEN
    Int_ED_P_2_SD_TP_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_SD_TP_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_SD_TP_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_SD_TP_Buf, Db_ED_P_2_SD_TP_Buf, Int_ED_P_2_SD_TP_Buf, OutData%ED_P_2_SD_TP, ErrStat, ErrMsg ) ! ED_P_2_SD_TP 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SD_TP_2_ED_P_Buf, Db_SD_TP_2_ED_P_Buf, Int_SD_TP_2_ED_P_Buf, OutData%SD_TP_2_ED_P, ErrStat, ErrMsg, .TRUE. ) ! SD_TP_2_ED_P 
  IF(ALLOCATED(Re_SD_TP_2_ED_P_Buf)) THEN
    Re_SD_TP_2_ED_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_TP_2_ED_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SD_TP_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_TP_2_ED_P_Buf)) THEN
    Db_SD_TP_2_ED_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_TP_2_ED_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SD_TP_2_ED_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_TP_2_ED_P_Buf)) THEN
    Int_SD_TP_2_ED_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_TP_2_ED_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SD_TP_2_ED_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SD_TP_2_ED_P_Buf, Db_SD_TP_2_ED_P_Buf, Int_SD_TP_2_ED_P_Buf, OutData%SD_TP_2_ED_P, ErrStat, ErrMsg ) ! SD_TP_2_ED_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_P_Buf, Db_SD_P_2_HD_M_P_Buf, Int_SD_P_2_HD_M_P_Buf, OutData%SD_P_2_HD_M_P, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_HD_M_P 
  IF(ALLOCATED(Re_SD_P_2_HD_M_P_Buf)) THEN
    Re_SD_P_2_HD_M_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_HD_M_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_HD_M_P_Buf)) THEN
    Db_SD_P_2_HD_M_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_HD_M_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_HD_M_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_HD_M_P_Buf)) THEN
    Int_SD_P_2_HD_M_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_HD_M_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_HD_M_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SD_P_2_HD_M_P_Buf, Db_SD_P_2_HD_M_P_Buf, Int_SD_P_2_HD_M_P_Buf, OutData%SD_P_2_HD_M_P, ErrStat, ErrMsg ) ! SD_P_2_HD_M_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_P_2_SD_P_Buf, Db_HD_M_P_2_SD_P_Buf, Int_HD_M_P_2_SD_P_Buf, OutData%HD_M_P_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_P_2_SD_P 
  IF(ALLOCATED(Re_HD_M_P_2_SD_P_Buf)) THEN
    Re_HD_M_P_2_SD_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_P_2_SD_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_P_2_SD_P_Buf)) THEN
    Db_HD_M_P_2_SD_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_P_2_SD_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_P_2_SD_P_Buf)) THEN
    Int_HD_M_P_2_SD_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_P_2_SD_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_P_2_SD_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_HD_M_P_2_SD_P_Buf, Db_HD_M_P_2_SD_P_Buf, Int_HD_M_P_2_SD_P_Buf, OutData%HD_M_P_2_SD_P, ErrStat, ErrMsg ) ! HD_M_P_2_SD_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_HD_M_L_Buf, Db_SD_P_2_HD_M_L_Buf, Int_SD_P_2_HD_M_L_Buf, OutData%SD_P_2_HD_M_L, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_HD_M_L 
  IF(ALLOCATED(Re_SD_P_2_HD_M_L_Buf)) THEN
    Re_SD_P_2_HD_M_L_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_HD_M_L_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_HD_M_L_Buf)) THEN
    Db_SD_P_2_HD_M_L_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_HD_M_L_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_HD_M_L_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_HD_M_L_Buf)) THEN
    Int_SD_P_2_HD_M_L_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_HD_M_L_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_HD_M_L_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SD_P_2_HD_M_L_Buf, Db_SD_P_2_HD_M_L_Buf, Int_SD_P_2_HD_M_L_Buf, OutData%SD_P_2_HD_M_L, ErrStat, ErrMsg ) ! SD_P_2_HD_M_L 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_HD_M_L_2_SD_P_Buf, Db_HD_M_L_2_SD_P_Buf, Int_HD_M_L_2_SD_P_Buf, OutData%HD_M_L_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! HD_M_L_2_SD_P 
  IF(ALLOCATED(Re_HD_M_L_2_SD_P_Buf)) THEN
    Re_HD_M_L_2_SD_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HD_M_L_2_SD_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HD_M_L_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_HD_M_L_2_SD_P_Buf)) THEN
    Db_HD_M_L_2_SD_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HD_M_L_2_SD_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HD_M_L_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_HD_M_L_2_SD_P_Buf)) THEN
    Int_HD_M_L_2_SD_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HD_M_L_2_SD_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HD_M_L_2_SD_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_HD_M_L_2_SD_P_Buf, Db_HD_M_L_2_SD_P_Buf, Int_HD_M_L_2_SD_P_Buf, OutData%HD_M_L_2_SD_P, ErrStat, ErrMsg ) ! HD_M_L_2_SD_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_P_2_SrvD_P_N_Buf, Db_ED_P_2_SrvD_P_N_Buf, Int_ED_P_2_SrvD_P_N_Buf, OutData%ED_P_2_SrvD_P_N, ErrStat, ErrMsg, .TRUE. ) ! ED_P_2_SrvD_P_N 
  IF(ALLOCATED(Re_ED_P_2_SrvD_P_N_Buf)) THEN
    Re_ED_P_2_SrvD_P_N_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_P_2_SrvD_P_N_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_P_2_SrvD_P_N_Buf)) THEN
    Db_ED_P_2_SrvD_P_N_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_P_2_SrvD_P_N_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_P_2_SrvD_P_N_Buf)) THEN
    Int_ED_P_2_SrvD_P_N_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_P_2_SrvD_P_N_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_P_2_SrvD_P_N_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_P_2_SrvD_P_N_Buf, Db_ED_P_2_SrvD_P_N_Buf, Int_ED_P_2_SrvD_P_N_Buf, OutData%ED_P_2_SrvD_P_N, ErrStat, ErrMsg ) ! ED_P_2_SrvD_P_N 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SrvD_P_2_ED_P_N_Buf, Db_SrvD_P_2_ED_P_N_Buf, Int_SrvD_P_2_ED_P_N_Buf, OutData%SrvD_P_2_ED_P_N, ErrStat, ErrMsg, .TRUE. ) ! SrvD_P_2_ED_P_N 
  IF(ALLOCATED(Re_SrvD_P_2_ED_P_N_Buf)) THEN
    Re_SrvD_P_2_ED_P_N_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SrvD_P_2_ED_P_N_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Db_SrvD_P_2_ED_P_N_Buf)) THEN
    Db_SrvD_P_2_ED_P_N_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SrvD_P_2_ED_P_N_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  IF(ALLOCATED(Int_SrvD_P_2_ED_P_N_Buf)) THEN
    Int_SrvD_P_2_ED_P_N_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SrvD_P_2_ED_P_N_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SrvD_P_2_ED_P_N_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SrvD_P_2_ED_P_N_Buf, Db_SrvD_P_2_ED_P_N_Buf, Int_SrvD_P_2_ED_P_N_Buf, OutData%SrvD_P_2_ED_P_N, ErrStat, ErrMsg ) ! SrvD_P_2_ED_P_N 
DO i1 = LBOUND(OutData%ED_L_2_AD_L_B,1), UBOUND(OutData%ED_L_2_AD_L_B,1)
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_B_Buf, Db_ED_L_2_AD_L_B_Buf, Int_ED_L_2_AD_L_B_Buf, OutData%ED_L_2_AD_L_B(i1), ErrStat, ErrMsg, .TRUE. ) ! ED_L_2_AD_L_B 
  IF(ALLOCATED(Re_ED_L_2_AD_L_B_Buf)) THEN
    Re_ED_L_2_AD_L_B_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_L_2_AD_L_B_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_L_2_AD_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_L_2_AD_L_B_Buf)) THEN
    Db_ED_L_2_AD_L_B_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_L_2_AD_L_B_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_L_2_AD_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_L_2_AD_L_B_Buf)) THEN
    Int_ED_L_2_AD_L_B_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_L_2_AD_L_B_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_L_2_AD_L_B_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_L_2_AD_L_B_Buf, Db_ED_L_2_AD_L_B_Buf, Int_ED_L_2_AD_L_B_Buf, OutData%ED_L_2_AD_L_B(i1), ErrStat, ErrMsg ) ! ED_L_2_AD_L_B 
ENDDO
DO i1 = LBOUND(OutData%AD_L_2_ED_L_B,1), UBOUND(OutData%AD_L_2_ED_L_B,1)
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_B_Buf, Db_AD_L_2_ED_L_B_Buf, Int_AD_L_2_ED_L_B_Buf, OutData%AD_L_2_ED_L_B(i1), ErrStat, ErrMsg, .TRUE. ) ! AD_L_2_ED_L_B 
  IF(ALLOCATED(Re_AD_L_2_ED_L_B_Buf)) THEN
    Re_AD_L_2_ED_L_B_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AD_L_2_ED_L_B_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AD_L_2_ED_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Db_AD_L_2_ED_L_B_Buf)) THEN
    Db_AD_L_2_ED_L_B_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AD_L_2_ED_L_B_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AD_L_2_ED_L_B_Buf)
  ENDIF
  IF(ALLOCATED(Int_AD_L_2_ED_L_B_Buf)) THEN
    Int_AD_L_2_ED_L_B_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AD_L_2_ED_L_B_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AD_L_2_ED_L_B_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_AD_L_2_ED_L_B_Buf, Db_AD_L_2_ED_L_B_Buf, Int_AD_L_2_ED_L_B_Buf, OutData%AD_L_2_ED_L_B(i1), ErrStat, ErrMsg ) ! AD_L_2_ED_L_B 
ENDDO
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_ED_L_2_AD_L_T_Buf, Db_ED_L_2_AD_L_T_Buf, Int_ED_L_2_AD_L_T_Buf, OutData%ED_L_2_AD_L_T, ErrStat, ErrMsg, .TRUE. ) ! ED_L_2_AD_L_T 
  IF(ALLOCATED(Re_ED_L_2_AD_L_T_Buf)) THEN
    Re_ED_L_2_AD_L_T_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ED_L_2_AD_L_T_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ED_L_2_AD_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Db_ED_L_2_AD_L_T_Buf)) THEN
    Db_ED_L_2_AD_L_T_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ED_L_2_AD_L_T_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ED_L_2_AD_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Int_ED_L_2_AD_L_T_Buf)) THEN
    Int_ED_L_2_AD_L_T_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ED_L_2_AD_L_T_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ED_L_2_AD_L_T_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_ED_L_2_AD_L_T_Buf, Db_ED_L_2_AD_L_T_Buf, Int_ED_L_2_AD_L_T_Buf, OutData%ED_L_2_AD_L_T, ErrStat, ErrMsg ) ! ED_L_2_AD_L_T 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_AD_L_2_ED_L_T_Buf, Db_AD_L_2_ED_L_T_Buf, Int_AD_L_2_ED_L_T_Buf, OutData%AD_L_2_ED_L_T, ErrStat, ErrMsg, .TRUE. ) ! AD_L_2_ED_L_T 
  IF(ALLOCATED(Re_AD_L_2_ED_L_T_Buf)) THEN
    Re_AD_L_2_ED_L_T_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AD_L_2_ED_L_T_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AD_L_2_ED_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Db_AD_L_2_ED_L_T_Buf)) THEN
    Db_AD_L_2_ED_L_T_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AD_L_2_ED_L_T_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AD_L_2_ED_L_T_Buf)
  ENDIF
  IF(ALLOCATED(Int_AD_L_2_ED_L_T_Buf)) THEN
    Int_AD_L_2_ED_L_T_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AD_L_2_ED_L_T_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AD_L_2_ED_L_T_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_AD_L_2_ED_L_T_Buf, Db_AD_L_2_ED_L_T_Buf, Int_AD_L_2_ED_L_T_Buf, OutData%AD_L_2_ED_L_T, ErrStat, ErrMsg ) ! AD_L_2_ED_L_T 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_IceF_P_2_SD_P_Buf, Db_IceF_P_2_SD_P_Buf, Int_IceF_P_2_SD_P_Buf, OutData%IceF_P_2_SD_P, ErrStat, ErrMsg, .TRUE. ) ! IceF_P_2_SD_P 
  IF(ALLOCATED(Re_IceF_P_2_SD_P_Buf)) THEN
    Re_IceF_P_2_SD_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IceF_P_2_SD_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IceF_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_IceF_P_2_SD_P_Buf)) THEN
    Db_IceF_P_2_SD_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IceF_P_2_SD_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IceF_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_IceF_P_2_SD_P_Buf)) THEN
    Int_IceF_P_2_SD_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IceF_P_2_SD_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IceF_P_2_SD_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_IceF_P_2_SD_P_Buf, Db_IceF_P_2_SD_P_Buf, Int_IceF_P_2_SD_P_Buf, OutData%IceF_P_2_SD_P, ErrStat, ErrMsg ) ! IceF_P_2_SD_P 
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceF_P_Buf, Db_SD_P_2_IceF_P_Buf, Int_SD_P_2_IceF_P_Buf, OutData%SD_P_2_IceF_P, ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_IceF_P 
  IF(ALLOCATED(Re_SD_P_2_IceF_P_Buf)) THEN
    Re_SD_P_2_IceF_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_IceF_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_IceF_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_IceF_P_Buf)) THEN
    Db_SD_P_2_IceF_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_IceF_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_IceF_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_IceF_P_Buf)) THEN
    Int_SD_P_2_IceF_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_IceF_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_IceF_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SD_P_2_IceF_P_Buf, Db_SD_P_2_IceF_P_Buf, Int_SD_P_2_IceF_P_Buf, OutData%SD_P_2_IceF_P, ErrStat, ErrMsg ) ! SD_P_2_IceF_P 
DO i1 = LBOUND(OutData%IceD_P_2_SD_P,1), UBOUND(OutData%IceD_P_2_SD_P,1)
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_IceD_P_2_SD_P_Buf, Db_IceD_P_2_SD_P_Buf, Int_IceD_P_2_SD_P_Buf, OutData%IceD_P_2_SD_P(i1), ErrStat, ErrMsg, .TRUE. ) ! IceD_P_2_SD_P 
  IF(ALLOCATED(Re_IceD_P_2_SD_P_Buf)) THEN
    Re_IceD_P_2_SD_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IceD_P_2_SD_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IceD_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_IceD_P_2_SD_P_Buf)) THEN
    Db_IceD_P_2_SD_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IceD_P_2_SD_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IceD_P_2_SD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_IceD_P_2_SD_P_Buf)) THEN
    Int_IceD_P_2_SD_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IceD_P_2_SD_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IceD_P_2_SD_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_IceD_P_2_SD_P_Buf, Db_IceD_P_2_SD_P_Buf, Int_IceD_P_2_SD_P_Buf, OutData%IceD_P_2_SD_P(i1), ErrStat, ErrMsg ) ! IceD_P_2_SD_P 
ENDDO
DO i1 = LBOUND(OutData%SD_P_2_IceD_P,1), UBOUND(OutData%SD_P_2_IceD_P,1)
 ! first call NWTC_Library_Packmeshmaptype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packmeshmaptype( Re_SD_P_2_IceD_P_Buf, Db_SD_P_2_IceD_P_Buf, Int_SD_P_2_IceD_P_Buf, OutData%SD_P_2_IceD_P(i1), ErrStat, ErrMsg, .TRUE. ) ! SD_P_2_IceD_P 
  IF(ALLOCATED(Re_SD_P_2_IceD_P_Buf)) THEN
    Re_SD_P_2_IceD_P_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SD_P_2_IceD_P_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SD_P_2_IceD_P_Buf)
  ENDIF
  IF(ALLOCATED(Db_SD_P_2_IceD_P_Buf)) THEN
    Db_SD_P_2_IceD_P_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SD_P_2_IceD_P_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SD_P_2_IceD_P_Buf)
  ENDIF
  IF(ALLOCATED(Int_SD_P_2_IceD_P_Buf)) THEN
    Int_SD_P_2_IceD_P_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SD_P_2_IceD_P_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SD_P_2_IceD_P_Buf)
  ENDIF
  CALL NWTC_Library_UnPackmeshmaptype( Re_SD_P_2_IceD_P_Buf, Db_SD_P_2_IceD_P_Buf, Int_SD_P_2_IceD_P_Buf, OutData%SD_P_2_IceD_P(i1), ErrStat, ErrMsg ) ! SD_P_2_IceD_P 
ENDDO
  IF ( ALLOCATED(OutData%Jacobian_ED_SD_HD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%Jacobian_ED_SD_HD,1),SIZE(OutData%Jacobian_ED_SD_HD,2)))
  mask2 = .TRUE.
    OutData%Jacobian_ED_SD_HD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Jacobian_ED_SD_HD))-1 ),mask2,OutData%Jacobian_ED_SD_HD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Jacobian_ED_SD_HD)
  ENDIF
  IF ( ALLOCATED(OutData%Jacobian_pivot) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Jacobian_pivot,1)))
  mask1 = .TRUE.
    OutData%Jacobian_pivot = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%Jacobian_pivot))-1 ),mask1,OutData%Jacobian_pivot)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%Jacobian_pivot)
  ENDIF
  IF ( ALLOCATED(OutData%Jac_u_indx) ) THEN
  ALLOCATE(mask2(SIZE(OutData%Jac_u_indx,1),SIZE(OutData%Jac_u_indx,2)))
  mask2 = .TRUE.
    OutData%Jac_u_indx = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%Jac_u_indx))-1 ),mask2,OutData%Jac_u_indx)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%Jac_u_indx)
  ENDIF
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%u_ED_PlatformPtMesh, Re_u_ED_PlatformPtMesh_Buf, Db_u_ED_PlatformPtMesh_Buf, Int_u_ED_PlatformPtMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_ED_PlatformPtMesh 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_Buf)) THEN
    Re_u_ED_PlatformPtMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_ED_PlatformPtMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_ED_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_Buf)) THEN
    Db_u_ED_PlatformPtMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_ED_PlatformPtMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_ED_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_Buf)) THEN
    Int_u_ED_PlatformPtMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_ED_PlatformPtMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_ED_PlatformPtMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_ED_PlatformPtMesh, Re_u_ED_PlatformPtMesh_Buf, Db_u_ED_PlatformPtMesh_Buf, Int_u_ED_PlatformPtMesh_Buf, ErrStat, ErrMsg ) ! u_ED_PlatformPtMesh 
  IF( ALLOCATED(Re_u_ED_PlatformPtMesh_Buf) )  DEALLOCATE(Re_u_ED_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_u_ED_PlatformPtMesh_Buf) )  DEALLOCATE(Db_u_ED_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_u_ED_PlatformPtMesh_Buf) ) DEALLOCATE(Int_u_ED_PlatformPtMesh_Buf)
  CALL MeshPack( OutData%u_ED_PlatformPtMesh_2, Re_u_ED_PlatformPtMesh_2_Buf, Db_u_ED_PlatformPtMesh_2_Buf, Int_u_ED_PlatformPtMesh_2_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_ED_PlatformPtMesh_2 
  IF(ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf)) THEN
    Re_u_ED_PlatformPtMesh_2_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_ED_PlatformPtMesh_2_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf)) THEN
    Db_u_ED_PlatformPtMesh_2_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_ED_PlatformPtMesh_2_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf)) THEN
    Int_u_ED_PlatformPtMesh_2_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_ED_PlatformPtMesh_2_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_ED_PlatformPtMesh_2_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_ED_PlatformPtMesh_2, Re_u_ED_PlatformPtMesh_2_Buf, Db_u_ED_PlatformPtMesh_2_Buf, Int_u_ED_PlatformPtMesh_2_Buf, ErrStat, ErrMsg ) ! u_ED_PlatformPtMesh_2 
  IF( ALLOCATED(Re_u_ED_PlatformPtMesh_2_Buf) )  DEALLOCATE(Re_u_ED_PlatformPtMesh_2_Buf)
  IF( ALLOCATED(Db_u_ED_PlatformPtMesh_2_Buf) )  DEALLOCATE(Db_u_ED_PlatformPtMesh_2_Buf)
  IF( ALLOCATED(Int_u_ED_PlatformPtMesh_2_Buf) ) DEALLOCATE(Int_u_ED_PlatformPtMesh_2_Buf)
  CALL MeshPack( OutData%u_SD_TPMesh, Re_u_SD_TPMesh_Buf, Db_u_SD_TPMesh_Buf, Int_u_SD_TPMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_SD_TPMesh 
  IF(ALLOCATED(Re_u_SD_TPMesh_Buf)) THEN
    Re_u_SD_TPMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_TPMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_TPMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_TPMesh_Buf)) THEN
    Db_u_SD_TPMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_TPMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_TPMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_TPMesh_Buf)) THEN
    Int_u_SD_TPMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_TPMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_TPMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_SD_TPMesh, Re_u_SD_TPMesh_Buf, Db_u_SD_TPMesh_Buf, Int_u_SD_TPMesh_Buf, ErrStat, ErrMsg ) ! u_SD_TPMesh 
  IF( ALLOCATED(Re_u_SD_TPMesh_Buf) )  DEALLOCATE(Re_u_SD_TPMesh_Buf)
  IF( ALLOCATED(Db_u_SD_TPMesh_Buf) )  DEALLOCATE(Db_u_SD_TPMesh_Buf)
  IF( ALLOCATED(Int_u_SD_TPMesh_Buf) ) DEALLOCATE(Int_u_SD_TPMesh_Buf)
  CALL MeshPack( OutData%u_SD_LMesh, Re_u_SD_LMesh_Buf, Db_u_SD_LMesh_Buf, Int_u_SD_LMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_SD_LMesh 
  IF(ALLOCATED(Re_u_SD_LMesh_Buf)) THEN
    Re_u_SD_LMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_LMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_LMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_LMesh_Buf)) THEN
    Db_u_SD_LMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_LMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_LMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_LMesh_Buf)) THEN
    Int_u_SD_LMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_LMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_LMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_SD_LMesh, Re_u_SD_LMesh_Buf, Db_u_SD_LMesh_Buf, Int_u_SD_LMesh_Buf, ErrStat, ErrMsg ) ! u_SD_LMesh 
  IF( ALLOCATED(Re_u_SD_LMesh_Buf) )  DEALLOCATE(Re_u_SD_LMesh_Buf)
  IF( ALLOCATED(Db_u_SD_LMesh_Buf) )  DEALLOCATE(Db_u_SD_LMesh_Buf)
  IF( ALLOCATED(Int_u_SD_LMesh_Buf) ) DEALLOCATE(Int_u_SD_LMesh_Buf)
  CALL MeshPack( OutData%u_SD_LMesh_2, Re_u_SD_LMesh_2_Buf, Db_u_SD_LMesh_2_Buf, Int_u_SD_LMesh_2_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_SD_LMesh_2 
  IF(ALLOCATED(Re_u_SD_LMesh_2_Buf)) THEN
    Re_u_SD_LMesh_2_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_SD_LMesh_2_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_SD_LMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_SD_LMesh_2_Buf)) THEN
    Db_u_SD_LMesh_2_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_SD_LMesh_2_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_SD_LMesh_2_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_SD_LMesh_2_Buf)) THEN
    Int_u_SD_LMesh_2_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_SD_LMesh_2_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_SD_LMesh_2_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_SD_LMesh_2, Re_u_SD_LMesh_2_Buf, Db_u_SD_LMesh_2_Buf, Int_u_SD_LMesh_2_Buf, ErrStat, ErrMsg ) ! u_SD_LMesh_2 
  IF( ALLOCATED(Re_u_SD_LMesh_2_Buf) )  DEALLOCATE(Re_u_SD_LMesh_2_Buf)
  IF( ALLOCATED(Db_u_SD_LMesh_2_Buf) )  DEALLOCATE(Db_u_SD_LMesh_2_Buf)
  IF( ALLOCATED(Int_u_SD_LMesh_2_Buf) ) DEALLOCATE(Int_u_SD_LMesh_2_Buf)
  CALL MeshPack( OutData%u_HD_M_LumpedMesh, Re_u_HD_M_LumpedMesh_Buf, Db_u_HD_M_LumpedMesh_Buf, Int_u_HD_M_LumpedMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_HD_M_LumpedMesh 
  IF(ALLOCATED(Re_u_HD_M_LumpedMesh_Buf)) THEN
    Re_u_HD_M_LumpedMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_M_LumpedMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_M_LumpedMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_M_LumpedMesh_Buf)) THEN
    Db_u_HD_M_LumpedMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_M_LumpedMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_M_LumpedMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_M_LumpedMesh_Buf)) THEN
    Int_u_HD_M_LumpedMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_M_LumpedMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_M_LumpedMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_HD_M_LumpedMesh, Re_u_HD_M_LumpedMesh_Buf, Db_u_HD_M_LumpedMesh_Buf, Int_u_HD_M_LumpedMesh_Buf, ErrStat, ErrMsg ) ! u_HD_M_LumpedMesh 
  IF( ALLOCATED(Re_u_HD_M_LumpedMesh_Buf) )  DEALLOCATE(Re_u_HD_M_LumpedMesh_Buf)
  IF( ALLOCATED(Db_u_HD_M_LumpedMesh_Buf) )  DEALLOCATE(Db_u_HD_M_LumpedMesh_Buf)
  IF( ALLOCATED(Int_u_HD_M_LumpedMesh_Buf) ) DEALLOCATE(Int_u_HD_M_LumpedMesh_Buf)
  CALL MeshPack( OutData%u_HD_M_DistribMesh, Re_u_HD_M_DistribMesh_Buf, Db_u_HD_M_DistribMesh_Buf, Int_u_HD_M_DistribMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_HD_M_DistribMesh 
  IF(ALLOCATED(Re_u_HD_M_DistribMesh_Buf)) THEN
    Re_u_HD_M_DistribMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_M_DistribMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_M_DistribMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_M_DistribMesh_Buf)) THEN
    Db_u_HD_M_DistribMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_M_DistribMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_M_DistribMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_M_DistribMesh_Buf)) THEN
    Int_u_HD_M_DistribMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_M_DistribMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_M_DistribMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_HD_M_DistribMesh, Re_u_HD_M_DistribMesh_Buf, Db_u_HD_M_DistribMesh_Buf, Int_u_HD_M_DistribMesh_Buf, ErrStat, ErrMsg ) ! u_HD_M_DistribMesh 
  IF( ALLOCATED(Re_u_HD_M_DistribMesh_Buf) )  DEALLOCATE(Re_u_HD_M_DistribMesh_Buf)
  IF( ALLOCATED(Db_u_HD_M_DistribMesh_Buf) )  DEALLOCATE(Db_u_HD_M_DistribMesh_Buf)
  IF( ALLOCATED(Int_u_HD_M_DistribMesh_Buf) ) DEALLOCATE(Int_u_HD_M_DistribMesh_Buf)
  CALL MeshPack( OutData%u_HD_Mesh, Re_u_HD_Mesh_Buf, Db_u_HD_Mesh_Buf, Int_u_HD_Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! u_HD_Mesh 
  IF(ALLOCATED(Re_u_HD_Mesh_Buf)) THEN
    Re_u_HD_Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_u_HD_Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_u_HD_Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_u_HD_Mesh_Buf)) THEN
    Db_u_HD_Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_u_HD_Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_u_HD_Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_u_HD_Mesh_Buf)) THEN
    Int_u_HD_Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_u_HD_Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_u_HD_Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%u_HD_Mesh, Re_u_HD_Mesh_Buf, Db_u_HD_Mesh_Buf, Int_u_HD_Mesh_Buf, ErrStat, ErrMsg ) ! u_HD_Mesh 
  IF( ALLOCATED(Re_u_HD_Mesh_Buf) )  DEALLOCATE(Re_u_HD_Mesh_Buf)
  IF( ALLOCATED(Db_u_HD_Mesh_Buf) )  DEALLOCATE(Db_u_HD_Mesh_Buf)
  IF( ALLOCATED(Int_u_HD_Mesh_Buf) ) DEALLOCATE(Int_u_HD_Mesh_Buf)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackModuleMapType

 SUBROUTINE FAST_CopyExternInputType( SrcExternInputTypeData, DstExternInputTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_ExternInputType), INTENT(IN) :: SrcExternInputTypeData
   TYPE(FAST_ExternInputType), INTENT(INOUT) :: DstExternInputTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstExternInputTypeData%GenTrq = SrcExternInputTypeData%GenTrq
   DstExternInputTypeData%ElecPwr = SrcExternInputTypeData%ElecPwr
   DstExternInputTypeData%YawPosCom = SrcExternInputTypeData%YawPosCom
   DstExternInputTypeData%YawRateCom = SrcExternInputTypeData%YawRateCom
   DstExternInputTypeData%BlPitchCom = SrcExternInputTypeData%BlPitchCom
   DstExternInputTypeData%HSSBrFrac = SrcExternInputTypeData%HSSBrFrac
   DstExternInputTypeData%LidarFocus = SrcExternInputTypeData%LidarFocus
 END SUBROUTINE FAST_CopyExternInputType

 SUBROUTINE FAST_DestroyExternInputType( ExternInputTypeData, ErrStat, ErrMsg )
  TYPE(FAST_ExternInputType), INTENT(INOUT) :: ExternInputTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE FAST_DestroyExternInputType

 SUBROUTINE FAST_PackExternInputType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_ExternInputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! GenTrq
  Re_BufSz   = Re_BufSz   + 1  ! ElecPwr
  Re_BufSz   = Re_BufSz   + 1  ! YawPosCom
  Re_BufSz   = Re_BufSz   + 1  ! YawRateCom
  Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitchCom )  ! BlPitchCom 
  Re_BufSz   = Re_BufSz   + 1  ! HSSBrFrac
  Re_BufSz    = Re_BufSz    + SIZE( InData%LidarFocus )  ! LidarFocus 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenTrq )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ElecPwr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawPosCom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawRateCom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitchCom))-1 ) =  PACK(InData%BlPitchCom ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitchCom)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSSBrFrac )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LidarFocus))-1 ) =  PACK(InData%LidarFocus ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LidarFocus)
 END SUBROUTINE FAST_PackExternInputType

 SUBROUTINE FAST_UnPackExternInputType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_ExternInputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%GenTrq = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ElecPwr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawPosCom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawRateCom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%BlPitchCom,1)))
  mask1 = .TRUE.
  OutData%BlPitchCom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitchCom))-1 ),mask1,OutData%BlPitchCom)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitchCom)
  OutData%HSSBrFrac = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%LidarFocus,1)))
  mask1 = .TRUE.
  OutData%LidarFocus = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LidarFocus))-1 ),mask1,OutData%LidarFocus)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LidarFocus)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackExternInputType

 SUBROUTINE FAST_CopyMiscVarType( SrcMiscVarTypeData, DstMiscVarTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_MiscVarType), INTENT(IN) :: SrcMiscVarTypeData
   TYPE(FAST_MiscVarType), INTENT(INOUT) :: DstMiscVarTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstMiscVarTypeData%TiLstPrn = SrcMiscVarTypeData%TiLstPrn
   DstMiscVarTypeData%t_global = SrcMiscVarTypeData%t_global
   DstMiscVarTypeData%NextJacCalcTime = SrcMiscVarTypeData%NextJacCalcTime
   DstMiscVarTypeData%PrevClockTime = SrcMiscVarTypeData%PrevClockTime
   DstMiscVarTypeData%UsrTime1 = SrcMiscVarTypeData%UsrTime1
   DstMiscVarTypeData%UsrTime2 = SrcMiscVarTypeData%UsrTime2
   DstMiscVarTypeData%StrtTime = SrcMiscVarTypeData%StrtTime
   DstMiscVarTypeData%SimStrtTime = SrcMiscVarTypeData%SimStrtTime
   DstMiscVarTypeData%n_TMax_m1 = SrcMiscVarTypeData%n_TMax_m1
   DstMiscVarTypeData%calcJacobian = SrcMiscVarTypeData%calcJacobian
      CALL FAST_Copyexterninputtype( SrcMiscVarTypeData%ExternInput, DstMiscVarTypeData%ExternInput, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'FAST_CopyMiscVarType:ExternInput')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE FAST_CopyMiscVarType

 SUBROUTINE FAST_DestroyMiscVarType( MiscVarTypeData, ErrStat, ErrMsg )
  TYPE(FAST_MiscVarType), INTENT(INOUT) :: MiscVarTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL FAST_Destroyexterninputtype( MiscVarTypeData%ExternInput, ErrStat, ErrMsg )
 END SUBROUTINE FAST_DestroyMiscVarType

 SUBROUTINE FAST_PackMiscVarType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_MiscVarType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_ExternInput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ExternInput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ExternInput_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! TiLstPrn
  Db_BufSz   = Db_BufSz   + 1  ! t_global
  Db_BufSz   = Db_BufSz   + 1  ! NextJacCalcTime
  Re_BufSz   = Re_BufSz   + 1  ! PrevClockTime
  Re_BufSz   = Re_BufSz   + 1  ! UsrTime1
  Re_BufSz   = Re_BufSz   + 1  ! UsrTime2
  Int_BufSz   = Int_BufSz   + SIZE( InData%StrtTime )  ! StrtTime 
  Int_BufSz   = Int_BufSz   + SIZE( InData%SimStrtTime )  ! SimStrtTime 
  Int_BufSz  = Int_BufSz  + 1  ! n_TMax_m1
  Int_BufSz  = Int_BufSz  + 1  ! calcJacobian
  CALL FAST_Packexterninputtype( Re_ExternInput_Buf, Db_ExternInput_Buf, Int_ExternInput_Buf, InData%ExternInput, ErrStat, ErrMsg, .TRUE. ) ! ExternInput 
  IF(ALLOCATED(Re_ExternInput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ExternInput_Buf  ) ! ExternInput
  IF(ALLOCATED(Db_ExternInput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ExternInput_Buf  ) ! ExternInput
  IF(ALLOCATED(Int_ExternInput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ExternInput_Buf ) ! ExternInput
  IF(ALLOCATED(Re_ExternInput_Buf))  DEALLOCATE(Re_ExternInput_Buf)
  IF(ALLOCATED(Db_ExternInput_Buf))  DEALLOCATE(Db_ExternInput_Buf)
  IF(ALLOCATED(Int_ExternInput_Buf)) DEALLOCATE(Int_ExternInput_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TiLstPrn )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%t_global )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%NextJacCalcTime )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PrevClockTime )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UsrTime1 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UsrTime2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%StrtTime))-1 ) = PACK(InData%StrtTime ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%StrtTime)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SimStrtTime))-1 ) = PACK(InData%SimStrtTime ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%SimStrtTime)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n_TMax_m1 )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%calcJacobian ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL FAST_Packexterninputtype( Re_ExternInput_Buf, Db_ExternInput_Buf, Int_ExternInput_Buf, InData%ExternInput, ErrStat, ErrMsg, OnlySize ) ! ExternInput 
  IF(ALLOCATED(Re_ExternInput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ExternInput_Buf)-1 ) = Re_ExternInput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ExternInput_Buf)
  ENDIF
  IF(ALLOCATED(Db_ExternInput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ExternInput_Buf)-1 ) = Db_ExternInput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ExternInput_Buf)
  ENDIF
  IF(ALLOCATED(Int_ExternInput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ExternInput_Buf)-1 ) = Int_ExternInput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ExternInput_Buf)
  ENDIF
  IF( ALLOCATED(Re_ExternInput_Buf) )  DEALLOCATE(Re_ExternInput_Buf)
  IF( ALLOCATED(Db_ExternInput_Buf) )  DEALLOCATE(Db_ExternInput_Buf)
  IF( ALLOCATED(Int_ExternInput_Buf) ) DEALLOCATE(Int_ExternInput_Buf)
 END SUBROUTINE FAST_PackMiscVarType

 SUBROUTINE FAST_UnPackMiscVarType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_MiscVarType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_ExternInput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ExternInput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ExternInput_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TiLstPrn = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%t_global = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%NextJacCalcTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%PrevClockTime = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UsrTime1 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UsrTime2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%StrtTime,1)))
  mask1 = .TRUE.
  OutData%StrtTime = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%StrtTime))-1 ),mask1,OutData%StrtTime)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%StrtTime)
  ALLOCATE(mask1(SIZE(OutData%SimStrtTime,1)))
  mask1 = .TRUE.
  OutData%SimStrtTime = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SimStrtTime))-1 ),mask1,OutData%SimStrtTime)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%SimStrtTime)
  OutData%n_TMax_m1 = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call FAST_Packexterninputtype to get correctly sized buffers for unpacking
  CALL FAST_Packexterninputtype( Re_ExternInput_Buf, Db_ExternInput_Buf, Int_ExternInput_Buf, OutData%ExternInput, ErrStat, ErrMsg, .TRUE. ) ! ExternInput 
  IF(ALLOCATED(Re_ExternInput_Buf)) THEN
    Re_ExternInput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ExternInput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ExternInput_Buf)
  ENDIF
  IF(ALLOCATED(Db_ExternInput_Buf)) THEN
    Db_ExternInput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ExternInput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ExternInput_Buf)
  ENDIF
  IF(ALLOCATED(Int_ExternInput_Buf)) THEN
    Int_ExternInput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ExternInput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ExternInput_Buf)
  ENDIF
  CALL FAST_UnPackexterninputtype( Re_ExternInput_Buf, Db_ExternInput_Buf, Int_ExternInput_Buf, OutData%ExternInput, ErrStat, ErrMsg ) ! ExternInput 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackMiscVarType

 SUBROUTINE FAST_CopyExternInitType( SrcExternInitTypeData, DstExternInitTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FAST_ExternInitType), INTENT(IN) :: SrcExternInitTypeData
   TYPE(FAST_ExternInitType), INTENT(INOUT) :: DstExternInitTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstExternInitTypeData%Tmax = SrcExternInitTypeData%Tmax
   DstExternInitTypeData%SensorType = SrcExternInitTypeData%SensorType
   DstExternInitTypeData%LidRadialVel = SrcExternInitTypeData%LidRadialVel
 END SUBROUTINE FAST_CopyExternInitType

 SUBROUTINE FAST_DestroyExternInitType( ExternInitTypeData, ErrStat, ErrMsg )
  TYPE(FAST_ExternInitType), INTENT(INOUT) :: ExternInitTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE FAST_DestroyExternInitType

 SUBROUTINE FAST_PackExternInitType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FAST_ExternInitType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! Tmax
  Int_BufSz  = Int_BufSz  + 1  ! SensorType
  Int_BufSz  = Int_BufSz  + 1  ! LidRadialVel
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Tmax )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%SensorType )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%LidRadialVel ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE FAST_PackExternInitType

 SUBROUTINE FAST_UnPackExternInitType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FAST_ExternInitType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Tmax = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%SensorType = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE FAST_UnPackExternInitType

END MODULE FAST_Types
!ENDOFREGISTRYGENERATEDFILE
