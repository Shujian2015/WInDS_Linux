!STARTOFREGISTRYGENERATEDFILE './AeroDyn_Types.f90'
!
! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
! FAST Registry (v2.05.00, 14-Jan-2015)
!*********************************************************************************************************************************
! AeroDyn_Types
!.................................................................................................................................
! This file is part of AeroDyn.
!
! Copyright (C) 2012-2015 National Renewable Energy Laboratory
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE AeroDyn_Types
! This module contains all of the user-defined types needed in AeroDyn. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE IfW_FFWind_Types
USE IfW_HHWind_Types
USE Lidar_Types
USE InflowWind_Types
USE DWM_Types
USE NWTC_Library
IMPLICIT NONE
! =========  Marker  =======
  TYPE, PUBLIC :: Marker
    REAL(ReKi) , DIMENSION(1:3)  :: Position 
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orientation 
    REAL(ReKi) , DIMENSION(1:3)  :: TranslationVel 
    REAL(ReKi) , DIMENSION(1:3)  :: RotationVel 
  END TYPE Marker
! =======================
! =========  AeroConfig  =======
  TYPE, PUBLIC :: AeroConfig
    TYPE(Marker) , DIMENSION(:), ALLOCATABLE  :: Blade 
    TYPE(Marker)  :: Hub 
    TYPE(Marker)  :: RotorFurl 
    TYPE(Marker)  :: Nacelle 
    TYPE(Marker)  :: TailFin 
    TYPE(Marker)  :: Tower 
    TYPE(Marker)  :: SubStructure 
    TYPE(Marker)  :: Foundation 
    REAL(ReKi)  :: BladeLength 
  END TYPE AeroConfig
! =======================
! =========  AirFoil  =======
  TYPE, PUBLIC :: AirFoil
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CD 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CM 
    REAL(ReKi)  :: PMC 
    REAL(ReKi)  :: MulTabLoc 
  END TYPE AirFoil
! =======================
! =========  AirFoilParms  =======
  TYPE, PUBLIC :: AirFoilParms
    INTEGER(IntKi)  :: MaxTable = 20 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTables 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NLift 
    INTEGER(IntKi)  :: NumCL 
    INTEGER(IntKi)  :: NumFoil 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NFoil 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabMet 
    CHARACTER(1024) , DIMENSION(:), ALLOCATABLE  :: FoilNm 
  END TYPE AirFoilParms
! =======================
! =========  Beddoes  =======
  TYPE, PUBLIC :: Beddoes
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE1 
    REAL(ReKi)  :: AN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOL 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: BEDSEP 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: OLDSEP 
    REAL(ReKi)  :: CC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CDO 
    REAL(ReKi)  :: CMI 
    REAL(ReKi)  :: CMQ 
    REAL(ReKi)  :: CN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNA 
    REAL(ReKi)  :: CNCP 
    REAL(ReKi)  :: CNIQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNSL 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP1 
    REAL(ReKi)  :: DS 
    REAL(ReKi)  :: FK 
    REAL(ReKi)  :: FP 
    REAL(ReKi)  :: FPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTB 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTBC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDCNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDTAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDXN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDYN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: XN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: YN 
    LOGICAL  :: SHIFT 
    LOGICAL  :: VOR 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StallAngle 
  END TYPE Beddoes
! =======================
! =========  BeddoesParms  =======
  TYPE, PUBLIC :: BeddoesParms
    REAL(ReKi)  :: AS      ! Speed of sound for mach num calc [-]
    REAL(ReKi)  :: TF      ! Time constant applied to loc of separation pt [-]
    REAL(ReKi)  :: TP      ! Time constant for pressure lag [-]
    REAL(ReKi)  :: TV      ! Time constant for strength and shed of vortex [-]
    REAL(ReKi)  :: TVL      ! Nondim time of transit of vort moving across airfoil surf [-]
  END TYPE BeddoesParms
! =======================
! =========  BladeParms  =======
  TYPE, PUBLIC :: BladeParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: C      ! Chord of each blade element from input file [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DR      ! Span-wise width of elem (len of elem ctred at RELM(i) [-]
    REAL(ReKi)  :: R      ! Rotor radius [-]
    REAL(ReKi)  :: BladeLength      ! Blade Length [-]
    REAL(DbKi)  :: TipRadius 
    REAL(DbKi)  :: HubRadius 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: RTrail 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: RNodes      ! sum P%Blade%DR [-]
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: AeroCen      ! The relative location of aerodynamic center [-]
  END TYPE BladeParms
! =======================
! =========  DynInflow  =======
  TYPE, PUBLIC :: DynInflow
    REAL(ReKi) , DIMENSION(1:6,1:4)  :: dAlph_dt 
    REAL(ReKi) , DIMENSION(3:6,1:4)  :: dBeta_dt 
    REAL(ReKi)  :: DTO 
    REAL(ReKi) , DIMENSION(1:6)  :: old_Alph 
    REAL(ReKi) , DIMENSION(3:6)  :: old_Beta 
    REAL(ReKi)  :: old_LmdM 
    REAL(ReKi)  :: oldKai 
    REAL(ReKi) , DIMENSION(1:6)  :: PhiLqC 
    REAL(ReKi) , DIMENSION(3:6)  :: PhiLqS 
    REAL(ReKi)  :: Pzero 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMC_SAVE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMS_SAVE 
    REAL(ReKi)  :: TipSpeed 
    REAL(ReKi)  :: totalInf 
    REAL(ReKi)  :: Vparam 
    REAL(ReKi)  :: Vtotal 
    REAL(ReKi) , DIMENSION(1:6)  :: xAlpha 
    REAL(ReKi) , DIMENSION(3:6)  :: xBeta 
    REAL(ReKi)  :: xKai 
    REAL(ReKi)  :: XLAMBDA_M 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: xLcos 
    REAL(ReKi) , DIMENSION(3:6,3:6)  :: xLsin 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminusR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MplusR 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: GAMMA 
  END TYPE DynInflow
! =======================
! =========  DynInflowParms  =======
  TYPE, PUBLIC :: DynInflowParms
    INTEGER(IntKi)  :: MAXINFLO = 2 
    REAL(ReKi) , DIMENSION(1:6)  :: xMinv 
  END TYPE DynInflowParms
! =======================
! =========  Element  =======
  TYPE, PUBLIC :: Element
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: A 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ALPHA 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: W2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_A_NS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_AP_NS 
    REAL(ReKi)  :: PITNOW 
  END TYPE Element
! =======================
! =========  ElementParms  =======
  TYPE, PUBLIC :: ElementParms
    INTEGER(IntKi)  :: NELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TWIST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HLCNST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TLCNST 
  END TYPE ElementParms
! =======================
! =========  ElOutParms  =======
  TYPE, PUBLIC :: ElOutParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAP 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ALF 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CDD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CLL 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CNN 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CTT 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFNSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFTSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DynPres 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PITSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ReyNum 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVY 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVZ 
    REAL(ReKi)  :: VXSAV 
    REAL(ReKi)  :: VYSAV 
    REAL(ReKi)  :: VZSAV 
    INTEGER(IntKi)  :: NumWndElOut      ! Number of Blade Elements [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrNum 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    INTEGER(IntKi)  :: NumElOut      ! Number of Blade Elements [-]
  END TYPE ElOutParms
! =======================
! =========  InducedVel  =======
  TYPE, PUBLIC :: InducedVel
    REAL(ReKi)  :: SumInFl = 0 
  END TYPE InducedVel
! =======================
! =========  InducedVelParms  =======
  TYPE, PUBLIC :: InducedVelParms
    REAL(ReKi)  :: AToler      ! Convergence tolerance for induction factor [-]
    REAL(ReKi)  :: EqAIDmult      ! Multiplier for drag term in axial-induction equation. [-]
    LOGICAL  :: EquilDA      ! False unless DB or DA appended to EQUIL [-]
    LOGICAL  :: EquilDT      ! False unless DB or DT appended to EQUIL [-]
    LOGICAL  :: TLoss      ! Tip-loss model (EQUIL only) [PRANDtl, GTECH, or NONE] [-]
    LOGICAL  :: GTech      ! Tip-loss model (EQUIL only) [PRANDtl, GTECH, or NONE] [-]
    LOGICAL  :: HLoss      ! Hub-loss model (EQUIL only) [PRANDtl or NONE] [-]
  END TYPE InducedVelParms
! =======================
! =========  Rotor  =======
  TYPE, PUBLIC :: Rotor
    REAL(ReKi)  :: AVGINFL      ! average induced velocity at the previous time [-]
    REAL(ReKi)  :: CTILT 
    REAL(ReKi)  :: CYaw 
    REAL(ReKi)  :: REVS 
    REAL(ReKi)  :: STILT 
    REAL(ReKi)  :: SYaw 
    REAL(ReKi)  :: TILT 
    REAL(ReKi)  :: YawAng 
    REAL(ReKi)  :: YawVEL 
  END TYPE Rotor
! =======================
! =========  RotorParms  =======
  TYPE, PUBLIC :: RotorParms
    REAL(ReKi)  :: HH 
  END TYPE RotorParms
! =======================
! =========  TwrPropsParms  =======
  TYPE, PUBLIC :: TwrPropsParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrHtFr 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrWid 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrCD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrRe 
    REAL(ReKi) , DIMENSION(1:3)  :: VTwr 
    REAL(ReKi)  :: Tower_Wake_Constant 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTwrCDCol      ! The tower CD column that represents a particular twr ht [-]
    INTEGER(IntKi)  :: NTwrHT      ! The number of tower height rows in the table [-]
    INTEGER(IntKi)  :: NTwrRe      ! The number of tower Re entry rows in the table [-]
    INTEGER(IntKi)  :: NTwrCD      ! The number of tower CD columns in the table [-]
    LOGICAL  :: TwrPotent      ! Tower influence model [-]
    LOGICAL  :: TwrShadow      ! Tower shadow model [-]
    REAL(ReKi)  :: ShadHWid      ! Tower-shadow half width [m]
    REAL(ReKi)  :: TShadC1      ! Tower-shadow constant [-]
    REAL(ReKi)  :: TShadC2      ! Tower-shadow constant [-]
    REAL(ReKi)  :: TwrShad      ! Tower-shadow velocity deficit [-]
    LOGICAL  :: PJM_Version      ! Only true if new tower influence model, by PJM [-]
    CHARACTER(1024)  :: TwrFile      ! Tower data file name [-]
    REAL(ReKi)  :: T_Shad_Refpt      ! Tower-shadow reference point [m]
    LOGICAL  :: CalcTwrAero      ! Flag to tell AeroDyn to calculate drag on the tower [m]
    INTEGER(IntKi)  :: NumTwrNodes      ! Number of ElastoDyn tower nodes.  Tower drag will be computed at those points. [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrNodeWidth      ! The width (diameter) of the tower at the ElastoDyn node locations. [-]
  END TYPE TwrPropsParms
! =======================
! =========  Wind  =======
  TYPE, PUBLIC :: Wind
    REAL(ReKi)  :: ANGFLW 
    REAL(ReKi)  :: CDEL 
    REAL(ReKi)  :: VROTORX 
    REAL(ReKi)  :: VROTORY 
    REAL(ReKi)  :: VROTORZ 
    REAL(ReKi)  :: SDEL 
  END TYPE Wind
! =======================
! =========  WindParms  =======
  TYPE, PUBLIC :: WindParms
    REAL(ReKi)  :: Rho      ! Air density [kg/m&3]
    REAL(ReKi)  :: KinVisc      ! Kinematic air viscosity [(m^2/sec)]
  END TYPE WindParms
! =======================
! =========  BEMParms  =======
  TYPE, PUBLIC :: BEMParms
    REAL(DbKi)  :: TOL      ! Tolerance [-]
    INTEGER(IntKi)  :: MAX_ITER 
    REAL(DbKi)  :: WT      ! Weighting factor on corrections to balance speed with stability [-]
  END TYPE BEMParms
! =======================
! =========  TreeParms  =======
  TYPE, PUBLIC :: TreeParms
    LOGICAL  :: TreeFlag      ! Whether use treecode algorithm [-]
    INTEGER(IntKi)  :: cores 
    REAL(DbKi)  :: theta 
    INTEGER(IntKi)  :: order 
    INTEGER(IntKi)  :: maxparnode 
    REAL(DbKi)  :: dist_tol 
    REAL(DbKi)  :: delta 
    LOGICAL  :: Speedup 
    CHARACTER(4)  :: Freq 
  END TYPE TreeParms
! =======================
! =========  OpenMPParms  =======
  TYPE, PUBLIC :: OpenMPParms
    LOGICAL  :: Accelerate      ! Whether use OpenMP [-]
    INTEGER(IntKi)  :: OpenMPCores 
  END TYPE OpenMPParms
! =======================
! =========  GPUParms  =======
  TYPE, PUBLIC :: GPUParms
    LOGICAL  :: Accelerate      ! Whether use treecode algorithm/GPU [-]
    LOGICAL  :: Speedup 
    LOGICAL  :: GPUFlag      ! Whether use GPU [-]
    INTEGER(IntKi) , DIMENSION(1:3)  :: GPUHW      ! [Thread Count, Number of GPUs, GPU Device Indices] [-]
    CHARACTER(4)  :: GPURUN      ! 'fuln' or .... [-]
    LOGICAL  :: OMP 
  END TYPE GPUParms
! =======================
! =========  TwrParms  =======
  TYPE, PUBLIC :: TwrParms
    LOGICAL  :: TWRFLAG      ! Tower: Include induced velocity from tower effects (true or false) [-]
    INTEGER(IntKi)  :: TWRUPDOWN      ! Tower: Upwind rotor=1, Downwind rotor=2 [-]
    INTEGER(IntKi)  :: TWRMETHOD      ! Tower: Basic potential flow=1, Aerodyn=2 [-]
  END TYPE TwrParms
! =======================
! =========  GroundParms  =======
  TYPE, PUBLIC :: GroundParms
    LOGICAL  :: GroundFLAG      ! Include vortex panels to model ground effects (true or false) [-]
    CHARACTER(5)  :: Method      ! Can be 'IMAGE' or 'PANEL' [-]
    LOGICAL  :: Saved_Geometry      ! Use previously saved ground geometry and influence coeff matrix if 'panel' [-]
    INTEGER(IntKi)  :: Sqrt_Panels      ! Square root of the number of panels (i.e. single dimension of panel matrix) [-]
    INTEGER(IntKi) , DIMENSION(1:4)  :: Extent      ! [xmin xmax ymin ymax] [-]
  END TYPE GroundParms
! =======================
! =========  WindShearParms  =======
  TYPE, PUBLIC :: WindShearParms
    LOGICAL  :: ShearFLAG 
    INTEGER(IntKi)  :: model_type      ! power law = 1, log law = 2, log law with stability = 3 [-]
    REAL(DbKi)  :: z_ref      ! height at which wind.infty is defined [-]
    REAL(DbKi)  :: alpha      ! power law exponent [-]
    REAL(DbKi)  :: z0      ! roughness length [-]
  END TYPE WindShearParms
! =======================
! =========  RLVortexModel  =======
  TYPE, PUBLIC :: RLVortexModel
    REAL(DbKi)  :: ALPHA 
    REAL(DbKi)  :: NU 
    REAL(DbKi)  :: DELTA 
    REAL(DbKi)  :: A1 
  END TYPE RLVortexModel
! =======================
! =========  DSParms  =======
  TYPE, PUBLIC :: DSParms
    LOGICAL  :: DS_Flag 
    LOGICAL  :: relax_tune 
    REAL(DbKi)  :: start_t 
    INTEGER(IntKi)  :: start_n 
    LOGICAL  :: load_data 
    CHARACTER(1024)  :: load_file 
    REAL(DbKi) , DIMENSION(1:4)  :: indicial 
    REAL(DbKi) , DIMENSION(1:4)  :: time_const 
    LOGICAL  :: write_data 
  END TYPE DSParms
! =======================
! =========  FVMParmsTYPE  =======
  TYPE, PUBLIC :: FVMParmsTYPE
    LOGICAL  :: UseWINDS      ! Whether to use winds [-]
    LOGICAL  :: WINDS_Sum      ! Whether to write summary for winds [-]
    CHARACTER(1024)  :: WINDS_dir 
    INTEGER(IntKi)  :: Total_Time 
    INTEGER(IntKi)  :: NB      ! Number of blades [-]
    INTEGER(IntKi)  :: NS      ! Number of spanwise stations [-]
    INTEGER(IntKi)  :: NST      ! Number of spanwise stations + 1 [-]
    INTEGER(IntKi)  :: NT      ! Total timesteps: count from 1 [-]
    INTEGER(IntKi)  :: NTP      ! Number of time steps stored in the arrays. To keep memory reasonable, usually ~3-4. [-]
    INTEGER(IntKi)  :: DT_RATIO      ! DT_WINDS / DT_AERODYN [-]
    REAL(DbKi)  :: DT_WINDS 
    LOGICAL  :: SteadyFlag      ! Whether steady inflow wind [-]
    LOGICAL  :: WakeFLAG 
    LOGICAL  :: Roll      ! Whether to apply induction to all wake nodes [-]
    INTEGER(IntKi)  :: RollDist 
    INTEGER(IntKi)  :: NTW_total 
    INTEGER(IntKi)  :: WakeDist 
    INTEGER(IntKi)  :: WakeNum 
    REAL(DbKi)  :: AveSpeed 
    LOGICAL  :: uindpast 
    LOGICAL  :: ViscFLAG      ! Whether viscous model for filaments [-]
    INTEGER(IntKi)  :: VISC      ! Index of Vatistas viscous model [-]
    REAL(DbKi)  :: DELTA      ! Smoothing parameter when no viscous model for filaments [-]
    CHARACTER(3)  :: INTEG      ! Numerical integration scheme [-]
    REAL(DbKi)  :: TOL      ! Tolerance value for convergence of numerical methods [-]
    REAL(DbKi)  :: CO      ! Distance from wake nodes beyond which influence is negligible (useful??) [-]
    REAL(DbKi)  :: RELAX      ! Relaxation value for fixed-point iteration [-]
    INTEGER(IntKi)  :: MAXITER      ! Maximum number of iterations for Kutta-Joukowski theorem [-]
    LOGICAL  :: extrap_wake      ! Use quadratic extrapolation to guess next bound vorticity value, otherwise use previous value as initial guess [-]
    LOGICAL  :: KJ_output      ! Whether to ouput the KJ iteration number [-]
    LOGICAL  :: element_output      ! Whether to ouput the blade elements' aoa [-]
    CHARACTER(15)  :: CURRENT_TIME      ! Date and time of code execution [-]
    LOGICAL  :: AnimFLAG      ! If true, will generate animation of wake evolution [-]
    CHARACTER(1024)  :: AnimRootDIR      ! Root directory for paraview visualizations [-]
    TYPE(BEMParms)  :: BEM_Parms 
    TYPE(OpenMPParms)  :: OpenMP_Parms 
    TYPE(TreeParms)  :: Tree_Parms 
    TYPE(TwrParms)  :: Twr_Parms      ! Variables for tower shadow [-]
    TYPE(GroundParms)  :: Ground_Parms      ! Variables for ground effects inclusion [-]
    TYPE(WindShearParms)  :: Shear_Parms 
    TYPE(RLVortexModel)  :: RL_Model      ! Constants associated with Ramasamy-Leishman vortex model [-]
    TYPE(DSParms)  :: DS_Parms      ! Dynamic Stall model [-]
    REAL(DbKi)  :: RHO      ! Atmospheric density (Standard at MSL) [-]
    REAL(DbKi)  :: Gravity 
    REAL(DbKi)  :: TURBINE_ShftTilt 
  END TYPE FVMParmsTYPE
! =======================
! =========  Ground_other  =======
  TYPE, PUBLIC :: Ground_other
    INTEGER(IntKi)  :: Np      ! square root of number of panels [-]
    INTEGER(IntKi)  :: x_min 
    INTEGER(IntKi)  :: x_max 
    REAL(DbKi)  :: dx 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: xp 
    INTEGER(IntKi)  :: y_min 
    INTEGER(IntKi)  :: y_max 
    REAL(DbKi)  :: dy 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: yp 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: zp 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: xp_mesh 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: yp_mesh 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: zp_mesh 
    REAL(DbKi)  :: co 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: Gamma 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: p 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: b 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: n_vec 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: P_source 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: gamma_grid 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: rc_grid 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: grid_righttop 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: grid_rightbottom 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: grid_leftbottom 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: grid_lefttop 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_top_main 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_right_main 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_bottom_main 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_left_main 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_top_kj 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_right_kj 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_bottom_kj 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V_ind_left_kj 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: V_n 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: Vind_mirtmp_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: Vind_mirtmp_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VindB_mirtmp_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VindB_mirtmp_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: MIRROR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_MIRROR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: GAMMA_SHED_MIRROR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: GAMMA_TRAIL_MIRROR 
  END TYPE Ground_other
! =======================
! =========  KJ_iter  =======
  TYPE, PUBLIC :: KJ_iter
    REAL(DbKi)  :: RELAX 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: DG 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: GAMMA1 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: CL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: CD 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: CM 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_ROT 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_TOT 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: U 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: V 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: W 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: Vinf 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: Vtot 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: AOA 
  END TYPE KJ_iter
! =======================
! =========  DS_other  =======
  TYPE, PUBLIC :: DS_other
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_previous_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_current_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_previous_sigma1 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_current_sigma1 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_previous_sigma3 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_current_sigma3 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_X1 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_X1 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_X2 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_X2 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_K_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_K_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_dK_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_dK_alpha 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_K_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_K_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_dK_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_dK_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_ddK_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_ddK_q 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_previous_C_p_n 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: attached_current_C_p_n 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_previous_D_p 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_current_D_p 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_previous_D_f 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_current_D_f 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_previous_f_prime 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_current_f_prime 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_previous_f_2prime 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: TEsep_current_f_2prime 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_previous_tau_v 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_current_tau_v 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_previous_C_v_n 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_current_C_v_n 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_previous_C_v 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_current_C_v 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: global_sigma2 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_vortex_shed_start 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: LEsep_seperating 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: global_ca_mdl_change 
    INTEGER(IntKi) , DIMENSION(:,:,:), ALLOCATABLE  :: global_ca_mdl 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: global_ca_mdl_over_write 
  END TYPE DS_other
! =======================
! =========  airfoils_LB  =======
  TYPE, PUBLIC :: airfoils_LB
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: A1 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: A2 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: b1 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: b2 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Tp 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Tf 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Tv 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Tvl 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: cn 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: ca 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Cn_alpha 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: Alpha_0 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: C_d_0 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: C_m_0 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: C_n_0 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: alpha_1 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: alpha_2 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: a 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: S 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: c 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: recovery_factor 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: C_n_1 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: C_n_2 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: ca_K1 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: aoa_KHn 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: aoa_KHp 
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: pp_size 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: pp_f_breaks 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: pp_f_coefs 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: pp_K_Ca_breaks 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: pp_K_Ca_coefs 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: pp_K_Cn_breaks 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: pp_K_Cn_coefs 
    REAL(DbKi) , DIMENSION(:,:), ALLOCATABLE  :: pp_K_Cm_breaks 
    REAL(DbKi) , DIMENSION(:,:,:), ALLOCATABLE  :: pp_K_Cm_coefs 
  END TYPE airfoils_LB
! =======================
! =========  Time_other  =======
  TYPE, PUBLIC :: Time_other
    REAL(DbKi)  :: Time_Total 
    REAL(DbKi)  :: Time_biotsavart 
    REAL(DbKi)  :: Time_biotsavart_Acce 
  END TYPE Time_other
! =======================
! =========  FVM_OtherStateTYPE  =======
  TYPE, PUBLIC :: FVM_OtherStateTYPE
    CHARACTER(1024)  :: FullDIR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_AEROCENT 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_LEAD 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_BOUND 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_COLLOC 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_QUARTER 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_END 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_NODES_BXN 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_NODES_BYN 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: POS_NODES_BZN 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_CL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_CD 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_AOA 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_PHI 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_A 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_AAP 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_AP 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_TSR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_DCZ 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_DCX 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PERF_CM 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_AEROCENT 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_BOUND 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_BLADE 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_DOMAIN 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_DOMAIN_RK 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_RK 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_GROUND 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_GROUND 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_MIRROR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_MIRROR 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_TRAIL_pre 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UINDB_SHED_pre 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_SHED_GROUND_P 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_TRAIL_GROUND_P 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_GROUND_P 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: VEL_UIND_TOWER 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_DOMAIN 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RE_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RE_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RC_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RC_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_LENGTH_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_LENGTH_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RC_EFF_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_RC_EFF_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_GAMMA_SHED 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WAKE_GAMMA_TRAIL 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WIND_INFTY 
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: WIND_INFTYM 
    REAL(DbKi) , DIMENSION(1:3)  :: Wind_Mean      ! If steady inflow, the mean wind speed [-]
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: StoredForces      ! Aerodynamic forces [-]
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: StoredMoments      ! Aerodynamic Moments [-]
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PreviousForces      ! Aerodynamic forces [-]
    REAL(DbKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PreviousMoments      ! Aerodynamic Moments [-]
    REAL(DbKi)  :: TipSpdRat 
    REAL(DbKi)  :: AzimuthAngle 
    REAL(DbKi) , DIMENSION(:), ALLOCATABLE  :: WAKE_R0 
    INTEGER(IntKi)  :: RK_counter 
    TYPE(Ground_other)  :: Ground 
    TYPE(KJ_iter)  :: KJ 
    TYPE(DS_other)  :: DS 
    TYPE(airfoils_LB)  :: airfoils_LB 
    TYPE(Time_other)  :: TIME      ! timer for debug or research [-]
    INTEGER(IntKi)  :: NTW 
    INTEGER(IntKi)  :: ntroll 
    INTEGER(IntKi) , DIMENSION(1:8)  :: StrtTime 
    REAL(DbKi)  :: UsrTime1 
    REAL(DbKi)  :: UsrTime2 
    INTEGER(IntKi) , DIMENSION(1:8)  :: SimStrtTime 
    REAL(DbKi)  :: ZTime      ! The current simulation time (actual or time of prediction) [-]
  END TYPE FVM_OtherStateTYPE
! =======================
! =========  PositionType  =======
  TYPE, PUBLIC :: PositionType
    REAL(ReKi) , DIMENSION(1:3)  :: Pos      ! X,Y,Z coordinate of a point [-]
  END TYPE PositionType
! =======================
! =========  OrientationType  =======
  TYPE, PUBLIC :: OrientationType
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orient      ! Direction Cosine Matrix [-]
  END TYPE OrientationType
! =======================
! =========  AD_InitInputType  =======
  TYPE, PUBLIC :: AD_InitInputType
    CHARACTER(1024)  :: Title      ! Title [-]
    CHARACTER(1024)  :: OutRootName 
    CHARACTER(1024)  :: ADFileName      ! AeroDyn file name [-]
    CHARACTER(1024)  :: WindFileName      ! Inflow init file name [-]
    LOGICAL  :: WrSumFile      ! T/F: Write an AeroDyn summary [-]
    INTEGER(IntKi)  :: NumBl      ! Number of Blades [-]
    REAL(ReKi)  :: BladeLength      ! Blade Length [-]
    LOGICAL  :: LinearizeFlag 
    LOGICAL  :: UseDWM = .FALSE.      ! flag to determine if DWM module should be used [-]
    TYPE(AeroConfig)  :: TurbineComponents 
    INTEGER(IntKi)  :: NumTwrNodes      ! Number of ElastoDyn tower nodes.  Tower drag will be computed at those points. [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrNodeLocs      ! Location of ElastoDyn tower nodes with respect to the inertial origin. [-]
    TYPE(IfW_InitInputType)  :: IfW_InitInputs 
    TYPE(DWM_InitInputType)  :: DWM_InitInputs 
  END TYPE AD_InitInputType
! =======================
! =========  AD_InitOutputType  =======
  TYPE, PUBLIC :: AD_InitOutputType
    TYPE(ProgDesc)  :: Ver      ! version information [-]
    TYPE(IfW_InitOutputType)  :: IfW_InitOutput 
    TYPE(DWM_InitOutputType)  :: DWM_InitOutput 
  END TYPE AD_InitOutputType
! =======================
! =========  AD_ContinuousStateType  =======
  TYPE, PUBLIC :: AD_ContinuousStateType
    TYPE(IfW_ContinuousStateType)  :: IfW_ContStates 
    TYPE(DWM_ContinuousStateType)  :: DWM_ContStates 
  END TYPE AD_ContinuousStateType
! =======================
! =========  AD_DiscreteStateType  =======
  TYPE, PUBLIC :: AD_DiscreteStateType
    TYPE(IfW_DiscreteStateType)  :: IfW_DiscStates 
    TYPE(DWM_DiscreteStateType)  :: DWM_DiscStates 
  END TYPE AD_DiscreteStateType
! =======================
! =========  AD_ConstraintStateType  =======
  TYPE, PUBLIC :: AD_ConstraintStateType
    TYPE(IfW_ConstraintStateType)  :: IfW_ConstrStates 
    TYPE(DWM_ConstraintStateType)  :: DWM_ConstrStates 
  END TYPE AD_ConstraintStateType
! =======================
! =========  AD_OtherStateType  =======
  TYPE, PUBLIC :: AD_OtherStateType
    REAL(DbKi)  :: DT      ! Time step [seconds]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    REAL(DbKi)  :: OldTime 
    REAL(ReKi)  :: HubLoss = 1 
    REAL(ReKi)  :: Loss = 1 
    REAL(ReKi)  :: TipLoss = 1 
    REAL(ReKi)  :: TLpt7 
    LOGICAL  :: FirstPassGTL = .TRUE. 
    LOGICAL  :: SuperSonic = .FALSE. 
    LOGICAL  :: AFLAGVinderr = .FALSE. 
    LOGICAL  :: AFLAGTwrInflu = .FALSE. 
    LOGICAL  :: OnePassDynDbg = .TRUE. 
    LOGICAL  :: NoLoadsCalculated = .TRUE. 
    INTEGER(IntKi)  :: NERRORS = 0 
    TYPE(IfW_OtherStateType)  :: IfW_OtherStates 
    TYPE(DWM_OtherStateType)  :: DWM_OtherStates 
    TYPE(AirFoil)  :: AirFoil 
    TYPE(Beddoes)  :: Beddoes 
    TYPE(DynInflow)  :: DynInflow 
    TYPE(Element)  :: Element 
    TYPE(Rotor)  :: Rotor 
    TYPE(Wind)  :: Wind 
    TYPE(InducedVel)  :: InducedVel 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredForces 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredMoments 
    LOGICAL  :: FirstWarn      ! If it's the first warning about AeroDyn not recalculating loads [-]
    TYPE(ElOutParms)  :: ElOut 
    LOGICAL  :: Skew 
    LOGICAL  :: DynInit      ! FALSE=EQUIL, TRUE=DYNIN [-]
    TYPE(IfW_InputType)  :: IfW_Inputs      ! inputs to IfW module; set here so we don't have to recreate it every time [-]
    TYPE(DWM_InputType)  :: DWM_Inputs 
    INTEGER(IntKi)  :: Aerodyn_Timestep 
    INTEGER(IntKi)  :: WINDS_Timestep      ! Current timestep (counts from 1, while FAST counts from 0)   [-]
    TYPE(FVM_OtherStateTYPE)  :: FVM_Other 
  END TYPE AD_OtherStateType
! =======================
! =========  AD_ParameterType  =======
  TYPE, PUBLIC :: AD_ParameterType
    CHARACTER(1024)  :: Title      ! Title [-]
    CHARACTER(1024)  :: WindFileName      ! Inflow init file name [-]
    LOGICAL  :: SIUnit 
    LOGICAL  :: Echo = .FALSE. 
    LOGICAL  :: MultiTab 
    LOGICAL  :: LinearizeFlag 
    LOGICAL  :: OutputPlottingInfo = .FALSE. 
    LOGICAL  :: Initialized = .FALSE. 
    LOGICAL  :: UseDWM = .FALSE.      ! flag to determine if DWM module should be used [-]
    REAL(ReKi)  :: TwoPiNB      ! 2*pi/num of blades [-]
    INTEGER(IntKi)  :: NumBl      ! Number of Blades [-]
    INTEGER(IntKi)  :: NBlInpSt      ! Number of Blade Input Stations [-]
    LOGICAL  :: ElemPrn 
    LOGICAL  :: DStall      ! FALSE=Steady, TRUE=BEDDOES [-]
    LOGICAL  :: PMoment      ! FALSE=NO_CM, TRUE=USE_CM [-]
    LOGICAL  :: Reynolds 
    LOGICAL  :: DynInfl      ! FALSE=EQUIL, TRUE=DYNIN [-]
    LOGICAL  :: Wake      ! False unless WAKE or SWIRL [-]
    LOGICAL  :: Swirl      ! False unless WAKE or SWIRL [-]
    REAL(DbKi)  :: DtAero      ! Time interval for aerodynamic calculations [-]
    REAL(ReKi)  :: HubRad      ! Hub radius [m]
    INTEGER(IntKi)  :: UnEc = -1 
    INTEGER(IntKi)  :: UnElem = -1 
    INTEGER(IntKi)  :: UnWndOut = -1 
    INTEGER(IntKi)  :: MAXICOUNT = 1000 
    LOGICAL  :: WrOptFile = .TRUE.      ! T/F: Write an AeroDyn summary [-]
    INTEGER(IntKi)  :: DEFAULT_Wind = -1 
    TYPE(AirFoilParms)  :: AirFoil 
    TYPE(BladeParms)  :: Blade 
    TYPE(BeddoesParms)  :: Beddoes 
    TYPE(DynInflowParms)  :: DynInflow 
    TYPE(ElementParms)  :: Element 
    TYPE(TwrPropsParms)  :: TwrProps 
    TYPE(InducedVelParms)  :: InducedVel 
    TYPE(WindParms)  :: Wind 
    TYPE(RotorParms)  :: Rotor 
    TYPE(IfW_ParameterType)  :: IfW_Params 
    TYPE(DWM_ParameterType)  :: DWM_Params 
    TYPE(FVMParmsTYPE)  :: FVM 
    INTEGER(IntKi)  :: n_TMax_m1      ! The time step of TMax - dt (the end time of the simulation) [-]
  END TYPE AD_ParameterType
! =======================
! =========  AD_InputType  =======
  TYPE, PUBLIC :: AD_InputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: InputMarkers      ! Input Forces and positions for the blades (mesh) for each blade [-]
    TYPE(MeshType)  :: Twr_InputMarkers      ! Input Forces and positions for the tower (mesh) [-]
    TYPE(AeroConfig)  :: TurbineComponents      ! Current locations of components [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabLoc 
  END TYPE AD_InputType
! =======================
! =========  AD_OutputType  =======
  TYPE, PUBLIC :: AD_OutputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: OutputLoads      ! Output Loads (mesh) for each blade [-]
    TYPE(MeshType)  :: Twr_OutputLoads      ! Tower Output Loads (mesh) [-]
    TYPE(IfW_OutputType)  :: IfW_Outputs 
    TYPE(DWM_OutputType)  :: DWM_Outputs 
  END TYPE AD_OutputType
! =======================
CONTAINS
 SUBROUTINE AD_CopyMarker( SrcMarkerData, DstMarkerData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Marker), INTENT(IN) :: SrcMarkerData
   TYPE(Marker), INTENT(INOUT) :: DstMarkerData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstMarkerData%Position = SrcMarkerData%Position
   DstMarkerData%Orientation = SrcMarkerData%Orientation
   DstMarkerData%TranslationVel = SrcMarkerData%TranslationVel
   DstMarkerData%RotationVel = SrcMarkerData%RotationVel
 END SUBROUTINE AD_CopyMarker

 SUBROUTINE AD_DestroyMarker( MarkerData, ErrStat, ErrMsg )
  TYPE(Marker), INTENT(INOUT) :: MarkerData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyMarker

 SUBROUTINE AD_PackMarker( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Marker),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Position )  ! Position 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orientation )  ! Orientation 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TranslationVel )  ! TranslationVel 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RotationVel )  ! RotationVel 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Position))-1 ) =  PACK(InData%Position ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Position)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orientation))-1 ) =  PACK(InData%Orientation ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orientation)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TranslationVel))-1 ) =  PACK(InData%TranslationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TranslationVel)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RotationVel))-1 ) =  PACK(InData%RotationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RotationVel)
 END SUBROUTINE AD_PackMarker

 SUBROUTINE AD_UnPackMarker( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Marker), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Position,1)))
  mask1 = .TRUE.
  OutData%Position = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Position))-1 ),mask1,OutData%Position)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Position)
  ALLOCATE(mask2(SIZE(OutData%Orientation,1),SIZE(OutData%Orientation,2)))
  mask2 = .TRUE.
  OutData%Orientation = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orientation))-1 ),mask2,OutData%Orientation)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orientation)
  ALLOCATE(mask1(SIZE(OutData%TranslationVel,1)))
  mask1 = .TRUE.
  OutData%TranslationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TranslationVel))-1 ),mask1,OutData%TranslationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TranslationVel)
  ALLOCATE(mask1(SIZE(OutData%RotationVel,1)))
  mask1 = .TRUE.
  OutData%RotationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RotationVel))-1 ),mask1,OutData%RotationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RotationVel)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackMarker

 SUBROUTINE AD_CopyAeroConfig( SrcAeroConfigData, DstAeroConfigData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AeroConfig), INTENT(IN) :: SrcAeroConfigData
   TYPE(AeroConfig), INTENT(INOUT) :: DstAeroConfigData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcAeroConfigData%Blade)) THEN
   i1_l = LBOUND(SrcAeroConfigData%Blade,1)
   i1_u = UBOUND(SrcAeroConfigData%Blade,1)
   IF (.NOT. ALLOCATED(DstAeroConfigData%Blade)) THEN 
      ALLOCATE(DstAeroConfigData%Blade(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAeroConfigData%Blade.', ErrStat, ErrMsg,'AD_CopyAeroConfig')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcAeroConfigData%Blade,1), UBOUND(SrcAeroConfigData%Blade,1)
      CALL AD_Copymarker( SrcAeroConfigData%Blade(i1), DstAeroConfigData%Blade(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Blade(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
      CALL AD_Copymarker( SrcAeroConfigData%Hub, DstAeroConfigData%Hub, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Hub')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%RotorFurl, DstAeroConfigData%RotorFurl, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:RotorFurl')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Nacelle, DstAeroConfigData%Nacelle, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Nacelle')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%TailFin, DstAeroConfigData%TailFin, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:TailFin')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Tower, DstAeroConfigData%Tower, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Tower')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%SubStructure, DstAeroConfigData%SubStructure, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:SubStructure')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Foundation, DstAeroConfigData%Foundation, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Foundation')
         IF (ErrStat>=AbortErrLev) RETURN
   DstAeroConfigData%BladeLength = SrcAeroConfigData%BladeLength
 END SUBROUTINE AD_CopyAeroConfig

 SUBROUTINE AD_DestroyAeroConfig( AeroConfigData, ErrStat, ErrMsg )
  TYPE(AeroConfig), INTENT(INOUT) :: AeroConfigData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AeroConfigData%Blade)) THEN
DO i1 = LBOUND(AeroConfigData%Blade,1), UBOUND(AeroConfigData%Blade,1)
  CALL AD_Destroymarker( AeroConfigData%Blade(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(AeroConfigData%Blade)
ENDIF
  CALL AD_Destroymarker( AeroConfigData%Hub, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%RotorFurl, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Nacelle, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%TailFin, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Tower, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%SubStructure, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Foundation, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyAeroConfig

 SUBROUTINE AD_PackAeroConfig( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AeroConfig),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Foundation_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Db_Hub_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Int_Hub_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Hub_Buf ) ! Hub
  IF(ALLOCATED(Re_Hub_Buf))  DEALLOCATE(Re_Hub_Buf)
  IF(ALLOCATED(Db_Hub_Buf))  DEALLOCATE(Db_Hub_Buf)
  IF(ALLOCATED(Int_Hub_Buf)) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Db_RotorFurl_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Int_RotorFurl_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RotorFurl_Buf ) ! RotorFurl
  IF(ALLOCATED(Re_RotorFurl_Buf))  DEALLOCATE(Re_RotorFurl_Buf)
  IF(ALLOCATED(Db_RotorFurl_Buf))  DEALLOCATE(Db_RotorFurl_Buf)
  IF(ALLOCATED(Int_RotorFurl_Buf)) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Db_Nacelle_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Int_Nacelle_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Nacelle_Buf ) ! Nacelle
  IF(ALLOCATED(Re_Nacelle_Buf))  DEALLOCATE(Re_Nacelle_Buf)
  IF(ALLOCATED(Db_Nacelle_Buf))  DEALLOCATE(Db_Nacelle_Buf)
  IF(ALLOCATED(Int_Nacelle_Buf)) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Db_TailFin_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Int_TailFin_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TailFin_Buf ) ! TailFin
  IF(ALLOCATED(Re_TailFin_Buf))  DEALLOCATE(Re_TailFin_Buf)
  IF(ALLOCATED(Db_TailFin_Buf))  DEALLOCATE(Db_TailFin_Buf)
  IF(ALLOCATED(Int_TailFin_Buf)) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Db_Tower_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Int_Tower_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Tower_Buf ) ! Tower
  IF(ALLOCATED(Re_Tower_Buf))  DEALLOCATE(Re_Tower_Buf)
  IF(ALLOCATED(Db_Tower_Buf))  DEALLOCATE(Db_Tower_Buf)
  IF(ALLOCATED(Int_Tower_Buf)) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Db_SubStructure_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Int_SubStructure_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SubStructure_Buf ) ! SubStructure
  IF(ALLOCATED(Re_SubStructure_Buf))  DEALLOCATE(Re_SubStructure_Buf)
  IF(ALLOCATED(Db_SubStructure_Buf))  DEALLOCATE(Db_SubStructure_Buf)
  IF(ALLOCATED(Int_SubStructure_Buf)) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Db_Foundation_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Int_Foundation_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Foundation_Buf ) ! Foundation
  IF(ALLOCATED(Re_Foundation_Buf))  DEALLOCATE(Re_Foundation_Buf)
  IF(ALLOCATED(Db_Foundation_Buf))  DEALLOCATE(Db_Foundation_Buf)
  IF(ALLOCATED(Int_Foundation_Buf)) DEALLOCATE(Int_Foundation_Buf)
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, OnlySize ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 ) = Re_Hub_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 ) = Db_Hub_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 ) = Int_Hub_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  IF( ALLOCATED(Re_Hub_Buf) )  DEALLOCATE(Re_Hub_Buf)
  IF( ALLOCATED(Db_Hub_Buf) )  DEALLOCATE(Db_Hub_Buf)
  IF( ALLOCATED(Int_Hub_Buf) ) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, OnlySize ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 ) = Re_RotorFurl_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 ) = Db_RotorFurl_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 ) = Int_RotorFurl_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  IF( ALLOCATED(Re_RotorFurl_Buf) )  DEALLOCATE(Re_RotorFurl_Buf)
  IF( ALLOCATED(Db_RotorFurl_Buf) )  DEALLOCATE(Db_RotorFurl_Buf)
  IF( ALLOCATED(Int_RotorFurl_Buf) ) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, OnlySize ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 ) = Re_Nacelle_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 ) = Db_Nacelle_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 ) = Int_Nacelle_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  IF( ALLOCATED(Re_Nacelle_Buf) )  DEALLOCATE(Re_Nacelle_Buf)
  IF( ALLOCATED(Db_Nacelle_Buf) )  DEALLOCATE(Db_Nacelle_Buf)
  IF( ALLOCATED(Int_Nacelle_Buf) ) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, OnlySize ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 ) = Re_TailFin_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 ) = Db_TailFin_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 ) = Int_TailFin_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  IF( ALLOCATED(Re_TailFin_Buf) )  DEALLOCATE(Re_TailFin_Buf)
  IF( ALLOCATED(Db_TailFin_Buf) )  DEALLOCATE(Db_TailFin_Buf)
  IF( ALLOCATED(Int_TailFin_Buf) ) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, OnlySize ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 ) = Re_Tower_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 ) = Db_Tower_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 ) = Int_Tower_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  IF( ALLOCATED(Re_Tower_Buf) )  DEALLOCATE(Re_Tower_Buf)
  IF( ALLOCATED(Db_Tower_Buf) )  DEALLOCATE(Db_Tower_Buf)
  IF( ALLOCATED(Int_Tower_Buf) ) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, OnlySize ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 ) = Re_SubStructure_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 ) = Db_SubStructure_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 ) = Int_SubStructure_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  IF( ALLOCATED(Re_SubStructure_Buf) )  DEALLOCATE(Re_SubStructure_Buf)
  IF( ALLOCATED(Db_SubStructure_Buf) )  DEALLOCATE(Db_SubStructure_Buf)
  IF( ALLOCATED(Int_SubStructure_Buf) ) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, OnlySize ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 ) = Re_Foundation_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 ) = Db_Foundation_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 ) = Int_Foundation_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  IF( ALLOCATED(Re_Foundation_Buf) )  DEALLOCATE(Re_Foundation_Buf)
  IF( ALLOCATED(Db_Foundation_Buf) )  DEALLOCATE(Db_Foundation_Buf)
  IF( ALLOCATED(Int_Foundation_Buf) ) DEALLOCATE(Int_Foundation_Buf)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackAeroConfig

 SUBROUTINE AD_UnPackAeroConfig( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AeroConfig), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Foundation_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%Blade,1), UBOUND(OutData%Blade,1)
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg ) ! Blade 
ENDDO
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    Re_Hub_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    Db_Hub_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    Int_Hub_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg ) ! Hub 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    Re_RotorFurl_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    Db_RotorFurl_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    Int_RotorFurl_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg ) ! RotorFurl 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    Re_Nacelle_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    Db_Nacelle_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    Int_Nacelle_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg ) ! Nacelle 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    Re_TailFin_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    Db_TailFin_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    Int_TailFin_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg ) ! TailFin 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    Re_Tower_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    Db_Tower_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    Int_Tower_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg ) ! Tower 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    Re_SubStructure_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    Db_SubStructure_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    Int_SubStructure_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg ) ! SubStructure 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    Re_Foundation_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    Db_Foundation_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    Int_Foundation_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg ) ! Foundation 
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAeroConfig

 SUBROUTINE AD_CopyAirFoil( SrcAirFoilData, DstAirFoilData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AirFoil), INTENT(IN) :: SrcAirFoilData
   TYPE(AirFoil), INTENT(INOUT) :: DstAirFoilData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcAirFoilData%AL)) THEN
   i1_l = LBOUND(SrcAirFoilData%AL,1)
   i1_u = UBOUND(SrcAirFoilData%AL,1)
   i2_l = LBOUND(SrcAirFoilData%AL,2)
   i2_u = UBOUND(SrcAirFoilData%AL,2)
   IF (.NOT. ALLOCATED(DstAirFoilData%AL)) THEN 
      ALLOCATE(DstAirFoilData%AL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%AL.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%AL = SrcAirFoilData%AL
ENDIF
IF (ALLOCATED(SrcAirFoilData%CD)) THEN
   i1_l = LBOUND(SrcAirFoilData%CD,1)
   i1_u = UBOUND(SrcAirFoilData%CD,1)
   i2_l = LBOUND(SrcAirFoilData%CD,2)
   i2_u = UBOUND(SrcAirFoilData%CD,2)
   i3_l = LBOUND(SrcAirFoilData%CD,3)
   i3_u = UBOUND(SrcAirFoilData%CD,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CD)) THEN 
      ALLOCATE(DstAirFoilData%CD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CD.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CD = SrcAirFoilData%CD
ENDIF
IF (ALLOCATED(SrcAirFoilData%CL)) THEN
   i1_l = LBOUND(SrcAirFoilData%CL,1)
   i1_u = UBOUND(SrcAirFoilData%CL,1)
   i2_l = LBOUND(SrcAirFoilData%CL,2)
   i2_u = UBOUND(SrcAirFoilData%CL,2)
   i3_l = LBOUND(SrcAirFoilData%CL,3)
   i3_u = UBOUND(SrcAirFoilData%CL,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CL)) THEN 
      ALLOCATE(DstAirFoilData%CL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CL.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CL = SrcAirFoilData%CL
ENDIF
IF (ALLOCATED(SrcAirFoilData%CM)) THEN
   i1_l = LBOUND(SrcAirFoilData%CM,1)
   i1_u = UBOUND(SrcAirFoilData%CM,1)
   i2_l = LBOUND(SrcAirFoilData%CM,2)
   i2_u = UBOUND(SrcAirFoilData%CM,2)
   i3_l = LBOUND(SrcAirFoilData%CM,3)
   i3_u = UBOUND(SrcAirFoilData%CM,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CM)) THEN 
      ALLOCATE(DstAirFoilData%CM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CM.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CM = SrcAirFoilData%CM
ENDIF
   DstAirFoilData%PMC = SrcAirFoilData%PMC
   DstAirFoilData%MulTabLoc = SrcAirFoilData%MulTabLoc
 END SUBROUTINE AD_CopyAirFoil

 SUBROUTINE AD_DestroyAirFoil( AirFoilData, ErrStat, ErrMsg )
  TYPE(AirFoil), INTENT(INOUT) :: AirFoilData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AirFoilData%AL)) THEN
   DEALLOCATE(AirFoilData%AL)
ENDIF
IF (ALLOCATED(AirFoilData%CD)) THEN
   DEALLOCATE(AirFoilData%CD)
ENDIF
IF (ALLOCATED(AirFoilData%CL)) THEN
   DEALLOCATE(AirFoilData%CL)
ENDIF
IF (ALLOCATED(AirFoilData%CM)) THEN
   DEALLOCATE(AirFoilData%CM)
ENDIF
 END SUBROUTINE AD_DestroyAirFoil

 SUBROUTINE AD_PackAirFoil( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AirFoil),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%AL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AL )  ! AL 
  IF ( ALLOCATED(InData%CD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CD )  ! CD 
  IF ( ALLOCATED(InData%CL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CL )  ! CL 
  IF ( ALLOCATED(InData%CM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CM )  ! CM 
  Re_BufSz   = Re_BufSz   + 1  ! PMC
  Re_BufSz   = Re_BufSz   + 1  ! MulTabLoc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AL))-1 ) =  PACK(InData%AL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AL)
  ENDIF
  IF ( ALLOCATED(InData%CD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CD))-1 ) =  PACK(InData%CD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CD)
  ENDIF
  IF ( ALLOCATED(InData%CL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CL))-1 ) =  PACK(InData%CL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CL)
  ENDIF
  IF ( ALLOCATED(InData%CM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CM))-1 ) =  PACK(InData%CM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CM)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PMC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%MulTabLoc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackAirFoil

 SUBROUTINE AD_UnPackAirFoil( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AirFoil), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AL,1),SIZE(OutData%AL,2)))
  mask2 = .TRUE.
    OutData%AL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AL))-1 ),mask2,OutData%AL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AL)
  ENDIF
  IF ( ALLOCATED(OutData%CD) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CD,1),SIZE(OutData%CD,2),SIZE(OutData%CD,3)))
  mask3 = .TRUE.
    OutData%CD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CD))-1 ),mask3,OutData%CD)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CD)
  ENDIF
  IF ( ALLOCATED(OutData%CL) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CL,1),SIZE(OutData%CL,2),SIZE(OutData%CL,3)))
  mask3 = .TRUE.
    OutData%CL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CL))-1 ),mask3,OutData%CL)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CL)
  ENDIF
  IF ( ALLOCATED(OutData%CM) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CM,1),SIZE(OutData%CM,2),SIZE(OutData%CM,3)))
  mask3 = .TRUE.
    OutData%CM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CM))-1 ),mask3,OutData%CM)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CM)
  ENDIF
  OutData%PMC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%MulTabLoc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAirFoil

 SUBROUTINE AD_CopyAirFoilParms( SrcAirFoilParmsData, DstAirFoilParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AirFoilParms), INTENT(IN) :: SrcAirFoilParmsData
   TYPE(AirFoilParms), INTENT(INOUT) :: DstAirFoilParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstAirFoilParmsData%MaxTable = SrcAirFoilParmsData%MaxTable
IF (ALLOCATED(SrcAirFoilParmsData%NTables)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NTables,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NTables,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NTables)) THEN 
      ALLOCATE(DstAirFoilParmsData%NTables(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NTables.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NTables = SrcAirFoilParmsData%NTables
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%NLift)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NLift,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NLift,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NLift)) THEN 
      ALLOCATE(DstAirFoilParmsData%NLift(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NLift.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NLift = SrcAirFoilParmsData%NLift
ENDIF
   DstAirFoilParmsData%NumCL = SrcAirFoilParmsData%NumCL
   DstAirFoilParmsData%NumFoil = SrcAirFoilParmsData%NumFoil
IF (ALLOCATED(SrcAirFoilParmsData%NFoil)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NFoil,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NFoil,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NFoil)) THEN 
      ALLOCATE(DstAirFoilParmsData%NFoil(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NFoil.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NFoil = SrcAirFoilParmsData%NFoil
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%MulTabMet)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%MulTabMet,1)
   i1_u = UBOUND(SrcAirFoilParmsData%MulTabMet,1)
   i2_l = LBOUND(SrcAirFoilParmsData%MulTabMet,2)
   i2_u = UBOUND(SrcAirFoilParmsData%MulTabMet,2)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%MulTabMet)) THEN 
      ALLOCATE(DstAirFoilParmsData%MulTabMet(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%MulTabMet.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%MulTabMet = SrcAirFoilParmsData%MulTabMet
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%FoilNm)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%FoilNm,1)
   i1_u = UBOUND(SrcAirFoilParmsData%FoilNm,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%FoilNm)) THEN 
      ALLOCATE(DstAirFoilParmsData%FoilNm(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%FoilNm.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%FoilNm = SrcAirFoilParmsData%FoilNm
ENDIF
 END SUBROUTINE AD_CopyAirFoilParms

 SUBROUTINE AD_DestroyAirFoilParms( AirFoilParmsData, ErrStat, ErrMsg )
  TYPE(AirFoilParms), INTENT(INOUT) :: AirFoilParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AirFoilParmsData%NTables)) THEN
   DEALLOCATE(AirFoilParmsData%NTables)
ENDIF
IF (ALLOCATED(AirFoilParmsData%NLift)) THEN
   DEALLOCATE(AirFoilParmsData%NLift)
ENDIF
IF (ALLOCATED(AirFoilParmsData%NFoil)) THEN
   DEALLOCATE(AirFoilParmsData%NFoil)
ENDIF
IF (ALLOCATED(AirFoilParmsData%MulTabMet)) THEN
   DEALLOCATE(AirFoilParmsData%MulTabMet)
ENDIF
IF (ALLOCATED(AirFoilParmsData%FoilNm)) THEN
   DEALLOCATE(AirFoilParmsData%FoilNm)
ENDIF
 END SUBROUTINE AD_DestroyAirFoilParms

 SUBROUTINE AD_PackAirFoilParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AirFoilParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MaxTable
  IF ( ALLOCATED(InData%NTables) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NTables )  ! NTables 
  IF ( ALLOCATED(InData%NLift) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NLift )  ! NLift 
  Int_BufSz  = Int_BufSz  + 1  ! NumCL
  Int_BufSz  = Int_BufSz  + 1  ! NumFoil
  IF ( ALLOCATED(InData%NFoil) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NFoil )  ! NFoil 
  IF ( ALLOCATED(InData%MulTabMet) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabMet )  ! MulTabMet 
!  missing buffer for FoilNm
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MaxTable )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NTables) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTables))-1 ) = PACK(InData%NTables ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTables)
  ENDIF
  IF ( ALLOCATED(InData%NLift) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NLift))-1 ) = PACK(InData%NLift ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NLift)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumCL )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumFoil )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NFoil) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NFoil))-1 ) = PACK(InData%NFoil ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NFoil)
  ENDIF
  IF ( ALLOCATED(InData%MulTabMet) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabMet))-1 ) =  PACK(InData%MulTabMet ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabMet)
  ENDIF
 END SUBROUTINE AD_PackAirFoilParms

 SUBROUTINE AD_UnPackAirFoilParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AirFoilParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MaxTable = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NTables) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTables,1)))
  mask1 = .TRUE.
    OutData%NTables = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTables))-1 ),mask1,OutData%NTables)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTables)
  ENDIF
  IF ( ALLOCATED(OutData%NLift) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NLift,1)))
  mask1 = .TRUE.
    OutData%NLift = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NLift))-1 ),mask1,OutData%NLift)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NLift)
  ENDIF
  OutData%NumCL = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NumFoil = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NFoil) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NFoil,1)))
  mask1 = .TRUE.
    OutData%NFoil = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NFoil))-1 ),mask1,OutData%NFoil)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NFoil)
  ENDIF
  IF ( ALLOCATED(OutData%MulTabMet) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabMet,1),SIZE(OutData%MulTabMet,2)))
  mask2 = .TRUE.
    OutData%MulTabMet = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabMet))-1 ),mask2,OutData%MulTabMet)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabMet)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAirFoilParms

 SUBROUTINE AD_CopyBeddoes( SrcBeddoesData, DstBeddoesData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Beddoes), INTENT(IN) :: SrcBeddoesData
   TYPE(Beddoes), INTENT(INOUT) :: DstBeddoesData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcBeddoesData%ADOT)) THEN
   i1_l = LBOUND(SrcBeddoesData%ADOT,1)
   i1_u = UBOUND(SrcBeddoesData%ADOT,1)
   i2_l = LBOUND(SrcBeddoesData%ADOT,2)
   i2_u = UBOUND(SrcBeddoesData%ADOT,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ADOT)) THEN 
      ALLOCATE(DstBeddoesData%ADOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ADOT.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ADOT = SrcBeddoesData%ADOT
ENDIF
IF (ALLOCATED(SrcBeddoesData%ADOT1)) THEN
   i1_l = LBOUND(SrcBeddoesData%ADOT1,1)
   i1_u = UBOUND(SrcBeddoesData%ADOT1,1)
   i2_l = LBOUND(SrcBeddoesData%ADOT1,2)
   i2_u = UBOUND(SrcBeddoesData%ADOT1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ADOT1)) THEN 
      ALLOCATE(DstBeddoesData%ADOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ADOT1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ADOT1 = SrcBeddoesData%ADOT1
ENDIF
IF (ALLOCATED(SrcBeddoesData%AFE)) THEN
   i1_l = LBOUND(SrcBeddoesData%AFE,1)
   i1_u = UBOUND(SrcBeddoesData%AFE,1)
   i2_l = LBOUND(SrcBeddoesData%AFE,2)
   i2_u = UBOUND(SrcBeddoesData%AFE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AFE)) THEN 
      ALLOCATE(DstBeddoesData%AFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AFE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AFE = SrcBeddoesData%AFE
ENDIF
IF (ALLOCATED(SrcBeddoesData%AFE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%AFE1,1)
   i1_u = UBOUND(SrcBeddoesData%AFE1,1)
   i2_l = LBOUND(SrcBeddoesData%AFE1,2)
   i2_u = UBOUND(SrcBeddoesData%AFE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AFE1)) THEN 
      ALLOCATE(DstBeddoesData%AFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AFE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AFE1 = SrcBeddoesData%AFE1
ENDIF
   DstBeddoesData%AN = SrcBeddoesData%AN
IF (ALLOCATED(SrcBeddoesData%ANE)) THEN
   i1_l = LBOUND(SrcBeddoesData%ANE,1)
   i1_u = UBOUND(SrcBeddoesData%ANE,1)
   i2_l = LBOUND(SrcBeddoesData%ANE,2)
   i2_u = UBOUND(SrcBeddoesData%ANE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ANE)) THEN 
      ALLOCATE(DstBeddoesData%ANE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ANE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ANE = SrcBeddoesData%ANE
ENDIF
IF (ALLOCATED(SrcBeddoesData%ANE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%ANE1,1)
   i1_u = UBOUND(SrcBeddoesData%ANE1,1)
   i2_l = LBOUND(SrcBeddoesData%ANE1,2)
   i2_u = UBOUND(SrcBeddoesData%ANE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ANE1)) THEN 
      ALLOCATE(DstBeddoesData%ANE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ANE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ANE1 = SrcBeddoesData%ANE1
ENDIF
IF (ALLOCATED(SrcBeddoesData%AOD)) THEN
   i1_l = LBOUND(SrcBeddoesData%AOD,1)
   i1_u = UBOUND(SrcBeddoesData%AOD,1)
   i2_l = LBOUND(SrcBeddoesData%AOD,2)
   i2_u = UBOUND(SrcBeddoesData%AOD,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AOD)) THEN 
      ALLOCATE(DstBeddoesData%AOD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AOD.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AOD = SrcBeddoesData%AOD
ENDIF
IF (ALLOCATED(SrcBeddoesData%AOL)) THEN
   i1_l = LBOUND(SrcBeddoesData%AOL,1)
   i1_u = UBOUND(SrcBeddoesData%AOL,1)
   i2_l = LBOUND(SrcBeddoesData%AOL,2)
   i2_u = UBOUND(SrcBeddoesData%AOL,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AOL)) THEN 
      ALLOCATE(DstBeddoesData%AOL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AOL.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AOL = SrcBeddoesData%AOL
ENDIF
IF (ALLOCATED(SrcBeddoesData%BEDSEP)) THEN
   i1_l = LBOUND(SrcBeddoesData%BEDSEP,1)
   i1_u = UBOUND(SrcBeddoesData%BEDSEP,1)
   i2_l = LBOUND(SrcBeddoesData%BEDSEP,2)
   i2_u = UBOUND(SrcBeddoesData%BEDSEP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%BEDSEP)) THEN 
      ALLOCATE(DstBeddoesData%BEDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%BEDSEP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%BEDSEP = SrcBeddoesData%BEDSEP
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDSEP)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDSEP,1)
   i1_u = UBOUND(SrcBeddoesData%OLDSEP,1)
   i2_l = LBOUND(SrcBeddoesData%OLDSEP,2)
   i2_u = UBOUND(SrcBeddoesData%OLDSEP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDSEP)) THEN 
      ALLOCATE(DstBeddoesData%OLDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDSEP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDSEP = SrcBeddoesData%OLDSEP
ENDIF
   DstBeddoesData%CC = SrcBeddoesData%CC
IF (ALLOCATED(SrcBeddoesData%CDO)) THEN
   i1_l = LBOUND(SrcBeddoesData%CDO,1)
   i1_u = UBOUND(SrcBeddoesData%CDO,1)
   i2_l = LBOUND(SrcBeddoesData%CDO,2)
   i2_u = UBOUND(SrcBeddoesData%CDO,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CDO)) THEN 
      ALLOCATE(DstBeddoesData%CDO(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CDO.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CDO = SrcBeddoesData%CDO
ENDIF
   DstBeddoesData%CMI = SrcBeddoesData%CMI
   DstBeddoesData%CMQ = SrcBeddoesData%CMQ
   DstBeddoesData%CN = SrcBeddoesData%CN
IF (ALLOCATED(SrcBeddoesData%CNA)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNA,1)
   i1_u = UBOUND(SrcBeddoesData%CNA,1)
   i2_l = LBOUND(SrcBeddoesData%CNA,2)
   i2_u = UBOUND(SrcBeddoesData%CNA,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNA)) THEN 
      ALLOCATE(DstBeddoesData%CNA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNA.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNA = SrcBeddoesData%CNA
ENDIF
   DstBeddoesData%CNCP = SrcBeddoesData%CNCP
   DstBeddoesData%CNIQ = SrcBeddoesData%CNIQ
IF (ALLOCATED(SrcBeddoesData%CNP)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNP,1)
   i1_u = UBOUND(SrcBeddoesData%CNP,1)
   i2_l = LBOUND(SrcBeddoesData%CNP,2)
   i2_u = UBOUND(SrcBeddoesData%CNP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNP)) THEN 
      ALLOCATE(DstBeddoesData%CNP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNP = SrcBeddoesData%CNP
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNP1,1)
   i1_u = UBOUND(SrcBeddoesData%CNP1,1)
   i2_l = LBOUND(SrcBeddoesData%CNP1,2)
   i2_u = UBOUND(SrcBeddoesData%CNP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNP1)) THEN 
      ALLOCATE(DstBeddoesData%CNP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNP1 = SrcBeddoesData%CNP1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPD)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPD,1)
   i1_u = UBOUND(SrcBeddoesData%CNPD,1)
   i2_l = LBOUND(SrcBeddoesData%CNPD,2)
   i2_u = UBOUND(SrcBeddoesData%CNPD,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPD)) THEN 
      ALLOCATE(DstBeddoesData%CNPD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPD.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPD = SrcBeddoesData%CNPD
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPD1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPD1,1)
   i1_u = UBOUND(SrcBeddoesData%CNPD1,1)
   i2_l = LBOUND(SrcBeddoesData%CNPD1,2)
   i2_u = UBOUND(SrcBeddoesData%CNPD1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPD1)) THEN 
      ALLOCATE(DstBeddoesData%CNPD1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPD1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPD1 = SrcBeddoesData%CNPD1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPOT)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPOT,1)
   i1_u = UBOUND(SrcBeddoesData%CNPOT,1)
   i2_l = LBOUND(SrcBeddoesData%CNPOT,2)
   i2_u = UBOUND(SrcBeddoesData%CNPOT,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPOT)) THEN 
      ALLOCATE(DstBeddoesData%CNPOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPOT.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPOT = SrcBeddoesData%CNPOT
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPOT1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPOT1,1)
   i1_u = UBOUND(SrcBeddoesData%CNPOT1,1)
   i2_l = LBOUND(SrcBeddoesData%CNPOT1,2)
   i2_u = UBOUND(SrcBeddoesData%CNPOT1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPOT1)) THEN 
      ALLOCATE(DstBeddoesData%CNPOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPOT1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPOT1 = SrcBeddoesData%CNPOT1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNS)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNS,1)
   i1_u = UBOUND(SrcBeddoesData%CNS,1)
   i2_l = LBOUND(SrcBeddoesData%CNS,2)
   i2_u = UBOUND(SrcBeddoesData%CNS,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNS)) THEN 
      ALLOCATE(DstBeddoesData%CNS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNS.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNS = SrcBeddoesData%CNS
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNSL)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNSL,1)
   i1_u = UBOUND(SrcBeddoesData%CNSL,1)
   i2_l = LBOUND(SrcBeddoesData%CNSL,2)
   i2_u = UBOUND(SrcBeddoesData%CNSL,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNSL)) THEN 
      ALLOCATE(DstBeddoesData%CNSL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNSL.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNSL = SrcBeddoesData%CNSL
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNV)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNV,1)
   i1_u = UBOUND(SrcBeddoesData%CNV,1)
   i2_l = LBOUND(SrcBeddoesData%CNV,2)
   i2_u = UBOUND(SrcBeddoesData%CNV,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNV)) THEN 
      ALLOCATE(DstBeddoesData%CNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNV.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNV = SrcBeddoesData%CNV
ENDIF
IF (ALLOCATED(SrcBeddoesData%CVN)) THEN
   i1_l = LBOUND(SrcBeddoesData%CVN,1)
   i1_u = UBOUND(SrcBeddoesData%CVN,1)
   i2_l = LBOUND(SrcBeddoesData%CVN,2)
   i2_u = UBOUND(SrcBeddoesData%CVN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CVN)) THEN 
      ALLOCATE(DstBeddoesData%CVN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CVN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CVN = SrcBeddoesData%CVN
ENDIF
IF (ALLOCATED(SrcBeddoesData%CVN1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CVN1,1)
   i1_u = UBOUND(SrcBeddoesData%CVN1,1)
   i2_l = LBOUND(SrcBeddoesData%CVN1,2)
   i2_u = UBOUND(SrcBeddoesData%CVN1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CVN1)) THEN 
      ALLOCATE(DstBeddoesData%CVN1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CVN1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CVN1 = SrcBeddoesData%CVN1
ENDIF
IF (ALLOCATED(SrcBeddoesData%DF)) THEN
   i1_l = LBOUND(SrcBeddoesData%DF,1)
   i1_u = UBOUND(SrcBeddoesData%DF,1)
   i2_l = LBOUND(SrcBeddoesData%DF,2)
   i2_u = UBOUND(SrcBeddoesData%DF,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DF)) THEN 
      ALLOCATE(DstBeddoesData%DF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DF.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DF = SrcBeddoesData%DF
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFAFE)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFAFE,1)
   i1_u = UBOUND(SrcBeddoesData%DFAFE,1)
   i2_l = LBOUND(SrcBeddoesData%DFAFE,2)
   i2_u = UBOUND(SrcBeddoesData%DFAFE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFAFE)) THEN 
      ALLOCATE(DstBeddoesData%DFAFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFAFE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFAFE = SrcBeddoesData%DFAFE
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFAFE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFAFE1,1)
   i1_u = UBOUND(SrcBeddoesData%DFAFE1,1)
   i2_l = LBOUND(SrcBeddoesData%DFAFE1,2)
   i2_u = UBOUND(SrcBeddoesData%DFAFE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFAFE1)) THEN 
      ALLOCATE(DstBeddoesData%DFAFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFAFE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFAFE1 = SrcBeddoesData%DFAFE1
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFC)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFC,1)
   i1_u = UBOUND(SrcBeddoesData%DFC,1)
   i2_l = LBOUND(SrcBeddoesData%DFC,2)
   i2_u = UBOUND(SrcBeddoesData%DFC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFC)) THEN 
      ALLOCATE(DstBeddoesData%DFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFC = SrcBeddoesData%DFC
ENDIF
IF (ALLOCATED(SrcBeddoesData%DN)) THEN
   i1_l = LBOUND(SrcBeddoesData%DN,1)
   i1_u = UBOUND(SrcBeddoesData%DN,1)
   i2_l = LBOUND(SrcBeddoesData%DN,2)
   i2_u = UBOUND(SrcBeddoesData%DN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DN)) THEN 
      ALLOCATE(DstBeddoesData%DN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DN = SrcBeddoesData%DN
ENDIF
IF (ALLOCATED(SrcBeddoesData%DPP)) THEN
   i1_l = LBOUND(SrcBeddoesData%DPP,1)
   i1_u = UBOUND(SrcBeddoesData%DPP,1)
   i2_l = LBOUND(SrcBeddoesData%DPP,2)
   i2_u = UBOUND(SrcBeddoesData%DPP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DPP)) THEN 
      ALLOCATE(DstBeddoesData%DPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DPP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DPP = SrcBeddoesData%DPP
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQ)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQ,1)
   i1_u = UBOUND(SrcBeddoesData%DQ,1)
   i2_l = LBOUND(SrcBeddoesData%DQ,2)
   i2_u = UBOUND(SrcBeddoesData%DQ,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQ)) THEN 
      ALLOCATE(DstBeddoesData%DQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQ.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQ = SrcBeddoesData%DQ
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQP)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQP,1)
   i1_u = UBOUND(SrcBeddoesData%DQP,1)
   i2_l = LBOUND(SrcBeddoesData%DQP,2)
   i2_u = UBOUND(SrcBeddoesData%DQP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQP)) THEN 
      ALLOCATE(DstBeddoesData%DQP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQP = SrcBeddoesData%DQP
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQP1,1)
   i1_u = UBOUND(SrcBeddoesData%DQP1,1)
   i2_l = LBOUND(SrcBeddoesData%DQP1,2)
   i2_u = UBOUND(SrcBeddoesData%DQP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQP1)) THEN 
      ALLOCATE(DstBeddoesData%DQP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQP1 = SrcBeddoesData%DQP1
ENDIF
   DstBeddoesData%DS = SrcBeddoesData%DS
   DstBeddoesData%FK = SrcBeddoesData%FK
   DstBeddoesData%FP = SrcBeddoesData%FP
   DstBeddoesData%FPC = SrcBeddoesData%FPC
IF (ALLOCATED(SrcBeddoesData%FSP)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSP,1)
   i1_u = UBOUND(SrcBeddoesData%FSP,1)
   i2_l = LBOUND(SrcBeddoesData%FSP,2)
   i2_u = UBOUND(SrcBeddoesData%FSP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSP)) THEN 
      ALLOCATE(DstBeddoesData%FSP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSP = SrcBeddoesData%FSP
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSP1,1)
   i1_u = UBOUND(SrcBeddoesData%FSP1,1)
   i2_l = LBOUND(SrcBeddoesData%FSP1,2)
   i2_u = UBOUND(SrcBeddoesData%FSP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSP1)) THEN 
      ALLOCATE(DstBeddoesData%FSP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSP1 = SrcBeddoesData%FSP1
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSPC)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSPC,1)
   i1_u = UBOUND(SrcBeddoesData%FSPC,1)
   i2_l = LBOUND(SrcBeddoesData%FSPC,2)
   i2_u = UBOUND(SrcBeddoesData%FSPC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSPC)) THEN 
      ALLOCATE(DstBeddoesData%FSPC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSPC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSPC = SrcBeddoesData%FSPC
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSPC1)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSPC1,1)
   i1_u = UBOUND(SrcBeddoesData%FSPC1,1)
   i2_l = LBOUND(SrcBeddoesData%FSPC1,2)
   i2_u = UBOUND(SrcBeddoesData%FSPC1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSPC1)) THEN 
      ALLOCATE(DstBeddoesData%FSPC1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSPC1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSPC1 = SrcBeddoesData%FSPC1
ENDIF
IF (ALLOCATED(SrcBeddoesData%FTB)) THEN
   i1_l = LBOUND(SrcBeddoesData%FTB,1)
   i1_u = UBOUND(SrcBeddoesData%FTB,1)
   i2_l = LBOUND(SrcBeddoesData%FTB,2)
   i2_u = UBOUND(SrcBeddoesData%FTB,2)
   i3_l = LBOUND(SrcBeddoesData%FTB,3)
   i3_u = UBOUND(SrcBeddoesData%FTB,3)
   IF (.NOT. ALLOCATED(DstBeddoesData%FTB)) THEN 
      ALLOCATE(DstBeddoesData%FTB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FTB.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FTB = SrcBeddoesData%FTB
ENDIF
IF (ALLOCATED(SrcBeddoesData%FTBC)) THEN
   i1_l = LBOUND(SrcBeddoesData%FTBC,1)
   i1_u = UBOUND(SrcBeddoesData%FTBC,1)
   i2_l = LBOUND(SrcBeddoesData%FTBC,2)
   i2_u = UBOUND(SrcBeddoesData%FTBC,2)
   i3_l = LBOUND(SrcBeddoesData%FTBC,3)
   i3_u = UBOUND(SrcBeddoesData%FTBC,3)
   IF (.NOT. ALLOCATED(DstBeddoesData%FTBC)) THEN 
      ALLOCATE(DstBeddoesData%FTBC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FTBC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FTBC = SrcBeddoesData%FTBC
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDCNV)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDCNV,1)
   i1_u = UBOUND(SrcBeddoesData%OLDCNV,1)
   i2_l = LBOUND(SrcBeddoesData%OLDCNV,2)
   i2_u = UBOUND(SrcBeddoesData%OLDCNV,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDCNV)) THEN 
      ALLOCATE(DstBeddoesData%OLDCNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDCNV.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDCNV = SrcBeddoesData%OLDCNV
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDF)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDF,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDF,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDF,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDF,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDF)) THEN 
      ALLOCATE(DstBeddoesData%OLDDF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDF.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDF = SrcBeddoesData%OLDDF
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDFC)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDFC,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDFC,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDFC,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDFC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDFC)) THEN 
      ALLOCATE(DstBeddoesData%OLDDFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDFC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDFC = SrcBeddoesData%OLDDFC
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDN)) THEN 
      ALLOCATE(DstBeddoesData%OLDDN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDN = SrcBeddoesData%OLDDN
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDPP)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDPP,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDPP,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDPP,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDPP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDPP)) THEN 
      ALLOCATE(DstBeddoesData%OLDDPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDPP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDPP = SrcBeddoesData%OLDDPP
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDQ)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDQ,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDQ,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDQ,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDQ,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDQ)) THEN 
      ALLOCATE(DstBeddoesData%OLDDQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDQ.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDQ = SrcBeddoesData%OLDDQ
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDTAU)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDTAU,1)
   i1_u = UBOUND(SrcBeddoesData%OLDTAU,1)
   i2_l = LBOUND(SrcBeddoesData%OLDTAU,2)
   i2_u = UBOUND(SrcBeddoesData%OLDTAU,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDTAU)) THEN 
      ALLOCATE(DstBeddoesData%OLDTAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDTAU.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDTAU = SrcBeddoesData%OLDTAU
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDXN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDXN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDXN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDXN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDXN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDXN)) THEN 
      ALLOCATE(DstBeddoesData%OLDXN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDXN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDXN = SrcBeddoesData%OLDXN
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDYN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDYN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDYN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDYN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDYN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDYN)) THEN 
      ALLOCATE(DstBeddoesData%OLDYN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDYN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDYN = SrcBeddoesData%OLDYN
ENDIF
IF (ALLOCATED(SrcBeddoesData%QX)) THEN
   i1_l = LBOUND(SrcBeddoesData%QX,1)
   i1_u = UBOUND(SrcBeddoesData%QX,1)
   i2_l = LBOUND(SrcBeddoesData%QX,2)
   i2_u = UBOUND(SrcBeddoesData%QX,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%QX)) THEN 
      ALLOCATE(DstBeddoesData%QX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%QX.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%QX = SrcBeddoesData%QX
ENDIF
IF (ALLOCATED(SrcBeddoesData%QX1)) THEN
   i1_l = LBOUND(SrcBeddoesData%QX1,1)
   i1_u = UBOUND(SrcBeddoesData%QX1,1)
   i2_l = LBOUND(SrcBeddoesData%QX1,2)
   i2_u = UBOUND(SrcBeddoesData%QX1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%QX1)) THEN 
      ALLOCATE(DstBeddoesData%QX1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%QX1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%QX1 = SrcBeddoesData%QX1
ENDIF
IF (ALLOCATED(SrcBeddoesData%TAU)) THEN
   i1_l = LBOUND(SrcBeddoesData%TAU,1)
   i1_u = UBOUND(SrcBeddoesData%TAU,1)
   i2_l = LBOUND(SrcBeddoesData%TAU,2)
   i2_u = UBOUND(SrcBeddoesData%TAU,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%TAU)) THEN 
      ALLOCATE(DstBeddoesData%TAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%TAU.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%TAU = SrcBeddoesData%TAU
ENDIF
IF (ALLOCATED(SrcBeddoesData%XN)) THEN
   i1_l = LBOUND(SrcBeddoesData%XN,1)
   i1_u = UBOUND(SrcBeddoesData%XN,1)
   i2_l = LBOUND(SrcBeddoesData%XN,2)
   i2_u = UBOUND(SrcBeddoesData%XN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%XN)) THEN 
      ALLOCATE(DstBeddoesData%XN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%XN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%XN = SrcBeddoesData%XN
ENDIF
IF (ALLOCATED(SrcBeddoesData%YN)) THEN
   i1_l = LBOUND(SrcBeddoesData%YN,1)
   i1_u = UBOUND(SrcBeddoesData%YN,1)
   i2_l = LBOUND(SrcBeddoesData%YN,2)
   i2_u = UBOUND(SrcBeddoesData%YN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%YN)) THEN 
      ALLOCATE(DstBeddoesData%YN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%YN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%YN = SrcBeddoesData%YN
ENDIF
   DstBeddoesData%SHIFT = SrcBeddoesData%SHIFT
   DstBeddoesData%VOR = SrcBeddoesData%VOR
IF (ALLOCATED(SrcBeddoesData%StallAngle)) THEN
   i1_l = LBOUND(SrcBeddoesData%StallAngle,1)
   i1_u = UBOUND(SrcBeddoesData%StallAngle,1)
   i2_l = LBOUND(SrcBeddoesData%StallAngle,2)
   i2_u = UBOUND(SrcBeddoesData%StallAngle,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%StallAngle)) THEN 
      ALLOCATE(DstBeddoesData%StallAngle(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%StallAngle.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%StallAngle = SrcBeddoesData%StallAngle
ENDIF
 END SUBROUTINE AD_CopyBeddoes

 SUBROUTINE AD_DestroyBeddoes( BeddoesData, ErrStat, ErrMsg )
  TYPE(Beddoes), INTENT(INOUT) :: BeddoesData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BeddoesData%ADOT)) THEN
   DEALLOCATE(BeddoesData%ADOT)
ENDIF
IF (ALLOCATED(BeddoesData%ADOT1)) THEN
   DEALLOCATE(BeddoesData%ADOT1)
ENDIF
IF (ALLOCATED(BeddoesData%AFE)) THEN
   DEALLOCATE(BeddoesData%AFE)
ENDIF
IF (ALLOCATED(BeddoesData%AFE1)) THEN
   DEALLOCATE(BeddoesData%AFE1)
ENDIF
IF (ALLOCATED(BeddoesData%ANE)) THEN
   DEALLOCATE(BeddoesData%ANE)
ENDIF
IF (ALLOCATED(BeddoesData%ANE1)) THEN
   DEALLOCATE(BeddoesData%ANE1)
ENDIF
IF (ALLOCATED(BeddoesData%AOD)) THEN
   DEALLOCATE(BeddoesData%AOD)
ENDIF
IF (ALLOCATED(BeddoesData%AOL)) THEN
   DEALLOCATE(BeddoesData%AOL)
ENDIF
IF (ALLOCATED(BeddoesData%BEDSEP)) THEN
   DEALLOCATE(BeddoesData%BEDSEP)
ENDIF
IF (ALLOCATED(BeddoesData%OLDSEP)) THEN
   DEALLOCATE(BeddoesData%OLDSEP)
ENDIF
IF (ALLOCATED(BeddoesData%CDO)) THEN
   DEALLOCATE(BeddoesData%CDO)
ENDIF
IF (ALLOCATED(BeddoesData%CNA)) THEN
   DEALLOCATE(BeddoesData%CNA)
ENDIF
IF (ALLOCATED(BeddoesData%CNP)) THEN
   DEALLOCATE(BeddoesData%CNP)
ENDIF
IF (ALLOCATED(BeddoesData%CNP1)) THEN
   DEALLOCATE(BeddoesData%CNP1)
ENDIF
IF (ALLOCATED(BeddoesData%CNPD)) THEN
   DEALLOCATE(BeddoesData%CNPD)
ENDIF
IF (ALLOCATED(BeddoesData%CNPD1)) THEN
   DEALLOCATE(BeddoesData%CNPD1)
ENDIF
IF (ALLOCATED(BeddoesData%CNPOT)) THEN
   DEALLOCATE(BeddoesData%CNPOT)
ENDIF
IF (ALLOCATED(BeddoesData%CNPOT1)) THEN
   DEALLOCATE(BeddoesData%CNPOT1)
ENDIF
IF (ALLOCATED(BeddoesData%CNS)) THEN
   DEALLOCATE(BeddoesData%CNS)
ENDIF
IF (ALLOCATED(BeddoesData%CNSL)) THEN
   DEALLOCATE(BeddoesData%CNSL)
ENDIF
IF (ALLOCATED(BeddoesData%CNV)) THEN
   DEALLOCATE(BeddoesData%CNV)
ENDIF
IF (ALLOCATED(BeddoesData%CVN)) THEN
   DEALLOCATE(BeddoesData%CVN)
ENDIF
IF (ALLOCATED(BeddoesData%CVN1)) THEN
   DEALLOCATE(BeddoesData%CVN1)
ENDIF
IF (ALLOCATED(BeddoesData%DF)) THEN
   DEALLOCATE(BeddoesData%DF)
ENDIF
IF (ALLOCATED(BeddoesData%DFAFE)) THEN
   DEALLOCATE(BeddoesData%DFAFE)
ENDIF
IF (ALLOCATED(BeddoesData%DFAFE1)) THEN
   DEALLOCATE(BeddoesData%DFAFE1)
ENDIF
IF (ALLOCATED(BeddoesData%DFC)) THEN
   DEALLOCATE(BeddoesData%DFC)
ENDIF
IF (ALLOCATED(BeddoesData%DN)) THEN
   DEALLOCATE(BeddoesData%DN)
ENDIF
IF (ALLOCATED(BeddoesData%DPP)) THEN
   DEALLOCATE(BeddoesData%DPP)
ENDIF
IF (ALLOCATED(BeddoesData%DQ)) THEN
   DEALLOCATE(BeddoesData%DQ)
ENDIF
IF (ALLOCATED(BeddoesData%DQP)) THEN
   DEALLOCATE(BeddoesData%DQP)
ENDIF
IF (ALLOCATED(BeddoesData%DQP1)) THEN
   DEALLOCATE(BeddoesData%DQP1)
ENDIF
IF (ALLOCATED(BeddoesData%FSP)) THEN
   DEALLOCATE(BeddoesData%FSP)
ENDIF
IF (ALLOCATED(BeddoesData%FSP1)) THEN
   DEALLOCATE(BeddoesData%FSP1)
ENDIF
IF (ALLOCATED(BeddoesData%FSPC)) THEN
   DEALLOCATE(BeddoesData%FSPC)
ENDIF
IF (ALLOCATED(BeddoesData%FSPC1)) THEN
   DEALLOCATE(BeddoesData%FSPC1)
ENDIF
IF (ALLOCATED(BeddoesData%FTB)) THEN
   DEALLOCATE(BeddoesData%FTB)
ENDIF
IF (ALLOCATED(BeddoesData%FTBC)) THEN
   DEALLOCATE(BeddoesData%FTBC)
ENDIF
IF (ALLOCATED(BeddoesData%OLDCNV)) THEN
   DEALLOCATE(BeddoesData%OLDCNV)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDF)) THEN
   DEALLOCATE(BeddoesData%OLDDF)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDFC)) THEN
   DEALLOCATE(BeddoesData%OLDDFC)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDN)) THEN
   DEALLOCATE(BeddoesData%OLDDN)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDPP)) THEN
   DEALLOCATE(BeddoesData%OLDDPP)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDQ)) THEN
   DEALLOCATE(BeddoesData%OLDDQ)
ENDIF
IF (ALLOCATED(BeddoesData%OLDTAU)) THEN
   DEALLOCATE(BeddoesData%OLDTAU)
ENDIF
IF (ALLOCATED(BeddoesData%OLDXN)) THEN
   DEALLOCATE(BeddoesData%OLDXN)
ENDIF
IF (ALLOCATED(BeddoesData%OLDYN)) THEN
   DEALLOCATE(BeddoesData%OLDYN)
ENDIF
IF (ALLOCATED(BeddoesData%QX)) THEN
   DEALLOCATE(BeddoesData%QX)
ENDIF
IF (ALLOCATED(BeddoesData%QX1)) THEN
   DEALLOCATE(BeddoesData%QX1)
ENDIF
IF (ALLOCATED(BeddoesData%TAU)) THEN
   DEALLOCATE(BeddoesData%TAU)
ENDIF
IF (ALLOCATED(BeddoesData%XN)) THEN
   DEALLOCATE(BeddoesData%XN)
ENDIF
IF (ALLOCATED(BeddoesData%YN)) THEN
   DEALLOCATE(BeddoesData%YN)
ENDIF
IF (ALLOCATED(BeddoesData%StallAngle)) THEN
   DEALLOCATE(BeddoesData%StallAngle)
ENDIF
 END SUBROUTINE AD_DestroyBeddoes

 SUBROUTINE AD_PackBeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Beddoes),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%ADOT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT )  ! ADOT 
  IF ( ALLOCATED(InData%ADOT1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT1 )  ! ADOT1 
  IF ( ALLOCATED(InData%AFE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AFE )  ! AFE 
  IF ( ALLOCATED(InData%AFE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AFE1 )  ! AFE1 
  Re_BufSz   = Re_BufSz   + 1  ! AN
  IF ( ALLOCATED(InData%ANE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ANE )  ! ANE 
  IF ( ALLOCATED(InData%ANE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ANE1 )  ! ANE1 
  IF ( ALLOCATED(InData%AOD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AOD )  ! AOD 
  IF ( ALLOCATED(InData%AOL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AOL )  ! AOL 
  IF ( ALLOCATED(InData%BEDSEP) )   Int_BufSz   = Int_BufSz   + SIZE( InData%BEDSEP )  ! BEDSEP 
  IF ( ALLOCATED(InData%OLDSEP) )   Int_BufSz   = Int_BufSz   + SIZE( InData%OLDSEP )  ! OLDSEP 
  Re_BufSz   = Re_BufSz   + 1  ! CC
  IF ( ALLOCATED(InData%CDO) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CDO )  ! CDO 
  Re_BufSz   = Re_BufSz   + 1  ! CMI
  Re_BufSz   = Re_BufSz   + 1  ! CMQ
  Re_BufSz   = Re_BufSz   + 1  ! CN
  IF ( ALLOCATED(InData%CNA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNA )  ! CNA 
  Re_BufSz   = Re_BufSz   + 1  ! CNCP
  Re_BufSz   = Re_BufSz   + 1  ! CNIQ
  IF ( ALLOCATED(InData%CNP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNP )  ! CNP 
  IF ( ALLOCATED(InData%CNP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNP1 )  ! CNP1 
  IF ( ALLOCATED(InData%CNPD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD )  ! CNPD 
  IF ( ALLOCATED(InData%CNPD1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD1 )  ! CNPD1 
  IF ( ALLOCATED(InData%CNPOT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT )  ! CNPOT 
  IF ( ALLOCATED(InData%CNPOT1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT1 )  ! CNPOT1 
  IF ( ALLOCATED(InData%CNS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNS )  ! CNS 
  IF ( ALLOCATED(InData%CNSL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNSL )  ! CNSL 
  IF ( ALLOCATED(InData%CNV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNV )  ! CNV 
  IF ( ALLOCATED(InData%CVN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CVN )  ! CVN 
  IF ( ALLOCATED(InData%CVN1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CVN1 )  ! CVN1 
  IF ( ALLOCATED(InData%DF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DF )  ! DF 
  IF ( ALLOCATED(InData%DFAFE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE )  ! DFAFE 
  IF ( ALLOCATED(InData%DFAFE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE1 )  ! DFAFE1 
  IF ( ALLOCATED(InData%DFC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFC )  ! DFC 
  IF ( ALLOCATED(InData%DN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DN )  ! DN 
  IF ( ALLOCATED(InData%DPP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DPP )  ! DPP 
  IF ( ALLOCATED(InData%DQ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQ )  ! DQ 
  IF ( ALLOCATED(InData%DQP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQP )  ! DQP 
  IF ( ALLOCATED(InData%DQP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQP1 )  ! DQP1 
  Re_BufSz   = Re_BufSz   + 1  ! DS
  Re_BufSz   = Re_BufSz   + 1  ! FK
  Re_BufSz   = Re_BufSz   + 1  ! FP
  Re_BufSz   = Re_BufSz   + 1  ! FPC
  IF ( ALLOCATED(InData%FSP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSP )  ! FSP 
  IF ( ALLOCATED(InData%FSP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSP1 )  ! FSP1 
  IF ( ALLOCATED(InData%FSPC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC )  ! FSPC 
  IF ( ALLOCATED(InData%FSPC1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC1 )  ! FSPC1 
  IF ( ALLOCATED(InData%FTB) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FTB )  ! FTB 
  IF ( ALLOCATED(InData%FTBC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FTBC )  ! FTBC 
  IF ( ALLOCATED(InData%OLDCNV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDCNV )  ! OLDCNV 
  IF ( ALLOCATED(InData%OLDDF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDF )  ! OLDDF 
  IF ( ALLOCATED(InData%OLDDFC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDFC )  ! OLDDFC 
  IF ( ALLOCATED(InData%OLDDN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDN )  ! OLDDN 
  IF ( ALLOCATED(InData%OLDDPP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDPP )  ! OLDDPP 
  IF ( ALLOCATED(InData%OLDDQ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDQ )  ! OLDDQ 
  IF ( ALLOCATED(InData%OLDTAU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDTAU )  ! OLDTAU 
  IF ( ALLOCATED(InData%OLDXN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDXN )  ! OLDXN 
  IF ( ALLOCATED(InData%OLDYN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDYN )  ! OLDYN 
  IF ( ALLOCATED(InData%QX) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QX )  ! QX 
  IF ( ALLOCATED(InData%QX1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QX1 )  ! QX1 
  IF ( ALLOCATED(InData%TAU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TAU )  ! TAU 
  IF ( ALLOCATED(InData%XN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%XN )  ! XN 
  IF ( ALLOCATED(InData%YN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%YN )  ! YN 
  Int_BufSz  = Int_BufSz  + 1  ! SHIFT
  Int_BufSz  = Int_BufSz  + 1  ! VOR
  IF ( ALLOCATED(InData%StallAngle) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StallAngle )  ! StallAngle 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%ADOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT))-1 ) =  PACK(InData%ADOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT)
  ENDIF
  IF ( ALLOCATED(InData%ADOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT1))-1 ) =  PACK(InData%ADOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT1)
  ENDIF
  IF ( ALLOCATED(InData%AFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE))-1 ) =  PACK(InData%AFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE)
  ENDIF
  IF ( ALLOCATED(InData%AFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE1))-1 ) =  PACK(InData%AFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%ANE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE))-1 ) =  PACK(InData%ANE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE)
  ENDIF
  IF ( ALLOCATED(InData%ANE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE1))-1 ) =  PACK(InData%ANE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE1)
  ENDIF
  IF ( ALLOCATED(InData%AOD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOD))-1 ) =  PACK(InData%AOD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOD)
  ENDIF
  IF ( ALLOCATED(InData%AOL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOL))-1 ) =  PACK(InData%AOL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOL)
  ENDIF
  IF ( ALLOCATED(InData%BEDSEP) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BEDSEP))-1 ) = TRANSFER( PACK(InData%BEDSEP ,.TRUE.), IntKiBuf(1), 1)
    Int_Xferred   = Int_Xferred   + SIZE(InData%BEDSEP)
  ENDIF
  IF ( ALLOCATED(InData%OLDSEP) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%OLDSEP))-1 ) = TRANSFER( PACK(InData%OLDSEP ,.TRUE.), IntKiBuf(1), 1)
    Int_Xferred   = Int_Xferred   + SIZE(InData%OLDSEP)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CDO) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDO))-1 ) =  PACK(InData%CDO ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDO)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMI )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNA))-1 ) =  PACK(InData%CNA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNA)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNCP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNIQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP))-1 ) =  PACK(InData%CNP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP)
  ENDIF
  IF ( ALLOCATED(InData%CNP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP1))-1 ) =  PACK(InData%CNP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP1)
  ENDIF
  IF ( ALLOCATED(InData%CNPD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD))-1 ) =  PACK(InData%CNPD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD)
  ENDIF
  IF ( ALLOCATED(InData%CNPD1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD1))-1 ) =  PACK(InData%CNPD1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD1)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT))-1 ) =  PACK(InData%CNPOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT1))-1 ) =  PACK(InData%CNPOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(InData%CNS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNS))-1 ) =  PACK(InData%CNS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNS)
  ENDIF
  IF ( ALLOCATED(InData%CNSL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNSL))-1 ) =  PACK(InData%CNSL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNSL)
  ENDIF
  IF ( ALLOCATED(InData%CNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNV))-1 ) =  PACK(InData%CNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNV)
  ENDIF
  IF ( ALLOCATED(InData%CVN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN))-1 ) =  PACK(InData%CVN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN)
  ENDIF
  IF ( ALLOCATED(InData%CVN1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN1))-1 ) =  PACK(InData%CVN1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN1)
  ENDIF
  IF ( ALLOCATED(InData%DF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DF))-1 ) =  PACK(InData%DF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DF)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE))-1 ) =  PACK(InData%DFAFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE1))-1 ) =  PACK(InData%DFAFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(InData%DFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFC))-1 ) =  PACK(InData%DFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFC)
  ENDIF
  IF ( ALLOCATED(InData%DN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DN))-1 ) =  PACK(InData%DN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DN)
  ENDIF
  IF ( ALLOCATED(InData%DPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DPP))-1 ) =  PACK(InData%DPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DPP)
  ENDIF
  IF ( ALLOCATED(InData%DQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQ))-1 ) =  PACK(InData%DQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQ)
  ENDIF
  IF ( ALLOCATED(InData%DQP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP))-1 ) =  PACK(InData%DQP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP)
  ENDIF
  IF ( ALLOCATED(InData%DQP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP1))-1 ) =  PACK(InData%DQP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FK )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FPC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%FSP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP))-1 ) =  PACK(InData%FSP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP)
  ENDIF
  IF ( ALLOCATED(InData%FSP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP1))-1 ) =  PACK(InData%FSP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP1)
  ENDIF
  IF ( ALLOCATED(InData%FSPC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC))-1 ) =  PACK(InData%FSPC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC)
  ENDIF
  IF ( ALLOCATED(InData%FSPC1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC1))-1 ) =  PACK(InData%FSPC1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC1)
  ENDIF
  IF ( ALLOCATED(InData%FTB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTB))-1 ) =  PACK(InData%FTB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTB)
  ENDIF
  IF ( ALLOCATED(InData%FTBC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTBC))-1 ) =  PACK(InData%FTBC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTBC)
  ENDIF
  IF ( ALLOCATED(InData%OLDCNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDCNV))-1 ) =  PACK(InData%OLDCNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(InData%OLDDF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDF))-1 ) =  PACK(InData%OLDDF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDF)
  ENDIF
  IF ( ALLOCATED(InData%OLDDFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDFC))-1 ) =  PACK(InData%OLDDFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(InData%OLDDN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDN))-1 ) =  PACK(InData%OLDDN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDN)
  ENDIF
  IF ( ALLOCATED(InData%OLDDPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDPP))-1 ) =  PACK(InData%OLDDPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(InData%OLDDQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDQ))-1 ) =  PACK(InData%OLDDQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(InData%OLDTAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDTAU))-1 ) =  PACK(InData%OLDTAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(InData%OLDXN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDXN))-1 ) =  PACK(InData%OLDXN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDXN)
  ENDIF
  IF ( ALLOCATED(InData%OLDYN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDYN))-1 ) =  PACK(InData%OLDYN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDYN)
  ENDIF
  IF ( ALLOCATED(InData%QX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX))-1 ) =  PACK(InData%QX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX)
  ENDIF
  IF ( ALLOCATED(InData%QX1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX1))-1 ) =  PACK(InData%QX1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX1)
  ENDIF
  IF ( ALLOCATED(InData%TAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TAU))-1 ) =  PACK(InData%TAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TAU)
  ENDIF
  IF ( ALLOCATED(InData%XN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%XN))-1 ) =  PACK(InData%XN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%XN)
  ENDIF
  IF ( ALLOCATED(InData%YN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%YN))-1 ) =  PACK(InData%YN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%YN)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SHIFT ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%VOR ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%StallAngle) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StallAngle))-1 ) =  PACK(InData%StallAngle ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StallAngle)
  ENDIF
 END SUBROUTINE AD_PackBeddoes

 SUBROUTINE AD_UnPackBeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Beddoes), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%ADOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT,1),SIZE(OutData%ADOT,2)))
  mask2 = .TRUE.
    OutData%ADOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT))-1 ),mask2,OutData%ADOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT)
  ENDIF
  IF ( ALLOCATED(OutData%ADOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT1,1),SIZE(OutData%ADOT1,2)))
  mask2 = .TRUE.
    OutData%ADOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT1))-1 ),mask2,OutData%ADOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT1)
  ENDIF
  IF ( ALLOCATED(OutData%AFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE,1),SIZE(OutData%AFE,2)))
  mask2 = .TRUE.
    OutData%AFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE))-1 ),mask2,OutData%AFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE)
  ENDIF
  IF ( ALLOCATED(OutData%AFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE1,1),SIZE(OutData%AFE1,2)))
  mask2 = .TRUE.
    OutData%AFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE1))-1 ),mask2,OutData%AFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE1)
  ENDIF
  OutData%AN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%ANE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE,1),SIZE(OutData%ANE,2)))
  mask2 = .TRUE.
    OutData%ANE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE))-1 ),mask2,OutData%ANE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE)
  ENDIF
  IF ( ALLOCATED(OutData%ANE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE1,1),SIZE(OutData%ANE1,2)))
  mask2 = .TRUE.
    OutData%ANE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE1))-1 ),mask2,OutData%ANE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE1)
  ENDIF
  IF ( ALLOCATED(OutData%AOD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOD,1),SIZE(OutData%AOD,2)))
  mask2 = .TRUE.
    OutData%AOD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOD))-1 ),mask2,OutData%AOD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOD)
  ENDIF
  IF ( ALLOCATED(OutData%AOL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOL,1),SIZE(OutData%AOL,2)))
  mask2 = .TRUE.
    OutData%AOL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOL))-1 ),mask2,OutData%AOL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOL)
  ENDIF
  IF ( ALLOCATED(OutData%BEDSEP) ) THEN
  ENDIF
  IF ( ALLOCATED(OutData%OLDSEP) ) THEN
  ENDIF
  OutData%CC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CDO) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CDO,1),SIZE(OutData%CDO,2)))
  mask2 = .TRUE.
    OutData%CDO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDO))-1 ),mask2,OutData%CDO)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDO)
  ENDIF
  OutData%CMI = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CMQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNA,1),SIZE(OutData%CNA,2)))
  mask2 = .TRUE.
    OutData%CNA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNA))-1 ),mask2,OutData%CNA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNA)
  ENDIF
  OutData%CNCP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CNIQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP,1),SIZE(OutData%CNP,2)))
  mask2 = .TRUE.
    OutData%CNP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP))-1 ),mask2,OutData%CNP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP)
  ENDIF
  IF ( ALLOCATED(OutData%CNP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP1,1),SIZE(OutData%CNP1,2)))
  mask2 = .TRUE.
    OutData%CNP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP1))-1 ),mask2,OutData%CNP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD,1),SIZE(OutData%CNPD,2)))
  mask2 = .TRUE.
    OutData%CNPD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD))-1 ),mask2,OutData%CNPD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD1,1),SIZE(OutData%CNPD1,2)))
  mask2 = .TRUE.
    OutData%CNPD1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD1))-1 ),mask2,OutData%CNPD1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT,1),SIZE(OutData%CNPOT,2)))
  mask2 = .TRUE.
    OutData%CNPOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT))-1 ),mask2,OutData%CNPOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT1,1),SIZE(OutData%CNPOT1,2)))
  mask2 = .TRUE.
    OutData%CNPOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT1))-1 ),mask2,OutData%CNPOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(OutData%CNS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNS,1),SIZE(OutData%CNS,2)))
  mask2 = .TRUE.
    OutData%CNS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNS))-1 ),mask2,OutData%CNS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNS)
  ENDIF
  IF ( ALLOCATED(OutData%CNSL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNSL,1),SIZE(OutData%CNSL,2)))
  mask2 = .TRUE.
    OutData%CNSL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNSL))-1 ),mask2,OutData%CNSL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNSL)
  ENDIF
  IF ( ALLOCATED(OutData%CNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNV,1),SIZE(OutData%CNV,2)))
  mask2 = .TRUE.
    OutData%CNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNV))-1 ),mask2,OutData%CNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNV)
  ENDIF
  IF ( ALLOCATED(OutData%CVN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN,1),SIZE(OutData%CVN,2)))
  mask2 = .TRUE.
    OutData%CVN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN))-1 ),mask2,OutData%CVN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN)
  ENDIF
  IF ( ALLOCATED(OutData%CVN1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN1,1),SIZE(OutData%CVN1,2)))
  mask2 = .TRUE.
    OutData%CVN1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN1))-1 ),mask2,OutData%CVN1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN1)
  ENDIF
  IF ( ALLOCATED(OutData%DF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DF,1),SIZE(OutData%DF,2)))
  mask2 = .TRUE.
    OutData%DF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DF))-1 ),mask2,OutData%DF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DF)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE,1),SIZE(OutData%DFAFE,2)))
  mask2 = .TRUE.
    OutData%DFAFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE))-1 ),mask2,OutData%DFAFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE1,1),SIZE(OutData%DFAFE1,2)))
  mask2 = .TRUE.
    OutData%DFAFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE1))-1 ),mask2,OutData%DFAFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(OutData%DFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFC,1),SIZE(OutData%DFC,2)))
  mask2 = .TRUE.
    OutData%DFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFC))-1 ),mask2,OutData%DFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFC)
  ENDIF
  IF ( ALLOCATED(OutData%DN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DN,1),SIZE(OutData%DN,2)))
  mask2 = .TRUE.
    OutData%DN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DN))-1 ),mask2,OutData%DN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DN)
  ENDIF
  IF ( ALLOCATED(OutData%DPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DPP,1),SIZE(OutData%DPP,2)))
  mask2 = .TRUE.
    OutData%DPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DPP))-1 ),mask2,OutData%DPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DPP)
  ENDIF
  IF ( ALLOCATED(OutData%DQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQ,1),SIZE(OutData%DQ,2)))
  mask2 = .TRUE.
    OutData%DQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQ))-1 ),mask2,OutData%DQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQ)
  ENDIF
  IF ( ALLOCATED(OutData%DQP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP,1),SIZE(OutData%DQP,2)))
  mask2 = .TRUE.
    OutData%DQP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP))-1 ),mask2,OutData%DQP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP)
  ENDIF
  IF ( ALLOCATED(OutData%DQP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP1,1),SIZE(OutData%DQP1,2)))
  mask2 = .TRUE.
    OutData%DQP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP1))-1 ),mask2,OutData%DQP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP1)
  ENDIF
  OutData%DS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FK = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FPC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%FSP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP,1),SIZE(OutData%FSP,2)))
  mask2 = .TRUE.
    OutData%FSP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP))-1 ),mask2,OutData%FSP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP)
  ENDIF
  IF ( ALLOCATED(OutData%FSP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP1,1),SIZE(OutData%FSP1,2)))
  mask2 = .TRUE.
    OutData%FSP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP1))-1 ),mask2,OutData%FSP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP1)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC,1),SIZE(OutData%FSPC,2)))
  mask2 = .TRUE.
    OutData%FSPC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC))-1 ),mask2,OutData%FSPC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC1,1),SIZE(OutData%FSPC1,2)))
  mask2 = .TRUE.
    OutData%FSPC1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC1))-1 ),mask2,OutData%FSPC1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC1)
  ENDIF
  IF ( ALLOCATED(OutData%FTB) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTB,1),SIZE(OutData%FTB,2),SIZE(OutData%FTB,3)))
  mask3 = .TRUE.
    OutData%FTB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTB))-1 ),mask3,OutData%FTB)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTB)
  ENDIF
  IF ( ALLOCATED(OutData%FTBC) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTBC,1),SIZE(OutData%FTBC,2),SIZE(OutData%FTBC,3)))
  mask3 = .TRUE.
    OutData%FTBC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTBC))-1 ),mask3,OutData%FTBC)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTBC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDCNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDCNV,1),SIZE(OutData%OLDCNV,2)))
  mask2 = .TRUE.
    OutData%OLDCNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDCNV))-1 ),mask2,OutData%OLDCNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDF,1),SIZE(OutData%OLDDF,2)))
  mask2 = .TRUE.
    OutData%OLDDF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDF))-1 ),mask2,OutData%OLDDF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDF)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDFC,1),SIZE(OutData%OLDDFC,2)))
  mask2 = .TRUE.
    OutData%OLDDFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDFC))-1 ),mask2,OutData%OLDDFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDN,1),SIZE(OutData%OLDDN,2)))
  mask2 = .TRUE.
    OutData%OLDDN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDN))-1 ),mask2,OutData%OLDDN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDPP,1),SIZE(OutData%OLDDPP,2)))
  mask2 = .TRUE.
    OutData%OLDDPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDPP))-1 ),mask2,OutData%OLDDPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDQ,1),SIZE(OutData%OLDDQ,2)))
  mask2 = .TRUE.
    OutData%OLDDQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDQ))-1 ),mask2,OutData%OLDDQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(OutData%OLDTAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDTAU,1),SIZE(OutData%OLDTAU,2)))
  mask2 = .TRUE.
    OutData%OLDTAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDTAU))-1 ),mask2,OutData%OLDTAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(OutData%OLDXN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDXN,1),SIZE(OutData%OLDXN,2)))
  mask2 = .TRUE.
    OutData%OLDXN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDXN))-1 ),mask2,OutData%OLDXN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDXN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDYN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDYN,1),SIZE(OutData%OLDYN,2)))
  mask2 = .TRUE.
    OutData%OLDYN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDYN))-1 ),mask2,OutData%OLDYN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDYN)
  ENDIF
  IF ( ALLOCATED(OutData%QX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX,1),SIZE(OutData%QX,2)))
  mask2 = .TRUE.
    OutData%QX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX))-1 ),mask2,OutData%QX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX)
  ENDIF
  IF ( ALLOCATED(OutData%QX1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX1,1),SIZE(OutData%QX1,2)))
  mask2 = .TRUE.
    OutData%QX1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX1))-1 ),mask2,OutData%QX1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX1)
  ENDIF
  IF ( ALLOCATED(OutData%TAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TAU,1),SIZE(OutData%TAU,2)))
  mask2 = .TRUE.
    OutData%TAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TAU))-1 ),mask2,OutData%TAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TAU)
  ENDIF
  IF ( ALLOCATED(OutData%XN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%XN,1),SIZE(OutData%XN,2)))
  mask2 = .TRUE.
    OutData%XN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%XN))-1 ),mask2,OutData%XN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%XN)
  ENDIF
  IF ( ALLOCATED(OutData%YN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%YN,1),SIZE(OutData%YN,2)))
  mask2 = .TRUE.
    OutData%YN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%YN))-1 ),mask2,OutData%YN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%YN)
  ENDIF
  IF ( ALLOCATED(OutData%StallAngle) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StallAngle,1),SIZE(OutData%StallAngle,2)))
  mask2 = .TRUE.
    OutData%StallAngle = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StallAngle))-1 ),mask2,OutData%StallAngle)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StallAngle)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBeddoes

 SUBROUTINE AD_CopyBeddoesParms( SrcBeddoesParmsData, DstBeddoesParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BeddoesParms), INTENT(IN) :: SrcBeddoesParmsData
   TYPE(BeddoesParms), INTENT(INOUT) :: DstBeddoesParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstBeddoesParmsData%AS = SrcBeddoesParmsData%AS
   DstBeddoesParmsData%TF = SrcBeddoesParmsData%TF
   DstBeddoesParmsData%TP = SrcBeddoesParmsData%TP
   DstBeddoesParmsData%TV = SrcBeddoesParmsData%TV
   DstBeddoesParmsData%TVL = SrcBeddoesParmsData%TVL
 END SUBROUTINE AD_CopyBeddoesParms

 SUBROUTINE AD_DestroyBeddoesParms( BeddoesParmsData, ErrStat, ErrMsg )
  TYPE(BeddoesParms), INTENT(INOUT) :: BeddoesParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyBeddoesParms

 SUBROUTINE AD_PackBeddoesParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BeddoesParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AS
  Re_BufSz   = Re_BufSz   + 1  ! TF
  Re_BufSz   = Re_BufSz   + 1  ! TP
  Re_BufSz   = Re_BufSz   + 1  ! TV
  Re_BufSz   = Re_BufSz   + 1  ! TVL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TF )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TVL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackBeddoesParms

 SUBROUTINE AD_UnPackBeddoesParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BeddoesParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TF = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TVL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBeddoesParms

 SUBROUTINE AD_CopyBladeParms( SrcBladeParmsData, DstBladeParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BladeParms), INTENT(IN) :: SrcBladeParmsData
   TYPE(BladeParms), INTENT(INOUT) :: DstBladeParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcBladeParmsData%C)) THEN
   i1_l = LBOUND(SrcBladeParmsData%C,1)
   i1_u = UBOUND(SrcBladeParmsData%C,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%C)) THEN 
      ALLOCATE(DstBladeParmsData%C(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%C.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%C = SrcBladeParmsData%C
ENDIF
IF (ALLOCATED(SrcBladeParmsData%DR)) THEN
   i1_l = LBOUND(SrcBladeParmsData%DR,1)
   i1_u = UBOUND(SrcBladeParmsData%DR,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%DR)) THEN 
      ALLOCATE(DstBladeParmsData%DR(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%DR.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%DR = SrcBladeParmsData%DR
ENDIF
   DstBladeParmsData%R = SrcBladeParmsData%R
   DstBladeParmsData%BladeLength = SrcBladeParmsData%BladeLength
   DstBladeParmsData%TipRadius = SrcBladeParmsData%TipRadius
   DstBladeParmsData%HubRadius = SrcBladeParmsData%HubRadius
IF (ALLOCATED(SrcBladeParmsData%RTrail)) THEN
   i1_l = LBOUND(SrcBladeParmsData%RTrail,1)
   i1_u = UBOUND(SrcBladeParmsData%RTrail,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%RTrail)) THEN 
      ALLOCATE(DstBladeParmsData%RTrail(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%RTrail.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%RTrail = SrcBladeParmsData%RTrail
ENDIF
IF (ALLOCATED(SrcBladeParmsData%RNodes)) THEN
   i1_l = LBOUND(SrcBladeParmsData%RNodes,1)
   i1_u = UBOUND(SrcBladeParmsData%RNodes,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%RNodes)) THEN 
      ALLOCATE(DstBladeParmsData%RNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%RNodes.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%RNodes = SrcBladeParmsData%RNodes
ENDIF
IF (ALLOCATED(SrcBladeParmsData%AeroCen)) THEN
   i1_l = LBOUND(SrcBladeParmsData%AeroCen,1)
   i1_u = UBOUND(SrcBladeParmsData%AeroCen,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%AeroCen)) THEN 
      ALLOCATE(DstBladeParmsData%AeroCen(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%AeroCen.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%AeroCen = SrcBladeParmsData%AeroCen
ENDIF
 END SUBROUTINE AD_CopyBladeParms

 SUBROUTINE AD_DestroyBladeParms( BladeParmsData, ErrStat, ErrMsg )
  TYPE(BladeParms), INTENT(INOUT) :: BladeParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BladeParmsData%C)) THEN
   DEALLOCATE(BladeParmsData%C)
ENDIF
IF (ALLOCATED(BladeParmsData%DR)) THEN
   DEALLOCATE(BladeParmsData%DR)
ENDIF
IF (ALLOCATED(BladeParmsData%RTrail)) THEN
   DEALLOCATE(BladeParmsData%RTrail)
ENDIF
IF (ALLOCATED(BladeParmsData%RNodes)) THEN
   DEALLOCATE(BladeParmsData%RNodes)
ENDIF
IF (ALLOCATED(BladeParmsData%AeroCen)) THEN
   DEALLOCATE(BladeParmsData%AeroCen)
ENDIF
 END SUBROUTINE AD_DestroyBladeParms

 SUBROUTINE AD_PackBladeParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BladeParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%C) )   Re_BufSz    = Re_BufSz    + SIZE( InData%C )  ! C 
  IF ( ALLOCATED(InData%DR) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DR )  ! DR 
  Re_BufSz   = Re_BufSz   + 1  ! R
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  Db_BufSz   = Db_BufSz   + 1  ! TipRadius
  Db_BufSz   = Db_BufSz   + 1  ! HubRadius
  IF ( ALLOCATED(InData%RTrail) )   Db_BufSz    = Db_BufSz    + SIZE( InData%RTrail )  ! RTrail 
  IF ( ALLOCATED(InData%RNodes) )   Db_BufSz    = Db_BufSz    + SIZE( InData%RNodes )  ! RNodes 
  IF ( ALLOCATED(InData%AeroCen) )   Db_BufSz    = Db_BufSz    + SIZE( InData%AeroCen )  ! AeroCen 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%C) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%C))-1 ) =  PACK(InData%C ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%C)
  ENDIF
  IF ( ALLOCATED(InData%DR) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DR))-1 ) =  PACK(InData%DR ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DR)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%R )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TipRadius )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%HubRadius )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%RTrail) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%RTrail))-1 ) =  PACK(InData%RTrail ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%RTrail)
  ENDIF
  IF ( ALLOCATED(InData%RNodes) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%RNodes))-1 ) =  PACK(InData%RNodes ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%RNodes)
  ENDIF
  IF ( ALLOCATED(InData%AeroCen) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%AeroCen))-1 ) =  PACK(InData%AeroCen ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%AeroCen)
  ENDIF
 END SUBROUTINE AD_PackBladeParms

 SUBROUTINE AD_UnPackBladeParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BladeParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%C) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C,1)))
  mask1 = .TRUE.
    OutData%C = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%C))-1 ),mask1,OutData%C)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%C)
  ENDIF
  IF ( ALLOCATED(OutData%DR) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DR,1)))
  mask1 = .TRUE.
    OutData%DR = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DR))-1 ),mask1,OutData%DR)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DR)
  ENDIF
  OutData%R = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipRadius = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubRadius = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%RTrail) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RTrail,1)))
  mask1 = .TRUE.
    OutData%RTrail = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%RTrail))-1 ),mask1,OutData%RTrail)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%RTrail)
  ENDIF
  IF ( ALLOCATED(OutData%RNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodes,1)))
  mask1 = .TRUE.
    OutData%RNodes = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%RNodes))-1 ),mask1,OutData%RNodes)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%RNodes)
  ENDIF
  IF ( ALLOCATED(OutData%AeroCen) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AeroCen,1)))
  mask1 = .TRUE.
    OutData%AeroCen = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%AeroCen))-1 ),mask1,OutData%AeroCen)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%AeroCen)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBladeParms

 SUBROUTINE AD_CopyDynInflow( SrcDynInflowData, DstDynInflowData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DynInflow), INTENT(IN) :: SrcDynInflowData
   TYPE(DynInflow), INTENT(INOUT) :: DstDynInflowData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDynInflowData%dAlph_dt = SrcDynInflowData%dAlph_dt
   DstDynInflowData%dBeta_dt = SrcDynInflowData%dBeta_dt
   DstDynInflowData%DTO = SrcDynInflowData%DTO
   DstDynInflowData%old_Alph = SrcDynInflowData%old_Alph
   DstDynInflowData%old_Beta = SrcDynInflowData%old_Beta
   DstDynInflowData%old_LmdM = SrcDynInflowData%old_LmdM
   DstDynInflowData%oldKai = SrcDynInflowData%oldKai
   DstDynInflowData%PhiLqC = SrcDynInflowData%PhiLqC
   DstDynInflowData%PhiLqS = SrcDynInflowData%PhiLqS
   DstDynInflowData%Pzero = SrcDynInflowData%Pzero
IF (ALLOCATED(SrcDynInflowData%RMC_SAVE)) THEN
   i1_l = LBOUND(SrcDynInflowData%RMC_SAVE,1)
   i1_u = UBOUND(SrcDynInflowData%RMC_SAVE,1)
   i2_l = LBOUND(SrcDynInflowData%RMC_SAVE,2)
   i2_u = UBOUND(SrcDynInflowData%RMC_SAVE,2)
   i3_l = LBOUND(SrcDynInflowData%RMC_SAVE,3)
   i3_u = UBOUND(SrcDynInflowData%RMC_SAVE,3)
   IF (.NOT. ALLOCATED(DstDynInflowData%RMC_SAVE)) THEN 
      ALLOCATE(DstDynInflowData%RMC_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDynInflowData%RMC_SAVE.', ErrStat, ErrMsg,'AD_CopyDynInflow')
         RETURN
      END IF
   END IF
   DstDynInflowData%RMC_SAVE = SrcDynInflowData%RMC_SAVE
ENDIF
IF (ALLOCATED(SrcDynInflowData%RMS_SAVE)) THEN
   i1_l = LBOUND(SrcDynInflowData%RMS_SAVE,1)
   i1_u = UBOUND(SrcDynInflowData%RMS_SAVE,1)
   i2_l = LBOUND(SrcDynInflowData%RMS_SAVE,2)
   i2_u = UBOUND(SrcDynInflowData%RMS_SAVE,2)
   i3_l = LBOUND(SrcDynInflowData%RMS_SAVE,3)
   i3_u = UBOUND(SrcDynInflowData%RMS_SAVE,3)
   IF (.NOT. ALLOCATED(DstDynInflowData%RMS_SAVE)) THEN 
      ALLOCATE(DstDynInflowData%RMS_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDynInflowData%RMS_SAVE.', ErrStat, ErrMsg,'AD_CopyDynInflow')
         RETURN
      END IF
   END IF
   DstDynInflowData%RMS_SAVE = SrcDynInflowData%RMS_SAVE
ENDIF
   DstDynInflowData%TipSpeed = SrcDynInflowData%TipSpeed
   DstDynInflowData%totalInf = SrcDynInflowData%totalInf
   DstDynInflowData%Vparam = SrcDynInflowData%Vparam
   DstDynInflowData%Vtotal = SrcDynInflowData%Vtotal
   DstDynInflowData%xAlpha = SrcDynInflowData%xAlpha
   DstDynInflowData%xBeta = SrcDynInflowData%xBeta
   DstDynInflowData%xKai = SrcDynInflowData%xKai
   DstDynInflowData%XLAMBDA_M = SrcDynInflowData%XLAMBDA_M
   DstDynInflowData%xLcos = SrcDynInflowData%xLcos
   DstDynInflowData%xLsin = SrcDynInflowData%xLsin
   DstDynInflowData%MminR = SrcDynInflowData%MminR
   DstDynInflowData%MminusR = SrcDynInflowData%MminusR
   DstDynInflowData%MplusR = SrcDynInflowData%MplusR
   DstDynInflowData%GAMMA = SrcDynInflowData%GAMMA
 END SUBROUTINE AD_CopyDynInflow

 SUBROUTINE AD_DestroyDynInflow( DynInflowData, ErrStat, ErrMsg )
  TYPE(DynInflow), INTENT(INOUT) :: DynInflowData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(DynInflowData%RMC_SAVE)) THEN
   DEALLOCATE(DynInflowData%RMC_SAVE)
ENDIF
IF (ALLOCATED(DynInflowData%RMS_SAVE)) THEN
   DEALLOCATE(DynInflowData%RMS_SAVE)
ENDIF
 END SUBROUTINE AD_DestroyDynInflow

 SUBROUTINE AD_PackDynInflow( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DynInflow),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%dAlph_dt )  ! dAlph_dt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%dBeta_dt )  ! dBeta_dt 
  Re_BufSz   = Re_BufSz   + 1  ! DTO
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Alph )  ! old_Alph 
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Beta )  ! old_Beta 
  Re_BufSz   = Re_BufSz   + 1  ! old_LmdM
  Re_BufSz   = Re_BufSz   + 1  ! oldKai
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqC )  ! PhiLqC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqS )  ! PhiLqS 
  Re_BufSz   = Re_BufSz   + 1  ! Pzero
  IF ( ALLOCATED(InData%RMC_SAVE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RMC_SAVE )  ! RMC_SAVE 
  IF ( ALLOCATED(InData%RMS_SAVE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RMS_SAVE )  ! RMS_SAVE 
  Re_BufSz   = Re_BufSz   + 1  ! TipSpeed
  Re_BufSz   = Re_BufSz   + 1  ! totalInf
  Re_BufSz   = Re_BufSz   + 1  ! Vparam
  Re_BufSz   = Re_BufSz   + 1  ! Vtotal
  Re_BufSz    = Re_BufSz    + SIZE( InData%xAlpha )  ! xAlpha 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xBeta )  ! xBeta 
  Re_BufSz   = Re_BufSz   + 1  ! xKai
  Re_BufSz   = Re_BufSz   + 1  ! XLAMBDA_M
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLcos )  ! xLcos 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLsin )  ! xLsin 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminR )  ! MminR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminusR )  ! MminusR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MplusR )  ! MplusR 
  Re_BufSz    = Re_BufSz    + SIZE( InData%GAMMA )  ! GAMMA 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dAlph_dt))-1 ) =  PACK(InData%dAlph_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dAlph_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dBeta_dt))-1 ) =  PACK(InData%dBeta_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dBeta_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTO )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Alph))-1 ) =  PACK(InData%old_Alph ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Alph)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Beta))-1 ) =  PACK(InData%old_Beta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Beta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%old_LmdM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%oldKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqC))-1 ) =  PACK(InData%PhiLqC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqC)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqS))-1 ) =  PACK(InData%PhiLqS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqS)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Pzero )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%RMC_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMC_SAVE))-1 ) =  PACK(InData%RMC_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(InData%RMS_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMS_SAVE))-1 ) =  PACK(InData%RMS_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMS_SAVE)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%totalInf )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vparam )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vtotal )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xAlpha))-1 ) =  PACK(InData%xAlpha ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xAlpha)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xBeta))-1 ) =  PACK(InData%xBeta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xBeta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%xKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%XLAMBDA_M )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLcos))-1 ) =  PACK(InData%xLcos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLcos)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLsin))-1 ) =  PACK(InData%xLsin ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLsin)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminR))-1 ) = PACK(InData%MminR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminusR))-1 ) = PACK(InData%MminusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminusR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MplusR))-1 ) = PACK(InData%MplusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MplusR)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%GAMMA))-1 ) =  PACK(InData%GAMMA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%GAMMA)
 END SUBROUTINE AD_PackDynInflow

 SUBROUTINE AD_UnPackDynInflow( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DynInflow), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%dAlph_dt,1),SIZE(OutData%dAlph_dt,2)))
  mask2 = .TRUE.
  OutData%dAlph_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dAlph_dt))-1 ),mask2,OutData%dAlph_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dAlph_dt)
  ALLOCATE(mask2(SIZE(OutData%dBeta_dt,1),SIZE(OutData%dBeta_dt,2)))
  mask2 = .TRUE.
  OutData%dBeta_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dBeta_dt))-1 ),mask2,OutData%dBeta_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dBeta_dt)
  OutData%DTO = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%old_Alph,1)))
  mask1 = .TRUE.
  OutData%old_Alph = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Alph))-1 ),mask1,OutData%old_Alph)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Alph)
  ALLOCATE(mask1(SIZE(OutData%old_Beta,1)))
  mask1 = .TRUE.
  OutData%old_Beta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Beta))-1 ),mask1,OutData%old_Beta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Beta)
  OutData%old_LmdM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%oldKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%PhiLqC,1)))
  mask1 = .TRUE.
  OutData%PhiLqC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqC))-1 ),mask1,OutData%PhiLqC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqC)
  ALLOCATE(mask1(SIZE(OutData%PhiLqS,1)))
  mask1 = .TRUE.
  OutData%PhiLqS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqS))-1 ),mask1,OutData%PhiLqS)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqS)
  OutData%Pzero = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%RMC_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMC_SAVE,1),SIZE(OutData%RMC_SAVE,2),SIZE(OutData%RMC_SAVE,3)))
  mask3 = .TRUE.
    OutData%RMC_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMC_SAVE))-1 ),mask3,OutData%RMC_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(OutData%RMS_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMS_SAVE,1),SIZE(OutData%RMS_SAVE,2),SIZE(OutData%RMS_SAVE,3)))
  mask3 = .TRUE.
    OutData%RMS_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMS_SAVE))-1 ),mask3,OutData%RMS_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMS_SAVE)
  ENDIF
  OutData%TipSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%totalInf = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vparam = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vtotal = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xAlpha,1)))
  mask1 = .TRUE.
  OutData%xAlpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xAlpha))-1 ),mask1,OutData%xAlpha)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xAlpha)
  ALLOCATE(mask1(SIZE(OutData%xBeta,1)))
  mask1 = .TRUE.
  OutData%xBeta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xBeta))-1 ),mask1,OutData%xBeta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xBeta)
  OutData%xKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%XLAMBDA_M = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask2(SIZE(OutData%xLcos,1),SIZE(OutData%xLcos,2)))
  mask2 = .TRUE.
  OutData%xLcos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLcos))-1 ),mask2,OutData%xLcos)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLcos)
  ALLOCATE(mask2(SIZE(OutData%xLsin,1),SIZE(OutData%xLsin,2)))
  mask2 = .TRUE.
  OutData%xLsin = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLsin))-1 ),mask2,OutData%xLsin)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLsin)
  ALLOCATE(mask2(SIZE(OutData%MminR,1),SIZE(OutData%MminR,2)))
  mask2 = .TRUE.
  OutData%MminR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminR))-1 ),mask2,OutData%MminR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminR)
  ALLOCATE(mask2(SIZE(OutData%MminusR,1),SIZE(OutData%MminusR,2)))
  mask2 = .TRUE.
  OutData%MminusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminusR))-1 ),mask2,OutData%MminusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminusR)
  ALLOCATE(mask2(SIZE(OutData%MplusR,1),SIZE(OutData%MplusR,2)))
  mask2 = .TRUE.
  OutData%MplusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MplusR))-1 ),mask2,OutData%MplusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MplusR)
  ALLOCATE(mask2(SIZE(OutData%GAMMA,1),SIZE(OutData%GAMMA,2)))
  mask2 = .TRUE.
  OutData%GAMMA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%GAMMA))-1 ),mask2,OutData%GAMMA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%GAMMA)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDynInflow

 SUBROUTINE AD_CopyDynInflowParms( SrcDynInflowParmsData, DstDynInflowParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DynInflowParms), INTENT(IN) :: SrcDynInflowParmsData
   TYPE(DynInflowParms), INTENT(INOUT) :: DstDynInflowParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDynInflowParmsData%MAXINFLO = SrcDynInflowParmsData%MAXINFLO
   DstDynInflowParmsData%xMinv = SrcDynInflowParmsData%xMinv
 END SUBROUTINE AD_CopyDynInflowParms

 SUBROUTINE AD_DestroyDynInflowParms( DynInflowParmsData, ErrStat, ErrMsg )
  TYPE(DynInflowParms), INTENT(INOUT) :: DynInflowParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyDynInflowParms

 SUBROUTINE AD_PackDynInflowParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DynInflowParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MAXINFLO
  Re_BufSz    = Re_BufSz    + SIZE( InData%xMinv )  ! xMinv 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXINFLO )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xMinv))-1 ) =  PACK(InData%xMinv ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xMinv)
 END SUBROUTINE AD_PackDynInflowParms

 SUBROUTINE AD_UnPackDynInflowParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DynInflowParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MAXINFLO = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xMinv,1)))
  mask1 = .TRUE.
  OutData%xMinv = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xMinv))-1 ),mask1,OutData%xMinv)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xMinv)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDynInflowParms

 SUBROUTINE AD_CopyElement( SrcElementData, DstElementData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Element), INTENT(IN) :: SrcElementData
   TYPE(Element), INTENT(INOUT) :: DstElementData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcElementData%A)) THEN
   i1_l = LBOUND(SrcElementData%A,1)
   i1_u = UBOUND(SrcElementData%A,1)
   i2_l = LBOUND(SrcElementData%A,2)
   i2_u = UBOUND(SrcElementData%A,2)
   IF (.NOT. ALLOCATED(DstElementData%A)) THEN 
      ALLOCATE(DstElementData%A(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%A.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%A = SrcElementData%A
ENDIF
IF (ALLOCATED(SrcElementData%AP)) THEN
   i1_l = LBOUND(SrcElementData%AP,1)
   i1_u = UBOUND(SrcElementData%AP,1)
   i2_l = LBOUND(SrcElementData%AP,2)
   i2_u = UBOUND(SrcElementData%AP,2)
   IF (.NOT. ALLOCATED(DstElementData%AP)) THEN 
      ALLOCATE(DstElementData%AP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%AP.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%AP = SrcElementData%AP
ENDIF
IF (ALLOCATED(SrcElementData%ALPHA)) THEN
   i1_l = LBOUND(SrcElementData%ALPHA,1)
   i1_u = UBOUND(SrcElementData%ALPHA,1)
   i2_l = LBOUND(SrcElementData%ALPHA,2)
   i2_u = UBOUND(SrcElementData%ALPHA,2)
   IF (.NOT. ALLOCATED(DstElementData%ALPHA)) THEN 
      ALLOCATE(DstElementData%ALPHA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%ALPHA.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%ALPHA = SrcElementData%ALPHA
ENDIF
IF (ALLOCATED(SrcElementData%W2)) THEN
   i1_l = LBOUND(SrcElementData%W2,1)
   i1_u = UBOUND(SrcElementData%W2,1)
   i2_l = LBOUND(SrcElementData%W2,2)
   i2_u = UBOUND(SrcElementData%W2,2)
   IF (.NOT. ALLOCATED(DstElementData%W2)) THEN 
      ALLOCATE(DstElementData%W2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%W2.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%W2 = SrcElementData%W2
ENDIF
IF (ALLOCATED(SrcElementData%OLD_A_NS)) THEN
   i1_l = LBOUND(SrcElementData%OLD_A_NS,1)
   i1_u = UBOUND(SrcElementData%OLD_A_NS,1)
   i2_l = LBOUND(SrcElementData%OLD_A_NS,2)
   i2_u = UBOUND(SrcElementData%OLD_A_NS,2)
   IF (.NOT. ALLOCATED(DstElementData%OLD_A_NS)) THEN 
      ALLOCATE(DstElementData%OLD_A_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%OLD_A_NS.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%OLD_A_NS = SrcElementData%OLD_A_NS
ENDIF
IF (ALLOCATED(SrcElementData%OLD_AP_NS)) THEN
   i1_l = LBOUND(SrcElementData%OLD_AP_NS,1)
   i1_u = UBOUND(SrcElementData%OLD_AP_NS,1)
   i2_l = LBOUND(SrcElementData%OLD_AP_NS,2)
   i2_u = UBOUND(SrcElementData%OLD_AP_NS,2)
   IF (.NOT. ALLOCATED(DstElementData%OLD_AP_NS)) THEN 
      ALLOCATE(DstElementData%OLD_AP_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%OLD_AP_NS.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%OLD_AP_NS = SrcElementData%OLD_AP_NS
ENDIF
   DstElementData%PITNOW = SrcElementData%PITNOW
 END SUBROUTINE AD_CopyElement

 SUBROUTINE AD_DestroyElement( ElementData, ErrStat, ErrMsg )
  TYPE(Element), INTENT(INOUT) :: ElementData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElementData%A)) THEN
   DEALLOCATE(ElementData%A)
ENDIF
IF (ALLOCATED(ElementData%AP)) THEN
   DEALLOCATE(ElementData%AP)
ENDIF
IF (ALLOCATED(ElementData%ALPHA)) THEN
   DEALLOCATE(ElementData%ALPHA)
ENDIF
IF (ALLOCATED(ElementData%W2)) THEN
   DEALLOCATE(ElementData%W2)
ENDIF
IF (ALLOCATED(ElementData%OLD_A_NS)) THEN
   DEALLOCATE(ElementData%OLD_A_NS)
ENDIF
IF (ALLOCATED(ElementData%OLD_AP_NS)) THEN
   DEALLOCATE(ElementData%OLD_AP_NS)
ENDIF
 END SUBROUTINE AD_DestroyElement

 SUBROUTINE AD_PackElement( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Element),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%A) )   Re_BufSz    = Re_BufSz    + SIZE( InData%A )  ! A 
  IF ( ALLOCATED(InData%AP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AP )  ! AP 
  IF ( ALLOCATED(InData%ALPHA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ALPHA )  ! ALPHA 
  IF ( ALLOCATED(InData%W2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%W2 )  ! W2 
  IF ( ALLOCATED(InData%OLD_A_NS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_A_NS )  ! OLD_A_NS 
  IF ( ALLOCATED(InData%OLD_AP_NS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_AP_NS )  ! OLD_AP_NS 
  Re_BufSz   = Re_BufSz   + 1  ! PITNOW
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%A) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%A))-1 ) =  PACK(InData%A ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%A)
  ENDIF
  IF ( ALLOCATED(InData%AP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AP))-1 ) =  PACK(InData%AP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AP)
  ENDIF
  IF ( ALLOCATED(InData%ALPHA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALPHA))-1 ) =  PACK(InData%ALPHA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALPHA)
  ENDIF
  IF ( ALLOCATED(InData%W2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%W2))-1 ) =  PACK(InData%W2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%W2)
  ENDIF
  IF ( ALLOCATED(InData%OLD_A_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_A_NS))-1 ) =  PACK(InData%OLD_A_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(InData%OLD_AP_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_AP_NS))-1 ) =  PACK(InData%OLD_AP_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_AP_NS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PITNOW )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackElement

 SUBROUTINE AD_UnPackElement( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Element), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%A) ) THEN
  ALLOCATE(mask2(SIZE(OutData%A,1),SIZE(OutData%A,2)))
  mask2 = .TRUE.
    OutData%A = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%A))-1 ),mask2,OutData%A)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%A)
  ENDIF
  IF ( ALLOCATED(OutData%AP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AP,1),SIZE(OutData%AP,2)))
  mask2 = .TRUE.
    OutData%AP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AP))-1 ),mask2,OutData%AP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AP)
  ENDIF
  IF ( ALLOCATED(OutData%ALPHA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ALPHA,1),SIZE(OutData%ALPHA,2)))
  mask2 = .TRUE.
    OutData%ALPHA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALPHA))-1 ),mask2,OutData%ALPHA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALPHA)
  ENDIF
  IF ( ALLOCATED(OutData%W2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%W2,1),SIZE(OutData%W2,2)))
  mask2 = .TRUE.
    OutData%W2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%W2))-1 ),mask2,OutData%W2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%W2)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_A_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_A_NS,1),SIZE(OutData%OLD_A_NS,2)))
  mask2 = .TRUE.
    OutData%OLD_A_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_A_NS))-1 ),mask2,OutData%OLD_A_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_AP_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_AP_NS,1),SIZE(OutData%OLD_AP_NS,2)))
  mask2 = .TRUE.
    OutData%OLD_AP_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_AP_NS))-1 ),mask2,OutData%OLD_AP_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_AP_NS)
  ENDIF
  OutData%PITNOW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElement

 SUBROUTINE AD_CopyElementParms( SrcElementParmsData, DstElementParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ElementParms), INTENT(IN) :: SrcElementParmsData
   TYPE(ElementParms), INTENT(INOUT) :: DstElementParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstElementParmsData%NELM = SrcElementParmsData%NELM
IF (ALLOCATED(SrcElementParmsData%TWIST)) THEN
   i1_l = LBOUND(SrcElementParmsData%TWIST,1)
   i1_u = UBOUND(SrcElementParmsData%TWIST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%TWIST)) THEN 
      ALLOCATE(DstElementParmsData%TWIST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%TWIST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%TWIST = SrcElementParmsData%TWIST
ENDIF
IF (ALLOCATED(SrcElementParmsData%RELM)) THEN
   i1_l = LBOUND(SrcElementParmsData%RELM,1)
   i1_u = UBOUND(SrcElementParmsData%RELM,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%RELM)) THEN 
      ALLOCATE(DstElementParmsData%RELM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%RELM.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%RELM = SrcElementParmsData%RELM
ENDIF
IF (ALLOCATED(SrcElementParmsData%HLCNST)) THEN
   i1_l = LBOUND(SrcElementParmsData%HLCNST,1)
   i1_u = UBOUND(SrcElementParmsData%HLCNST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%HLCNST)) THEN 
      ALLOCATE(DstElementParmsData%HLCNST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%HLCNST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%HLCNST = SrcElementParmsData%HLCNST
ENDIF
IF (ALLOCATED(SrcElementParmsData%TLCNST)) THEN
   i1_l = LBOUND(SrcElementParmsData%TLCNST,1)
   i1_u = UBOUND(SrcElementParmsData%TLCNST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%TLCNST)) THEN 
      ALLOCATE(DstElementParmsData%TLCNST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%TLCNST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%TLCNST = SrcElementParmsData%TLCNST
ENDIF
 END SUBROUTINE AD_CopyElementParms

 SUBROUTINE AD_DestroyElementParms( ElementParmsData, ErrStat, ErrMsg )
  TYPE(ElementParms), INTENT(INOUT) :: ElementParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElementParmsData%TWIST)) THEN
   DEALLOCATE(ElementParmsData%TWIST)
ENDIF
IF (ALLOCATED(ElementParmsData%RELM)) THEN
   DEALLOCATE(ElementParmsData%RELM)
ENDIF
IF (ALLOCATED(ElementParmsData%HLCNST)) THEN
   DEALLOCATE(ElementParmsData%HLCNST)
ENDIF
IF (ALLOCATED(ElementParmsData%TLCNST)) THEN
   DEALLOCATE(ElementParmsData%TLCNST)
ENDIF
 END SUBROUTINE AD_DestroyElementParms

 SUBROUTINE AD_PackElementParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ElementParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NELM
  IF ( ALLOCATED(InData%TWIST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TWIST )  ! TWIST 
  IF ( ALLOCATED(InData%RELM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RELM )  ! RELM 
  IF ( ALLOCATED(InData%HLCNST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%HLCNST )  ! HLCNST 
  IF ( ALLOCATED(InData%TLCNST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TLCNST )  ! TLCNST 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NELM )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TWIST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TWIST))-1 ) =  PACK(InData%TWIST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TWIST)
  ENDIF
  IF ( ALLOCATED(InData%RELM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RELM))-1 ) =  PACK(InData%RELM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RELM)
  ENDIF
  IF ( ALLOCATED(InData%HLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HLCNST))-1 ) =  PACK(InData%HLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HLCNST)
  ENDIF
  IF ( ALLOCATED(InData%TLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TLCNST))-1 ) =  PACK(InData%TLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TLCNST)
  ENDIF
 END SUBROUTINE AD_PackElementParms

 SUBROUTINE AD_UnPackElementParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ElementParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NELM = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TWIST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TWIST,1)))
  mask1 = .TRUE.
    OutData%TWIST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TWIST))-1 ),mask1,OutData%TWIST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TWIST)
  ENDIF
  IF ( ALLOCATED(OutData%RELM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RELM,1)))
  mask1 = .TRUE.
    OutData%RELM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RELM))-1 ),mask1,OutData%RELM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RELM)
  ENDIF
  IF ( ALLOCATED(OutData%HLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HLCNST,1)))
  mask1 = .TRUE.
    OutData%HLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HLCNST))-1 ),mask1,OutData%HLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HLCNST)
  ENDIF
  IF ( ALLOCATED(OutData%TLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TLCNST,1)))
  mask1 = .TRUE.
    OutData%TLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TLCNST))-1 ),mask1,OutData%TLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TLCNST)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElementParms

 SUBROUTINE AD_CopyElOutParms( SrcElOutParmsData, DstElOutParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ElOutParms), INTENT(IN) :: SrcElOutParmsData
   TYPE(ElOutParms), INTENT(INOUT) :: DstElOutParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcElOutParmsData%AAA)) THEN
   i1_l = LBOUND(SrcElOutParmsData%AAA,1)
   i1_u = UBOUND(SrcElOutParmsData%AAA,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%AAA)) THEN 
      ALLOCATE(DstElOutParmsData%AAA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%AAA.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%AAA = SrcElOutParmsData%AAA
ENDIF
IF (ALLOCATED(SrcElOutParmsData%AAP)) THEN
   i1_l = LBOUND(SrcElOutParmsData%AAP,1)
   i1_u = UBOUND(SrcElOutParmsData%AAP,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%AAP)) THEN 
      ALLOCATE(DstElOutParmsData%AAP(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%AAP.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%AAP = SrcElOutParmsData%AAP
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ALF)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ALF,1)
   i1_u = UBOUND(SrcElOutParmsData%ALF,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ALF)) THEN 
      ALLOCATE(DstElOutParmsData%ALF(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ALF.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ALF = SrcElOutParmsData%ALF
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CDD)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CDD,1)
   i1_u = UBOUND(SrcElOutParmsData%CDD,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CDD)) THEN 
      ALLOCATE(DstElOutParmsData%CDD(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CDD.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CDD = SrcElOutParmsData%CDD
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CLL)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CLL,1)
   i1_u = UBOUND(SrcElOutParmsData%CLL,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CLL)) THEN 
      ALLOCATE(DstElOutParmsData%CLL(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CLL.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CLL = SrcElOutParmsData%CLL
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CMM)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CMM,1)
   i1_u = UBOUND(SrcElOutParmsData%CMM,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CMM)) THEN 
      ALLOCATE(DstElOutParmsData%CMM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CMM.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CMM = SrcElOutParmsData%CMM
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CNN)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CNN,1)
   i1_u = UBOUND(SrcElOutParmsData%CNN,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CNN)) THEN 
      ALLOCATE(DstElOutParmsData%CNN(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CNN.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CNN = SrcElOutParmsData%CNN
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CTT)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CTT,1)
   i1_u = UBOUND(SrcElOutParmsData%CTT,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CTT)) THEN 
      ALLOCATE(DstElOutParmsData%CTT(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CTT.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CTT = SrcElOutParmsData%CTT
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DFNSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DFNSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%DFNSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DFNSAV)) THEN 
      ALLOCATE(DstElOutParmsData%DFNSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DFNSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DFNSAV = SrcElOutParmsData%DFNSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DFTSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DFTSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%DFTSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DFTSAV)) THEN 
      ALLOCATE(DstElOutParmsData%DFTSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DFTSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DFTSAV = SrcElOutParmsData%DFTSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DynPres)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DynPres,1)
   i1_u = UBOUND(SrcElOutParmsData%DynPres,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DynPres)) THEN 
      ALLOCATE(DstElOutParmsData%DynPres(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DynPres.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DynPres = SrcElOutParmsData%DynPres
ENDIF
IF (ALLOCATED(SrcElOutParmsData%PMM)) THEN
   i1_l = LBOUND(SrcElOutParmsData%PMM,1)
   i1_u = UBOUND(SrcElOutParmsData%PMM,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%PMM)) THEN 
      ALLOCATE(DstElOutParmsData%PMM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%PMM.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%PMM = SrcElOutParmsData%PMM
ENDIF
IF (ALLOCATED(SrcElOutParmsData%PITSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%PITSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%PITSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%PITSAV)) THEN 
      ALLOCATE(DstElOutParmsData%PITSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%PITSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%PITSAV = SrcElOutParmsData%PITSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ReyNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ReyNum,1)
   i1_u = UBOUND(SrcElOutParmsData%ReyNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ReyNum)) THEN 
      ALLOCATE(DstElOutParmsData%ReyNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ReyNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ReyNum = SrcElOutParmsData%ReyNum
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVX)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVX,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVX,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVX,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVX,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVX)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVX.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVX = SrcElOutParmsData%SaveVX
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVY)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVY,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVY,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVY,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVY,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVY)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVY(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVY.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVY = SrcElOutParmsData%SaveVY
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVZ)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVZ,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVZ,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVZ,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVZ,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVZ)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVZ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVZ.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVZ = SrcElOutParmsData%SaveVZ
ENDIF
   DstElOutParmsData%VXSAV = SrcElOutParmsData%VXSAV
   DstElOutParmsData%VYSAV = SrcElOutParmsData%VYSAV
   DstElOutParmsData%VZSAV = SrcElOutParmsData%VZSAV
   DstElOutParmsData%NumWndElOut = SrcElOutParmsData%NumWndElOut
IF (ALLOCATED(SrcElOutParmsData%WndElPrList)) THEN
   i1_l = LBOUND(SrcElOutParmsData%WndElPrList,1)
   i1_u = UBOUND(SrcElOutParmsData%WndElPrList,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%WndElPrList)) THEN 
      ALLOCATE(DstElOutParmsData%WndElPrList(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%WndElPrList.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%WndElPrList = SrcElOutParmsData%WndElPrList
ENDIF
IF (ALLOCATED(SrcElOutParmsData%WndElPrNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%WndElPrNum,1)
   i1_u = UBOUND(SrcElOutParmsData%WndElPrNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%WndElPrNum)) THEN 
      ALLOCATE(DstElOutParmsData%WndElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%WndElPrNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%WndElPrNum = SrcElOutParmsData%WndElPrNum
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ElPrList)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ElPrList,1)
   i1_u = UBOUND(SrcElOutParmsData%ElPrList,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ElPrList)) THEN 
      ALLOCATE(DstElOutParmsData%ElPrList(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ElPrList.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ElPrList = SrcElOutParmsData%ElPrList
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ElPrNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ElPrNum,1)
   i1_u = UBOUND(SrcElOutParmsData%ElPrNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ElPrNum)) THEN 
      ALLOCATE(DstElOutParmsData%ElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ElPrNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ElPrNum = SrcElOutParmsData%ElPrNum
ENDIF
   DstElOutParmsData%NumElOut = SrcElOutParmsData%NumElOut
 END SUBROUTINE AD_CopyElOutParms

 SUBROUTINE AD_DestroyElOutParms( ElOutParmsData, ErrStat, ErrMsg )
  TYPE(ElOutParms), INTENT(INOUT) :: ElOutParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElOutParmsData%AAA)) THEN
   DEALLOCATE(ElOutParmsData%AAA)
ENDIF
IF (ALLOCATED(ElOutParmsData%AAP)) THEN
   DEALLOCATE(ElOutParmsData%AAP)
ENDIF
IF (ALLOCATED(ElOutParmsData%ALF)) THEN
   DEALLOCATE(ElOutParmsData%ALF)
ENDIF
IF (ALLOCATED(ElOutParmsData%CDD)) THEN
   DEALLOCATE(ElOutParmsData%CDD)
ENDIF
IF (ALLOCATED(ElOutParmsData%CLL)) THEN
   DEALLOCATE(ElOutParmsData%CLL)
ENDIF
IF (ALLOCATED(ElOutParmsData%CMM)) THEN
   DEALLOCATE(ElOutParmsData%CMM)
ENDIF
IF (ALLOCATED(ElOutParmsData%CNN)) THEN
   DEALLOCATE(ElOutParmsData%CNN)
ENDIF
IF (ALLOCATED(ElOutParmsData%CTT)) THEN
   DEALLOCATE(ElOutParmsData%CTT)
ENDIF
IF (ALLOCATED(ElOutParmsData%DFNSAV)) THEN
   DEALLOCATE(ElOutParmsData%DFNSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%DFTSAV)) THEN
   DEALLOCATE(ElOutParmsData%DFTSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%DynPres)) THEN
   DEALLOCATE(ElOutParmsData%DynPres)
ENDIF
IF (ALLOCATED(ElOutParmsData%PMM)) THEN
   DEALLOCATE(ElOutParmsData%PMM)
ENDIF
IF (ALLOCATED(ElOutParmsData%PITSAV)) THEN
   DEALLOCATE(ElOutParmsData%PITSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%ReyNum)) THEN
   DEALLOCATE(ElOutParmsData%ReyNum)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVX)) THEN
   DEALLOCATE(ElOutParmsData%SaveVX)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVY)) THEN
   DEALLOCATE(ElOutParmsData%SaveVY)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVZ)) THEN
   DEALLOCATE(ElOutParmsData%SaveVZ)
ENDIF
IF (ALLOCATED(ElOutParmsData%WndElPrList)) THEN
   DEALLOCATE(ElOutParmsData%WndElPrList)
ENDIF
IF (ALLOCATED(ElOutParmsData%WndElPrNum)) THEN
   DEALLOCATE(ElOutParmsData%WndElPrNum)
ENDIF
IF (ALLOCATED(ElOutParmsData%ElPrList)) THEN
   DEALLOCATE(ElOutParmsData%ElPrList)
ENDIF
IF (ALLOCATED(ElOutParmsData%ElPrNum)) THEN
   DEALLOCATE(ElOutParmsData%ElPrNum)
ENDIF
 END SUBROUTINE AD_DestroyElOutParms

 SUBROUTINE AD_PackElOutParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ElOutParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%AAA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AAA )  ! AAA 
  IF ( ALLOCATED(InData%AAP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AAP )  ! AAP 
  IF ( ALLOCATED(InData%ALF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ALF )  ! ALF 
  IF ( ALLOCATED(InData%CDD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CDD )  ! CDD 
  IF ( ALLOCATED(InData%CLL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CLL )  ! CLL 
  IF ( ALLOCATED(InData%CMM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CMM )  ! CMM 
  IF ( ALLOCATED(InData%CNN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNN )  ! CNN 
  IF ( ALLOCATED(InData%CTT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CTT )  ! CTT 
  IF ( ALLOCATED(InData%DFNSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFNSAV )  ! DFNSAV 
  IF ( ALLOCATED(InData%DFTSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFTSAV )  ! DFTSAV 
  IF ( ALLOCATED(InData%DynPres) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DynPres )  ! DynPres 
  IF ( ALLOCATED(InData%PMM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMM )  ! PMM 
  IF ( ALLOCATED(InData%PITSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PITSAV )  ! PITSAV 
  IF ( ALLOCATED(InData%ReyNum) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ReyNum )  ! ReyNum 
  IF ( ALLOCATED(InData%SaveVX) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVX )  ! SaveVX 
  IF ( ALLOCATED(InData%SaveVY) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVY )  ! SaveVY 
  IF ( ALLOCATED(InData%SaveVZ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVZ )  ! SaveVZ 
  Re_BufSz   = Re_BufSz   + 1  ! VXSAV
  Re_BufSz   = Re_BufSz   + 1  ! VYSAV
  Re_BufSz   = Re_BufSz   + 1  ! VZSAV
  Int_BufSz  = Int_BufSz  + 1  ! NumWndElOut
  IF ( ALLOCATED(InData%WndElPrList) )   Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrList )  ! WndElPrList 
  IF ( ALLOCATED(InData%WndElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrNum )  ! WndElPrNum 
  IF ( ALLOCATED(InData%ElPrList) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrList )  ! ElPrList 
  IF ( ALLOCATED(InData%ElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Int_BufSz  = Int_BufSz  + 1  ! NumElOut
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AAA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAA))-1 ) =  PACK(InData%AAA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAA)
  ENDIF
  IF ( ALLOCATED(InData%AAP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAP))-1 ) =  PACK(InData%AAP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAP)
  ENDIF
  IF ( ALLOCATED(InData%ALF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALF))-1 ) =  PACK(InData%ALF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALF)
  ENDIF
  IF ( ALLOCATED(InData%CDD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDD))-1 ) =  PACK(InData%CDD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDD)
  ENDIF
  IF ( ALLOCATED(InData%CLL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CLL))-1 ) =  PACK(InData%CLL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CLL)
  ENDIF
  IF ( ALLOCATED(InData%CMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CMM))-1 ) =  PACK(InData%CMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CMM)
  ENDIF
  IF ( ALLOCATED(InData%CNN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNN))-1 ) =  PACK(InData%CNN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNN)
  ENDIF
  IF ( ALLOCATED(InData%CTT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTT))-1 ) =  PACK(InData%CTT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CTT)
  ENDIF
  IF ( ALLOCATED(InData%DFNSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFNSAV))-1 ) =  PACK(InData%DFNSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(InData%DFTSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFTSAV))-1 ) =  PACK(InData%DFTSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(InData%DynPres) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DynPres))-1 ) =  PACK(InData%DynPres ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DynPres)
  ENDIF
  IF ( ALLOCATED(InData%PMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMM))-1 ) =  PACK(InData%PMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMM)
  ENDIF
  IF ( ALLOCATED(InData%PITSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PITSAV))-1 ) =  PACK(InData%PITSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PITSAV)
  ENDIF
  IF ( ALLOCATED(InData%ReyNum) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ReyNum))-1 ) =  PACK(InData%ReyNum ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ReyNum)
  ENDIF
  IF ( ALLOCATED(InData%SaveVX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVX))-1 ) =  PACK(InData%SaveVX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVX)
  ENDIF
  IF ( ALLOCATED(InData%SaveVY) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVY))-1 ) =  PACK(InData%SaveVY ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVY)
  ENDIF
  IF ( ALLOCATED(InData%SaveVZ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVZ))-1 ) =  PACK(InData%SaveVZ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVZ)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VXSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VYSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VZSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumWndElOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%WndElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrList))-1 ) = PACK(InData%WndElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(InData%WndElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrNum))-1 ) = PACK(InData%WndElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(InData%ElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrList))-1 ) = PACK(InData%ElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrList)
  ENDIF
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumElOut )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackElOutParms

 SUBROUTINE AD_UnPackElOutParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ElOutParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AAA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAA,1)))
  mask1 = .TRUE.
    OutData%AAA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAA))-1 ),mask1,OutData%AAA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAA)
  ENDIF
  IF ( ALLOCATED(OutData%AAP) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAP,1)))
  mask1 = .TRUE.
    OutData%AAP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAP))-1 ),mask1,OutData%AAP)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAP)
  ENDIF
  IF ( ALLOCATED(OutData%ALF) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ALF,1)))
  mask1 = .TRUE.
    OutData%ALF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALF))-1 ),mask1,OutData%ALF)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALF)
  ENDIF
  IF ( ALLOCATED(OutData%CDD) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CDD,1)))
  mask1 = .TRUE.
    OutData%CDD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDD))-1 ),mask1,OutData%CDD)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDD)
  ENDIF
  IF ( ALLOCATED(OutData%CLL) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CLL,1)))
  mask1 = .TRUE.
    OutData%CLL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CLL))-1 ),mask1,OutData%CLL)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CLL)
  ENDIF
  IF ( ALLOCATED(OutData%CMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CMM,1)))
  mask1 = .TRUE.
    OutData%CMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CMM))-1 ),mask1,OutData%CMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CMM)
  ENDIF
  IF ( ALLOCATED(OutData%CNN) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CNN,1)))
  mask1 = .TRUE.
    OutData%CNN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNN))-1 ),mask1,OutData%CNN)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNN)
  ENDIF
  IF ( ALLOCATED(OutData%CTT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CTT,1)))
  mask1 = .TRUE.
    OutData%CTT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTT))-1 ),mask1,OutData%CTT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CTT)
  ENDIF
  IF ( ALLOCATED(OutData%DFNSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFNSAV,1)))
  mask1 = .TRUE.
    OutData%DFNSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFNSAV))-1 ),mask1,OutData%DFNSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DFTSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFTSAV,1)))
  mask1 = .TRUE.
    OutData%DFTSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFTSAV))-1 ),mask1,OutData%DFTSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DynPres) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DynPres,1)))
  mask1 = .TRUE.
    OutData%DynPres = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DynPres))-1 ),mask1,OutData%DynPres)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DynPres)
  ENDIF
  IF ( ALLOCATED(OutData%PMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PMM,1)))
  mask1 = .TRUE.
    OutData%PMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMM))-1 ),mask1,OutData%PMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMM)
  ENDIF
  IF ( ALLOCATED(OutData%PITSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PITSAV,1)))
  mask1 = .TRUE.
    OutData%PITSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PITSAV))-1 ),mask1,OutData%PITSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PITSAV)
  ENDIF
  IF ( ALLOCATED(OutData%ReyNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ReyNum,1)))
  mask1 = .TRUE.
    OutData%ReyNum = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ReyNum))-1 ),mask1,OutData%ReyNum)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ReyNum)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVX,1),SIZE(OutData%SaveVX,2)))
  mask2 = .TRUE.
    OutData%SaveVX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVX))-1 ),mask2,OutData%SaveVX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVX)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVY) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVY,1),SIZE(OutData%SaveVY,2)))
  mask2 = .TRUE.
    OutData%SaveVY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVY))-1 ),mask2,OutData%SaveVY)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVY)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVZ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVZ,1),SIZE(OutData%SaveVZ,2)))
  mask2 = .TRUE.
    OutData%SaveVZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVZ))-1 ),mask2,OutData%SaveVZ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVZ)
  ENDIF
  OutData%VXSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VYSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VZSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumWndElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%WndElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrList,1)))
  mask1 = .TRUE.
    OutData%WndElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrList))-1 ),mask1,OutData%WndElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%WndElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrNum,1)))
  mask1 = .TRUE.
    OutData%WndElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrNum))-1 ),mask1,OutData%WndElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrList,1)))
  mask1 = .TRUE.
    OutData%ElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrList))-1 ),mask1,OutData%ElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1)))
  mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%NumElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElOutParms

 SUBROUTINE AD_CopyInducedVel( SrcInducedVelData, DstInducedVelData, CtrlCode, ErrStat, ErrMsg )
   TYPE(InducedVel), INTENT(IN) :: SrcInducedVelData
   TYPE(InducedVel), INTENT(INOUT) :: DstInducedVelData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInducedVelData%SumInFl = SrcInducedVelData%SumInFl
 END SUBROUTINE AD_CopyInducedVel

 SUBROUTINE AD_DestroyInducedVel( InducedVelData, ErrStat, ErrMsg )
  TYPE(InducedVel), INTENT(INOUT) :: InducedVelData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyInducedVel

 SUBROUTINE AD_PackInducedVel( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(InducedVel),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! SumInFl
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SumInFl )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackInducedVel

 SUBROUTINE AD_UnPackInducedVel( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(InducedVel), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%SumInFl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInducedVel

 SUBROUTINE AD_CopyInducedVelParms( SrcInducedVelParmsData, DstInducedVelParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(InducedVelParms), INTENT(IN) :: SrcInducedVelParmsData
   TYPE(InducedVelParms), INTENT(INOUT) :: DstInducedVelParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInducedVelParmsData%AToler = SrcInducedVelParmsData%AToler
   DstInducedVelParmsData%EqAIDmult = SrcInducedVelParmsData%EqAIDmult
   DstInducedVelParmsData%EquilDA = SrcInducedVelParmsData%EquilDA
   DstInducedVelParmsData%EquilDT = SrcInducedVelParmsData%EquilDT
   DstInducedVelParmsData%TLoss = SrcInducedVelParmsData%TLoss
   DstInducedVelParmsData%GTech = SrcInducedVelParmsData%GTech
   DstInducedVelParmsData%HLoss = SrcInducedVelParmsData%HLoss
 END SUBROUTINE AD_CopyInducedVelParms

 SUBROUTINE AD_DestroyInducedVelParms( InducedVelParmsData, ErrStat, ErrMsg )
  TYPE(InducedVelParms), INTENT(INOUT) :: InducedVelParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyInducedVelParms

 SUBROUTINE AD_PackInducedVelParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(InducedVelParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AToler
  Re_BufSz   = Re_BufSz   + 1  ! EqAIDmult
  Int_BufSz  = Int_BufSz  + 1  ! EquilDA
  Int_BufSz  = Int_BufSz  + 1  ! EquilDT
  Int_BufSz  = Int_BufSz  + 1  ! TLoss
  Int_BufSz  = Int_BufSz  + 1  ! GTech
  Int_BufSz  = Int_BufSz  + 1  ! HLoss
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AToler )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%EqAIDmult )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%EquilDA ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%EquilDT ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TLoss ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%GTech ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%HLoss ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackInducedVelParms

 SUBROUTINE AD_UnPackInducedVelParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(InducedVelParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AToler = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%EqAIDmult = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInducedVelParms

 SUBROUTINE AD_CopyRotor( SrcRotorData, DstRotorData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Rotor), INTENT(IN) :: SrcRotorData
   TYPE(Rotor), INTENT(INOUT) :: DstRotorData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRotorData%AVGINFL = SrcRotorData%AVGINFL
   DstRotorData%CTILT = SrcRotorData%CTILT
   DstRotorData%CYaw = SrcRotorData%CYaw
   DstRotorData%REVS = SrcRotorData%REVS
   DstRotorData%STILT = SrcRotorData%STILT
   DstRotorData%SYaw = SrcRotorData%SYaw
   DstRotorData%TILT = SrcRotorData%TILT
   DstRotorData%YawAng = SrcRotorData%YawAng
   DstRotorData%YawVEL = SrcRotorData%YawVEL
 END SUBROUTINE AD_CopyRotor

 SUBROUTINE AD_DestroyRotor( RotorData, ErrStat, ErrMsg )
  TYPE(Rotor), INTENT(INOUT) :: RotorData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyRotor

 SUBROUTINE AD_PackRotor( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Rotor),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AVGINFL
  Re_BufSz   = Re_BufSz   + 1  ! CTILT
  Re_BufSz   = Re_BufSz   + 1  ! CYaw
  Re_BufSz   = Re_BufSz   + 1  ! REVS
  Re_BufSz   = Re_BufSz   + 1  ! STILT
  Re_BufSz   = Re_BufSz   + 1  ! SYaw
  Re_BufSz   = Re_BufSz   + 1  ! TILT
  Re_BufSz   = Re_BufSz   + 1  ! YawAng
  Re_BufSz   = Re_BufSz   + 1  ! YawVEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AVGINFL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%REVS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawAng )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawVEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackRotor

 SUBROUTINE AD_UnPackRotor( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Rotor), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AVGINFL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%REVS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawAng = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawVEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackRotor

 SUBROUTINE AD_CopyRotorParms( SrcRotorParmsData, DstRotorParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(RotorParms), INTENT(IN) :: SrcRotorParmsData
   TYPE(RotorParms), INTENT(INOUT) :: DstRotorParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRotorParmsData%HH = SrcRotorParmsData%HH
 END SUBROUTINE AD_CopyRotorParms

 SUBROUTINE AD_DestroyRotorParms( RotorParmsData, ErrStat, ErrMsg )
  TYPE(RotorParms), INTENT(INOUT) :: RotorParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyRotorParms

 SUBROUTINE AD_PackRotorParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(RotorParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! HH
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HH )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackRotorParms

 SUBROUTINE AD_UnPackRotorParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(RotorParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%HH = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackRotorParms

 SUBROUTINE AD_CopyTwrPropsParms( SrcTwrPropsParmsData, DstTwrPropsParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(TwrPropsParms), INTENT(IN) :: SrcTwrPropsParmsData
   TYPE(TwrPropsParms), INTENT(INOUT) :: DstTwrPropsParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcTwrPropsParmsData%TwrHtFr)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrHtFr,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrHtFr,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrHtFr)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrHtFr(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrHtFr.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrHtFr = SrcTwrPropsParmsData%TwrHtFr
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrWid)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrWid,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrWid,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrWid)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrWid(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrWid.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrWid = SrcTwrPropsParmsData%TwrWid
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrCD)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrCD,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrCD,1)
   i2_l = LBOUND(SrcTwrPropsParmsData%TwrCD,2)
   i2_u = UBOUND(SrcTwrPropsParmsData%TwrCD,2)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrCD)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrCD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrCD.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrCD = SrcTwrPropsParmsData%TwrCD
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrRe)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrRe,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrRe,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrRe)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrRe(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrRe.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrRe = SrcTwrPropsParmsData%TwrRe
ENDIF
   DstTwrPropsParmsData%VTwr = SrcTwrPropsParmsData%VTwr
   DstTwrPropsParmsData%Tower_Wake_Constant = SrcTwrPropsParmsData%Tower_Wake_Constant
IF (ALLOCATED(SrcTwrPropsParmsData%NTwrCDCol)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%NTwrCDCol,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%NTwrCDCol,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%NTwrCDCol)) THEN 
      ALLOCATE(DstTwrPropsParmsData%NTwrCDCol(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%NTwrCDCol.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%NTwrCDCol = SrcTwrPropsParmsData%NTwrCDCol
ENDIF
   DstTwrPropsParmsData%NTwrHT = SrcTwrPropsParmsData%NTwrHT
   DstTwrPropsParmsData%NTwrRe = SrcTwrPropsParmsData%NTwrRe
   DstTwrPropsParmsData%NTwrCD = SrcTwrPropsParmsData%NTwrCD
   DstTwrPropsParmsData%TwrPotent = SrcTwrPropsParmsData%TwrPotent
   DstTwrPropsParmsData%TwrShadow = SrcTwrPropsParmsData%TwrShadow
   DstTwrPropsParmsData%ShadHWid = SrcTwrPropsParmsData%ShadHWid
   DstTwrPropsParmsData%TShadC1 = SrcTwrPropsParmsData%TShadC1
   DstTwrPropsParmsData%TShadC2 = SrcTwrPropsParmsData%TShadC2
   DstTwrPropsParmsData%TwrShad = SrcTwrPropsParmsData%TwrShad
   DstTwrPropsParmsData%PJM_Version = SrcTwrPropsParmsData%PJM_Version
   DstTwrPropsParmsData%TwrFile = SrcTwrPropsParmsData%TwrFile
   DstTwrPropsParmsData%T_Shad_Refpt = SrcTwrPropsParmsData%T_Shad_Refpt
   DstTwrPropsParmsData%CalcTwrAero = SrcTwrPropsParmsData%CalcTwrAero
   DstTwrPropsParmsData%NumTwrNodes = SrcTwrPropsParmsData%NumTwrNodes
IF (ALLOCATED(SrcTwrPropsParmsData%TwrNodeWidth)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrNodeWidth,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrNodeWidth,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrNodeWidth)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrNodeWidth(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrNodeWidth.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrNodeWidth = SrcTwrPropsParmsData%TwrNodeWidth
ENDIF
 END SUBROUTINE AD_CopyTwrPropsParms

 SUBROUTINE AD_DestroyTwrPropsParms( TwrPropsParmsData, ErrStat, ErrMsg )
  TYPE(TwrPropsParms), INTENT(INOUT) :: TwrPropsParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(TwrPropsParmsData%TwrHtFr)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrHtFr)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrWid)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrWid)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrCD)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrCD)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrRe)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrRe)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%NTwrCDCol)) THEN
   DEALLOCATE(TwrPropsParmsData%NTwrCDCol)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrNodeWidth)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrNodeWidth)
ENDIF
 END SUBROUTINE AD_DestroyTwrPropsParms

 SUBROUTINE AD_PackTwrPropsParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(TwrPropsParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%TwrHtFr) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrHtFr )  ! TwrHtFr 
  IF ( ALLOCATED(InData%TwrWid) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrWid )  ! TwrWid 
  IF ( ALLOCATED(InData%TwrCD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrCD )  ! TwrCD 
  IF ( ALLOCATED(InData%TwrRe) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrRe )  ! TwrRe 
  Re_BufSz    = Re_BufSz    + SIZE( InData%VTwr )  ! VTwr 
  Re_BufSz   = Re_BufSz   + 1  ! Tower_Wake_Constant
  IF ( ALLOCATED(InData%NTwrCDCol) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NTwrCDCol )  ! NTwrCDCol 
  Int_BufSz  = Int_BufSz  + 1  ! NTwrHT
  Int_BufSz  = Int_BufSz  + 1  ! NTwrRe
  Int_BufSz  = Int_BufSz  + 1  ! NTwrCD
  Int_BufSz  = Int_BufSz  + 1  ! TwrPotent
  Int_BufSz  = Int_BufSz  + 1  ! TwrShadow
  Re_BufSz   = Re_BufSz   + 1  ! ShadHWid
  Re_BufSz   = Re_BufSz   + 1  ! TShadC1
  Re_BufSz   = Re_BufSz   + 1  ! TShadC2
  Re_BufSz   = Re_BufSz   + 1  ! TwrShad
  Int_BufSz  = Int_BufSz  + 1  ! PJM_Version
!  missing buffer for TwrFile
  Re_BufSz   = Re_BufSz   + 1  ! T_Shad_Refpt
  Int_BufSz  = Int_BufSz  + 1  ! CalcTwrAero
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  IF ( ALLOCATED(InData%TwrNodeWidth) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeWidth )  ! TwrNodeWidth 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%TwrHtFr) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrHtFr))-1 ) =  PACK(InData%TwrHtFr ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(InData%TwrWid) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrWid))-1 ) =  PACK(InData%TwrWid ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrWid)
  ENDIF
  IF ( ALLOCATED(InData%TwrCD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrCD))-1 ) =  PACK(InData%TwrCD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrCD)
  ENDIF
  IF ( ALLOCATED(InData%TwrRe) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrRe))-1 ) =  PACK(InData%TwrRe ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrRe)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%VTwr))-1 ) =  PACK(InData%VTwr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%VTwr)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Tower_Wake_Constant )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%NTwrCDCol) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTwrCDCol))-1 ) = PACK(InData%NTwrCDCol ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTwrCDCol)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrHT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrRe )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrCD )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwrPotent ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwrShadow ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShadHWid )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC1 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrShad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PJM_Version ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%T_Shad_Refpt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%CalcTwrAero ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeWidth) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeWidth))-1 ) =  PACK(InData%TwrNodeWidth ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeWidth)
  ENDIF
 END SUBROUTINE AD_PackTwrPropsParms

 SUBROUTINE AD_UnPackTwrPropsParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(TwrPropsParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%TwrHtFr) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrHtFr,1)))
  mask1 = .TRUE.
    OutData%TwrHtFr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrHtFr))-1 ),mask1,OutData%TwrHtFr)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(OutData%TwrWid) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrWid,1)))
  mask1 = .TRUE.
    OutData%TwrWid = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrWid))-1 ),mask1,OutData%TwrWid)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrWid)
  ENDIF
  IF ( ALLOCATED(OutData%TwrCD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrCD,1),SIZE(OutData%TwrCD,2)))
  mask2 = .TRUE.
    OutData%TwrCD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrCD))-1 ),mask2,OutData%TwrCD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrCD)
  ENDIF
  IF ( ALLOCATED(OutData%TwrRe) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrRe,1)))
  mask1 = .TRUE.
    OutData%TwrRe = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrRe))-1 ),mask1,OutData%TwrRe)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrRe)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%VTwr,1)))
  mask1 = .TRUE.
  OutData%VTwr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%VTwr))-1 ),mask1,OutData%VTwr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%VTwr)
  OutData%Tower_Wake_Constant = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%NTwrCDCol) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTwrCDCol,1)))
  mask1 = .TRUE.
    OutData%NTwrCDCol = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTwrCDCol))-1 ),mask1,OutData%NTwrCDCol)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTwrCDCol)
  ENDIF
  OutData%NTwrHT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrRe = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrCD = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ShadHWid = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC1 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrShad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%T_Shad_Refpt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeWidth) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrNodeWidth,1)))
  mask1 = .TRUE.
    OutData%TwrNodeWidth = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeWidth))-1 ),mask1,OutData%TwrNodeWidth)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeWidth)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackTwrPropsParms

 SUBROUTINE AD_CopyWind( SrcWindData, DstWindData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Wind), INTENT(IN) :: SrcWindData
   TYPE(Wind), INTENT(INOUT) :: DstWindData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstWindData%ANGFLW = SrcWindData%ANGFLW
   DstWindData%CDEL = SrcWindData%CDEL
   DstWindData%VROTORX = SrcWindData%VROTORX
   DstWindData%VROTORY = SrcWindData%VROTORY
   DstWindData%VROTORZ = SrcWindData%VROTORZ
   DstWindData%SDEL = SrcWindData%SDEL
 END SUBROUTINE AD_CopyWind

 SUBROUTINE AD_DestroyWind( WindData, ErrStat, ErrMsg )
  TYPE(Wind), INTENT(INOUT) :: WindData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyWind

 SUBROUTINE AD_PackWind( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Wind),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! ANGFLW
  Re_BufSz   = Re_BufSz   + 1  ! CDEL
  Re_BufSz   = Re_BufSz   + 1  ! VROTORX
  Re_BufSz   = Re_BufSz   + 1  ! VROTORY
  Re_BufSz   = Re_BufSz   + 1  ! VROTORZ
  Re_BufSz   = Re_BufSz   + 1  ! SDEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ANGFLW )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CDEL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORX )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORY )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORZ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SDEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackWind

 SUBROUTINE AD_UnPackWind( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Wind), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%ANGFLW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORX = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORY = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORZ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackWind

 SUBROUTINE AD_CopyWindParms( SrcWindParmsData, DstWindParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(WindParms), INTENT(IN) :: SrcWindParmsData
   TYPE(WindParms), INTENT(INOUT) :: DstWindParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstWindParmsData%Rho = SrcWindParmsData%Rho
   DstWindParmsData%KinVisc = SrcWindParmsData%KinVisc
 END SUBROUTINE AD_CopyWindParms

 SUBROUTINE AD_DestroyWindParms( WindParmsData, ErrStat, ErrMsg )
  TYPE(WindParms), INTENT(INOUT) :: WindParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyWindParms

 SUBROUTINE AD_PackWindParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(WindParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! Rho
  Re_BufSz   = Re_BufSz   + 1  ! KinVisc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Rho )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%KinVisc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackWindParms

 SUBROUTINE AD_UnPackWindParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(WindParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Rho = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%KinVisc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackWindParms

 SUBROUTINE AD_CopyBEMParms( SrcBEMParmsData, DstBEMParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BEMParms), INTENT(IN) :: SrcBEMParmsData
   TYPE(BEMParms), INTENT(INOUT) :: DstBEMParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstBEMParmsData%TOL = SrcBEMParmsData%TOL
   DstBEMParmsData%MAX_ITER = SrcBEMParmsData%MAX_ITER
   DstBEMParmsData%WT = SrcBEMParmsData%WT
 END SUBROUTINE AD_CopyBEMParms

 SUBROUTINE AD_DestroyBEMParms( BEMParmsData, ErrStat, ErrMsg )
  TYPE(BEMParms), INTENT(INOUT) :: BEMParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyBEMParms

 SUBROUTINE AD_PackBEMParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BEMParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! TOL
  Int_BufSz  = Int_BufSz  + 1  ! MAX_ITER
  Db_BufSz   = Db_BufSz   + 1  ! WT
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TOL )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAX_ITER )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%WT )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackBEMParms

 SUBROUTINE AD_UnPackBEMParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BEMParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TOL = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%MAX_ITER = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%WT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBEMParms

 SUBROUTINE AD_CopyTreeParms( SrcTreeParmsData, DstTreeParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(TreeParms), INTENT(IN) :: SrcTreeParmsData
   TYPE(TreeParms), INTENT(INOUT) :: DstTreeParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstTreeParmsData%TreeFlag = SrcTreeParmsData%TreeFlag
   DstTreeParmsData%cores = SrcTreeParmsData%cores
   DstTreeParmsData%theta = SrcTreeParmsData%theta
   DstTreeParmsData%order = SrcTreeParmsData%order
   DstTreeParmsData%maxparnode = SrcTreeParmsData%maxparnode
   DstTreeParmsData%dist_tol = SrcTreeParmsData%dist_tol
   DstTreeParmsData%delta = SrcTreeParmsData%delta
   DstTreeParmsData%Speedup = SrcTreeParmsData%Speedup
   DstTreeParmsData%Freq = SrcTreeParmsData%Freq
 END SUBROUTINE AD_CopyTreeParms

 SUBROUTINE AD_DestroyTreeParms( TreeParmsData, ErrStat, ErrMsg )
  TYPE(TreeParms), INTENT(INOUT) :: TreeParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyTreeParms

 SUBROUTINE AD_PackTreeParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(TreeParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! TreeFlag
  Int_BufSz  = Int_BufSz  + 1  ! cores
  Db_BufSz   = Db_BufSz   + 1  ! theta
  Int_BufSz  = Int_BufSz  + 1  ! order
  Int_BufSz  = Int_BufSz  + 1  ! maxparnode
  Db_BufSz   = Db_BufSz   + 1  ! dist_tol
  Db_BufSz   = Db_BufSz   + 1  ! delta
  Int_BufSz  = Int_BufSz  + 1  ! Speedup
!  missing buffer for Freq
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TreeFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%cores )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%theta )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%order )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%maxparnode )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%dist_tol )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%delta )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Speedup ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackTreeParms

 SUBROUTINE AD_UnPackTreeParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(TreeParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%cores = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%theta = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%order = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%maxparnode = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%dist_tol = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%delta = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackTreeParms

 SUBROUTINE AD_CopyOpenMPParms( SrcOpenMPParmsData, DstOpenMPParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(OpenMPParms), INTENT(IN) :: SrcOpenMPParmsData
   TYPE(OpenMPParms), INTENT(INOUT) :: DstOpenMPParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOpenMPParmsData%Accelerate = SrcOpenMPParmsData%Accelerate
   DstOpenMPParmsData%OpenMPCores = SrcOpenMPParmsData%OpenMPCores
 END SUBROUTINE AD_CopyOpenMPParms

 SUBROUTINE AD_DestroyOpenMPParms( OpenMPParmsData, ErrStat, ErrMsg )
  TYPE(OpenMPParms), INTENT(INOUT) :: OpenMPParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyOpenMPParms

 SUBROUTINE AD_PackOpenMPParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(OpenMPParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! Accelerate
  Int_BufSz  = Int_BufSz  + 1  ! OpenMPCores
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Accelerate ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%OpenMPCores )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackOpenMPParms

 SUBROUTINE AD_UnPackOpenMPParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(OpenMPParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%OpenMPCores = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOpenMPParms

 SUBROUTINE AD_CopyGPUParms( SrcGPUParmsData, DstGPUParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(GPUParms), INTENT(IN) :: SrcGPUParmsData
   TYPE(GPUParms), INTENT(INOUT) :: DstGPUParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstGPUParmsData%Accelerate = SrcGPUParmsData%Accelerate
   DstGPUParmsData%Speedup = SrcGPUParmsData%Speedup
   DstGPUParmsData%GPUFlag = SrcGPUParmsData%GPUFlag
   DstGPUParmsData%GPUHW = SrcGPUParmsData%GPUHW
   DstGPUParmsData%GPURUN = SrcGPUParmsData%GPURUN
   DstGPUParmsData%OMP = SrcGPUParmsData%OMP
 END SUBROUTINE AD_CopyGPUParms

 SUBROUTINE AD_DestroyGPUParms( GPUParmsData, ErrStat, ErrMsg )
  TYPE(GPUParms), INTENT(INOUT) :: GPUParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyGPUParms

 SUBROUTINE AD_PackGPUParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(GPUParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! Accelerate
  Int_BufSz  = Int_BufSz  + 1  ! Speedup
  Int_BufSz  = Int_BufSz  + 1  ! GPUFlag
  Int_BufSz   = Int_BufSz   + SIZE( InData%GPUHW )  ! GPUHW 
!  missing buffer for GPURUN
  Int_BufSz  = Int_BufSz  + 1  ! OMP
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Accelerate ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Speedup ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%GPUFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%GPUHW))-1 ) = PACK(InData%GPUHW ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%GPUHW)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%OMP ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackGPUParms

 SUBROUTINE AD_UnPackGPUParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(GPUParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%GPUHW,1)))
  mask1 = .TRUE.
  OutData%GPUHW = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%GPUHW))-1 ),mask1,OutData%GPUHW)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%GPUHW)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackGPUParms

 SUBROUTINE AD_CopyTwrParms( SrcTwrParmsData, DstTwrParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(TwrParms), INTENT(IN) :: SrcTwrParmsData
   TYPE(TwrParms), INTENT(INOUT) :: DstTwrParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstTwrParmsData%TWRFLAG = SrcTwrParmsData%TWRFLAG
   DstTwrParmsData%TWRUPDOWN = SrcTwrParmsData%TWRUPDOWN
   DstTwrParmsData%TWRMETHOD = SrcTwrParmsData%TWRMETHOD
 END SUBROUTINE AD_CopyTwrParms

 SUBROUTINE AD_DestroyTwrParms( TwrParmsData, ErrStat, ErrMsg )
  TYPE(TwrParms), INTENT(INOUT) :: TwrParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyTwrParms

 SUBROUTINE AD_PackTwrParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(TwrParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! TWRFLAG
  Int_BufSz  = Int_BufSz  + 1  ! TWRUPDOWN
  Int_BufSz  = Int_BufSz  + 1  ! TWRMETHOD
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TWRFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TWRUPDOWN )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TWRMETHOD )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackTwrParms

 SUBROUTINE AD_UnPackTwrParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(TwrParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TWRUPDOWN = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TWRMETHOD = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackTwrParms

 SUBROUTINE AD_CopyGroundParms( SrcGroundParmsData, DstGroundParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(GroundParms), INTENT(IN) :: SrcGroundParmsData
   TYPE(GroundParms), INTENT(INOUT) :: DstGroundParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstGroundParmsData%GroundFLAG = SrcGroundParmsData%GroundFLAG
   DstGroundParmsData%Method = SrcGroundParmsData%Method
   DstGroundParmsData%Saved_Geometry = SrcGroundParmsData%Saved_Geometry
   DstGroundParmsData%Sqrt_Panels = SrcGroundParmsData%Sqrt_Panels
   DstGroundParmsData%Extent = SrcGroundParmsData%Extent
 END SUBROUTINE AD_CopyGroundParms

 SUBROUTINE AD_DestroyGroundParms( GroundParmsData, ErrStat, ErrMsg )
  TYPE(GroundParms), INTENT(INOUT) :: GroundParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyGroundParms

 SUBROUTINE AD_PackGroundParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(GroundParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! GroundFLAG
!  missing buffer for Method
  Int_BufSz  = Int_BufSz  + 1  ! Saved_Geometry
  Int_BufSz  = Int_BufSz  + 1  ! Sqrt_Panels
  Int_BufSz   = Int_BufSz   + SIZE( InData%Extent )  ! Extent 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%GroundFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Saved_Geometry ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%Sqrt_Panels )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%Extent))-1 ) = PACK(InData%Extent ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%Extent)
 END SUBROUTINE AD_PackGroundParms

 SUBROUTINE AD_UnPackGroundParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(GroundParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Sqrt_Panels = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%Extent,1)))
  mask1 = .TRUE.
  OutData%Extent = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%Extent))-1 ),mask1,OutData%Extent)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%Extent)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackGroundParms

 SUBROUTINE AD_CopyWindShearParms( SrcWindShearParmsData, DstWindShearParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(WindShearParms), INTENT(IN) :: SrcWindShearParmsData
   TYPE(WindShearParms), INTENT(INOUT) :: DstWindShearParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstWindShearParmsData%ShearFLAG = SrcWindShearParmsData%ShearFLAG
   DstWindShearParmsData%model_type = SrcWindShearParmsData%model_type
   DstWindShearParmsData%z_ref = SrcWindShearParmsData%z_ref
   DstWindShearParmsData%alpha = SrcWindShearParmsData%alpha
   DstWindShearParmsData%z0 = SrcWindShearParmsData%z0
 END SUBROUTINE AD_CopyWindShearParms

 SUBROUTINE AD_DestroyWindShearParms( WindShearParmsData, ErrStat, ErrMsg )
  TYPE(WindShearParms), INTENT(INOUT) :: WindShearParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyWindShearParms

 SUBROUTINE AD_PackWindShearParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(WindShearParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! ShearFLAG
  Int_BufSz  = Int_BufSz  + 1  ! model_type
  Db_BufSz   = Db_BufSz   + 1  ! z_ref
  Db_BufSz   = Db_BufSz   + 1  ! alpha
  Db_BufSz   = Db_BufSz   + 1  ! z0
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%ShearFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%model_type )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%z_ref )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%alpha )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%z0 )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackWindShearParms

 SUBROUTINE AD_UnPackWindShearParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(WindShearParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%model_type = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%z_ref = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%alpha = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%z0 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackWindShearParms

 SUBROUTINE AD_CopyRLVortexModel( SrcRLVortexModelData, DstRLVortexModelData, CtrlCode, ErrStat, ErrMsg )
   TYPE(RLVortexModel), INTENT(IN) :: SrcRLVortexModelData
   TYPE(RLVortexModel), INTENT(INOUT) :: DstRLVortexModelData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRLVortexModelData%ALPHA = SrcRLVortexModelData%ALPHA
   DstRLVortexModelData%NU = SrcRLVortexModelData%NU
   DstRLVortexModelData%DELTA = SrcRLVortexModelData%DELTA
   DstRLVortexModelData%A1 = SrcRLVortexModelData%A1
 END SUBROUTINE AD_CopyRLVortexModel

 SUBROUTINE AD_DestroyRLVortexModel( RLVortexModelData, ErrStat, ErrMsg )
  TYPE(RLVortexModel), INTENT(INOUT) :: RLVortexModelData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyRLVortexModel

 SUBROUTINE AD_PackRLVortexModel( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(RLVortexModel),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! ALPHA
  Db_BufSz   = Db_BufSz   + 1  ! NU
  Db_BufSz   = Db_BufSz   + 1  ! DELTA
  Db_BufSz   = Db_BufSz   + 1  ! A1
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%ALPHA )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%NU )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DELTA )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%A1 )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackRLVortexModel

 SUBROUTINE AD_UnPackRLVortexModel( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(RLVortexModel), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%ALPHA = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%NU = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DELTA = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%A1 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackRLVortexModel

 SUBROUTINE AD_CopyDSParms( SrcDSParmsData, DstDSParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DSParms), INTENT(IN) :: SrcDSParmsData
   TYPE(DSParms), INTENT(INOUT) :: DstDSParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDSParmsData%DS_Flag = SrcDSParmsData%DS_Flag
   DstDSParmsData%relax_tune = SrcDSParmsData%relax_tune
   DstDSParmsData%start_t = SrcDSParmsData%start_t
   DstDSParmsData%start_n = SrcDSParmsData%start_n
   DstDSParmsData%load_data = SrcDSParmsData%load_data
   DstDSParmsData%load_file = SrcDSParmsData%load_file
   DstDSParmsData%indicial = SrcDSParmsData%indicial
   DstDSParmsData%time_const = SrcDSParmsData%time_const
   DstDSParmsData%write_data = SrcDSParmsData%write_data
 END SUBROUTINE AD_CopyDSParms

 SUBROUTINE AD_DestroyDSParms( DSParmsData, ErrStat, ErrMsg )
  TYPE(DSParms), INTENT(INOUT) :: DSParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyDSParms

 SUBROUTINE AD_PackDSParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DSParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! DS_Flag
  Int_BufSz  = Int_BufSz  + 1  ! relax_tune
  Db_BufSz   = Db_BufSz   + 1  ! start_t
  Int_BufSz  = Int_BufSz  + 1  ! start_n
  Int_BufSz  = Int_BufSz  + 1  ! load_data
!  missing buffer for load_file
  Db_BufSz    = Db_BufSz    + SIZE( InData%indicial )  ! indicial 
  Db_BufSz    = Db_BufSz    + SIZE( InData%time_const )  ! time_const 
  Int_BufSz  = Int_BufSz  + 1  ! write_data
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DS_Flag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%relax_tune ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%start_t )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%start_n )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%load_data ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%indicial))-1 ) =  PACK(InData%indicial ,.TRUE.)
  Db_Xferred   = Db_Xferred   + SIZE(InData%indicial)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%time_const))-1 ) =  PACK(InData%time_const ,.TRUE.)
  Db_Xferred   = Db_Xferred   + SIZE(InData%time_const)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%write_data ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackDSParms

 SUBROUTINE AD_UnPackDSParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DSParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%start_t = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%start_n = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%indicial,1)))
  mask1 = .TRUE.
  OutData%indicial = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%indicial))-1 ),mask1,OutData%indicial)
  DEALLOCATE(mask1)
  Db_Xferred   = Db_Xferred   + SIZE(OutData%indicial)
  ALLOCATE(mask1(SIZE(OutData%time_const,1)))
  mask1 = .TRUE.
  OutData%time_const = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%time_const))-1 ),mask1,OutData%time_const)
  DEALLOCATE(mask1)
  Db_Xferred   = Db_Xferred   + SIZE(OutData%time_const)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDSParms

 SUBROUTINE AD_CopyFVMParmsTYPE( SrcFVMParmsTYPEData, DstFVMParmsTYPEData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FVMParmsTYPE), INTENT(IN) :: SrcFVMParmsTYPEData
   TYPE(FVMParmsTYPE), INTENT(INOUT) :: DstFVMParmsTYPEData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstFVMParmsTYPEData%UseWINDS = SrcFVMParmsTYPEData%UseWINDS
   DstFVMParmsTYPEData%WINDS_Sum = SrcFVMParmsTYPEData%WINDS_Sum
   DstFVMParmsTYPEData%WINDS_dir = SrcFVMParmsTYPEData%WINDS_dir
   DstFVMParmsTYPEData%Total_Time = SrcFVMParmsTYPEData%Total_Time
   DstFVMParmsTYPEData%NB = SrcFVMParmsTYPEData%NB
   DstFVMParmsTYPEData%NS = SrcFVMParmsTYPEData%NS
   DstFVMParmsTYPEData%NST = SrcFVMParmsTYPEData%NST
   DstFVMParmsTYPEData%NT = SrcFVMParmsTYPEData%NT
   DstFVMParmsTYPEData%NTP = SrcFVMParmsTYPEData%NTP
   DstFVMParmsTYPEData%DT_RATIO = SrcFVMParmsTYPEData%DT_RATIO
   DstFVMParmsTYPEData%DT_WINDS = SrcFVMParmsTYPEData%DT_WINDS
   DstFVMParmsTYPEData%SteadyFlag = SrcFVMParmsTYPEData%SteadyFlag
   DstFVMParmsTYPEData%WakeFLAG = SrcFVMParmsTYPEData%WakeFLAG
   DstFVMParmsTYPEData%Roll = SrcFVMParmsTYPEData%Roll
   DstFVMParmsTYPEData%RollDist = SrcFVMParmsTYPEData%RollDist
   DstFVMParmsTYPEData%NTW_total = SrcFVMParmsTYPEData%NTW_total
   DstFVMParmsTYPEData%WakeDist = SrcFVMParmsTYPEData%WakeDist
   DstFVMParmsTYPEData%WakeNum = SrcFVMParmsTYPEData%WakeNum
   DstFVMParmsTYPEData%AveSpeed = SrcFVMParmsTYPEData%AveSpeed
   DstFVMParmsTYPEData%uindpast = SrcFVMParmsTYPEData%uindpast
   DstFVMParmsTYPEData%ViscFLAG = SrcFVMParmsTYPEData%ViscFLAG
   DstFVMParmsTYPEData%VISC = SrcFVMParmsTYPEData%VISC
   DstFVMParmsTYPEData%DELTA = SrcFVMParmsTYPEData%DELTA
   DstFVMParmsTYPEData%INTEG = SrcFVMParmsTYPEData%INTEG
   DstFVMParmsTYPEData%TOL = SrcFVMParmsTYPEData%TOL
   DstFVMParmsTYPEData%CO = SrcFVMParmsTYPEData%CO
   DstFVMParmsTYPEData%RELAX = SrcFVMParmsTYPEData%RELAX
   DstFVMParmsTYPEData%MAXITER = SrcFVMParmsTYPEData%MAXITER
   DstFVMParmsTYPEData%extrap_wake = SrcFVMParmsTYPEData%extrap_wake
   DstFVMParmsTYPEData%KJ_output = SrcFVMParmsTYPEData%KJ_output
   DstFVMParmsTYPEData%element_output = SrcFVMParmsTYPEData%element_output
   DstFVMParmsTYPEData%CURRENT_TIME = SrcFVMParmsTYPEData%CURRENT_TIME
   DstFVMParmsTYPEData%AnimFLAG = SrcFVMParmsTYPEData%AnimFLAG
   DstFVMParmsTYPEData%AnimRootDIR = SrcFVMParmsTYPEData%AnimRootDIR
      CALL AD_Copybemparms( SrcFVMParmsTYPEData%BEM_Parms, DstFVMParmsTYPEData%BEM_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:BEM_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyopenmpparms( SrcFVMParmsTYPEData%OpenMP_Parms, DstFVMParmsTYPEData%OpenMP_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:OpenMP_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copytreeparms( SrcFVMParmsTYPEData%Tree_Parms, DstFVMParmsTYPEData%Tree_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:Tree_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copytwrparms( SrcFVMParmsTYPEData%Twr_Parms, DstFVMParmsTYPEData%Twr_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:Twr_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copygroundparms( SrcFVMParmsTYPEData%Ground_Parms, DstFVMParmsTYPEData%Ground_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:Ground_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copywindshearparms( SrcFVMParmsTYPEData%Shear_Parms, DstFVMParmsTYPEData%Shear_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:Shear_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyrlvortexmodel( SrcFVMParmsTYPEData%RL_Model, DstFVMParmsTYPEData%RL_Model, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:RL_Model')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copydsparms( SrcFVMParmsTYPEData%DS_Parms, DstFVMParmsTYPEData%DS_Parms, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVMParmsTYPE:DS_Parms')
         IF (ErrStat>=AbortErrLev) RETURN
   DstFVMParmsTYPEData%RHO = SrcFVMParmsTYPEData%RHO
   DstFVMParmsTYPEData%Gravity = SrcFVMParmsTYPEData%Gravity
   DstFVMParmsTYPEData%TURBINE_ShftTilt = SrcFVMParmsTYPEData%TURBINE_ShftTilt
 END SUBROUTINE AD_CopyFVMParmsTYPE

 SUBROUTINE AD_DestroyFVMParmsTYPE( FVMParmsTYPEData, ErrStat, ErrMsg )
  TYPE(FVMParmsTYPE), INTENT(INOUT) :: FVMParmsTYPEData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroybemparms( FVMParmsTYPEData%BEM_Parms, ErrStat, ErrMsg )
  CALL AD_Destroyopenmpparms( FVMParmsTYPEData%OpenMP_Parms, ErrStat, ErrMsg )
  CALL AD_Destroytreeparms( FVMParmsTYPEData%Tree_Parms, ErrStat, ErrMsg )
  CALL AD_Destroytwrparms( FVMParmsTYPEData%Twr_Parms, ErrStat, ErrMsg )
  CALL AD_Destroygroundparms( FVMParmsTYPEData%Ground_Parms, ErrStat, ErrMsg )
  CALL AD_Destroywindshearparms( FVMParmsTYPEData%Shear_Parms, ErrStat, ErrMsg )
  CALL AD_Destroyrlvortexmodel( FVMParmsTYPEData%RL_Model, ErrStat, ErrMsg )
  CALL AD_Destroydsparms( FVMParmsTYPEData%DS_Parms, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyFVMParmsTYPE

 SUBROUTINE AD_PackFVMParmsTYPE( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FVMParmsTYPE),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_BEM_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_BEM_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_BEM_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OpenMP_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OpenMP_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OpenMP_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Tree_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Tree_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Tree_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Ground_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ground_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ground_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Shear_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Shear_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Shear_Parms_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RL_Model_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RL_Model_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RL_Model_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DS_Parms_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DS_Parms_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DS_Parms_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! UseWINDS
  Int_BufSz  = Int_BufSz  + 1  ! WINDS_Sum
!  missing buffer for WINDS_dir
  Int_BufSz  = Int_BufSz  + 1  ! Total_Time
  Int_BufSz  = Int_BufSz  + 1  ! NB
  Int_BufSz  = Int_BufSz  + 1  ! NS
  Int_BufSz  = Int_BufSz  + 1  ! NST
  Int_BufSz  = Int_BufSz  + 1  ! NT
  Int_BufSz  = Int_BufSz  + 1  ! NTP
  Int_BufSz  = Int_BufSz  + 1  ! DT_RATIO
  Db_BufSz   = Db_BufSz   + 1  ! DT_WINDS
  Int_BufSz  = Int_BufSz  + 1  ! SteadyFlag
  Int_BufSz  = Int_BufSz  + 1  ! WakeFLAG
  Int_BufSz  = Int_BufSz  + 1  ! Roll
  Int_BufSz  = Int_BufSz  + 1  ! RollDist
  Int_BufSz  = Int_BufSz  + 1  ! NTW_total
  Int_BufSz  = Int_BufSz  + 1  ! WakeDist
  Int_BufSz  = Int_BufSz  + 1  ! WakeNum
  Db_BufSz   = Db_BufSz   + 1  ! AveSpeed
  Int_BufSz  = Int_BufSz  + 1  ! uindpast
  Int_BufSz  = Int_BufSz  + 1  ! ViscFLAG
  Int_BufSz  = Int_BufSz  + 1  ! VISC
  Db_BufSz   = Db_BufSz   + 1  ! DELTA
!  missing buffer for INTEG
  Db_BufSz   = Db_BufSz   + 1  ! TOL
  Db_BufSz   = Db_BufSz   + 1  ! CO
  Db_BufSz   = Db_BufSz   + 1  ! RELAX
  Int_BufSz  = Int_BufSz  + 1  ! MAXITER
  Int_BufSz  = Int_BufSz  + 1  ! extrap_wake
  Int_BufSz  = Int_BufSz  + 1  ! KJ_output
  Int_BufSz  = Int_BufSz  + 1  ! element_output
!  missing buffer for CURRENT_TIME
  Int_BufSz  = Int_BufSz  + 1  ! AnimFLAG
!  missing buffer for AnimRootDIR
  CALL AD_Packbemparms( Re_BEM_Parms_Buf, Db_BEM_Parms_Buf, Int_BEM_Parms_Buf, InData%BEM_Parms, ErrStat, ErrMsg, .TRUE. ) ! BEM_Parms 
  IF(ALLOCATED(Re_BEM_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_BEM_Parms_Buf  ) ! BEM_Parms
  IF(ALLOCATED(Db_BEM_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_BEM_Parms_Buf  ) ! BEM_Parms
  IF(ALLOCATED(Int_BEM_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_BEM_Parms_Buf ) ! BEM_Parms
  IF(ALLOCATED(Re_BEM_Parms_Buf))  DEALLOCATE(Re_BEM_Parms_Buf)
  IF(ALLOCATED(Db_BEM_Parms_Buf))  DEALLOCATE(Db_BEM_Parms_Buf)
  IF(ALLOCATED(Int_BEM_Parms_Buf)) DEALLOCATE(Int_BEM_Parms_Buf)
  CALL AD_Packopenmpparms( Re_OpenMP_Parms_Buf, Db_OpenMP_Parms_Buf, Int_OpenMP_Parms_Buf, InData%OpenMP_Parms, ErrStat, ErrMsg, .TRUE. ) ! OpenMP_Parms 
  IF(ALLOCATED(Re_OpenMP_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OpenMP_Parms_Buf  ) ! OpenMP_Parms
  IF(ALLOCATED(Db_OpenMP_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OpenMP_Parms_Buf  ) ! OpenMP_Parms
  IF(ALLOCATED(Int_OpenMP_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OpenMP_Parms_Buf ) ! OpenMP_Parms
  IF(ALLOCATED(Re_OpenMP_Parms_Buf))  DEALLOCATE(Re_OpenMP_Parms_Buf)
  IF(ALLOCATED(Db_OpenMP_Parms_Buf))  DEALLOCATE(Db_OpenMP_Parms_Buf)
  IF(ALLOCATED(Int_OpenMP_Parms_Buf)) DEALLOCATE(Int_OpenMP_Parms_Buf)
  CALL AD_Packtreeparms( Re_Tree_Parms_Buf, Db_Tree_Parms_Buf, Int_Tree_Parms_Buf, InData%Tree_Parms, ErrStat, ErrMsg, .TRUE. ) ! Tree_Parms 
  IF(ALLOCATED(Re_Tree_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Tree_Parms_Buf  ) ! Tree_Parms
  IF(ALLOCATED(Db_Tree_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Tree_Parms_Buf  ) ! Tree_Parms
  IF(ALLOCATED(Int_Tree_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Tree_Parms_Buf ) ! Tree_Parms
  IF(ALLOCATED(Re_Tree_Parms_Buf))  DEALLOCATE(Re_Tree_Parms_Buf)
  IF(ALLOCATED(Db_Tree_Parms_Buf))  DEALLOCATE(Db_Tree_Parms_Buf)
  IF(ALLOCATED(Int_Tree_Parms_Buf)) DEALLOCATE(Int_Tree_Parms_Buf)
  CALL AD_Packtwrparms( Re_Twr_Parms_Buf, Db_Twr_Parms_Buf, Int_Twr_Parms_Buf, InData%Twr_Parms, ErrStat, ErrMsg, .TRUE. ) ! Twr_Parms 
  IF(ALLOCATED(Re_Twr_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_Parms_Buf  ) ! Twr_Parms
  IF(ALLOCATED(Db_Twr_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_Parms_Buf  ) ! Twr_Parms
  IF(ALLOCATED(Int_Twr_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_Parms_Buf ) ! Twr_Parms
  IF(ALLOCATED(Re_Twr_Parms_Buf))  DEALLOCATE(Re_Twr_Parms_Buf)
  IF(ALLOCATED(Db_Twr_Parms_Buf))  DEALLOCATE(Db_Twr_Parms_Buf)
  IF(ALLOCATED(Int_Twr_Parms_Buf)) DEALLOCATE(Int_Twr_Parms_Buf)
  CALL AD_Packgroundparms( Re_Ground_Parms_Buf, Db_Ground_Parms_Buf, Int_Ground_Parms_Buf, InData%Ground_Parms, ErrStat, ErrMsg, .TRUE. ) ! Ground_Parms 
  IF(ALLOCATED(Re_Ground_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ground_Parms_Buf  ) ! Ground_Parms
  IF(ALLOCATED(Db_Ground_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ground_Parms_Buf  ) ! Ground_Parms
  IF(ALLOCATED(Int_Ground_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ground_Parms_Buf ) ! Ground_Parms
  IF(ALLOCATED(Re_Ground_Parms_Buf))  DEALLOCATE(Re_Ground_Parms_Buf)
  IF(ALLOCATED(Db_Ground_Parms_Buf))  DEALLOCATE(Db_Ground_Parms_Buf)
  IF(ALLOCATED(Int_Ground_Parms_Buf)) DEALLOCATE(Int_Ground_Parms_Buf)
  CALL AD_Packwindshearparms( Re_Shear_Parms_Buf, Db_Shear_Parms_Buf, Int_Shear_Parms_Buf, InData%Shear_Parms, ErrStat, ErrMsg, .TRUE. ) ! Shear_Parms 
  IF(ALLOCATED(Re_Shear_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Shear_Parms_Buf  ) ! Shear_Parms
  IF(ALLOCATED(Db_Shear_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Shear_Parms_Buf  ) ! Shear_Parms
  IF(ALLOCATED(Int_Shear_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Shear_Parms_Buf ) ! Shear_Parms
  IF(ALLOCATED(Re_Shear_Parms_Buf))  DEALLOCATE(Re_Shear_Parms_Buf)
  IF(ALLOCATED(Db_Shear_Parms_Buf))  DEALLOCATE(Db_Shear_Parms_Buf)
  IF(ALLOCATED(Int_Shear_Parms_Buf)) DEALLOCATE(Int_Shear_Parms_Buf)
  CALL AD_Packrlvortexmodel( Re_RL_Model_Buf, Db_RL_Model_Buf, Int_RL_Model_Buf, InData%RL_Model, ErrStat, ErrMsg, .TRUE. ) ! RL_Model 
  IF(ALLOCATED(Re_RL_Model_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RL_Model_Buf  ) ! RL_Model
  IF(ALLOCATED(Db_RL_Model_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RL_Model_Buf  ) ! RL_Model
  IF(ALLOCATED(Int_RL_Model_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RL_Model_Buf ) ! RL_Model
  IF(ALLOCATED(Re_RL_Model_Buf))  DEALLOCATE(Re_RL_Model_Buf)
  IF(ALLOCATED(Db_RL_Model_Buf))  DEALLOCATE(Db_RL_Model_Buf)
  IF(ALLOCATED(Int_RL_Model_Buf)) DEALLOCATE(Int_RL_Model_Buf)
  CALL AD_Packdsparms( Re_DS_Parms_Buf, Db_DS_Parms_Buf, Int_DS_Parms_Buf, InData%DS_Parms, ErrStat, ErrMsg, .TRUE. ) ! DS_Parms 
  IF(ALLOCATED(Re_DS_Parms_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DS_Parms_Buf  ) ! DS_Parms
  IF(ALLOCATED(Db_DS_Parms_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DS_Parms_Buf  ) ! DS_Parms
  IF(ALLOCATED(Int_DS_Parms_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DS_Parms_Buf ) ! DS_Parms
  IF(ALLOCATED(Re_DS_Parms_Buf))  DEALLOCATE(Re_DS_Parms_Buf)
  IF(ALLOCATED(Db_DS_Parms_Buf))  DEALLOCATE(Db_DS_Parms_Buf)
  IF(ALLOCATED(Int_DS_Parms_Buf)) DEALLOCATE(Int_DS_Parms_Buf)
  Db_BufSz   = Db_BufSz   + 1  ! RHO
  Db_BufSz   = Db_BufSz   + 1  ! Gravity
  Db_BufSz   = Db_BufSz   + 1  ! TURBINE_ShftTilt
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseWINDS ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WINDS_Sum ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%Total_Time )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NB )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NS )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NST )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTP )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DT_RATIO )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT_WINDS )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SteadyFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WakeFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Roll ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RollDist )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTW_total )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%WakeDist )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%WakeNum )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%AveSpeed )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%uindpast ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%ViscFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%VISC )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DELTA )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TOL )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%CO )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%RELAX )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXITER )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%extrap_wake ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%KJ_output ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%element_output ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%AnimFLAG ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packbemparms( Re_BEM_Parms_Buf, Db_BEM_Parms_Buf, Int_BEM_Parms_Buf, InData%BEM_Parms, ErrStat, ErrMsg, OnlySize ) ! BEM_Parms 
  IF(ALLOCATED(Re_BEM_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BEM_Parms_Buf)-1 ) = Re_BEM_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_BEM_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_BEM_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BEM_Parms_Buf)-1 ) = Db_BEM_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_BEM_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_BEM_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BEM_Parms_Buf)-1 ) = Int_BEM_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_BEM_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_BEM_Parms_Buf) )  DEALLOCATE(Re_BEM_Parms_Buf)
  IF( ALLOCATED(Db_BEM_Parms_Buf) )  DEALLOCATE(Db_BEM_Parms_Buf)
  IF( ALLOCATED(Int_BEM_Parms_Buf) ) DEALLOCATE(Int_BEM_Parms_Buf)
  CALL AD_Packopenmpparms( Re_OpenMP_Parms_Buf, Db_OpenMP_Parms_Buf, Int_OpenMP_Parms_Buf, InData%OpenMP_Parms, ErrStat, ErrMsg, OnlySize ) ! OpenMP_Parms 
  IF(ALLOCATED(Re_OpenMP_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OpenMP_Parms_Buf)-1 ) = Re_OpenMP_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OpenMP_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_OpenMP_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OpenMP_Parms_Buf)-1 ) = Db_OpenMP_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OpenMP_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_OpenMP_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OpenMP_Parms_Buf)-1 ) = Int_OpenMP_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OpenMP_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_OpenMP_Parms_Buf) )  DEALLOCATE(Re_OpenMP_Parms_Buf)
  IF( ALLOCATED(Db_OpenMP_Parms_Buf) )  DEALLOCATE(Db_OpenMP_Parms_Buf)
  IF( ALLOCATED(Int_OpenMP_Parms_Buf) ) DEALLOCATE(Int_OpenMP_Parms_Buf)
  CALL AD_Packtreeparms( Re_Tree_Parms_Buf, Db_Tree_Parms_Buf, Int_Tree_Parms_Buf, InData%Tree_Parms, ErrStat, ErrMsg, OnlySize ) ! Tree_Parms 
  IF(ALLOCATED(Re_Tree_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tree_Parms_Buf)-1 ) = Re_Tree_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Tree_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tree_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tree_Parms_Buf)-1 ) = Db_Tree_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Tree_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tree_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tree_Parms_Buf)-1 ) = Int_Tree_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Tree_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_Tree_Parms_Buf) )  DEALLOCATE(Re_Tree_Parms_Buf)
  IF( ALLOCATED(Db_Tree_Parms_Buf) )  DEALLOCATE(Db_Tree_Parms_Buf)
  IF( ALLOCATED(Int_Tree_Parms_Buf) ) DEALLOCATE(Int_Tree_Parms_Buf)
  CALL AD_Packtwrparms( Re_Twr_Parms_Buf, Db_Twr_Parms_Buf, Int_Twr_Parms_Buf, InData%Twr_Parms, ErrStat, ErrMsg, OnlySize ) ! Twr_Parms 
  IF(ALLOCATED(Re_Twr_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_Parms_Buf)-1 ) = Re_Twr_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_Parms_Buf)-1 ) = Db_Twr_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_Parms_Buf)-1 ) = Int_Twr_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_Parms_Buf) )  DEALLOCATE(Re_Twr_Parms_Buf)
  IF( ALLOCATED(Db_Twr_Parms_Buf) )  DEALLOCATE(Db_Twr_Parms_Buf)
  IF( ALLOCATED(Int_Twr_Parms_Buf) ) DEALLOCATE(Int_Twr_Parms_Buf)
  CALL AD_Packgroundparms( Re_Ground_Parms_Buf, Db_Ground_Parms_Buf, Int_Ground_Parms_Buf, InData%Ground_Parms, ErrStat, ErrMsg, OnlySize ) ! Ground_Parms 
  IF(ALLOCATED(Re_Ground_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ground_Parms_Buf)-1 ) = Re_Ground_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ground_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ground_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ground_Parms_Buf)-1 ) = Db_Ground_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ground_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ground_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ground_Parms_Buf)-1 ) = Int_Ground_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ground_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ground_Parms_Buf) )  DEALLOCATE(Re_Ground_Parms_Buf)
  IF( ALLOCATED(Db_Ground_Parms_Buf) )  DEALLOCATE(Db_Ground_Parms_Buf)
  IF( ALLOCATED(Int_Ground_Parms_Buf) ) DEALLOCATE(Int_Ground_Parms_Buf)
  CALL AD_Packwindshearparms( Re_Shear_Parms_Buf, Db_Shear_Parms_Buf, Int_Shear_Parms_Buf, InData%Shear_Parms, ErrStat, ErrMsg, OnlySize ) ! Shear_Parms 
  IF(ALLOCATED(Re_Shear_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Shear_Parms_Buf)-1 ) = Re_Shear_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Shear_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Shear_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Shear_Parms_Buf)-1 ) = Db_Shear_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Shear_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Shear_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Shear_Parms_Buf)-1 ) = Int_Shear_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Shear_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_Shear_Parms_Buf) )  DEALLOCATE(Re_Shear_Parms_Buf)
  IF( ALLOCATED(Db_Shear_Parms_Buf) )  DEALLOCATE(Db_Shear_Parms_Buf)
  IF( ALLOCATED(Int_Shear_Parms_Buf) ) DEALLOCATE(Int_Shear_Parms_Buf)
  CALL AD_Packrlvortexmodel( Re_RL_Model_Buf, Db_RL_Model_Buf, Int_RL_Model_Buf, InData%RL_Model, ErrStat, ErrMsg, OnlySize ) ! RL_Model 
  IF(ALLOCATED(Re_RL_Model_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RL_Model_Buf)-1 ) = Re_RL_Model_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RL_Model_Buf)
  ENDIF
  IF(ALLOCATED(Db_RL_Model_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RL_Model_Buf)-1 ) = Db_RL_Model_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RL_Model_Buf)
  ENDIF
  IF(ALLOCATED(Int_RL_Model_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RL_Model_Buf)-1 ) = Int_RL_Model_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RL_Model_Buf)
  ENDIF
  IF( ALLOCATED(Re_RL_Model_Buf) )  DEALLOCATE(Re_RL_Model_Buf)
  IF( ALLOCATED(Db_RL_Model_Buf) )  DEALLOCATE(Db_RL_Model_Buf)
  IF( ALLOCATED(Int_RL_Model_Buf) ) DEALLOCATE(Int_RL_Model_Buf)
  CALL AD_Packdsparms( Re_DS_Parms_Buf, Db_DS_Parms_Buf, Int_DS_Parms_Buf, InData%DS_Parms, ErrStat, ErrMsg, OnlySize ) ! DS_Parms 
  IF(ALLOCATED(Re_DS_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DS_Parms_Buf)-1 ) = Re_DS_Parms_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DS_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_DS_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DS_Parms_Buf)-1 ) = Db_DS_Parms_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DS_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_DS_Parms_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DS_Parms_Buf)-1 ) = Int_DS_Parms_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DS_Parms_Buf)
  ENDIF
  IF( ALLOCATED(Re_DS_Parms_Buf) )  DEALLOCATE(Re_DS_Parms_Buf)
  IF( ALLOCATED(Db_DS_Parms_Buf) )  DEALLOCATE(Db_DS_Parms_Buf)
  IF( ALLOCATED(Int_DS_Parms_Buf) ) DEALLOCATE(Int_DS_Parms_Buf)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%RHO )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Gravity )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TURBINE_ShftTilt )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackFVMParmsTYPE

 SUBROUTINE AD_UnPackFVMParmsTYPE( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FVMParmsTYPE), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_BEM_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_BEM_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_BEM_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OpenMP_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OpenMP_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OpenMP_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Tree_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Tree_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Tree_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Ground_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ground_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ground_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Shear_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Shear_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Shear_Parms_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RL_Model_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RL_Model_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RL_Model_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DS_Parms_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DS_Parms_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DS_Parms_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Total_Time = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NB = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NS = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NST = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTP = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DT_RATIO = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DT_WINDS = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%RollDist = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTW_total = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%WakeDist = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%WakeNum = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%AveSpeed = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%VISC = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DELTA = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%TOL = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%CO = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%RELAX = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%MAXITER = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packbemparms to get correctly sized buffers for unpacking
  CALL AD_Packbemparms( Re_BEM_Parms_Buf, Db_BEM_Parms_Buf, Int_BEM_Parms_Buf, OutData%BEM_Parms, ErrStat, ErrMsg, .TRUE. ) ! BEM_Parms 
  IF(ALLOCATED(Re_BEM_Parms_Buf)) THEN
    Re_BEM_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BEM_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_BEM_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_BEM_Parms_Buf)) THEN
    Db_BEM_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BEM_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_BEM_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_BEM_Parms_Buf)) THEN
    Int_BEM_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BEM_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_BEM_Parms_Buf)
  ENDIF
  CALL AD_UnPackbemparms( Re_BEM_Parms_Buf, Db_BEM_Parms_Buf, Int_BEM_Parms_Buf, OutData%BEM_Parms, ErrStat, ErrMsg ) ! BEM_Parms 
 ! first call AD_Packopenmpparms to get correctly sized buffers for unpacking
  CALL AD_Packopenmpparms( Re_OpenMP_Parms_Buf, Db_OpenMP_Parms_Buf, Int_OpenMP_Parms_Buf, OutData%OpenMP_Parms, ErrStat, ErrMsg, .TRUE. ) ! OpenMP_Parms 
  IF(ALLOCATED(Re_OpenMP_Parms_Buf)) THEN
    Re_OpenMP_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OpenMP_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OpenMP_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_OpenMP_Parms_Buf)) THEN
    Db_OpenMP_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OpenMP_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OpenMP_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_OpenMP_Parms_Buf)) THEN
    Int_OpenMP_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OpenMP_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OpenMP_Parms_Buf)
  ENDIF
  CALL AD_UnPackopenmpparms( Re_OpenMP_Parms_Buf, Db_OpenMP_Parms_Buf, Int_OpenMP_Parms_Buf, OutData%OpenMP_Parms, ErrStat, ErrMsg ) ! OpenMP_Parms 
 ! first call AD_Packtreeparms to get correctly sized buffers for unpacking
  CALL AD_Packtreeparms( Re_Tree_Parms_Buf, Db_Tree_Parms_Buf, Int_Tree_Parms_Buf, OutData%Tree_Parms, ErrStat, ErrMsg, .TRUE. ) ! Tree_Parms 
  IF(ALLOCATED(Re_Tree_Parms_Buf)) THEN
    Re_Tree_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tree_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Tree_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tree_Parms_Buf)) THEN
    Db_Tree_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tree_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Tree_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tree_Parms_Buf)) THEN
    Int_Tree_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tree_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Tree_Parms_Buf)
  ENDIF
  CALL AD_UnPacktreeparms( Re_Tree_Parms_Buf, Db_Tree_Parms_Buf, Int_Tree_Parms_Buf, OutData%Tree_Parms, ErrStat, ErrMsg ) ! Tree_Parms 
 ! first call AD_Packtwrparms to get correctly sized buffers for unpacking
  CALL AD_Packtwrparms( Re_Twr_Parms_Buf, Db_Twr_Parms_Buf, Int_Twr_Parms_Buf, OutData%Twr_Parms, ErrStat, ErrMsg, .TRUE. ) ! Twr_Parms 
  IF(ALLOCATED(Re_Twr_Parms_Buf)) THEN
    Re_Twr_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_Parms_Buf)) THEN
    Db_Twr_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_Parms_Buf)) THEN
    Int_Twr_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_Parms_Buf)
  ENDIF
  CALL AD_UnPacktwrparms( Re_Twr_Parms_Buf, Db_Twr_Parms_Buf, Int_Twr_Parms_Buf, OutData%Twr_Parms, ErrStat, ErrMsg ) ! Twr_Parms 
 ! first call AD_Packgroundparms to get correctly sized buffers for unpacking
  CALL AD_Packgroundparms( Re_Ground_Parms_Buf, Db_Ground_Parms_Buf, Int_Ground_Parms_Buf, OutData%Ground_Parms, ErrStat, ErrMsg, .TRUE. ) ! Ground_Parms 
  IF(ALLOCATED(Re_Ground_Parms_Buf)) THEN
    Re_Ground_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ground_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ground_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ground_Parms_Buf)) THEN
    Db_Ground_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ground_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ground_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ground_Parms_Buf)) THEN
    Int_Ground_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ground_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ground_Parms_Buf)
  ENDIF
  CALL AD_UnPackgroundparms( Re_Ground_Parms_Buf, Db_Ground_Parms_Buf, Int_Ground_Parms_Buf, OutData%Ground_Parms, ErrStat, ErrMsg ) ! Ground_Parms 
 ! first call AD_Packwindshearparms to get correctly sized buffers for unpacking
  CALL AD_Packwindshearparms( Re_Shear_Parms_Buf, Db_Shear_Parms_Buf, Int_Shear_Parms_Buf, OutData%Shear_Parms, ErrStat, ErrMsg, .TRUE. ) ! Shear_Parms 
  IF(ALLOCATED(Re_Shear_Parms_Buf)) THEN
    Re_Shear_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Shear_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Shear_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_Shear_Parms_Buf)) THEN
    Db_Shear_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Shear_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Shear_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_Shear_Parms_Buf)) THEN
    Int_Shear_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Shear_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Shear_Parms_Buf)
  ENDIF
  CALL AD_UnPackwindshearparms( Re_Shear_Parms_Buf, Db_Shear_Parms_Buf, Int_Shear_Parms_Buf, OutData%Shear_Parms, ErrStat, ErrMsg ) ! Shear_Parms 
 ! first call AD_Packrlvortexmodel to get correctly sized buffers for unpacking
  CALL AD_Packrlvortexmodel( Re_RL_Model_Buf, Db_RL_Model_Buf, Int_RL_Model_Buf, OutData%RL_Model, ErrStat, ErrMsg, .TRUE. ) ! RL_Model 
  IF(ALLOCATED(Re_RL_Model_Buf)) THEN
    Re_RL_Model_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RL_Model_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RL_Model_Buf)
  ENDIF
  IF(ALLOCATED(Db_RL_Model_Buf)) THEN
    Db_RL_Model_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RL_Model_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RL_Model_Buf)
  ENDIF
  IF(ALLOCATED(Int_RL_Model_Buf)) THEN
    Int_RL_Model_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RL_Model_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RL_Model_Buf)
  ENDIF
  CALL AD_UnPackrlvortexmodel( Re_RL_Model_Buf, Db_RL_Model_Buf, Int_RL_Model_Buf, OutData%RL_Model, ErrStat, ErrMsg ) ! RL_Model 
 ! first call AD_Packdsparms to get correctly sized buffers for unpacking
  CALL AD_Packdsparms( Re_DS_Parms_Buf, Db_DS_Parms_Buf, Int_DS_Parms_Buf, OutData%DS_Parms, ErrStat, ErrMsg, .TRUE. ) ! DS_Parms 
  IF(ALLOCATED(Re_DS_Parms_Buf)) THEN
    Re_DS_Parms_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DS_Parms_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DS_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Db_DS_Parms_Buf)) THEN
    Db_DS_Parms_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DS_Parms_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DS_Parms_Buf)
  ENDIF
  IF(ALLOCATED(Int_DS_Parms_Buf)) THEN
    Int_DS_Parms_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DS_Parms_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DS_Parms_Buf)
  ENDIF
  CALL AD_UnPackdsparms( Re_DS_Parms_Buf, Db_DS_Parms_Buf, Int_DS_Parms_Buf, OutData%DS_Parms, ErrStat, ErrMsg ) ! DS_Parms 
  OutData%RHO = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%Gravity = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%TURBINE_ShftTilt = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackFVMParmsTYPE

 SUBROUTINE AD_CopyGround_other( SrcGround_otherData, DstGround_otherData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Ground_other), INTENT(IN) :: SrcGround_otherData
   TYPE(Ground_other), INTENT(INOUT) :: DstGround_otherData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstGround_otherData%Np = SrcGround_otherData%Np
   DstGround_otherData%x_min = SrcGround_otherData%x_min
   DstGround_otherData%x_max = SrcGround_otherData%x_max
   DstGround_otherData%dx = SrcGround_otherData%dx
IF (ALLOCATED(SrcGround_otherData%xp)) THEN
   i1_l = LBOUND(SrcGround_otherData%xp,1)
   i1_u = UBOUND(SrcGround_otherData%xp,1)
   i2_l = LBOUND(SrcGround_otherData%xp,2)
   i2_u = UBOUND(SrcGround_otherData%xp,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%xp)) THEN 
      ALLOCATE(DstGround_otherData%xp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%xp.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%xp = SrcGround_otherData%xp
ENDIF
   DstGround_otherData%y_min = SrcGround_otherData%y_min
   DstGround_otherData%y_max = SrcGround_otherData%y_max
   DstGround_otherData%dy = SrcGround_otherData%dy
IF (ALLOCATED(SrcGround_otherData%yp)) THEN
   i1_l = LBOUND(SrcGround_otherData%yp,1)
   i1_u = UBOUND(SrcGround_otherData%yp,1)
   i2_l = LBOUND(SrcGround_otherData%yp,2)
   i2_u = UBOUND(SrcGround_otherData%yp,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%yp)) THEN 
      ALLOCATE(DstGround_otherData%yp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%yp.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%yp = SrcGround_otherData%yp
ENDIF
IF (ALLOCATED(SrcGround_otherData%zp)) THEN
   i1_l = LBOUND(SrcGround_otherData%zp,1)
   i1_u = UBOUND(SrcGround_otherData%zp,1)
   i2_l = LBOUND(SrcGround_otherData%zp,2)
   i2_u = UBOUND(SrcGround_otherData%zp,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%zp)) THEN 
      ALLOCATE(DstGround_otherData%zp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%zp.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%zp = SrcGround_otherData%zp
ENDIF
IF (ALLOCATED(SrcGround_otherData%xp_mesh)) THEN
   i1_l = LBOUND(SrcGround_otherData%xp_mesh,1)
   i1_u = UBOUND(SrcGround_otherData%xp_mesh,1)
   i2_l = LBOUND(SrcGround_otherData%xp_mesh,2)
   i2_u = UBOUND(SrcGround_otherData%xp_mesh,2)
   i3_l = LBOUND(SrcGround_otherData%xp_mesh,3)
   i3_u = UBOUND(SrcGround_otherData%xp_mesh,3)
   IF (.NOT. ALLOCATED(DstGround_otherData%xp_mesh)) THEN 
      ALLOCATE(DstGround_otherData%xp_mesh(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%xp_mesh.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%xp_mesh = SrcGround_otherData%xp_mesh
ENDIF
IF (ALLOCATED(SrcGround_otherData%yp_mesh)) THEN
   i1_l = LBOUND(SrcGround_otherData%yp_mesh,1)
   i1_u = UBOUND(SrcGround_otherData%yp_mesh,1)
   i2_l = LBOUND(SrcGround_otherData%yp_mesh,2)
   i2_u = UBOUND(SrcGround_otherData%yp_mesh,2)
   i3_l = LBOUND(SrcGround_otherData%yp_mesh,3)
   i3_u = UBOUND(SrcGround_otherData%yp_mesh,3)
   IF (.NOT. ALLOCATED(DstGround_otherData%yp_mesh)) THEN 
      ALLOCATE(DstGround_otherData%yp_mesh(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%yp_mesh.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%yp_mesh = SrcGround_otherData%yp_mesh
ENDIF
IF (ALLOCATED(SrcGround_otherData%zp_mesh)) THEN
   i1_l = LBOUND(SrcGround_otherData%zp_mesh,1)
   i1_u = UBOUND(SrcGround_otherData%zp_mesh,1)
   i2_l = LBOUND(SrcGround_otherData%zp_mesh,2)
   i2_u = UBOUND(SrcGround_otherData%zp_mesh,2)
   i3_l = LBOUND(SrcGround_otherData%zp_mesh,3)
   i3_u = UBOUND(SrcGround_otherData%zp_mesh,3)
   IF (.NOT. ALLOCATED(DstGround_otherData%zp_mesh)) THEN 
      ALLOCATE(DstGround_otherData%zp_mesh(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%zp_mesh.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%zp_mesh = SrcGround_otherData%zp_mesh
ENDIF
   DstGround_otherData%co = SrcGround_otherData%co
IF (ALLOCATED(SrcGround_otherData%Gamma)) THEN
   i1_l = LBOUND(SrcGround_otherData%Gamma,1)
   i1_u = UBOUND(SrcGround_otherData%Gamma,1)
   i2_l = LBOUND(SrcGround_otherData%Gamma,2)
   i2_u = UBOUND(SrcGround_otherData%Gamma,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%Gamma)) THEN 
      ALLOCATE(DstGround_otherData%Gamma(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%Gamma.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%Gamma = SrcGround_otherData%Gamma
ENDIF
IF (ALLOCATED(SrcGround_otherData%p)) THEN
   i1_l = LBOUND(SrcGround_otherData%p,1)
   i1_u = UBOUND(SrcGround_otherData%p,1)
   i2_l = LBOUND(SrcGround_otherData%p,2)
   i2_u = UBOUND(SrcGround_otherData%p,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%p)) THEN 
      ALLOCATE(DstGround_otherData%p(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%p.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%p = SrcGround_otherData%p
ENDIF
IF (ALLOCATED(SrcGround_otherData%b)) THEN
   i1_l = LBOUND(SrcGround_otherData%b,1)
   i1_u = UBOUND(SrcGround_otherData%b,1)
   i2_l = LBOUND(SrcGround_otherData%b,2)
   i2_u = UBOUND(SrcGround_otherData%b,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%b)) THEN 
      ALLOCATE(DstGround_otherData%b(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%b.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%b = SrcGround_otherData%b
ENDIF
IF (ALLOCATED(SrcGround_otherData%n_vec)) THEN
   i1_l = LBOUND(SrcGround_otherData%n_vec,1)
   i1_u = UBOUND(SrcGround_otherData%n_vec,1)
   i2_l = LBOUND(SrcGround_otherData%n_vec,2)
   i2_u = UBOUND(SrcGround_otherData%n_vec,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%n_vec)) THEN 
      ALLOCATE(DstGround_otherData%n_vec(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%n_vec.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%n_vec = SrcGround_otherData%n_vec
ENDIF
IF (ALLOCATED(SrcGround_otherData%P_source)) THEN
   i1_l = LBOUND(SrcGround_otherData%P_source,1)
   i1_u = UBOUND(SrcGround_otherData%P_source,1)
   i2_l = LBOUND(SrcGround_otherData%P_source,2)
   i2_u = UBOUND(SrcGround_otherData%P_source,2)
   i3_l = LBOUND(SrcGround_otherData%P_source,3)
   i3_u = UBOUND(SrcGround_otherData%P_source,3)
   i4_l = LBOUND(SrcGround_otherData%P_source,4)
   i4_u = UBOUND(SrcGround_otherData%P_source,4)
   i5_l = LBOUND(SrcGround_otherData%P_source,5)
   i5_u = UBOUND(SrcGround_otherData%P_source,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%P_source)) THEN 
      ALLOCATE(DstGround_otherData%P_source(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%P_source.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%P_source = SrcGround_otherData%P_source
ENDIF
IF (ALLOCATED(SrcGround_otherData%gamma_grid)) THEN
   i1_l = LBOUND(SrcGround_otherData%gamma_grid,1)
   i1_u = UBOUND(SrcGround_otherData%gamma_grid,1)
   i2_l = LBOUND(SrcGround_otherData%gamma_grid,2)
   i2_u = UBOUND(SrcGround_otherData%gamma_grid,2)
   i3_l = LBOUND(SrcGround_otherData%gamma_grid,3)
   i3_u = UBOUND(SrcGround_otherData%gamma_grid,3)
   i4_l = LBOUND(SrcGround_otherData%gamma_grid,4)
   i4_u = UBOUND(SrcGround_otherData%gamma_grid,4)
   i5_l = LBOUND(SrcGround_otherData%gamma_grid,5)
   i5_u = UBOUND(SrcGround_otherData%gamma_grid,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%gamma_grid)) THEN 
      ALLOCATE(DstGround_otherData%gamma_grid(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%gamma_grid.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%gamma_grid = SrcGround_otherData%gamma_grid
ENDIF
IF (ALLOCATED(SrcGround_otherData%rc_grid)) THEN
   i1_l = LBOUND(SrcGround_otherData%rc_grid,1)
   i1_u = UBOUND(SrcGround_otherData%rc_grid,1)
   i2_l = LBOUND(SrcGround_otherData%rc_grid,2)
   i2_u = UBOUND(SrcGround_otherData%rc_grid,2)
   i3_l = LBOUND(SrcGround_otherData%rc_grid,3)
   i3_u = UBOUND(SrcGround_otherData%rc_grid,3)
   i4_l = LBOUND(SrcGround_otherData%rc_grid,4)
   i4_u = UBOUND(SrcGround_otherData%rc_grid,4)
   i5_l = LBOUND(SrcGround_otherData%rc_grid,5)
   i5_u = UBOUND(SrcGround_otherData%rc_grid,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%rc_grid)) THEN 
      ALLOCATE(DstGround_otherData%rc_grid(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%rc_grid.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%rc_grid = SrcGround_otherData%rc_grid
ENDIF
IF (ALLOCATED(SrcGround_otherData%grid_righttop)) THEN
   i1_l = LBOUND(SrcGround_otherData%grid_righttop,1)
   i1_u = UBOUND(SrcGround_otherData%grid_righttop,1)
   i2_l = LBOUND(SrcGround_otherData%grid_righttop,2)
   i2_u = UBOUND(SrcGround_otherData%grid_righttop,2)
   i3_l = LBOUND(SrcGround_otherData%grid_righttop,3)
   i3_u = UBOUND(SrcGround_otherData%grid_righttop,3)
   i4_l = LBOUND(SrcGround_otherData%grid_righttop,4)
   i4_u = UBOUND(SrcGround_otherData%grid_righttop,4)
   i5_l = LBOUND(SrcGround_otherData%grid_righttop,5)
   i5_u = UBOUND(SrcGround_otherData%grid_righttop,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%grid_righttop)) THEN 
      ALLOCATE(DstGround_otherData%grid_righttop(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%grid_righttop.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%grid_righttop = SrcGround_otherData%grid_righttop
ENDIF
IF (ALLOCATED(SrcGround_otherData%grid_rightbottom)) THEN
   i1_l = LBOUND(SrcGround_otherData%grid_rightbottom,1)
   i1_u = UBOUND(SrcGround_otherData%grid_rightbottom,1)
   i2_l = LBOUND(SrcGround_otherData%grid_rightbottom,2)
   i2_u = UBOUND(SrcGround_otherData%grid_rightbottom,2)
   i3_l = LBOUND(SrcGround_otherData%grid_rightbottom,3)
   i3_u = UBOUND(SrcGround_otherData%grid_rightbottom,3)
   i4_l = LBOUND(SrcGround_otherData%grid_rightbottom,4)
   i4_u = UBOUND(SrcGround_otherData%grid_rightbottom,4)
   i5_l = LBOUND(SrcGround_otherData%grid_rightbottom,5)
   i5_u = UBOUND(SrcGround_otherData%grid_rightbottom,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%grid_rightbottom)) THEN 
      ALLOCATE(DstGround_otherData%grid_rightbottom(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%grid_rightbottom.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%grid_rightbottom = SrcGround_otherData%grid_rightbottom
ENDIF
IF (ALLOCATED(SrcGround_otherData%grid_leftbottom)) THEN
   i1_l = LBOUND(SrcGround_otherData%grid_leftbottom,1)
   i1_u = UBOUND(SrcGround_otherData%grid_leftbottom,1)
   i2_l = LBOUND(SrcGround_otherData%grid_leftbottom,2)
   i2_u = UBOUND(SrcGround_otherData%grid_leftbottom,2)
   i3_l = LBOUND(SrcGround_otherData%grid_leftbottom,3)
   i3_u = UBOUND(SrcGround_otherData%grid_leftbottom,3)
   i4_l = LBOUND(SrcGround_otherData%grid_leftbottom,4)
   i4_u = UBOUND(SrcGround_otherData%grid_leftbottom,4)
   i5_l = LBOUND(SrcGround_otherData%grid_leftbottom,5)
   i5_u = UBOUND(SrcGround_otherData%grid_leftbottom,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%grid_leftbottom)) THEN 
      ALLOCATE(DstGround_otherData%grid_leftbottom(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%grid_leftbottom.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%grid_leftbottom = SrcGround_otherData%grid_leftbottom
ENDIF
IF (ALLOCATED(SrcGround_otherData%grid_lefttop)) THEN
   i1_l = LBOUND(SrcGround_otherData%grid_lefttop,1)
   i1_u = UBOUND(SrcGround_otherData%grid_lefttop,1)
   i2_l = LBOUND(SrcGround_otherData%grid_lefttop,2)
   i2_u = UBOUND(SrcGround_otherData%grid_lefttop,2)
   i3_l = LBOUND(SrcGround_otherData%grid_lefttop,3)
   i3_u = UBOUND(SrcGround_otherData%grid_lefttop,3)
   i4_l = LBOUND(SrcGround_otherData%grid_lefttop,4)
   i4_u = UBOUND(SrcGround_otherData%grid_lefttop,4)
   i5_l = LBOUND(SrcGround_otherData%grid_lefttop,5)
   i5_u = UBOUND(SrcGround_otherData%grid_lefttop,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%grid_lefttop)) THEN 
      ALLOCATE(DstGround_otherData%grid_lefttop(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%grid_lefttop.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%grid_lefttop = SrcGround_otherData%grid_lefttop
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_top_main)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_top_main,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_top_main,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_top_main,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_top_main,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_top_main,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_top_main,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_top_main,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_top_main,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_top_main,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_top_main,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_top_main)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_top_main(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_top_main.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_top_main = SrcGround_otherData%V_ind_top_main
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_right_main)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_right_main,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_right_main,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_right_main,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_right_main,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_right_main,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_right_main,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_right_main,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_right_main,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_right_main,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_right_main,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_right_main)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_right_main(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_right_main.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_right_main = SrcGround_otherData%V_ind_right_main
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_bottom_main)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_bottom_main,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_bottom_main,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_bottom_main,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_bottom_main,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_bottom_main,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_bottom_main,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_bottom_main,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_bottom_main,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_bottom_main,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_bottom_main,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_bottom_main)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_bottom_main(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_bottom_main.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_bottom_main = SrcGround_otherData%V_ind_bottom_main
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_left_main)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_left_main,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_left_main,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_left_main,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_left_main,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_left_main,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_left_main,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_left_main,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_left_main,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_left_main,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_left_main,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_left_main)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_left_main(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_left_main.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_left_main = SrcGround_otherData%V_ind_left_main
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_top_kj)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_top_kj,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_top_kj,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_top_kj,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_top_kj,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_top_kj,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_top_kj,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_top_kj,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_top_kj,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_top_kj,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_top_kj,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_top_kj)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_top_kj(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_top_kj.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_top_kj = SrcGround_otherData%V_ind_top_kj
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_right_kj)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_right_kj,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_right_kj,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_right_kj,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_right_kj,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_right_kj,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_right_kj,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_right_kj,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_right_kj,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_right_kj,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_right_kj,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_right_kj)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_right_kj(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_right_kj.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_right_kj = SrcGround_otherData%V_ind_right_kj
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_bottom_kj)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_bottom_kj,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_bottom_kj,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_bottom_kj,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_bottom_kj,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_bottom_kj,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_bottom_kj,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_bottom_kj,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_bottom_kj,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_bottom_kj,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_bottom_kj,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_bottom_kj)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_bottom_kj(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_bottom_kj.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_bottom_kj = SrcGround_otherData%V_ind_bottom_kj
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_ind_left_kj)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_ind_left_kj,1)
   i1_u = UBOUND(SrcGround_otherData%V_ind_left_kj,1)
   i2_l = LBOUND(SrcGround_otherData%V_ind_left_kj,2)
   i2_u = UBOUND(SrcGround_otherData%V_ind_left_kj,2)
   i3_l = LBOUND(SrcGround_otherData%V_ind_left_kj,3)
   i3_u = UBOUND(SrcGround_otherData%V_ind_left_kj,3)
   i4_l = LBOUND(SrcGround_otherData%V_ind_left_kj,4)
   i4_u = UBOUND(SrcGround_otherData%V_ind_left_kj,4)
   i5_l = LBOUND(SrcGround_otherData%V_ind_left_kj,5)
   i5_u = UBOUND(SrcGround_otherData%V_ind_left_kj,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_ind_left_kj)) THEN 
      ALLOCATE(DstGround_otherData%V_ind_left_kj(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_ind_left_kj.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_ind_left_kj = SrcGround_otherData%V_ind_left_kj
ENDIF
IF (ALLOCATED(SrcGround_otherData%V_n)) THEN
   i1_l = LBOUND(SrcGround_otherData%V_n,1)
   i1_u = UBOUND(SrcGround_otherData%V_n,1)
   i2_l = LBOUND(SrcGround_otherData%V_n,2)
   i2_u = UBOUND(SrcGround_otherData%V_n,2)
   IF (.NOT. ALLOCATED(DstGround_otherData%V_n)) THEN 
      ALLOCATE(DstGround_otherData%V_n(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%V_n.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%V_n = SrcGround_otherData%V_n
ENDIF
IF (ALLOCATED(SrcGround_otherData%Vind_mirtmp_SHED)) THEN
   i1_l = LBOUND(SrcGround_otherData%Vind_mirtmp_SHED,1)
   i1_u = UBOUND(SrcGround_otherData%Vind_mirtmp_SHED,1)
   i2_l = LBOUND(SrcGround_otherData%Vind_mirtmp_SHED,2)
   i2_u = UBOUND(SrcGround_otherData%Vind_mirtmp_SHED,2)
   i3_l = LBOUND(SrcGround_otherData%Vind_mirtmp_SHED,3)
   i3_u = UBOUND(SrcGround_otherData%Vind_mirtmp_SHED,3)
   i4_l = LBOUND(SrcGround_otherData%Vind_mirtmp_SHED,4)
   i4_u = UBOUND(SrcGround_otherData%Vind_mirtmp_SHED,4)
   i5_l = LBOUND(SrcGround_otherData%Vind_mirtmp_SHED,5)
   i5_u = UBOUND(SrcGround_otherData%Vind_mirtmp_SHED,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%Vind_mirtmp_SHED)) THEN 
      ALLOCATE(DstGround_otherData%Vind_mirtmp_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%Vind_mirtmp_SHED.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%Vind_mirtmp_SHED = SrcGround_otherData%Vind_mirtmp_SHED
ENDIF
IF (ALLOCATED(SrcGround_otherData%Vind_mirtmp_TRAIL)) THEN
   i1_l = LBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,1)
   i1_u = UBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,1)
   i2_l = LBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,2)
   i2_u = UBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,2)
   i3_l = LBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,3)
   i3_u = UBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,3)
   i4_l = LBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,4)
   i4_u = UBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,4)
   i5_l = LBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,5)
   i5_u = UBOUND(SrcGround_otherData%Vind_mirtmp_TRAIL,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%Vind_mirtmp_TRAIL)) THEN 
      ALLOCATE(DstGround_otherData%Vind_mirtmp_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%Vind_mirtmp_TRAIL.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%Vind_mirtmp_TRAIL = SrcGround_otherData%Vind_mirtmp_TRAIL
ENDIF
IF (ALLOCATED(SrcGround_otherData%VindB_mirtmp_SHED)) THEN
   i1_l = LBOUND(SrcGround_otherData%VindB_mirtmp_SHED,1)
   i1_u = UBOUND(SrcGround_otherData%VindB_mirtmp_SHED,1)
   i2_l = LBOUND(SrcGround_otherData%VindB_mirtmp_SHED,2)
   i2_u = UBOUND(SrcGround_otherData%VindB_mirtmp_SHED,2)
   i3_l = LBOUND(SrcGround_otherData%VindB_mirtmp_SHED,3)
   i3_u = UBOUND(SrcGround_otherData%VindB_mirtmp_SHED,3)
   i4_l = LBOUND(SrcGround_otherData%VindB_mirtmp_SHED,4)
   i4_u = UBOUND(SrcGround_otherData%VindB_mirtmp_SHED,4)
   i5_l = LBOUND(SrcGround_otherData%VindB_mirtmp_SHED,5)
   i5_u = UBOUND(SrcGround_otherData%VindB_mirtmp_SHED,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%VindB_mirtmp_SHED)) THEN 
      ALLOCATE(DstGround_otherData%VindB_mirtmp_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%VindB_mirtmp_SHED.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%VindB_mirtmp_SHED = SrcGround_otherData%VindB_mirtmp_SHED
ENDIF
IF (ALLOCATED(SrcGround_otherData%VindB_mirtmp_TRAIL)) THEN
   i1_l = LBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,1)
   i1_u = UBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,1)
   i2_l = LBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,2)
   i2_u = UBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,2)
   i3_l = LBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,3)
   i3_u = UBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,3)
   i4_l = LBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,4)
   i4_u = UBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,4)
   i5_l = LBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,5)
   i5_u = UBOUND(SrcGround_otherData%VindB_mirtmp_TRAIL,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%VindB_mirtmp_TRAIL)) THEN 
      ALLOCATE(DstGround_otherData%VindB_mirtmp_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%VindB_mirtmp_TRAIL.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%VindB_mirtmp_TRAIL = SrcGround_otherData%VindB_mirtmp_TRAIL
ENDIF
IF (ALLOCATED(SrcGround_otherData%MIRROR)) THEN
   i1_l = LBOUND(SrcGround_otherData%MIRROR,1)
   i1_u = UBOUND(SrcGround_otherData%MIRROR,1)
   i2_l = LBOUND(SrcGround_otherData%MIRROR,2)
   i2_u = UBOUND(SrcGround_otherData%MIRROR,2)
   i3_l = LBOUND(SrcGround_otherData%MIRROR,3)
   i3_u = UBOUND(SrcGround_otherData%MIRROR,3)
   i4_l = LBOUND(SrcGround_otherData%MIRROR,4)
   i4_u = UBOUND(SrcGround_otherData%MIRROR,4)
   i5_l = LBOUND(SrcGround_otherData%MIRROR,5)
   i5_u = UBOUND(SrcGround_otherData%MIRROR,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%MIRROR)) THEN 
      ALLOCATE(DstGround_otherData%MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%MIRROR.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%MIRROR = SrcGround_otherData%MIRROR
ENDIF
IF (ALLOCATED(SrcGround_otherData%WAKE_MIRROR)) THEN
   i1_l = LBOUND(SrcGround_otherData%WAKE_MIRROR,1)
   i1_u = UBOUND(SrcGround_otherData%WAKE_MIRROR,1)
   i2_l = LBOUND(SrcGround_otherData%WAKE_MIRROR,2)
   i2_u = UBOUND(SrcGround_otherData%WAKE_MIRROR,2)
   i3_l = LBOUND(SrcGround_otherData%WAKE_MIRROR,3)
   i3_u = UBOUND(SrcGround_otherData%WAKE_MIRROR,3)
   i4_l = LBOUND(SrcGround_otherData%WAKE_MIRROR,4)
   i4_u = UBOUND(SrcGround_otherData%WAKE_MIRROR,4)
   i5_l = LBOUND(SrcGround_otherData%WAKE_MIRROR,5)
   i5_u = UBOUND(SrcGround_otherData%WAKE_MIRROR,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%WAKE_MIRROR)) THEN 
      ALLOCATE(DstGround_otherData%WAKE_MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%WAKE_MIRROR.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%WAKE_MIRROR = SrcGround_otherData%WAKE_MIRROR
ENDIF
IF (ALLOCATED(SrcGround_otherData%GAMMA_SHED_MIRROR)) THEN
   i1_l = LBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,1)
   i1_u = UBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,1)
   i2_l = LBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,2)
   i2_u = UBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,2)
   i3_l = LBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,3)
   i3_u = UBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,3)
   i4_l = LBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,4)
   i4_u = UBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,4)
   i5_l = LBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,5)
   i5_u = UBOUND(SrcGround_otherData%GAMMA_SHED_MIRROR,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%GAMMA_SHED_MIRROR)) THEN 
      ALLOCATE(DstGround_otherData%GAMMA_SHED_MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%GAMMA_SHED_MIRROR.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%GAMMA_SHED_MIRROR = SrcGround_otherData%GAMMA_SHED_MIRROR
ENDIF
IF (ALLOCATED(SrcGround_otherData%GAMMA_TRAIL_MIRROR)) THEN
   i1_l = LBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,1)
   i1_u = UBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,1)
   i2_l = LBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,2)
   i2_u = UBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,2)
   i3_l = LBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,3)
   i3_u = UBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,3)
   i4_l = LBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,4)
   i4_u = UBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,4)
   i5_l = LBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,5)
   i5_u = UBOUND(SrcGround_otherData%GAMMA_TRAIL_MIRROR,5)
   IF (.NOT. ALLOCATED(DstGround_otherData%GAMMA_TRAIL_MIRROR)) THEN 
      ALLOCATE(DstGround_otherData%GAMMA_TRAIL_MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstGround_otherData%GAMMA_TRAIL_MIRROR.', ErrStat, ErrMsg,'AD_CopyGround_other')
         RETURN
      END IF
   END IF
   DstGround_otherData%GAMMA_TRAIL_MIRROR = SrcGround_otherData%GAMMA_TRAIL_MIRROR
ENDIF
 END SUBROUTINE AD_CopyGround_other

 SUBROUTINE AD_DestroyGround_other( Ground_otherData, ErrStat, ErrMsg )
  TYPE(Ground_other), INTENT(INOUT) :: Ground_otherData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(Ground_otherData%xp)) THEN
   DEALLOCATE(Ground_otherData%xp)
ENDIF
IF (ALLOCATED(Ground_otherData%yp)) THEN
   DEALLOCATE(Ground_otherData%yp)
ENDIF
IF (ALLOCATED(Ground_otherData%zp)) THEN
   DEALLOCATE(Ground_otherData%zp)
ENDIF
IF (ALLOCATED(Ground_otherData%xp_mesh)) THEN
   DEALLOCATE(Ground_otherData%xp_mesh)
ENDIF
IF (ALLOCATED(Ground_otherData%yp_mesh)) THEN
   DEALLOCATE(Ground_otherData%yp_mesh)
ENDIF
IF (ALLOCATED(Ground_otherData%zp_mesh)) THEN
   DEALLOCATE(Ground_otherData%zp_mesh)
ENDIF
IF (ALLOCATED(Ground_otherData%Gamma)) THEN
   DEALLOCATE(Ground_otherData%Gamma)
ENDIF
IF (ALLOCATED(Ground_otherData%p)) THEN
   DEALLOCATE(Ground_otherData%p)
ENDIF
IF (ALLOCATED(Ground_otherData%b)) THEN
   DEALLOCATE(Ground_otherData%b)
ENDIF
IF (ALLOCATED(Ground_otherData%n_vec)) THEN
   DEALLOCATE(Ground_otherData%n_vec)
ENDIF
IF (ALLOCATED(Ground_otherData%P_source)) THEN
   DEALLOCATE(Ground_otherData%P_source)
ENDIF
IF (ALLOCATED(Ground_otherData%gamma_grid)) THEN
   DEALLOCATE(Ground_otherData%gamma_grid)
ENDIF
IF (ALLOCATED(Ground_otherData%rc_grid)) THEN
   DEALLOCATE(Ground_otherData%rc_grid)
ENDIF
IF (ALLOCATED(Ground_otherData%grid_righttop)) THEN
   DEALLOCATE(Ground_otherData%grid_righttop)
ENDIF
IF (ALLOCATED(Ground_otherData%grid_rightbottom)) THEN
   DEALLOCATE(Ground_otherData%grid_rightbottom)
ENDIF
IF (ALLOCATED(Ground_otherData%grid_leftbottom)) THEN
   DEALLOCATE(Ground_otherData%grid_leftbottom)
ENDIF
IF (ALLOCATED(Ground_otherData%grid_lefttop)) THEN
   DEALLOCATE(Ground_otherData%grid_lefttop)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_top_main)) THEN
   DEALLOCATE(Ground_otherData%V_ind_top_main)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_right_main)) THEN
   DEALLOCATE(Ground_otherData%V_ind_right_main)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_bottom_main)) THEN
   DEALLOCATE(Ground_otherData%V_ind_bottom_main)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_left_main)) THEN
   DEALLOCATE(Ground_otherData%V_ind_left_main)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_top_kj)) THEN
   DEALLOCATE(Ground_otherData%V_ind_top_kj)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_right_kj)) THEN
   DEALLOCATE(Ground_otherData%V_ind_right_kj)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_bottom_kj)) THEN
   DEALLOCATE(Ground_otherData%V_ind_bottom_kj)
ENDIF
IF (ALLOCATED(Ground_otherData%V_ind_left_kj)) THEN
   DEALLOCATE(Ground_otherData%V_ind_left_kj)
ENDIF
IF (ALLOCATED(Ground_otherData%V_n)) THEN
   DEALLOCATE(Ground_otherData%V_n)
ENDIF
IF (ALLOCATED(Ground_otherData%Vind_mirtmp_SHED)) THEN
   DEALLOCATE(Ground_otherData%Vind_mirtmp_SHED)
ENDIF
IF (ALLOCATED(Ground_otherData%Vind_mirtmp_TRAIL)) THEN
   DEALLOCATE(Ground_otherData%Vind_mirtmp_TRAIL)
ENDIF
IF (ALLOCATED(Ground_otherData%VindB_mirtmp_SHED)) THEN
   DEALLOCATE(Ground_otherData%VindB_mirtmp_SHED)
ENDIF
IF (ALLOCATED(Ground_otherData%VindB_mirtmp_TRAIL)) THEN
   DEALLOCATE(Ground_otherData%VindB_mirtmp_TRAIL)
ENDIF
IF (ALLOCATED(Ground_otherData%MIRROR)) THEN
   DEALLOCATE(Ground_otherData%MIRROR)
ENDIF
IF (ALLOCATED(Ground_otherData%WAKE_MIRROR)) THEN
   DEALLOCATE(Ground_otherData%WAKE_MIRROR)
ENDIF
IF (ALLOCATED(Ground_otherData%GAMMA_SHED_MIRROR)) THEN
   DEALLOCATE(Ground_otherData%GAMMA_SHED_MIRROR)
ENDIF
IF (ALLOCATED(Ground_otherData%GAMMA_TRAIL_MIRROR)) THEN
   DEALLOCATE(Ground_otherData%GAMMA_TRAIL_MIRROR)
ENDIF
 END SUBROUTINE AD_DestroyGround_other

 SUBROUTINE AD_PackGround_other( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Ground_other),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! Np
  Int_BufSz  = Int_BufSz  + 1  ! x_min
  Int_BufSz  = Int_BufSz  + 1  ! x_max
  Db_BufSz   = Db_BufSz   + 1  ! dx
  IF ( ALLOCATED(InData%xp) )   Int_BufSz   = Int_BufSz   + SIZE( InData%xp )  ! xp 
  Int_BufSz  = Int_BufSz  + 1  ! y_min
  Int_BufSz  = Int_BufSz  + 1  ! y_max
  Db_BufSz   = Db_BufSz   + 1  ! dy
  IF ( ALLOCATED(InData%yp) )   Int_BufSz   = Int_BufSz   + SIZE( InData%yp )  ! yp 
  IF ( ALLOCATED(InData%zp) )   Int_BufSz   = Int_BufSz   + SIZE( InData%zp )  ! zp 
  IF ( ALLOCATED(InData%xp_mesh) )   Db_BufSz    = Db_BufSz    + SIZE( InData%xp_mesh )  ! xp_mesh 
  IF ( ALLOCATED(InData%yp_mesh) )   Db_BufSz    = Db_BufSz    + SIZE( InData%yp_mesh )  ! yp_mesh 
  IF ( ALLOCATED(InData%zp_mesh) )   Db_BufSz    = Db_BufSz    + SIZE( InData%zp_mesh )  ! zp_mesh 
  Db_BufSz   = Db_BufSz   + 1  ! co
  IF ( ALLOCATED(InData%Gamma) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Gamma )  ! Gamma 
  IF ( ALLOCATED(InData%p) )   Db_BufSz    = Db_BufSz    + SIZE( InData%p )  ! p 
  IF ( ALLOCATED(InData%b) )   Db_BufSz    = Db_BufSz    + SIZE( InData%b )  ! b 
  IF ( ALLOCATED(InData%n_vec) )   Db_BufSz    = Db_BufSz    + SIZE( InData%n_vec )  ! n_vec 
  IF ( ALLOCATED(InData%P_source) )   Db_BufSz    = Db_BufSz    + SIZE( InData%P_source )  ! P_source 
  IF ( ALLOCATED(InData%gamma_grid) )   Db_BufSz    = Db_BufSz    + SIZE( InData%gamma_grid )  ! gamma_grid 
  IF ( ALLOCATED(InData%rc_grid) )   Db_BufSz    = Db_BufSz    + SIZE( InData%rc_grid )  ! rc_grid 
  IF ( ALLOCATED(InData%grid_righttop) )   Db_BufSz    = Db_BufSz    + SIZE( InData%grid_righttop )  ! grid_righttop 
  IF ( ALLOCATED(InData%grid_rightbottom) )   Db_BufSz    = Db_BufSz    + SIZE( InData%grid_rightbottom )  ! grid_rightbottom 
  IF ( ALLOCATED(InData%grid_leftbottom) )   Db_BufSz    = Db_BufSz    + SIZE( InData%grid_leftbottom )  ! grid_leftbottom 
  IF ( ALLOCATED(InData%grid_lefttop) )   Db_BufSz    = Db_BufSz    + SIZE( InData%grid_lefttop )  ! grid_lefttop 
  IF ( ALLOCATED(InData%V_ind_top_main) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_top_main )  ! V_ind_top_main 
  IF ( ALLOCATED(InData%V_ind_right_main) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_right_main )  ! V_ind_right_main 
  IF ( ALLOCATED(InData%V_ind_bottom_main) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_bottom_main )  ! V_ind_bottom_main 
  IF ( ALLOCATED(InData%V_ind_left_main) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_left_main )  ! V_ind_left_main 
  IF ( ALLOCATED(InData%V_ind_top_kj) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_top_kj )  ! V_ind_top_kj 
  IF ( ALLOCATED(InData%V_ind_right_kj) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_right_kj )  ! V_ind_right_kj 
  IF ( ALLOCATED(InData%V_ind_bottom_kj) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_bottom_kj )  ! V_ind_bottom_kj 
  IF ( ALLOCATED(InData%V_ind_left_kj) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_ind_left_kj )  ! V_ind_left_kj 
  IF ( ALLOCATED(InData%V_n) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V_n )  ! V_n 
  IF ( ALLOCATED(InData%Vind_mirtmp_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Vind_mirtmp_SHED )  ! Vind_mirtmp_SHED 
  IF ( ALLOCATED(InData%Vind_mirtmp_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Vind_mirtmp_TRAIL )  ! Vind_mirtmp_TRAIL 
  IF ( ALLOCATED(InData%VindB_mirtmp_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VindB_mirtmp_SHED )  ! VindB_mirtmp_SHED 
  IF ( ALLOCATED(InData%VindB_mirtmp_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VindB_mirtmp_TRAIL )  ! VindB_mirtmp_TRAIL 
  IF ( ALLOCATED(InData%MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%MIRROR )  ! MIRROR 
  IF ( ALLOCATED(InData%WAKE_MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_MIRROR )  ! WAKE_MIRROR 
  IF ( ALLOCATED(InData%GAMMA_SHED_MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%GAMMA_SHED_MIRROR )  ! GAMMA_SHED_MIRROR 
  IF ( ALLOCATED(InData%GAMMA_TRAIL_MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%GAMMA_TRAIL_MIRROR )  ! GAMMA_TRAIL_MIRROR 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%Np )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%x_min )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%x_max )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%dx )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%xp) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%xp))-1 ) = PACK(InData%xp ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%xp)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%y_min )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%y_max )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%dy )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%yp) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%yp))-1 ) = PACK(InData%yp ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%yp)
  ENDIF
  IF ( ALLOCATED(InData%zp) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%zp))-1 ) = PACK(InData%zp ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%zp)
  ENDIF
  IF ( ALLOCATED(InData%xp_mesh) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%xp_mesh))-1 ) =  PACK(InData%xp_mesh ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%xp_mesh)
  ENDIF
  IF ( ALLOCATED(InData%yp_mesh) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%yp_mesh))-1 ) =  PACK(InData%yp_mesh ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%yp_mesh)
  ENDIF
  IF ( ALLOCATED(InData%zp_mesh) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%zp_mesh))-1 ) =  PACK(InData%zp_mesh ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%zp_mesh)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%co )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%Gamma) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Gamma))-1 ) =  PACK(InData%Gamma ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Gamma)
  ENDIF
  IF ( ALLOCATED(InData%p) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%p))-1 ) =  PACK(InData%p ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%p)
  ENDIF
  IF ( ALLOCATED(InData%b) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%b))-1 ) =  PACK(InData%b ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%b)
  ENDIF
  IF ( ALLOCATED(InData%n_vec) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%n_vec))-1 ) =  PACK(InData%n_vec ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%n_vec)
  ENDIF
  IF ( ALLOCATED(InData%P_source) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%P_source))-1 ) =  PACK(InData%P_source ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%P_source)
  ENDIF
  IF ( ALLOCATED(InData%gamma_grid) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%gamma_grid))-1 ) =  PACK(InData%gamma_grid ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%gamma_grid)
  ENDIF
  IF ( ALLOCATED(InData%rc_grid) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%rc_grid))-1 ) =  PACK(InData%rc_grid ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%rc_grid)
  ENDIF
  IF ( ALLOCATED(InData%grid_righttop) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%grid_righttop))-1 ) =  PACK(InData%grid_righttop ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%grid_righttop)
  ENDIF
  IF ( ALLOCATED(InData%grid_rightbottom) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%grid_rightbottom))-1 ) =  PACK(InData%grid_rightbottom ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%grid_rightbottom)
  ENDIF
  IF ( ALLOCATED(InData%grid_leftbottom) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%grid_leftbottom))-1 ) =  PACK(InData%grid_leftbottom ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%grid_leftbottom)
  ENDIF
  IF ( ALLOCATED(InData%grid_lefttop) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%grid_lefttop))-1 ) =  PACK(InData%grid_lefttop ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%grid_lefttop)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_top_main) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_top_main))-1 ) =  PACK(InData%V_ind_top_main ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_top_main)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_right_main) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_right_main))-1 ) =  PACK(InData%V_ind_right_main ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_right_main)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_bottom_main) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_bottom_main))-1 ) =  PACK(InData%V_ind_bottom_main ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_bottom_main)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_left_main) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_left_main))-1 ) =  PACK(InData%V_ind_left_main ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_left_main)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_top_kj) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_top_kj))-1 ) =  PACK(InData%V_ind_top_kj ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_top_kj)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_right_kj) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_right_kj))-1 ) =  PACK(InData%V_ind_right_kj ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_right_kj)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_bottom_kj) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_bottom_kj))-1 ) =  PACK(InData%V_ind_bottom_kj ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_bottom_kj)
  ENDIF
  IF ( ALLOCATED(InData%V_ind_left_kj) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_ind_left_kj))-1 ) =  PACK(InData%V_ind_left_kj ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_ind_left_kj)
  ENDIF
  IF ( ALLOCATED(InData%V_n) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V_n))-1 ) =  PACK(InData%V_n ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V_n)
  ENDIF
  IF ( ALLOCATED(InData%Vind_mirtmp_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Vind_mirtmp_SHED))-1 ) =  PACK(InData%Vind_mirtmp_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Vind_mirtmp_SHED)
  ENDIF
  IF ( ALLOCATED(InData%Vind_mirtmp_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Vind_mirtmp_TRAIL))-1 ) =  PACK(InData%Vind_mirtmp_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Vind_mirtmp_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%VindB_mirtmp_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VindB_mirtmp_SHED))-1 ) =  PACK(InData%VindB_mirtmp_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VindB_mirtmp_SHED)
  ENDIF
  IF ( ALLOCATED(InData%VindB_mirtmp_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VindB_mirtmp_TRAIL))-1 ) =  PACK(InData%VindB_mirtmp_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VindB_mirtmp_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%MIRROR))-1 ) =  PACK(InData%MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%MIRROR)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_MIRROR))-1 ) =  PACK(InData%WAKE_MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_MIRROR)
  ENDIF
  IF ( ALLOCATED(InData%GAMMA_SHED_MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%GAMMA_SHED_MIRROR))-1 ) =  PACK(InData%GAMMA_SHED_MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%GAMMA_SHED_MIRROR)
  ENDIF
  IF ( ALLOCATED(InData%GAMMA_TRAIL_MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%GAMMA_TRAIL_MIRROR))-1 ) =  PACK(InData%GAMMA_TRAIL_MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%GAMMA_TRAIL_MIRROR)
  ENDIF
 END SUBROUTINE AD_PackGround_other

 SUBROUTINE AD_UnPackGround_other( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Ground_other), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Np = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%x_min = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%x_max = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%dx = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%xp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%xp,1),SIZE(OutData%xp,2)))
  mask2 = .TRUE.
    OutData%xp = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%xp))-1 ),mask2,OutData%xp)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%xp)
  ENDIF
  OutData%y_min = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%y_max = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%dy = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%yp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%yp,1),SIZE(OutData%yp,2)))
  mask2 = .TRUE.
    OutData%yp = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%yp))-1 ),mask2,OutData%yp)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%yp)
  ENDIF
  IF ( ALLOCATED(OutData%zp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%zp,1),SIZE(OutData%zp,2)))
  mask2 = .TRUE.
    OutData%zp = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%zp))-1 ),mask2,OutData%zp)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%zp)
  ENDIF
  IF ( ALLOCATED(OutData%xp_mesh) ) THEN
  ALLOCATE(mask3(SIZE(OutData%xp_mesh,1),SIZE(OutData%xp_mesh,2),SIZE(OutData%xp_mesh,3)))
  mask3 = .TRUE.
    OutData%xp_mesh = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%xp_mesh))-1 ),mask3,OutData%xp_mesh)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%xp_mesh)
  ENDIF
  IF ( ALLOCATED(OutData%yp_mesh) ) THEN
  ALLOCATE(mask3(SIZE(OutData%yp_mesh,1),SIZE(OutData%yp_mesh,2),SIZE(OutData%yp_mesh,3)))
  mask3 = .TRUE.
    OutData%yp_mesh = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%yp_mesh))-1 ),mask3,OutData%yp_mesh)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%yp_mesh)
  ENDIF
  IF ( ALLOCATED(OutData%zp_mesh) ) THEN
  ALLOCATE(mask3(SIZE(OutData%zp_mesh,1),SIZE(OutData%zp_mesh,2),SIZE(OutData%zp_mesh,3)))
  mask3 = .TRUE.
    OutData%zp_mesh = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%zp_mesh))-1 ),mask3,OutData%zp_mesh)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%zp_mesh)
  ENDIF
  OutData%co = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%Gamma) ) THEN
  ALLOCATE(mask2(SIZE(OutData%Gamma,1),SIZE(OutData%Gamma,2)))
  mask2 = .TRUE.
    OutData%Gamma = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Gamma))-1 ),mask2,OutData%Gamma)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Gamma)
  ENDIF
  IF ( ALLOCATED(OutData%p) ) THEN
  ALLOCATE(mask2(SIZE(OutData%p,1),SIZE(OutData%p,2)))
  mask2 = .TRUE.
    OutData%p = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%p))-1 ),mask2,OutData%p)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%p)
  ENDIF
  IF ( ALLOCATED(OutData%b) ) THEN
  ALLOCATE(mask2(SIZE(OutData%b,1),SIZE(OutData%b,2)))
  mask2 = .TRUE.
    OutData%b = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%b))-1 ),mask2,OutData%b)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%b)
  ENDIF
  IF ( ALLOCATED(OutData%n_vec) ) THEN
  ALLOCATE(mask2(SIZE(OutData%n_vec,1),SIZE(OutData%n_vec,2)))
  mask2 = .TRUE.
    OutData%n_vec = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%n_vec))-1 ),mask2,OutData%n_vec)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%n_vec)
  ENDIF
  IF ( ALLOCATED(OutData%P_source) ) THEN
  ALLOCATE(mask5(SIZE(OutData%P_source,1),SIZE(OutData%P_source,2),SIZE(OutData%P_source,3),SIZE(OutData%P_source,4),SIZE(OutData%P_source,5)))
  mask5 = .TRUE.
    OutData%P_source = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%P_source))-1 ),mask5,OutData%P_source)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%P_source)
  ENDIF
  IF ( ALLOCATED(OutData%gamma_grid) ) THEN
  ALLOCATE(mask5(SIZE(OutData%gamma_grid,1),SIZE(OutData%gamma_grid,2),SIZE(OutData%gamma_grid,3),SIZE(OutData%gamma_grid,4),SIZE(OutData%gamma_grid,5)))
  mask5 = .TRUE.
    OutData%gamma_grid = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%gamma_grid))-1 ),mask5,OutData%gamma_grid)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%gamma_grid)
  ENDIF
  IF ( ALLOCATED(OutData%rc_grid) ) THEN
  ALLOCATE(mask5(SIZE(OutData%rc_grid,1),SIZE(OutData%rc_grid,2),SIZE(OutData%rc_grid,3),SIZE(OutData%rc_grid,4),SIZE(OutData%rc_grid,5)))
  mask5 = .TRUE.
    OutData%rc_grid = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%rc_grid))-1 ),mask5,OutData%rc_grid)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%rc_grid)
  ENDIF
  IF ( ALLOCATED(OutData%grid_righttop) ) THEN
  ALLOCATE(mask5(SIZE(OutData%grid_righttop,1),SIZE(OutData%grid_righttop,2),SIZE(OutData%grid_righttop,3),SIZE(OutData%grid_righttop,4),SIZE(OutData%grid_righttop,5)))
  mask5 = .TRUE.
    OutData%grid_righttop = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%grid_righttop))-1 ),mask5,OutData%grid_righttop)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%grid_righttop)
  ENDIF
  IF ( ALLOCATED(OutData%grid_rightbottom) ) THEN
  ALLOCATE(mask5(SIZE(OutData%grid_rightbottom,1),SIZE(OutData%grid_rightbottom,2),SIZE(OutData%grid_rightbottom,3),SIZE(OutData%grid_rightbottom,4),SIZE(OutData%grid_rightbottom,5)))
  mask5 = .TRUE.
    OutData%grid_rightbottom = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%grid_rightbottom))-1 ),mask5,OutData%grid_rightbottom)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%grid_rightbottom)
  ENDIF
  IF ( ALLOCATED(OutData%grid_leftbottom) ) THEN
  ALLOCATE(mask5(SIZE(OutData%grid_leftbottom,1),SIZE(OutData%grid_leftbottom,2),SIZE(OutData%grid_leftbottom,3),SIZE(OutData%grid_leftbottom,4),SIZE(OutData%grid_leftbottom,5)))
  mask5 = .TRUE.
    OutData%grid_leftbottom = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%grid_leftbottom))-1 ),mask5,OutData%grid_leftbottom)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%grid_leftbottom)
  ENDIF
  IF ( ALLOCATED(OutData%grid_lefttop) ) THEN
  ALLOCATE(mask5(SIZE(OutData%grid_lefttop,1),SIZE(OutData%grid_lefttop,2),SIZE(OutData%grid_lefttop,3),SIZE(OutData%grid_lefttop,4),SIZE(OutData%grid_lefttop,5)))
  mask5 = .TRUE.
    OutData%grid_lefttop = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%grid_lefttop))-1 ),mask5,OutData%grid_lefttop)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%grid_lefttop)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_top_main) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_top_main,1),SIZE(OutData%V_ind_top_main,2),SIZE(OutData%V_ind_top_main,3),SIZE(OutData%V_ind_top_main,4),SIZE(OutData%V_ind_top_main,5)))
  mask5 = .TRUE.
    OutData%V_ind_top_main = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_top_main))-1 ),mask5,OutData%V_ind_top_main)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_top_main)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_right_main) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_right_main,1),SIZE(OutData%V_ind_right_main,2),SIZE(OutData%V_ind_right_main,3),SIZE(OutData%V_ind_right_main,4),SIZE(OutData%V_ind_right_main,5)))
  mask5 = .TRUE.
    OutData%V_ind_right_main = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_right_main))-1 ),mask5,OutData%V_ind_right_main)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_right_main)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_bottom_main) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_bottom_main,1),SIZE(OutData%V_ind_bottom_main,2),SIZE(OutData%V_ind_bottom_main,3),SIZE(OutData%V_ind_bottom_main,4),SIZE(OutData%V_ind_bottom_main,5)))
  mask5 = .TRUE.
    OutData%V_ind_bottom_main = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_bottom_main))-1 ),mask5,OutData%V_ind_bottom_main)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_bottom_main)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_left_main) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_left_main,1),SIZE(OutData%V_ind_left_main,2),SIZE(OutData%V_ind_left_main,3),SIZE(OutData%V_ind_left_main,4),SIZE(OutData%V_ind_left_main,5)))
  mask5 = .TRUE.
    OutData%V_ind_left_main = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_left_main))-1 ),mask5,OutData%V_ind_left_main)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_left_main)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_top_kj) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_top_kj,1),SIZE(OutData%V_ind_top_kj,2),SIZE(OutData%V_ind_top_kj,3),SIZE(OutData%V_ind_top_kj,4),SIZE(OutData%V_ind_top_kj,5)))
  mask5 = .TRUE.
    OutData%V_ind_top_kj = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_top_kj))-1 ),mask5,OutData%V_ind_top_kj)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_top_kj)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_right_kj) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_right_kj,1),SIZE(OutData%V_ind_right_kj,2),SIZE(OutData%V_ind_right_kj,3),SIZE(OutData%V_ind_right_kj,4),SIZE(OutData%V_ind_right_kj,5)))
  mask5 = .TRUE.
    OutData%V_ind_right_kj = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_right_kj))-1 ),mask5,OutData%V_ind_right_kj)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_right_kj)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_bottom_kj) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_bottom_kj,1),SIZE(OutData%V_ind_bottom_kj,2),SIZE(OutData%V_ind_bottom_kj,3),SIZE(OutData%V_ind_bottom_kj,4),SIZE(OutData%V_ind_bottom_kj,5)))
  mask5 = .TRUE.
    OutData%V_ind_bottom_kj = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_bottom_kj))-1 ),mask5,OutData%V_ind_bottom_kj)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_bottom_kj)
  ENDIF
  IF ( ALLOCATED(OutData%V_ind_left_kj) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V_ind_left_kj,1),SIZE(OutData%V_ind_left_kj,2),SIZE(OutData%V_ind_left_kj,3),SIZE(OutData%V_ind_left_kj,4),SIZE(OutData%V_ind_left_kj,5)))
  mask5 = .TRUE.
    OutData%V_ind_left_kj = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_ind_left_kj))-1 ),mask5,OutData%V_ind_left_kj)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_ind_left_kj)
  ENDIF
  IF ( ALLOCATED(OutData%V_n) ) THEN
  ALLOCATE(mask2(SIZE(OutData%V_n,1),SIZE(OutData%V_n,2)))
  mask2 = .TRUE.
    OutData%V_n = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V_n))-1 ),mask2,OutData%V_n)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V_n)
  ENDIF
  IF ( ALLOCATED(OutData%Vind_mirtmp_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%Vind_mirtmp_SHED,1),SIZE(OutData%Vind_mirtmp_SHED,2),SIZE(OutData%Vind_mirtmp_SHED,3),SIZE(OutData%Vind_mirtmp_SHED,4),SIZE(OutData%Vind_mirtmp_SHED,5)))
  mask5 = .TRUE.
    OutData%Vind_mirtmp_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Vind_mirtmp_SHED))-1 ),mask5,OutData%Vind_mirtmp_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Vind_mirtmp_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%Vind_mirtmp_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%Vind_mirtmp_TRAIL,1),SIZE(OutData%Vind_mirtmp_TRAIL,2),SIZE(OutData%Vind_mirtmp_TRAIL,3),SIZE(OutData%Vind_mirtmp_TRAIL,4),SIZE(OutData%Vind_mirtmp_TRAIL,5)))
  mask5 = .TRUE.
    OutData%Vind_mirtmp_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Vind_mirtmp_TRAIL))-1 ),mask5,OutData%Vind_mirtmp_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Vind_mirtmp_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%VindB_mirtmp_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VindB_mirtmp_SHED,1),SIZE(OutData%VindB_mirtmp_SHED,2),SIZE(OutData%VindB_mirtmp_SHED,3),SIZE(OutData%VindB_mirtmp_SHED,4),SIZE(OutData%VindB_mirtmp_SHED,5)))
  mask5 = .TRUE.
    OutData%VindB_mirtmp_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VindB_mirtmp_SHED))-1 ),mask5,OutData%VindB_mirtmp_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VindB_mirtmp_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%VindB_mirtmp_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VindB_mirtmp_TRAIL,1),SIZE(OutData%VindB_mirtmp_TRAIL,2),SIZE(OutData%VindB_mirtmp_TRAIL,3),SIZE(OutData%VindB_mirtmp_TRAIL,4),SIZE(OutData%VindB_mirtmp_TRAIL,5)))
  mask5 = .TRUE.
    OutData%VindB_mirtmp_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VindB_mirtmp_TRAIL))-1 ),mask5,OutData%VindB_mirtmp_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VindB_mirtmp_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%MIRROR,1),SIZE(OutData%MIRROR,2),SIZE(OutData%MIRROR,3),SIZE(OutData%MIRROR,4),SIZE(OutData%MIRROR,5)))
  mask5 = .TRUE.
    OutData%MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%MIRROR))-1 ),mask5,OutData%MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%MIRROR)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_MIRROR,1),SIZE(OutData%WAKE_MIRROR,2),SIZE(OutData%WAKE_MIRROR,3),SIZE(OutData%WAKE_MIRROR,4),SIZE(OutData%WAKE_MIRROR,5)))
  mask5 = .TRUE.
    OutData%WAKE_MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_MIRROR))-1 ),mask5,OutData%WAKE_MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_MIRROR)
  ENDIF
  IF ( ALLOCATED(OutData%GAMMA_SHED_MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%GAMMA_SHED_MIRROR,1),SIZE(OutData%GAMMA_SHED_MIRROR,2),SIZE(OutData%GAMMA_SHED_MIRROR,3),SIZE(OutData%GAMMA_SHED_MIRROR,4),SIZE(OutData%GAMMA_SHED_MIRROR,5)))
  mask5 = .TRUE.
    OutData%GAMMA_SHED_MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%GAMMA_SHED_MIRROR))-1 ),mask5,OutData%GAMMA_SHED_MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%GAMMA_SHED_MIRROR)
  ENDIF
  IF ( ALLOCATED(OutData%GAMMA_TRAIL_MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%GAMMA_TRAIL_MIRROR,1),SIZE(OutData%GAMMA_TRAIL_MIRROR,2),SIZE(OutData%GAMMA_TRAIL_MIRROR,3),SIZE(OutData%GAMMA_TRAIL_MIRROR,4),SIZE(OutData%GAMMA_TRAIL_MIRROR,5)))
  mask5 = .TRUE.
    OutData%GAMMA_TRAIL_MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%GAMMA_TRAIL_MIRROR))-1 ),mask5,OutData%GAMMA_TRAIL_MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%GAMMA_TRAIL_MIRROR)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackGround_other

 SUBROUTINE AD_CopyKJ_iter( SrcKJ_iterData, DstKJ_iterData, CtrlCode, ErrStat, ErrMsg )
   TYPE(KJ_iter), INTENT(IN) :: SrcKJ_iterData
   TYPE(KJ_iter), INTENT(INOUT) :: DstKJ_iterData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstKJ_iterData%RELAX = SrcKJ_iterData%RELAX
IF (ALLOCATED(SrcKJ_iterData%DG)) THEN
   i1_l = LBOUND(SrcKJ_iterData%DG,1)
   i1_u = UBOUND(SrcKJ_iterData%DG,1)
   i2_l = LBOUND(SrcKJ_iterData%DG,2)
   i2_u = UBOUND(SrcKJ_iterData%DG,2)
   i3_l = LBOUND(SrcKJ_iterData%DG,3)
   i3_u = UBOUND(SrcKJ_iterData%DG,3)
   i4_l = LBOUND(SrcKJ_iterData%DG,4)
   i4_u = UBOUND(SrcKJ_iterData%DG,4)
   i5_l = LBOUND(SrcKJ_iterData%DG,5)
   i5_u = UBOUND(SrcKJ_iterData%DG,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%DG)) THEN 
      ALLOCATE(DstKJ_iterData%DG(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%DG.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%DG = SrcKJ_iterData%DG
ENDIF
IF (ALLOCATED(SrcKJ_iterData%GAMMA1)) THEN
   i1_l = LBOUND(SrcKJ_iterData%GAMMA1,1)
   i1_u = UBOUND(SrcKJ_iterData%GAMMA1,1)
   i2_l = LBOUND(SrcKJ_iterData%GAMMA1,2)
   i2_u = UBOUND(SrcKJ_iterData%GAMMA1,2)
   i3_l = LBOUND(SrcKJ_iterData%GAMMA1,3)
   i3_u = UBOUND(SrcKJ_iterData%GAMMA1,3)
   i4_l = LBOUND(SrcKJ_iterData%GAMMA1,4)
   i4_u = UBOUND(SrcKJ_iterData%GAMMA1,4)
   i5_l = LBOUND(SrcKJ_iterData%GAMMA1,5)
   i5_u = UBOUND(SrcKJ_iterData%GAMMA1,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%GAMMA1)) THEN 
      ALLOCATE(DstKJ_iterData%GAMMA1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%GAMMA1.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%GAMMA1 = SrcKJ_iterData%GAMMA1
ENDIF
IF (ALLOCATED(SrcKJ_iterData%CL)) THEN
   i1_l = LBOUND(SrcKJ_iterData%CL,1)
   i1_u = UBOUND(SrcKJ_iterData%CL,1)
   i2_l = LBOUND(SrcKJ_iterData%CL,2)
   i2_u = UBOUND(SrcKJ_iterData%CL,2)
   i3_l = LBOUND(SrcKJ_iterData%CL,3)
   i3_u = UBOUND(SrcKJ_iterData%CL,3)
   i4_l = LBOUND(SrcKJ_iterData%CL,4)
   i4_u = UBOUND(SrcKJ_iterData%CL,4)
   i5_l = LBOUND(SrcKJ_iterData%CL,5)
   i5_u = UBOUND(SrcKJ_iterData%CL,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%CL)) THEN 
      ALLOCATE(DstKJ_iterData%CL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%CL.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%CL = SrcKJ_iterData%CL
ENDIF
IF (ALLOCATED(SrcKJ_iterData%CD)) THEN
   i1_l = LBOUND(SrcKJ_iterData%CD,1)
   i1_u = UBOUND(SrcKJ_iterData%CD,1)
   i2_l = LBOUND(SrcKJ_iterData%CD,2)
   i2_u = UBOUND(SrcKJ_iterData%CD,2)
   i3_l = LBOUND(SrcKJ_iterData%CD,3)
   i3_u = UBOUND(SrcKJ_iterData%CD,3)
   i4_l = LBOUND(SrcKJ_iterData%CD,4)
   i4_u = UBOUND(SrcKJ_iterData%CD,4)
   i5_l = LBOUND(SrcKJ_iterData%CD,5)
   i5_u = UBOUND(SrcKJ_iterData%CD,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%CD)) THEN 
      ALLOCATE(DstKJ_iterData%CD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%CD.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%CD = SrcKJ_iterData%CD
ENDIF
IF (ALLOCATED(SrcKJ_iterData%CM)) THEN
   i1_l = LBOUND(SrcKJ_iterData%CM,1)
   i1_u = UBOUND(SrcKJ_iterData%CM,1)
   i2_l = LBOUND(SrcKJ_iterData%CM,2)
   i2_u = UBOUND(SrcKJ_iterData%CM,2)
   i3_l = LBOUND(SrcKJ_iterData%CM,3)
   i3_u = UBOUND(SrcKJ_iterData%CM,3)
   i4_l = LBOUND(SrcKJ_iterData%CM,4)
   i4_u = UBOUND(SrcKJ_iterData%CM,4)
   i5_l = LBOUND(SrcKJ_iterData%CM,5)
   i5_u = UBOUND(SrcKJ_iterData%CM,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%CM)) THEN 
      ALLOCATE(DstKJ_iterData%CM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%CM.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%CM = SrcKJ_iterData%CM
ENDIF
IF (ALLOCATED(SrcKJ_iterData%VEL_ROT)) THEN
   i1_l = LBOUND(SrcKJ_iterData%VEL_ROT,1)
   i1_u = UBOUND(SrcKJ_iterData%VEL_ROT,1)
   i2_l = LBOUND(SrcKJ_iterData%VEL_ROT,2)
   i2_u = UBOUND(SrcKJ_iterData%VEL_ROT,2)
   i3_l = LBOUND(SrcKJ_iterData%VEL_ROT,3)
   i3_u = UBOUND(SrcKJ_iterData%VEL_ROT,3)
   i4_l = LBOUND(SrcKJ_iterData%VEL_ROT,4)
   i4_u = UBOUND(SrcKJ_iterData%VEL_ROT,4)
   i5_l = LBOUND(SrcKJ_iterData%VEL_ROT,5)
   i5_u = UBOUND(SrcKJ_iterData%VEL_ROT,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%VEL_ROT)) THEN 
      ALLOCATE(DstKJ_iterData%VEL_ROT(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%VEL_ROT.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%VEL_ROT = SrcKJ_iterData%VEL_ROT
ENDIF
IF (ALLOCATED(SrcKJ_iterData%VEL_TOT)) THEN
   i1_l = LBOUND(SrcKJ_iterData%VEL_TOT,1)
   i1_u = UBOUND(SrcKJ_iterData%VEL_TOT,1)
   i2_l = LBOUND(SrcKJ_iterData%VEL_TOT,2)
   i2_u = UBOUND(SrcKJ_iterData%VEL_TOT,2)
   i3_l = LBOUND(SrcKJ_iterData%VEL_TOT,3)
   i3_u = UBOUND(SrcKJ_iterData%VEL_TOT,3)
   i4_l = LBOUND(SrcKJ_iterData%VEL_TOT,4)
   i4_u = UBOUND(SrcKJ_iterData%VEL_TOT,4)
   i5_l = LBOUND(SrcKJ_iterData%VEL_TOT,5)
   i5_u = UBOUND(SrcKJ_iterData%VEL_TOT,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%VEL_TOT)) THEN 
      ALLOCATE(DstKJ_iterData%VEL_TOT(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%VEL_TOT.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%VEL_TOT = SrcKJ_iterData%VEL_TOT
ENDIF
IF (ALLOCATED(SrcKJ_iterData%U)) THEN
   i1_l = LBOUND(SrcKJ_iterData%U,1)
   i1_u = UBOUND(SrcKJ_iterData%U,1)
   i2_l = LBOUND(SrcKJ_iterData%U,2)
   i2_u = UBOUND(SrcKJ_iterData%U,2)
   i3_l = LBOUND(SrcKJ_iterData%U,3)
   i3_u = UBOUND(SrcKJ_iterData%U,3)
   i4_l = LBOUND(SrcKJ_iterData%U,4)
   i4_u = UBOUND(SrcKJ_iterData%U,4)
   i5_l = LBOUND(SrcKJ_iterData%U,5)
   i5_u = UBOUND(SrcKJ_iterData%U,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%U)) THEN 
      ALLOCATE(DstKJ_iterData%U(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%U.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%U = SrcKJ_iterData%U
ENDIF
IF (ALLOCATED(SrcKJ_iterData%V)) THEN
   i1_l = LBOUND(SrcKJ_iterData%V,1)
   i1_u = UBOUND(SrcKJ_iterData%V,1)
   i2_l = LBOUND(SrcKJ_iterData%V,2)
   i2_u = UBOUND(SrcKJ_iterData%V,2)
   i3_l = LBOUND(SrcKJ_iterData%V,3)
   i3_u = UBOUND(SrcKJ_iterData%V,3)
   i4_l = LBOUND(SrcKJ_iterData%V,4)
   i4_u = UBOUND(SrcKJ_iterData%V,4)
   i5_l = LBOUND(SrcKJ_iterData%V,5)
   i5_u = UBOUND(SrcKJ_iterData%V,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%V)) THEN 
      ALLOCATE(DstKJ_iterData%V(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%V.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%V = SrcKJ_iterData%V
ENDIF
IF (ALLOCATED(SrcKJ_iterData%W)) THEN
   i1_l = LBOUND(SrcKJ_iterData%W,1)
   i1_u = UBOUND(SrcKJ_iterData%W,1)
   i2_l = LBOUND(SrcKJ_iterData%W,2)
   i2_u = UBOUND(SrcKJ_iterData%W,2)
   i3_l = LBOUND(SrcKJ_iterData%W,3)
   i3_u = UBOUND(SrcKJ_iterData%W,3)
   i4_l = LBOUND(SrcKJ_iterData%W,4)
   i4_u = UBOUND(SrcKJ_iterData%W,4)
   i5_l = LBOUND(SrcKJ_iterData%W,5)
   i5_u = UBOUND(SrcKJ_iterData%W,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%W)) THEN 
      ALLOCATE(DstKJ_iterData%W(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%W.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%W = SrcKJ_iterData%W
ENDIF
IF (ALLOCATED(SrcKJ_iterData%Vinf)) THEN
   i1_l = LBOUND(SrcKJ_iterData%Vinf,1)
   i1_u = UBOUND(SrcKJ_iterData%Vinf,1)
   i2_l = LBOUND(SrcKJ_iterData%Vinf,2)
   i2_u = UBOUND(SrcKJ_iterData%Vinf,2)
   i3_l = LBOUND(SrcKJ_iterData%Vinf,3)
   i3_u = UBOUND(SrcKJ_iterData%Vinf,3)
   i4_l = LBOUND(SrcKJ_iterData%Vinf,4)
   i4_u = UBOUND(SrcKJ_iterData%Vinf,4)
   i5_l = LBOUND(SrcKJ_iterData%Vinf,5)
   i5_u = UBOUND(SrcKJ_iterData%Vinf,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%Vinf)) THEN 
      ALLOCATE(DstKJ_iterData%Vinf(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%Vinf.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%Vinf = SrcKJ_iterData%Vinf
ENDIF
IF (ALLOCATED(SrcKJ_iterData%Vtot)) THEN
   i1_l = LBOUND(SrcKJ_iterData%Vtot,1)
   i1_u = UBOUND(SrcKJ_iterData%Vtot,1)
   i2_l = LBOUND(SrcKJ_iterData%Vtot,2)
   i2_u = UBOUND(SrcKJ_iterData%Vtot,2)
   i3_l = LBOUND(SrcKJ_iterData%Vtot,3)
   i3_u = UBOUND(SrcKJ_iterData%Vtot,3)
   i4_l = LBOUND(SrcKJ_iterData%Vtot,4)
   i4_u = UBOUND(SrcKJ_iterData%Vtot,4)
   i5_l = LBOUND(SrcKJ_iterData%Vtot,5)
   i5_u = UBOUND(SrcKJ_iterData%Vtot,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%Vtot)) THEN 
      ALLOCATE(DstKJ_iterData%Vtot(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%Vtot.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%Vtot = SrcKJ_iterData%Vtot
ENDIF
IF (ALLOCATED(SrcKJ_iterData%AOA)) THEN
   i1_l = LBOUND(SrcKJ_iterData%AOA,1)
   i1_u = UBOUND(SrcKJ_iterData%AOA,1)
   i2_l = LBOUND(SrcKJ_iterData%AOA,2)
   i2_u = UBOUND(SrcKJ_iterData%AOA,2)
   i3_l = LBOUND(SrcKJ_iterData%AOA,3)
   i3_u = UBOUND(SrcKJ_iterData%AOA,3)
   i4_l = LBOUND(SrcKJ_iterData%AOA,4)
   i4_u = UBOUND(SrcKJ_iterData%AOA,4)
   i5_l = LBOUND(SrcKJ_iterData%AOA,5)
   i5_u = UBOUND(SrcKJ_iterData%AOA,5)
   IF (.NOT. ALLOCATED(DstKJ_iterData%AOA)) THEN 
      ALLOCATE(DstKJ_iterData%AOA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstKJ_iterData%AOA.', ErrStat, ErrMsg,'AD_CopyKJ_iter')
         RETURN
      END IF
   END IF
   DstKJ_iterData%AOA = SrcKJ_iterData%AOA
ENDIF
 END SUBROUTINE AD_CopyKJ_iter

 SUBROUTINE AD_DestroyKJ_iter( KJ_iterData, ErrStat, ErrMsg )
  TYPE(KJ_iter), INTENT(INOUT) :: KJ_iterData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(KJ_iterData%DG)) THEN
   DEALLOCATE(KJ_iterData%DG)
ENDIF
IF (ALLOCATED(KJ_iterData%GAMMA1)) THEN
   DEALLOCATE(KJ_iterData%GAMMA1)
ENDIF
IF (ALLOCATED(KJ_iterData%CL)) THEN
   DEALLOCATE(KJ_iterData%CL)
ENDIF
IF (ALLOCATED(KJ_iterData%CD)) THEN
   DEALLOCATE(KJ_iterData%CD)
ENDIF
IF (ALLOCATED(KJ_iterData%CM)) THEN
   DEALLOCATE(KJ_iterData%CM)
ENDIF
IF (ALLOCATED(KJ_iterData%VEL_ROT)) THEN
   DEALLOCATE(KJ_iterData%VEL_ROT)
ENDIF
IF (ALLOCATED(KJ_iterData%VEL_TOT)) THEN
   DEALLOCATE(KJ_iterData%VEL_TOT)
ENDIF
IF (ALLOCATED(KJ_iterData%U)) THEN
   DEALLOCATE(KJ_iterData%U)
ENDIF
IF (ALLOCATED(KJ_iterData%V)) THEN
   DEALLOCATE(KJ_iterData%V)
ENDIF
IF (ALLOCATED(KJ_iterData%W)) THEN
   DEALLOCATE(KJ_iterData%W)
ENDIF
IF (ALLOCATED(KJ_iterData%Vinf)) THEN
   DEALLOCATE(KJ_iterData%Vinf)
ENDIF
IF (ALLOCATED(KJ_iterData%Vtot)) THEN
   DEALLOCATE(KJ_iterData%Vtot)
ENDIF
IF (ALLOCATED(KJ_iterData%AOA)) THEN
   DEALLOCATE(KJ_iterData%AOA)
ENDIF
 END SUBROUTINE AD_DestroyKJ_iter

 SUBROUTINE AD_PackKJ_iter( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(KJ_iter),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! RELAX
  IF ( ALLOCATED(InData%DG) )   Db_BufSz    = Db_BufSz    + SIZE( InData%DG )  ! DG 
  IF ( ALLOCATED(InData%GAMMA1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%GAMMA1 )  ! GAMMA1 
  IF ( ALLOCATED(InData%CL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%CL )  ! CL 
  IF ( ALLOCATED(InData%CD) )   Db_BufSz    = Db_BufSz    + SIZE( InData%CD )  ! CD 
  IF ( ALLOCATED(InData%CM) )   Db_BufSz    = Db_BufSz    + SIZE( InData%CM )  ! CM 
  IF ( ALLOCATED(InData%VEL_ROT) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_ROT )  ! VEL_ROT 
  IF ( ALLOCATED(InData%VEL_TOT) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_TOT )  ! VEL_TOT 
  IF ( ALLOCATED(InData%U) )   Db_BufSz    = Db_BufSz    + SIZE( InData%U )  ! U 
  IF ( ALLOCATED(InData%V) )   Db_BufSz    = Db_BufSz    + SIZE( InData%V )  ! V 
  IF ( ALLOCATED(InData%W) )   Db_BufSz    = Db_BufSz    + SIZE( InData%W )  ! W 
  IF ( ALLOCATED(InData%Vinf) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Vinf )  ! Vinf 
  IF ( ALLOCATED(InData%Vtot) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Vtot )  ! Vtot 
  IF ( ALLOCATED(InData%AOA) )   Db_BufSz    = Db_BufSz    + SIZE( InData%AOA )  ! AOA 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%RELAX )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%DG) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%DG))-1 ) =  PACK(InData%DG ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%DG)
  ENDIF
  IF ( ALLOCATED(InData%GAMMA1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%GAMMA1))-1 ) =  PACK(InData%GAMMA1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%GAMMA1)
  ENDIF
  IF ( ALLOCATED(InData%CL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%CL))-1 ) =  PACK(InData%CL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%CL)
  ENDIF
  IF ( ALLOCATED(InData%CD) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%CD))-1 ) =  PACK(InData%CD ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%CD)
  ENDIF
  IF ( ALLOCATED(InData%CM) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%CM))-1 ) =  PACK(InData%CM ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%CM)
  ENDIF
  IF ( ALLOCATED(InData%VEL_ROT) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_ROT))-1 ) =  PACK(InData%VEL_ROT ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_ROT)
  ENDIF
  IF ( ALLOCATED(InData%VEL_TOT) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_TOT))-1 ) =  PACK(InData%VEL_TOT ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_TOT)
  ENDIF
  IF ( ALLOCATED(InData%U) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%U))-1 ) =  PACK(InData%U ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%U)
  ENDIF
  IF ( ALLOCATED(InData%V) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%V))-1 ) =  PACK(InData%V ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%V)
  ENDIF
  IF ( ALLOCATED(InData%W) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%W))-1 ) =  PACK(InData%W ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%W)
  ENDIF
  IF ( ALLOCATED(InData%Vinf) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Vinf))-1 ) =  PACK(InData%Vinf ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Vinf)
  ENDIF
  IF ( ALLOCATED(InData%Vtot) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Vtot))-1 ) =  PACK(InData%Vtot ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Vtot)
  ENDIF
  IF ( ALLOCATED(InData%AOA) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%AOA))-1 ) =  PACK(InData%AOA ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%AOA)
  ENDIF
 END SUBROUTINE AD_PackKJ_iter

 SUBROUTINE AD_UnPackKJ_iter( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(KJ_iter), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%RELAX = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%DG) ) THEN
  ALLOCATE(mask5(SIZE(OutData%DG,1),SIZE(OutData%DG,2),SIZE(OutData%DG,3),SIZE(OutData%DG,4),SIZE(OutData%DG,5)))
  mask5 = .TRUE.
    OutData%DG = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%DG))-1 ),mask5,OutData%DG)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%DG)
  ENDIF
  IF ( ALLOCATED(OutData%GAMMA1) ) THEN
  ALLOCATE(mask5(SIZE(OutData%GAMMA1,1),SIZE(OutData%GAMMA1,2),SIZE(OutData%GAMMA1,3),SIZE(OutData%GAMMA1,4),SIZE(OutData%GAMMA1,5)))
  mask5 = .TRUE.
    OutData%GAMMA1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%GAMMA1))-1 ),mask5,OutData%GAMMA1)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%GAMMA1)
  ENDIF
  IF ( ALLOCATED(OutData%CL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%CL,1),SIZE(OutData%CL,2),SIZE(OutData%CL,3),SIZE(OutData%CL,4),SIZE(OutData%CL,5)))
  mask5 = .TRUE.
    OutData%CL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%CL))-1 ),mask5,OutData%CL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%CL)
  ENDIF
  IF ( ALLOCATED(OutData%CD) ) THEN
  ALLOCATE(mask5(SIZE(OutData%CD,1),SIZE(OutData%CD,2),SIZE(OutData%CD,3),SIZE(OutData%CD,4),SIZE(OutData%CD,5)))
  mask5 = .TRUE.
    OutData%CD = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%CD))-1 ),mask5,OutData%CD)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%CD)
  ENDIF
  IF ( ALLOCATED(OutData%CM) ) THEN
  ALLOCATE(mask5(SIZE(OutData%CM,1),SIZE(OutData%CM,2),SIZE(OutData%CM,3),SIZE(OutData%CM,4),SIZE(OutData%CM,5)))
  mask5 = .TRUE.
    OutData%CM = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%CM))-1 ),mask5,OutData%CM)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%CM)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_ROT) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_ROT,1),SIZE(OutData%VEL_ROT,2),SIZE(OutData%VEL_ROT,3),SIZE(OutData%VEL_ROT,4),SIZE(OutData%VEL_ROT,5)))
  mask5 = .TRUE.
    OutData%VEL_ROT = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_ROT))-1 ),mask5,OutData%VEL_ROT)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_ROT)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_TOT) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_TOT,1),SIZE(OutData%VEL_TOT,2),SIZE(OutData%VEL_TOT,3),SIZE(OutData%VEL_TOT,4),SIZE(OutData%VEL_TOT,5)))
  mask5 = .TRUE.
    OutData%VEL_TOT = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_TOT))-1 ),mask5,OutData%VEL_TOT)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_TOT)
  ENDIF
  IF ( ALLOCATED(OutData%U) ) THEN
  ALLOCATE(mask5(SIZE(OutData%U,1),SIZE(OutData%U,2),SIZE(OutData%U,3),SIZE(OutData%U,4),SIZE(OutData%U,5)))
  mask5 = .TRUE.
    OutData%U = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%U))-1 ),mask5,OutData%U)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%U)
  ENDIF
  IF ( ALLOCATED(OutData%V) ) THEN
  ALLOCATE(mask5(SIZE(OutData%V,1),SIZE(OutData%V,2),SIZE(OutData%V,3),SIZE(OutData%V,4),SIZE(OutData%V,5)))
  mask5 = .TRUE.
    OutData%V = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%V))-1 ),mask5,OutData%V)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%V)
  ENDIF
  IF ( ALLOCATED(OutData%W) ) THEN
  ALLOCATE(mask5(SIZE(OutData%W,1),SIZE(OutData%W,2),SIZE(OutData%W,3),SIZE(OutData%W,4),SIZE(OutData%W,5)))
  mask5 = .TRUE.
    OutData%W = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%W))-1 ),mask5,OutData%W)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%W)
  ENDIF
  IF ( ALLOCATED(OutData%Vinf) ) THEN
  ALLOCATE(mask5(SIZE(OutData%Vinf,1),SIZE(OutData%Vinf,2),SIZE(OutData%Vinf,3),SIZE(OutData%Vinf,4),SIZE(OutData%Vinf,5)))
  mask5 = .TRUE.
    OutData%Vinf = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Vinf))-1 ),mask5,OutData%Vinf)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Vinf)
  ENDIF
  IF ( ALLOCATED(OutData%Vtot) ) THEN
  ALLOCATE(mask5(SIZE(OutData%Vtot,1),SIZE(OutData%Vtot,2),SIZE(OutData%Vtot,3),SIZE(OutData%Vtot,4),SIZE(OutData%Vtot,5)))
  mask5 = .TRUE.
    OutData%Vtot = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Vtot))-1 ),mask5,OutData%Vtot)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Vtot)
  ENDIF
  IF ( ALLOCATED(OutData%AOA) ) THEN
  ALLOCATE(mask5(SIZE(OutData%AOA,1),SIZE(OutData%AOA,2),SIZE(OutData%AOA,3),SIZE(OutData%AOA,4),SIZE(OutData%AOA,5)))
  mask5 = .TRUE.
    OutData%AOA = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%AOA))-1 ),mask5,OutData%AOA)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%AOA)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackKJ_iter

 SUBROUTINE AD_CopyDS_other( SrcDS_otherData, DstDS_otherData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DS_other), INTENT(IN) :: SrcDS_otherData
   TYPE(DS_other), INTENT(INOUT) :: DstDS_otherData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcDS_otherData%global_previous_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_previous_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%global_previous_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%global_previous_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%global_previous_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_previous_alpha)) THEN 
      ALLOCATE(DstDS_otherData%global_previous_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_previous_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_previous_alpha = SrcDS_otherData%global_previous_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_current_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_current_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%global_current_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%global_current_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%global_current_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_current_alpha)) THEN 
      ALLOCATE(DstDS_otherData%global_current_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_current_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_current_alpha = SrcDS_otherData%global_current_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_previous_sigma1)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_previous_sigma1,1)
   i1_u = UBOUND(SrcDS_otherData%global_previous_sigma1,1)
   i2_l = LBOUND(SrcDS_otherData%global_previous_sigma1,2)
   i2_u = UBOUND(SrcDS_otherData%global_previous_sigma1,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_previous_sigma1)) THEN 
      ALLOCATE(DstDS_otherData%global_previous_sigma1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_previous_sigma1.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_previous_sigma1 = SrcDS_otherData%global_previous_sigma1
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_current_sigma1)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_current_sigma1,1)
   i1_u = UBOUND(SrcDS_otherData%global_current_sigma1,1)
   i2_l = LBOUND(SrcDS_otherData%global_current_sigma1,2)
   i2_u = UBOUND(SrcDS_otherData%global_current_sigma1,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_current_sigma1)) THEN 
      ALLOCATE(DstDS_otherData%global_current_sigma1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_current_sigma1.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_current_sigma1 = SrcDS_otherData%global_current_sigma1
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_previous_sigma3)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_previous_sigma3,1)
   i1_u = UBOUND(SrcDS_otherData%global_previous_sigma3,1)
   i2_l = LBOUND(SrcDS_otherData%global_previous_sigma3,2)
   i2_u = UBOUND(SrcDS_otherData%global_previous_sigma3,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_previous_sigma3)) THEN 
      ALLOCATE(DstDS_otherData%global_previous_sigma3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_previous_sigma3.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_previous_sigma3 = SrcDS_otherData%global_previous_sigma3
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_current_sigma3)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_current_sigma3,1)
   i1_u = UBOUND(SrcDS_otherData%global_current_sigma3,1)
   i2_l = LBOUND(SrcDS_otherData%global_current_sigma3,2)
   i2_u = UBOUND(SrcDS_otherData%global_current_sigma3,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_current_sigma3)) THEN 
      ALLOCATE(DstDS_otherData%global_current_sigma3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_current_sigma3.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_current_sigma3 = SrcDS_otherData%global_current_sigma3
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_q = SrcDS_otherData%attached_previous_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_q = SrcDS_otherData%attached_current_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_X1)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_X1,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_X1,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_X1,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_X1,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_X1)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_X1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_X1.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_X1 = SrcDS_otherData%attached_previous_X1
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_X1)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_X1,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_X1,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_X1,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_X1,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_X1)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_X1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_X1.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_X1 = SrcDS_otherData%attached_current_X1
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_X2)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_X2,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_X2,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_X2,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_X2,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_X2)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_X2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_X2.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_X2 = SrcDS_otherData%attached_previous_X2
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_X2)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_X2,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_X2,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_X2,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_X2,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_X2)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_X2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_X2.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_X2 = SrcDS_otherData%attached_current_X2
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_K_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_K_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_K_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_K_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_K_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_K_alpha)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_K_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_K_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_K_alpha = SrcDS_otherData%attached_previous_K_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_K_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_K_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_K_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_K_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_K_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_K_alpha)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_K_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_K_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_K_alpha = SrcDS_otherData%attached_current_K_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_dK_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_dK_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_dK_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_dK_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_dK_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_dK_alpha)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_dK_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_dK_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_dK_alpha = SrcDS_otherData%attached_previous_dK_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_dK_alpha)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_dK_alpha,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_dK_alpha,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_dK_alpha,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_dK_alpha,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_dK_alpha)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_dK_alpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_dK_alpha.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_dK_alpha = SrcDS_otherData%attached_current_dK_alpha
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_K_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_K_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_K_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_K_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_K_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_K_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_K_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_K_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_K_q = SrcDS_otherData%attached_previous_K_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_K_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_K_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_K_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_K_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_K_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_K_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_K_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_K_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_K_q = SrcDS_otherData%attached_current_K_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_dK_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_dK_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_dK_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_dK_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_dK_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_dK_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_dK_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_dK_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_dK_q = SrcDS_otherData%attached_previous_dK_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_dK_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_dK_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_dK_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_dK_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_dK_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_dK_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_dK_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_dK_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_dK_q = SrcDS_otherData%attached_current_dK_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_ddK_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_ddK_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_ddK_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_ddK_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_ddK_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_ddK_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_ddK_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_ddK_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_ddK_q = SrcDS_otherData%attached_previous_ddK_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_ddK_q)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_ddK_q,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_ddK_q,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_ddK_q,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_ddK_q,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_ddK_q)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_ddK_q(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_ddK_q.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_ddK_q = SrcDS_otherData%attached_current_ddK_q
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_previous_C_p_n)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_previous_C_p_n,1)
   i1_u = UBOUND(SrcDS_otherData%attached_previous_C_p_n,1)
   i2_l = LBOUND(SrcDS_otherData%attached_previous_C_p_n,2)
   i2_u = UBOUND(SrcDS_otherData%attached_previous_C_p_n,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_previous_C_p_n)) THEN 
      ALLOCATE(DstDS_otherData%attached_previous_C_p_n(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_previous_C_p_n.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_previous_C_p_n = SrcDS_otherData%attached_previous_C_p_n
ENDIF
IF (ALLOCATED(SrcDS_otherData%attached_current_C_p_n)) THEN
   i1_l = LBOUND(SrcDS_otherData%attached_current_C_p_n,1)
   i1_u = UBOUND(SrcDS_otherData%attached_current_C_p_n,1)
   i2_l = LBOUND(SrcDS_otherData%attached_current_C_p_n,2)
   i2_u = UBOUND(SrcDS_otherData%attached_current_C_p_n,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%attached_current_C_p_n)) THEN 
      ALLOCATE(DstDS_otherData%attached_current_C_p_n(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%attached_current_C_p_n.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%attached_current_C_p_n = SrcDS_otherData%attached_current_C_p_n
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_previous_D_p)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_previous_D_p,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_previous_D_p,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_previous_D_p,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_previous_D_p,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_previous_D_p)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_previous_D_p(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_previous_D_p.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_previous_D_p = SrcDS_otherData%TEsep_previous_D_p
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_current_D_p)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_current_D_p,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_current_D_p,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_current_D_p,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_current_D_p,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_current_D_p)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_current_D_p(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_current_D_p.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_current_D_p = SrcDS_otherData%TEsep_current_D_p
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_previous_D_f)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_previous_D_f,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_previous_D_f,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_previous_D_f,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_previous_D_f,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_previous_D_f)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_previous_D_f(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_previous_D_f.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_previous_D_f = SrcDS_otherData%TEsep_previous_D_f
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_current_D_f)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_current_D_f,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_current_D_f,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_current_D_f,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_current_D_f,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_current_D_f)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_current_D_f(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_current_D_f.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_current_D_f = SrcDS_otherData%TEsep_current_D_f
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_previous_f_prime)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_previous_f_prime,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_previous_f_prime,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_previous_f_prime,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_previous_f_prime,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_previous_f_prime)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_previous_f_prime(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_previous_f_prime.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_previous_f_prime = SrcDS_otherData%TEsep_previous_f_prime
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_current_f_prime)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_current_f_prime,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_current_f_prime,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_current_f_prime,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_current_f_prime,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_current_f_prime)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_current_f_prime(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_current_f_prime.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_current_f_prime = SrcDS_otherData%TEsep_current_f_prime
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_previous_f_2prime)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_previous_f_2prime,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_previous_f_2prime,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_previous_f_2prime,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_previous_f_2prime,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_previous_f_2prime)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_previous_f_2prime(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_previous_f_2prime.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_previous_f_2prime = SrcDS_otherData%TEsep_previous_f_2prime
ENDIF
IF (ALLOCATED(SrcDS_otherData%TEsep_current_f_2prime)) THEN
   i1_l = LBOUND(SrcDS_otherData%TEsep_current_f_2prime,1)
   i1_u = UBOUND(SrcDS_otherData%TEsep_current_f_2prime,1)
   i2_l = LBOUND(SrcDS_otherData%TEsep_current_f_2prime,2)
   i2_u = UBOUND(SrcDS_otherData%TEsep_current_f_2prime,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%TEsep_current_f_2prime)) THEN 
      ALLOCATE(DstDS_otherData%TEsep_current_f_2prime(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%TEsep_current_f_2prime.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%TEsep_current_f_2prime = SrcDS_otherData%TEsep_current_f_2prime
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_previous_tau_v)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_previous_tau_v,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_previous_tau_v,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_previous_tau_v,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_previous_tau_v,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_previous_tau_v)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_previous_tau_v(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_previous_tau_v.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_previous_tau_v = SrcDS_otherData%LEsep_previous_tau_v
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_current_tau_v)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_current_tau_v,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_current_tau_v,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_current_tau_v,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_current_tau_v,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_current_tau_v)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_current_tau_v(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_current_tau_v.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_current_tau_v = SrcDS_otherData%LEsep_current_tau_v
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_previous_C_v_n)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_previous_C_v_n,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_previous_C_v_n,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_previous_C_v_n,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_previous_C_v_n,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_previous_C_v_n)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_previous_C_v_n(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_previous_C_v_n.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_previous_C_v_n = SrcDS_otherData%LEsep_previous_C_v_n
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_current_C_v_n)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_current_C_v_n,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_current_C_v_n,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_current_C_v_n,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_current_C_v_n,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_current_C_v_n)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_current_C_v_n(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_current_C_v_n.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_current_C_v_n = SrcDS_otherData%LEsep_current_C_v_n
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_previous_C_v)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_previous_C_v,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_previous_C_v,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_previous_C_v,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_previous_C_v,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_previous_C_v)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_previous_C_v(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_previous_C_v.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_previous_C_v = SrcDS_otherData%LEsep_previous_C_v
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_current_C_v)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_current_C_v,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_current_C_v,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_current_C_v,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_current_C_v,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_current_C_v)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_current_C_v(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_current_C_v.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_current_C_v = SrcDS_otherData%LEsep_current_C_v
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_sigma2)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_sigma2,1)
   i1_u = UBOUND(SrcDS_otherData%global_sigma2,1)
   i2_l = LBOUND(SrcDS_otherData%global_sigma2,2)
   i2_u = UBOUND(SrcDS_otherData%global_sigma2,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_sigma2)) THEN 
      ALLOCATE(DstDS_otherData%global_sigma2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_sigma2.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_sigma2 = SrcDS_otherData%global_sigma2
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_vortex_shed_start)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_vortex_shed_start,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_vortex_shed_start,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_vortex_shed_start,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_vortex_shed_start,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_vortex_shed_start)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_vortex_shed_start(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_vortex_shed_start.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_vortex_shed_start = SrcDS_otherData%LEsep_vortex_shed_start
ENDIF
IF (ALLOCATED(SrcDS_otherData%LEsep_seperating)) THEN
   i1_l = LBOUND(SrcDS_otherData%LEsep_seperating,1)
   i1_u = UBOUND(SrcDS_otherData%LEsep_seperating,1)
   i2_l = LBOUND(SrcDS_otherData%LEsep_seperating,2)
   i2_u = UBOUND(SrcDS_otherData%LEsep_seperating,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%LEsep_seperating)) THEN 
      ALLOCATE(DstDS_otherData%LEsep_seperating(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%LEsep_seperating.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%LEsep_seperating = SrcDS_otherData%LEsep_seperating
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_ca_mdl_change)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_ca_mdl_change,1)
   i1_u = UBOUND(SrcDS_otherData%global_ca_mdl_change,1)
   i2_l = LBOUND(SrcDS_otherData%global_ca_mdl_change,2)
   i2_u = UBOUND(SrcDS_otherData%global_ca_mdl_change,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_ca_mdl_change)) THEN 
      ALLOCATE(DstDS_otherData%global_ca_mdl_change(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_ca_mdl_change.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_ca_mdl_change = SrcDS_otherData%global_ca_mdl_change
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_ca_mdl)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_ca_mdl,1)
   i1_u = UBOUND(SrcDS_otherData%global_ca_mdl,1)
   i2_l = LBOUND(SrcDS_otherData%global_ca_mdl,2)
   i2_u = UBOUND(SrcDS_otherData%global_ca_mdl,2)
   i3_l = LBOUND(SrcDS_otherData%global_ca_mdl,3)
   i3_u = UBOUND(SrcDS_otherData%global_ca_mdl,3)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_ca_mdl)) THEN 
      ALLOCATE(DstDS_otherData%global_ca_mdl(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_ca_mdl.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_ca_mdl = SrcDS_otherData%global_ca_mdl
ENDIF
IF (ALLOCATED(SrcDS_otherData%global_ca_mdl_over_write)) THEN
   i1_l = LBOUND(SrcDS_otherData%global_ca_mdl_over_write,1)
   i1_u = UBOUND(SrcDS_otherData%global_ca_mdl_over_write,1)
   i2_l = LBOUND(SrcDS_otherData%global_ca_mdl_over_write,2)
   i2_u = UBOUND(SrcDS_otherData%global_ca_mdl_over_write,2)
   IF (.NOT. ALLOCATED(DstDS_otherData%global_ca_mdl_over_write)) THEN 
      ALLOCATE(DstDS_otherData%global_ca_mdl_over_write(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDS_otherData%global_ca_mdl_over_write.', ErrStat, ErrMsg,'AD_CopyDS_other')
         RETURN
      END IF
   END IF
   DstDS_otherData%global_ca_mdl_over_write = SrcDS_otherData%global_ca_mdl_over_write
ENDIF
 END SUBROUTINE AD_CopyDS_other

 SUBROUTINE AD_DestroyDS_other( DS_otherData, ErrStat, ErrMsg )
  TYPE(DS_other), INTENT(INOUT) :: DS_otherData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(DS_otherData%global_previous_alpha)) THEN
   DEALLOCATE(DS_otherData%global_previous_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%global_current_alpha)) THEN
   DEALLOCATE(DS_otherData%global_current_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%global_previous_sigma1)) THEN
   DEALLOCATE(DS_otherData%global_previous_sigma1)
ENDIF
IF (ALLOCATED(DS_otherData%global_current_sigma1)) THEN
   DEALLOCATE(DS_otherData%global_current_sigma1)
ENDIF
IF (ALLOCATED(DS_otherData%global_previous_sigma3)) THEN
   DEALLOCATE(DS_otherData%global_previous_sigma3)
ENDIF
IF (ALLOCATED(DS_otherData%global_current_sigma3)) THEN
   DEALLOCATE(DS_otherData%global_current_sigma3)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_q)) THEN
   DEALLOCATE(DS_otherData%attached_previous_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_q)) THEN
   DEALLOCATE(DS_otherData%attached_current_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_X1)) THEN
   DEALLOCATE(DS_otherData%attached_previous_X1)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_X1)) THEN
   DEALLOCATE(DS_otherData%attached_current_X1)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_X2)) THEN
   DEALLOCATE(DS_otherData%attached_previous_X2)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_X2)) THEN
   DEALLOCATE(DS_otherData%attached_current_X2)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_K_alpha)) THEN
   DEALLOCATE(DS_otherData%attached_previous_K_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_K_alpha)) THEN
   DEALLOCATE(DS_otherData%attached_current_K_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_dK_alpha)) THEN
   DEALLOCATE(DS_otherData%attached_previous_dK_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_dK_alpha)) THEN
   DEALLOCATE(DS_otherData%attached_current_dK_alpha)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_K_q)) THEN
   DEALLOCATE(DS_otherData%attached_previous_K_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_K_q)) THEN
   DEALLOCATE(DS_otherData%attached_current_K_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_dK_q)) THEN
   DEALLOCATE(DS_otherData%attached_previous_dK_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_dK_q)) THEN
   DEALLOCATE(DS_otherData%attached_current_dK_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_ddK_q)) THEN
   DEALLOCATE(DS_otherData%attached_previous_ddK_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_ddK_q)) THEN
   DEALLOCATE(DS_otherData%attached_current_ddK_q)
ENDIF
IF (ALLOCATED(DS_otherData%attached_previous_C_p_n)) THEN
   DEALLOCATE(DS_otherData%attached_previous_C_p_n)
ENDIF
IF (ALLOCATED(DS_otherData%attached_current_C_p_n)) THEN
   DEALLOCATE(DS_otherData%attached_current_C_p_n)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_previous_D_p)) THEN
   DEALLOCATE(DS_otherData%TEsep_previous_D_p)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_current_D_p)) THEN
   DEALLOCATE(DS_otherData%TEsep_current_D_p)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_previous_D_f)) THEN
   DEALLOCATE(DS_otherData%TEsep_previous_D_f)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_current_D_f)) THEN
   DEALLOCATE(DS_otherData%TEsep_current_D_f)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_previous_f_prime)) THEN
   DEALLOCATE(DS_otherData%TEsep_previous_f_prime)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_current_f_prime)) THEN
   DEALLOCATE(DS_otherData%TEsep_current_f_prime)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_previous_f_2prime)) THEN
   DEALLOCATE(DS_otherData%TEsep_previous_f_2prime)
ENDIF
IF (ALLOCATED(DS_otherData%TEsep_current_f_2prime)) THEN
   DEALLOCATE(DS_otherData%TEsep_current_f_2prime)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_previous_tau_v)) THEN
   DEALLOCATE(DS_otherData%LEsep_previous_tau_v)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_current_tau_v)) THEN
   DEALLOCATE(DS_otherData%LEsep_current_tau_v)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_previous_C_v_n)) THEN
   DEALLOCATE(DS_otherData%LEsep_previous_C_v_n)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_current_C_v_n)) THEN
   DEALLOCATE(DS_otherData%LEsep_current_C_v_n)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_previous_C_v)) THEN
   DEALLOCATE(DS_otherData%LEsep_previous_C_v)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_current_C_v)) THEN
   DEALLOCATE(DS_otherData%LEsep_current_C_v)
ENDIF
IF (ALLOCATED(DS_otherData%global_sigma2)) THEN
   DEALLOCATE(DS_otherData%global_sigma2)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_vortex_shed_start)) THEN
   DEALLOCATE(DS_otherData%LEsep_vortex_shed_start)
ENDIF
IF (ALLOCATED(DS_otherData%LEsep_seperating)) THEN
   DEALLOCATE(DS_otherData%LEsep_seperating)
ENDIF
IF (ALLOCATED(DS_otherData%global_ca_mdl_change)) THEN
   DEALLOCATE(DS_otherData%global_ca_mdl_change)
ENDIF
IF (ALLOCATED(DS_otherData%global_ca_mdl)) THEN
   DEALLOCATE(DS_otherData%global_ca_mdl)
ENDIF
IF (ALLOCATED(DS_otherData%global_ca_mdl_over_write)) THEN
   DEALLOCATE(DS_otherData%global_ca_mdl_over_write)
ENDIF
 END SUBROUTINE AD_DestroyDS_other

 SUBROUTINE AD_PackDS_other( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DS_other),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%global_previous_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_previous_alpha )  ! global_previous_alpha 
  IF ( ALLOCATED(InData%global_current_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_current_alpha )  ! global_current_alpha 
  IF ( ALLOCATED(InData%global_previous_sigma1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_previous_sigma1 )  ! global_previous_sigma1 
  IF ( ALLOCATED(InData%global_current_sigma1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_current_sigma1 )  ! global_current_sigma1 
  IF ( ALLOCATED(InData%global_previous_sigma3) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_previous_sigma3 )  ! global_previous_sigma3 
  IF ( ALLOCATED(InData%global_current_sigma3) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_current_sigma3 )  ! global_current_sigma3 
  IF ( ALLOCATED(InData%attached_previous_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_q )  ! attached_previous_q 
  IF ( ALLOCATED(InData%attached_current_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_q )  ! attached_current_q 
  IF ( ALLOCATED(InData%attached_previous_X1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_X1 )  ! attached_previous_X1 
  IF ( ALLOCATED(InData%attached_current_X1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_X1 )  ! attached_current_X1 
  IF ( ALLOCATED(InData%attached_previous_X2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_X2 )  ! attached_previous_X2 
  IF ( ALLOCATED(InData%attached_current_X2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_X2 )  ! attached_current_X2 
  IF ( ALLOCATED(InData%attached_previous_K_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_K_alpha )  ! attached_previous_K_alpha 
  IF ( ALLOCATED(InData%attached_current_K_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_K_alpha )  ! attached_current_K_alpha 
  IF ( ALLOCATED(InData%attached_previous_dK_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_dK_alpha )  ! attached_previous_dK_alpha 
  IF ( ALLOCATED(InData%attached_current_dK_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_dK_alpha )  ! attached_current_dK_alpha 
  IF ( ALLOCATED(InData%attached_previous_K_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_K_q )  ! attached_previous_K_q 
  IF ( ALLOCATED(InData%attached_current_K_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_K_q )  ! attached_current_K_q 
  IF ( ALLOCATED(InData%attached_previous_dK_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_dK_q )  ! attached_previous_dK_q 
  IF ( ALLOCATED(InData%attached_current_dK_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_dK_q )  ! attached_current_dK_q 
  IF ( ALLOCATED(InData%attached_previous_ddK_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_ddK_q )  ! attached_previous_ddK_q 
  IF ( ALLOCATED(InData%attached_current_ddK_q) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_ddK_q )  ! attached_current_ddK_q 
  IF ( ALLOCATED(InData%attached_previous_C_p_n) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_previous_C_p_n )  ! attached_previous_C_p_n 
  IF ( ALLOCATED(InData%attached_current_C_p_n) )   Db_BufSz    = Db_BufSz    + SIZE( InData%attached_current_C_p_n )  ! attached_current_C_p_n 
  IF ( ALLOCATED(InData%TEsep_previous_D_p) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_previous_D_p )  ! TEsep_previous_D_p 
  IF ( ALLOCATED(InData%TEsep_current_D_p) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_current_D_p )  ! TEsep_current_D_p 
  IF ( ALLOCATED(InData%TEsep_previous_D_f) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_previous_D_f )  ! TEsep_previous_D_f 
  IF ( ALLOCATED(InData%TEsep_current_D_f) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_current_D_f )  ! TEsep_current_D_f 
  IF ( ALLOCATED(InData%TEsep_previous_f_prime) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_previous_f_prime )  ! TEsep_previous_f_prime 
  IF ( ALLOCATED(InData%TEsep_current_f_prime) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_current_f_prime )  ! TEsep_current_f_prime 
  IF ( ALLOCATED(InData%TEsep_previous_f_2prime) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_previous_f_2prime )  ! TEsep_previous_f_2prime 
  IF ( ALLOCATED(InData%TEsep_current_f_2prime) )   Db_BufSz    = Db_BufSz    + SIZE( InData%TEsep_current_f_2prime )  ! TEsep_current_f_2prime 
  IF ( ALLOCATED(InData%LEsep_previous_tau_v) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_previous_tau_v )  ! LEsep_previous_tau_v 
  IF ( ALLOCATED(InData%LEsep_current_tau_v) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_current_tau_v )  ! LEsep_current_tau_v 
  IF ( ALLOCATED(InData%LEsep_previous_C_v_n) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_previous_C_v_n )  ! LEsep_previous_C_v_n 
  IF ( ALLOCATED(InData%LEsep_current_C_v_n) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_current_C_v_n )  ! LEsep_current_C_v_n 
  IF ( ALLOCATED(InData%LEsep_previous_C_v) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_previous_C_v )  ! LEsep_previous_C_v 
  IF ( ALLOCATED(InData%LEsep_current_C_v) )   Db_BufSz    = Db_BufSz    + SIZE( InData%LEsep_current_C_v )  ! LEsep_current_C_v 
  IF ( ALLOCATED(InData%global_sigma2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%global_sigma2 )  ! global_sigma2 
  IF ( ALLOCATED(InData%LEsep_vortex_shed_start) )   Int_BufSz   = Int_BufSz   + SIZE( InData%LEsep_vortex_shed_start )  ! LEsep_vortex_shed_start 
  IF ( ALLOCATED(InData%LEsep_seperating) )   Int_BufSz   = Int_BufSz   + SIZE( InData%LEsep_seperating )  ! LEsep_seperating 
  IF ( ALLOCATED(InData%global_ca_mdl_change) )   Int_BufSz   = Int_BufSz   + SIZE( InData%global_ca_mdl_change )  ! global_ca_mdl_change 
  IF ( ALLOCATED(InData%global_ca_mdl) )   Int_BufSz   = Int_BufSz   + SIZE( InData%global_ca_mdl )  ! global_ca_mdl 
  IF ( ALLOCATED(InData%global_ca_mdl_over_write) )   Int_BufSz   = Int_BufSz   + SIZE( InData%global_ca_mdl_over_write )  ! global_ca_mdl_over_write 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%global_previous_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_previous_alpha))-1 ) =  PACK(InData%global_previous_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_previous_alpha)
  ENDIF
  IF ( ALLOCATED(InData%global_current_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_current_alpha))-1 ) =  PACK(InData%global_current_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_current_alpha)
  ENDIF
  IF ( ALLOCATED(InData%global_previous_sigma1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_previous_sigma1))-1 ) =  PACK(InData%global_previous_sigma1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_previous_sigma1)
  ENDIF
  IF ( ALLOCATED(InData%global_current_sigma1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_current_sigma1))-1 ) =  PACK(InData%global_current_sigma1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_current_sigma1)
  ENDIF
  IF ( ALLOCATED(InData%global_previous_sigma3) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_previous_sigma3))-1 ) =  PACK(InData%global_previous_sigma3 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_previous_sigma3)
  ENDIF
  IF ( ALLOCATED(InData%global_current_sigma3) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_current_sigma3))-1 ) =  PACK(InData%global_current_sigma3 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_current_sigma3)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_q))-1 ) =  PACK(InData%attached_previous_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_q))-1 ) =  PACK(InData%attached_current_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_X1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_X1))-1 ) =  PACK(InData%attached_previous_X1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_X1)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_X1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_X1))-1 ) =  PACK(InData%attached_current_X1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_X1)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_X2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_X2))-1 ) =  PACK(InData%attached_previous_X2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_X2)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_X2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_X2))-1 ) =  PACK(InData%attached_current_X2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_X2)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_K_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_K_alpha))-1 ) =  PACK(InData%attached_previous_K_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_K_alpha)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_K_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_K_alpha))-1 ) =  PACK(InData%attached_current_K_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_K_alpha)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_dK_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_dK_alpha))-1 ) =  PACK(InData%attached_previous_dK_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_dK_alpha)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_dK_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_dK_alpha))-1 ) =  PACK(InData%attached_current_dK_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_dK_alpha)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_K_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_K_q))-1 ) =  PACK(InData%attached_previous_K_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_K_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_K_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_K_q))-1 ) =  PACK(InData%attached_current_K_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_K_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_dK_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_dK_q))-1 ) =  PACK(InData%attached_previous_dK_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_dK_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_dK_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_dK_q))-1 ) =  PACK(InData%attached_current_dK_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_dK_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_ddK_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_ddK_q))-1 ) =  PACK(InData%attached_previous_ddK_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_ddK_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_ddK_q) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_ddK_q))-1 ) =  PACK(InData%attached_current_ddK_q ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_ddK_q)
  ENDIF
  IF ( ALLOCATED(InData%attached_previous_C_p_n) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_previous_C_p_n))-1 ) =  PACK(InData%attached_previous_C_p_n ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_previous_C_p_n)
  ENDIF
  IF ( ALLOCATED(InData%attached_current_C_p_n) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%attached_current_C_p_n))-1 ) =  PACK(InData%attached_current_C_p_n ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%attached_current_C_p_n)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_previous_D_p) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_previous_D_p))-1 ) =  PACK(InData%TEsep_previous_D_p ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_previous_D_p)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_current_D_p) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_current_D_p))-1 ) =  PACK(InData%TEsep_current_D_p ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_current_D_p)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_previous_D_f) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_previous_D_f))-1 ) =  PACK(InData%TEsep_previous_D_f ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_previous_D_f)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_current_D_f) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_current_D_f))-1 ) =  PACK(InData%TEsep_current_D_f ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_current_D_f)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_previous_f_prime) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_previous_f_prime))-1 ) =  PACK(InData%TEsep_previous_f_prime ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_previous_f_prime)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_current_f_prime) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_current_f_prime))-1 ) =  PACK(InData%TEsep_current_f_prime ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_current_f_prime)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_previous_f_2prime) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_previous_f_2prime))-1 ) =  PACK(InData%TEsep_previous_f_2prime ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_previous_f_2prime)
  ENDIF
  IF ( ALLOCATED(InData%TEsep_current_f_2prime) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%TEsep_current_f_2prime))-1 ) =  PACK(InData%TEsep_current_f_2prime ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%TEsep_current_f_2prime)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_previous_tau_v) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_previous_tau_v))-1 ) =  PACK(InData%LEsep_previous_tau_v ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_previous_tau_v)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_current_tau_v) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_current_tau_v))-1 ) =  PACK(InData%LEsep_current_tau_v ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_current_tau_v)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_previous_C_v_n) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_previous_C_v_n))-1 ) =  PACK(InData%LEsep_previous_C_v_n ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_previous_C_v_n)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_current_C_v_n) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_current_C_v_n))-1 ) =  PACK(InData%LEsep_current_C_v_n ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_current_C_v_n)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_previous_C_v) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_previous_C_v))-1 ) =  PACK(InData%LEsep_previous_C_v ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_previous_C_v)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_current_C_v) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%LEsep_current_C_v))-1 ) =  PACK(InData%LEsep_current_C_v ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%LEsep_current_C_v)
  ENDIF
  IF ( ALLOCATED(InData%global_sigma2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%global_sigma2))-1 ) =  PACK(InData%global_sigma2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%global_sigma2)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_vortex_shed_start) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%LEsep_vortex_shed_start))-1 ) = PACK(InData%LEsep_vortex_shed_start ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%LEsep_vortex_shed_start)
  ENDIF
  IF ( ALLOCATED(InData%LEsep_seperating) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%LEsep_seperating))-1 ) = PACK(InData%LEsep_seperating ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%LEsep_seperating)
  ENDIF
  IF ( ALLOCATED(InData%global_ca_mdl_change) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%global_ca_mdl_change))-1 ) = PACK(InData%global_ca_mdl_change ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%global_ca_mdl_change)
  ENDIF
  IF ( ALLOCATED(InData%global_ca_mdl) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%global_ca_mdl))-1 ) = PACK(InData%global_ca_mdl ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%global_ca_mdl)
  ENDIF
  IF ( ALLOCATED(InData%global_ca_mdl_over_write) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%global_ca_mdl_over_write))-1 ) = PACK(InData%global_ca_mdl_over_write ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%global_ca_mdl_over_write)
  ENDIF
 END SUBROUTINE AD_PackDS_other

 SUBROUTINE AD_UnPackDS_other( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DS_other), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%global_previous_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_previous_alpha,1),SIZE(OutData%global_previous_alpha,2)))
  mask2 = .TRUE.
    OutData%global_previous_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_previous_alpha))-1 ),mask2,OutData%global_previous_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_previous_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%global_current_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_current_alpha,1),SIZE(OutData%global_current_alpha,2)))
  mask2 = .TRUE.
    OutData%global_current_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_current_alpha))-1 ),mask2,OutData%global_current_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_current_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%global_previous_sigma1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_previous_sigma1,1),SIZE(OutData%global_previous_sigma1,2)))
  mask2 = .TRUE.
    OutData%global_previous_sigma1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_previous_sigma1))-1 ),mask2,OutData%global_previous_sigma1)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_previous_sigma1)
  ENDIF
  IF ( ALLOCATED(OutData%global_current_sigma1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_current_sigma1,1),SIZE(OutData%global_current_sigma1,2)))
  mask2 = .TRUE.
    OutData%global_current_sigma1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_current_sigma1))-1 ),mask2,OutData%global_current_sigma1)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_current_sigma1)
  ENDIF
  IF ( ALLOCATED(OutData%global_previous_sigma3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_previous_sigma3,1),SIZE(OutData%global_previous_sigma3,2)))
  mask2 = .TRUE.
    OutData%global_previous_sigma3 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_previous_sigma3))-1 ),mask2,OutData%global_previous_sigma3)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_previous_sigma3)
  ENDIF
  IF ( ALLOCATED(OutData%global_current_sigma3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_current_sigma3,1),SIZE(OutData%global_current_sigma3,2)))
  mask2 = .TRUE.
    OutData%global_current_sigma3 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_current_sigma3))-1 ),mask2,OutData%global_current_sigma3)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_current_sigma3)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_q,1),SIZE(OutData%attached_previous_q,2)))
  mask2 = .TRUE.
    OutData%attached_previous_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_q))-1 ),mask2,OutData%attached_previous_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_q,1),SIZE(OutData%attached_current_q,2)))
  mask2 = .TRUE.
    OutData%attached_current_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_q))-1 ),mask2,OutData%attached_current_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_X1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_X1,1),SIZE(OutData%attached_previous_X1,2)))
  mask2 = .TRUE.
    OutData%attached_previous_X1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_X1))-1 ),mask2,OutData%attached_previous_X1)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_X1)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_X1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_X1,1),SIZE(OutData%attached_current_X1,2)))
  mask2 = .TRUE.
    OutData%attached_current_X1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_X1))-1 ),mask2,OutData%attached_current_X1)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_X1)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_X2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_X2,1),SIZE(OutData%attached_previous_X2,2)))
  mask2 = .TRUE.
    OutData%attached_previous_X2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_X2))-1 ),mask2,OutData%attached_previous_X2)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_X2)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_X2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_X2,1),SIZE(OutData%attached_current_X2,2)))
  mask2 = .TRUE.
    OutData%attached_current_X2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_X2))-1 ),mask2,OutData%attached_current_X2)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_X2)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_K_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_K_alpha,1),SIZE(OutData%attached_previous_K_alpha,2)))
  mask2 = .TRUE.
    OutData%attached_previous_K_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_K_alpha))-1 ),mask2,OutData%attached_previous_K_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_K_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_K_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_K_alpha,1),SIZE(OutData%attached_current_K_alpha,2)))
  mask2 = .TRUE.
    OutData%attached_current_K_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_K_alpha))-1 ),mask2,OutData%attached_current_K_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_K_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_dK_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_dK_alpha,1),SIZE(OutData%attached_previous_dK_alpha,2)))
  mask2 = .TRUE.
    OutData%attached_previous_dK_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_dK_alpha))-1 ),mask2,OutData%attached_previous_dK_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_dK_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_dK_alpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_dK_alpha,1),SIZE(OutData%attached_current_dK_alpha,2)))
  mask2 = .TRUE.
    OutData%attached_current_dK_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_dK_alpha))-1 ),mask2,OutData%attached_current_dK_alpha)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_dK_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_K_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_K_q,1),SIZE(OutData%attached_previous_K_q,2)))
  mask2 = .TRUE.
    OutData%attached_previous_K_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_K_q))-1 ),mask2,OutData%attached_previous_K_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_K_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_K_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_K_q,1),SIZE(OutData%attached_current_K_q,2)))
  mask2 = .TRUE.
    OutData%attached_current_K_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_K_q))-1 ),mask2,OutData%attached_current_K_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_K_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_dK_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_dK_q,1),SIZE(OutData%attached_previous_dK_q,2)))
  mask2 = .TRUE.
    OutData%attached_previous_dK_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_dK_q))-1 ),mask2,OutData%attached_previous_dK_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_dK_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_dK_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_dK_q,1),SIZE(OutData%attached_current_dK_q,2)))
  mask2 = .TRUE.
    OutData%attached_current_dK_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_dK_q))-1 ),mask2,OutData%attached_current_dK_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_dK_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_ddK_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_ddK_q,1),SIZE(OutData%attached_previous_ddK_q,2)))
  mask2 = .TRUE.
    OutData%attached_previous_ddK_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_ddK_q))-1 ),mask2,OutData%attached_previous_ddK_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_ddK_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_ddK_q) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_ddK_q,1),SIZE(OutData%attached_current_ddK_q,2)))
  mask2 = .TRUE.
    OutData%attached_current_ddK_q = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_ddK_q))-1 ),mask2,OutData%attached_current_ddK_q)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_ddK_q)
  ENDIF
  IF ( ALLOCATED(OutData%attached_previous_C_p_n) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_previous_C_p_n,1),SIZE(OutData%attached_previous_C_p_n,2)))
  mask2 = .TRUE.
    OutData%attached_previous_C_p_n = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_previous_C_p_n))-1 ),mask2,OutData%attached_previous_C_p_n)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_previous_C_p_n)
  ENDIF
  IF ( ALLOCATED(OutData%attached_current_C_p_n) ) THEN
  ALLOCATE(mask2(SIZE(OutData%attached_current_C_p_n,1),SIZE(OutData%attached_current_C_p_n,2)))
  mask2 = .TRUE.
    OutData%attached_current_C_p_n = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%attached_current_C_p_n))-1 ),mask2,OutData%attached_current_C_p_n)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%attached_current_C_p_n)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_previous_D_p) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_previous_D_p,1),SIZE(OutData%TEsep_previous_D_p,2)))
  mask2 = .TRUE.
    OutData%TEsep_previous_D_p = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_previous_D_p))-1 ),mask2,OutData%TEsep_previous_D_p)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_previous_D_p)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_current_D_p) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_current_D_p,1),SIZE(OutData%TEsep_current_D_p,2)))
  mask2 = .TRUE.
    OutData%TEsep_current_D_p = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_current_D_p))-1 ),mask2,OutData%TEsep_current_D_p)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_current_D_p)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_previous_D_f) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_previous_D_f,1),SIZE(OutData%TEsep_previous_D_f,2)))
  mask2 = .TRUE.
    OutData%TEsep_previous_D_f = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_previous_D_f))-1 ),mask2,OutData%TEsep_previous_D_f)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_previous_D_f)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_current_D_f) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_current_D_f,1),SIZE(OutData%TEsep_current_D_f,2)))
  mask2 = .TRUE.
    OutData%TEsep_current_D_f = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_current_D_f))-1 ),mask2,OutData%TEsep_current_D_f)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_current_D_f)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_previous_f_prime) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_previous_f_prime,1),SIZE(OutData%TEsep_previous_f_prime,2)))
  mask2 = .TRUE.
    OutData%TEsep_previous_f_prime = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_previous_f_prime))-1 ),mask2,OutData%TEsep_previous_f_prime)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_previous_f_prime)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_current_f_prime) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_current_f_prime,1),SIZE(OutData%TEsep_current_f_prime,2)))
  mask2 = .TRUE.
    OutData%TEsep_current_f_prime = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_current_f_prime))-1 ),mask2,OutData%TEsep_current_f_prime)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_current_f_prime)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_previous_f_2prime) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_previous_f_2prime,1),SIZE(OutData%TEsep_previous_f_2prime,2)))
  mask2 = .TRUE.
    OutData%TEsep_previous_f_2prime = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_previous_f_2prime))-1 ),mask2,OutData%TEsep_previous_f_2prime)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_previous_f_2prime)
  ENDIF
  IF ( ALLOCATED(OutData%TEsep_current_f_2prime) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TEsep_current_f_2prime,1),SIZE(OutData%TEsep_current_f_2prime,2)))
  mask2 = .TRUE.
    OutData%TEsep_current_f_2prime = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%TEsep_current_f_2prime))-1 ),mask2,OutData%TEsep_current_f_2prime)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%TEsep_current_f_2prime)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_previous_tau_v) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_previous_tau_v,1),SIZE(OutData%LEsep_previous_tau_v,2)))
  mask2 = .TRUE.
    OutData%LEsep_previous_tau_v = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_previous_tau_v))-1 ),mask2,OutData%LEsep_previous_tau_v)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_previous_tau_v)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_current_tau_v) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_current_tau_v,1),SIZE(OutData%LEsep_current_tau_v,2)))
  mask2 = .TRUE.
    OutData%LEsep_current_tau_v = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_current_tau_v))-1 ),mask2,OutData%LEsep_current_tau_v)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_current_tau_v)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_previous_C_v_n) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_previous_C_v_n,1),SIZE(OutData%LEsep_previous_C_v_n,2)))
  mask2 = .TRUE.
    OutData%LEsep_previous_C_v_n = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_previous_C_v_n))-1 ),mask2,OutData%LEsep_previous_C_v_n)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_previous_C_v_n)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_current_C_v_n) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_current_C_v_n,1),SIZE(OutData%LEsep_current_C_v_n,2)))
  mask2 = .TRUE.
    OutData%LEsep_current_C_v_n = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_current_C_v_n))-1 ),mask2,OutData%LEsep_current_C_v_n)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_current_C_v_n)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_previous_C_v) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_previous_C_v,1),SIZE(OutData%LEsep_previous_C_v,2)))
  mask2 = .TRUE.
    OutData%LEsep_previous_C_v = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_previous_C_v))-1 ),mask2,OutData%LEsep_previous_C_v)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_previous_C_v)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_current_C_v) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_current_C_v,1),SIZE(OutData%LEsep_current_C_v,2)))
  mask2 = .TRUE.
    OutData%LEsep_current_C_v = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%LEsep_current_C_v))-1 ),mask2,OutData%LEsep_current_C_v)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%LEsep_current_C_v)
  ENDIF
  IF ( ALLOCATED(OutData%global_sigma2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_sigma2,1),SIZE(OutData%global_sigma2,2)))
  mask2 = .TRUE.
    OutData%global_sigma2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%global_sigma2))-1 ),mask2,OutData%global_sigma2)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%global_sigma2)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_vortex_shed_start) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_vortex_shed_start,1),SIZE(OutData%LEsep_vortex_shed_start,2)))
  mask2 = .TRUE.
    OutData%LEsep_vortex_shed_start = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%LEsep_vortex_shed_start))-1 ),mask2,OutData%LEsep_vortex_shed_start)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%LEsep_vortex_shed_start)
  ENDIF
  IF ( ALLOCATED(OutData%LEsep_seperating) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LEsep_seperating,1),SIZE(OutData%LEsep_seperating,2)))
  mask2 = .TRUE.
    OutData%LEsep_seperating = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%LEsep_seperating))-1 ),mask2,OutData%LEsep_seperating)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%LEsep_seperating)
  ENDIF
  IF ( ALLOCATED(OutData%global_ca_mdl_change) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_ca_mdl_change,1),SIZE(OutData%global_ca_mdl_change,2)))
  mask2 = .TRUE.
    OutData%global_ca_mdl_change = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%global_ca_mdl_change))-1 ),mask2,OutData%global_ca_mdl_change)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%global_ca_mdl_change)
  ENDIF
  IF ( ALLOCATED(OutData%global_ca_mdl) ) THEN
  ALLOCATE(mask3(SIZE(OutData%global_ca_mdl,1),SIZE(OutData%global_ca_mdl,2),SIZE(OutData%global_ca_mdl,3)))
  mask3 = .TRUE.
    OutData%global_ca_mdl = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%global_ca_mdl))-1 ),mask3,OutData%global_ca_mdl)
  DEALLOCATE(mask3)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%global_ca_mdl)
  ENDIF
  IF ( ALLOCATED(OutData%global_ca_mdl_over_write) ) THEN
  ALLOCATE(mask2(SIZE(OutData%global_ca_mdl_over_write,1),SIZE(OutData%global_ca_mdl_over_write,2)))
  mask2 = .TRUE.
    OutData%global_ca_mdl_over_write = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%global_ca_mdl_over_write))-1 ),mask2,OutData%global_ca_mdl_over_write)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%global_ca_mdl_over_write)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDS_other

 SUBROUTINE AD_Copyairfoils_LB( Srcairfoils_LBData, Dstairfoils_LBData, CtrlCode, ErrStat, ErrMsg )
   TYPE(airfoils_LB), INTENT(IN) :: Srcairfoils_LBData
   TYPE(airfoils_LB), INTENT(INOUT) :: Dstairfoils_LBData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(Srcairfoils_LBData%A1)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%A1,1)
   i1_u = UBOUND(Srcairfoils_LBData%A1,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%A1)) THEN 
      ALLOCATE(Dstairfoils_LBData%A1(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%A1.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%A1 = Srcairfoils_LBData%A1
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%A2)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%A2,1)
   i1_u = UBOUND(Srcairfoils_LBData%A2,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%A2)) THEN 
      ALLOCATE(Dstairfoils_LBData%A2(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%A2.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%A2 = Srcairfoils_LBData%A2
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%b1)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%b1,1)
   i1_u = UBOUND(Srcairfoils_LBData%b1,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%b1)) THEN 
      ALLOCATE(Dstairfoils_LBData%b1(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%b1.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%b1 = Srcairfoils_LBData%b1
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%b2)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%b2,1)
   i1_u = UBOUND(Srcairfoils_LBData%b2,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%b2)) THEN 
      ALLOCATE(Dstairfoils_LBData%b2(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%b2.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%b2 = Srcairfoils_LBData%b2
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Tp)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Tp,1)
   i1_u = UBOUND(Srcairfoils_LBData%Tp,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Tp)) THEN 
      ALLOCATE(Dstairfoils_LBData%Tp(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Tp.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Tp = Srcairfoils_LBData%Tp
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Tf)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Tf,1)
   i1_u = UBOUND(Srcairfoils_LBData%Tf,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Tf)) THEN 
      ALLOCATE(Dstairfoils_LBData%Tf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Tf.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Tf = Srcairfoils_LBData%Tf
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Tv)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Tv,1)
   i1_u = UBOUND(Srcairfoils_LBData%Tv,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Tv)) THEN 
      ALLOCATE(Dstairfoils_LBData%Tv(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Tv.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Tv = Srcairfoils_LBData%Tv
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Tvl)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Tvl,1)
   i1_u = UBOUND(Srcairfoils_LBData%Tvl,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Tvl)) THEN 
      ALLOCATE(Dstairfoils_LBData%Tvl(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Tvl.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Tvl = Srcairfoils_LBData%Tvl
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%cn)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%cn,1)
   i1_u = UBOUND(Srcairfoils_LBData%cn,1)
   i2_l = LBOUND(Srcairfoils_LBData%cn,2)
   i2_u = UBOUND(Srcairfoils_LBData%cn,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%cn)) THEN 
      ALLOCATE(Dstairfoils_LBData%cn(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%cn.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%cn = Srcairfoils_LBData%cn
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%ca)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%ca,1)
   i1_u = UBOUND(Srcairfoils_LBData%ca,1)
   i2_l = LBOUND(Srcairfoils_LBData%ca,2)
   i2_u = UBOUND(Srcairfoils_LBData%ca,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%ca)) THEN 
      ALLOCATE(Dstairfoils_LBData%ca(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%ca.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%ca = Srcairfoils_LBData%ca
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Cn_alpha)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Cn_alpha,1)
   i1_u = UBOUND(Srcairfoils_LBData%Cn_alpha,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Cn_alpha)) THEN 
      ALLOCATE(Dstairfoils_LBData%Cn_alpha(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Cn_alpha.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Cn_alpha = Srcairfoils_LBData%Cn_alpha
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%Alpha_0)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%Alpha_0,1)
   i1_u = UBOUND(Srcairfoils_LBData%Alpha_0,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%Alpha_0)) THEN 
      ALLOCATE(Dstairfoils_LBData%Alpha_0(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%Alpha_0.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%Alpha_0 = Srcairfoils_LBData%Alpha_0
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%C_d_0)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%C_d_0,1)
   i1_u = UBOUND(Srcairfoils_LBData%C_d_0,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%C_d_0)) THEN 
      ALLOCATE(Dstairfoils_LBData%C_d_0(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%C_d_0.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%C_d_0 = Srcairfoils_LBData%C_d_0
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%C_m_0)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%C_m_0,1)
   i1_u = UBOUND(Srcairfoils_LBData%C_m_0,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%C_m_0)) THEN 
      ALLOCATE(Dstairfoils_LBData%C_m_0(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%C_m_0.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%C_m_0 = Srcairfoils_LBData%C_m_0
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%C_n_0)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%C_n_0,1)
   i1_u = UBOUND(Srcairfoils_LBData%C_n_0,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%C_n_0)) THEN 
      ALLOCATE(Dstairfoils_LBData%C_n_0(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%C_n_0.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%C_n_0 = Srcairfoils_LBData%C_n_0
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%alpha_1)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%alpha_1,1)
   i1_u = UBOUND(Srcairfoils_LBData%alpha_1,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%alpha_1)) THEN 
      ALLOCATE(Dstairfoils_LBData%alpha_1(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%alpha_1.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%alpha_1 = Srcairfoils_LBData%alpha_1
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%alpha_2)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%alpha_2,1)
   i1_u = UBOUND(Srcairfoils_LBData%alpha_2,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%alpha_2)) THEN 
      ALLOCATE(Dstairfoils_LBData%alpha_2(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%alpha_2.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%alpha_2 = Srcairfoils_LBData%alpha_2
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%a)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%a,1)
   i1_u = UBOUND(Srcairfoils_LBData%a,1)
   i2_l = LBOUND(Srcairfoils_LBData%a,2)
   i2_u = UBOUND(Srcairfoils_LBData%a,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%a)) THEN 
      ALLOCATE(Dstairfoils_LBData%a(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%a.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%a = Srcairfoils_LBData%a
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%S)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%S,1)
   i1_u = UBOUND(Srcairfoils_LBData%S,1)
   i2_l = LBOUND(Srcairfoils_LBData%S,2)
   i2_u = UBOUND(Srcairfoils_LBData%S,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%S)) THEN 
      ALLOCATE(Dstairfoils_LBData%S(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%S.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%S = Srcairfoils_LBData%S
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%c)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%c,1)
   i1_u = UBOUND(Srcairfoils_LBData%c,1)
   i2_l = LBOUND(Srcairfoils_LBData%c,2)
   i2_u = UBOUND(Srcairfoils_LBData%c,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%c)) THEN 
      ALLOCATE(Dstairfoils_LBData%c(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%c.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%c = Srcairfoils_LBData%c
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%recovery_factor)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%recovery_factor,1)
   i1_u = UBOUND(Srcairfoils_LBData%recovery_factor,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%recovery_factor)) THEN 
      ALLOCATE(Dstairfoils_LBData%recovery_factor(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%recovery_factor.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%recovery_factor = Srcairfoils_LBData%recovery_factor
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%C_n_1)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%C_n_1,1)
   i1_u = UBOUND(Srcairfoils_LBData%C_n_1,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%C_n_1)) THEN 
      ALLOCATE(Dstairfoils_LBData%C_n_1(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%C_n_1.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%C_n_1 = Srcairfoils_LBData%C_n_1
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%C_n_2)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%C_n_2,1)
   i1_u = UBOUND(Srcairfoils_LBData%C_n_2,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%C_n_2)) THEN 
      ALLOCATE(Dstairfoils_LBData%C_n_2(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%C_n_2.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%C_n_2 = Srcairfoils_LBData%C_n_2
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%ca_K1)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%ca_K1,1)
   i1_u = UBOUND(Srcairfoils_LBData%ca_K1,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%ca_K1)) THEN 
      ALLOCATE(Dstairfoils_LBData%ca_K1(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%ca_K1.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%ca_K1 = Srcairfoils_LBData%ca_K1
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%aoa_KHn)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%aoa_KHn,1)
   i1_u = UBOUND(Srcairfoils_LBData%aoa_KHn,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%aoa_KHn)) THEN 
      ALLOCATE(Dstairfoils_LBData%aoa_KHn(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%aoa_KHn.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%aoa_KHn = Srcairfoils_LBData%aoa_KHn
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%aoa_KHp)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%aoa_KHp,1)
   i1_u = UBOUND(Srcairfoils_LBData%aoa_KHp,1)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%aoa_KHp)) THEN 
      ALLOCATE(Dstairfoils_LBData%aoa_KHp(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%aoa_KHp.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%aoa_KHp = Srcairfoils_LBData%aoa_KHp
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_size)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_size,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_size,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_size,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_size,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_size)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_size(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_size.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_size = Srcairfoils_LBData%pp_size
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_f_breaks)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_f_breaks,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_f_breaks,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_f_breaks,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_f_breaks,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_f_breaks)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_f_breaks(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_f_breaks.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_f_breaks = Srcairfoils_LBData%pp_f_breaks
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_f_coefs)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_f_coefs,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_f_coefs,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_f_coefs,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_f_coefs,2)
   i3_l = LBOUND(Srcairfoils_LBData%pp_f_coefs,3)
   i3_u = UBOUND(Srcairfoils_LBData%pp_f_coefs,3)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_f_coefs)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_f_coefs(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_f_coefs.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_f_coefs = Srcairfoils_LBData%pp_f_coefs
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Ca_breaks)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Ca_breaks,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Ca_breaks,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Ca_breaks,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Ca_breaks,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Ca_breaks)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Ca_breaks(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Ca_breaks.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Ca_breaks = Srcairfoils_LBData%pp_K_Ca_breaks
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Ca_coefs)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,2)
   i3_l = LBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,3)
   i3_u = UBOUND(Srcairfoils_LBData%pp_K_Ca_coefs,3)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Ca_coefs)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Ca_coefs(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Ca_coefs.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Ca_coefs = Srcairfoils_LBData%pp_K_Ca_coefs
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Cn_breaks)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Cn_breaks,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Cn_breaks,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Cn_breaks,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Cn_breaks,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Cn_breaks)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Cn_breaks(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Cn_breaks.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Cn_breaks = Srcairfoils_LBData%pp_K_Cn_breaks
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Cn_coefs)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,2)
   i3_l = LBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,3)
   i3_u = UBOUND(Srcairfoils_LBData%pp_K_Cn_coefs,3)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Cn_coefs)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Cn_coefs(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Cn_coefs.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Cn_coefs = Srcairfoils_LBData%pp_K_Cn_coefs
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Cm_breaks)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Cm_breaks,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Cm_breaks,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Cm_breaks,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Cm_breaks,2)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Cm_breaks)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Cm_breaks(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Cm_breaks.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Cm_breaks = Srcairfoils_LBData%pp_K_Cm_breaks
ENDIF
IF (ALLOCATED(Srcairfoils_LBData%pp_K_Cm_coefs)) THEN
   i1_l = LBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,1)
   i1_u = UBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,1)
   i2_l = LBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,2)
   i2_u = UBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,2)
   i3_l = LBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,3)
   i3_u = UBOUND(Srcairfoils_LBData%pp_K_Cm_coefs,3)
   IF (.NOT. ALLOCATED(Dstairfoils_LBData%pp_K_Cm_coefs)) THEN 
      ALLOCATE(Dstairfoils_LBData%pp_K_Cm_coefs(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating Dstairfoils_LBData%pp_K_Cm_coefs.', ErrStat, ErrMsg,'AD_Copyairfoils_LB')
         RETURN
      END IF
   END IF
   Dstairfoils_LBData%pp_K_Cm_coefs = Srcairfoils_LBData%pp_K_Cm_coefs
ENDIF
 END SUBROUTINE AD_Copyairfoils_LB

 SUBROUTINE AD_Destroyairfoils_LB( airfoils_LBData, ErrStat, ErrMsg )
  TYPE(airfoils_LB), INTENT(INOUT) :: airfoils_LBData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(airfoils_LBData%A1)) THEN
   DEALLOCATE(airfoils_LBData%A1)
ENDIF
IF (ALLOCATED(airfoils_LBData%A2)) THEN
   DEALLOCATE(airfoils_LBData%A2)
ENDIF
IF (ALLOCATED(airfoils_LBData%b1)) THEN
   DEALLOCATE(airfoils_LBData%b1)
ENDIF
IF (ALLOCATED(airfoils_LBData%b2)) THEN
   DEALLOCATE(airfoils_LBData%b2)
ENDIF
IF (ALLOCATED(airfoils_LBData%Tp)) THEN
   DEALLOCATE(airfoils_LBData%Tp)
ENDIF
IF (ALLOCATED(airfoils_LBData%Tf)) THEN
   DEALLOCATE(airfoils_LBData%Tf)
ENDIF
IF (ALLOCATED(airfoils_LBData%Tv)) THEN
   DEALLOCATE(airfoils_LBData%Tv)
ENDIF
IF (ALLOCATED(airfoils_LBData%Tvl)) THEN
   DEALLOCATE(airfoils_LBData%Tvl)
ENDIF
IF (ALLOCATED(airfoils_LBData%cn)) THEN
   DEALLOCATE(airfoils_LBData%cn)
ENDIF
IF (ALLOCATED(airfoils_LBData%ca)) THEN
   DEALLOCATE(airfoils_LBData%ca)
ENDIF
IF (ALLOCATED(airfoils_LBData%Cn_alpha)) THEN
   DEALLOCATE(airfoils_LBData%Cn_alpha)
ENDIF
IF (ALLOCATED(airfoils_LBData%Alpha_0)) THEN
   DEALLOCATE(airfoils_LBData%Alpha_0)
ENDIF
IF (ALLOCATED(airfoils_LBData%C_d_0)) THEN
   DEALLOCATE(airfoils_LBData%C_d_0)
ENDIF
IF (ALLOCATED(airfoils_LBData%C_m_0)) THEN
   DEALLOCATE(airfoils_LBData%C_m_0)
ENDIF
IF (ALLOCATED(airfoils_LBData%C_n_0)) THEN
   DEALLOCATE(airfoils_LBData%C_n_0)
ENDIF
IF (ALLOCATED(airfoils_LBData%alpha_1)) THEN
   DEALLOCATE(airfoils_LBData%alpha_1)
ENDIF
IF (ALLOCATED(airfoils_LBData%alpha_2)) THEN
   DEALLOCATE(airfoils_LBData%alpha_2)
ENDIF
IF (ALLOCATED(airfoils_LBData%a)) THEN
   DEALLOCATE(airfoils_LBData%a)
ENDIF
IF (ALLOCATED(airfoils_LBData%S)) THEN
   DEALLOCATE(airfoils_LBData%S)
ENDIF
IF (ALLOCATED(airfoils_LBData%c)) THEN
   DEALLOCATE(airfoils_LBData%c)
ENDIF
IF (ALLOCATED(airfoils_LBData%recovery_factor)) THEN
   DEALLOCATE(airfoils_LBData%recovery_factor)
ENDIF
IF (ALLOCATED(airfoils_LBData%C_n_1)) THEN
   DEALLOCATE(airfoils_LBData%C_n_1)
ENDIF
IF (ALLOCATED(airfoils_LBData%C_n_2)) THEN
   DEALLOCATE(airfoils_LBData%C_n_2)
ENDIF
IF (ALLOCATED(airfoils_LBData%ca_K1)) THEN
   DEALLOCATE(airfoils_LBData%ca_K1)
ENDIF
IF (ALLOCATED(airfoils_LBData%aoa_KHn)) THEN
   DEALLOCATE(airfoils_LBData%aoa_KHn)
ENDIF
IF (ALLOCATED(airfoils_LBData%aoa_KHp)) THEN
   DEALLOCATE(airfoils_LBData%aoa_KHp)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_size)) THEN
   DEALLOCATE(airfoils_LBData%pp_size)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_f_breaks)) THEN
   DEALLOCATE(airfoils_LBData%pp_f_breaks)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_f_coefs)) THEN
   DEALLOCATE(airfoils_LBData%pp_f_coefs)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Ca_breaks)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Ca_breaks)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Ca_coefs)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Ca_coefs)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Cn_breaks)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Cn_breaks)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Cn_coefs)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Cn_coefs)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Cm_breaks)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Cm_breaks)
ENDIF
IF (ALLOCATED(airfoils_LBData%pp_K_Cm_coefs)) THEN
   DEALLOCATE(airfoils_LBData%pp_K_Cm_coefs)
ENDIF
 END SUBROUTINE AD_Destroyairfoils_LB

 SUBROUTINE AD_Packairfoils_LB( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(airfoils_LB),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%A1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%A1 )  ! A1 
  IF ( ALLOCATED(InData%A2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%A2 )  ! A2 
  IF ( ALLOCATED(InData%b1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%b1 )  ! b1 
  IF ( ALLOCATED(InData%b2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%b2 )  ! b2 
  IF ( ALLOCATED(InData%Tp) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Tp )  ! Tp 
  IF ( ALLOCATED(InData%Tf) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Tf )  ! Tf 
  IF ( ALLOCATED(InData%Tv) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Tv )  ! Tv 
  IF ( ALLOCATED(InData%Tvl) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Tvl )  ! Tvl 
  IF ( ALLOCATED(InData%cn) )   Db_BufSz    = Db_BufSz    + SIZE( InData%cn )  ! cn 
  IF ( ALLOCATED(InData%ca) )   Db_BufSz    = Db_BufSz    + SIZE( InData%ca )  ! ca 
  IF ( ALLOCATED(InData%Cn_alpha) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Cn_alpha )  ! Cn_alpha 
  IF ( ALLOCATED(InData%Alpha_0) )   Db_BufSz    = Db_BufSz    + SIZE( InData%Alpha_0 )  ! Alpha_0 
  IF ( ALLOCATED(InData%C_d_0) )   Db_BufSz    = Db_BufSz    + SIZE( InData%C_d_0 )  ! C_d_0 
  IF ( ALLOCATED(InData%C_m_0) )   Db_BufSz    = Db_BufSz    + SIZE( InData%C_m_0 )  ! C_m_0 
  IF ( ALLOCATED(InData%C_n_0) )   Db_BufSz    = Db_BufSz    + SIZE( InData%C_n_0 )  ! C_n_0 
  IF ( ALLOCATED(InData%alpha_1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%alpha_1 )  ! alpha_1 
  IF ( ALLOCATED(InData%alpha_2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%alpha_2 )  ! alpha_2 
  IF ( ALLOCATED(InData%a) )   Db_BufSz    = Db_BufSz    + SIZE( InData%a )  ! a 
  IF ( ALLOCATED(InData%S) )   Db_BufSz    = Db_BufSz    + SIZE( InData%S )  ! S 
  IF ( ALLOCATED(InData%c) )   Db_BufSz    = Db_BufSz    + SIZE( InData%c )  ! c 
  IF ( ALLOCATED(InData%recovery_factor) )   Db_BufSz    = Db_BufSz    + SIZE( InData%recovery_factor )  ! recovery_factor 
  IF ( ALLOCATED(InData%C_n_1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%C_n_1 )  ! C_n_1 
  IF ( ALLOCATED(InData%C_n_2) )   Db_BufSz    = Db_BufSz    + SIZE( InData%C_n_2 )  ! C_n_2 
  IF ( ALLOCATED(InData%ca_K1) )   Db_BufSz    = Db_BufSz    + SIZE( InData%ca_K1 )  ! ca_K1 
  IF ( ALLOCATED(InData%aoa_KHn) )   Db_BufSz    = Db_BufSz    + SIZE( InData%aoa_KHn )  ! aoa_KHn 
  IF ( ALLOCATED(InData%aoa_KHp) )   Db_BufSz    = Db_BufSz    + SIZE( InData%aoa_KHp )  ! aoa_KHp 
  IF ( ALLOCATED(InData%pp_size) )   Int_BufSz   = Int_BufSz   + SIZE( InData%pp_size )  ! pp_size 
  IF ( ALLOCATED(InData%pp_f_breaks) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_f_breaks )  ! pp_f_breaks 
  IF ( ALLOCATED(InData%pp_f_coefs) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_f_coefs )  ! pp_f_coefs 
  IF ( ALLOCATED(InData%pp_K_Ca_breaks) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Ca_breaks )  ! pp_K_Ca_breaks 
  IF ( ALLOCATED(InData%pp_K_Ca_coefs) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Ca_coefs )  ! pp_K_Ca_coefs 
  IF ( ALLOCATED(InData%pp_K_Cn_breaks) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Cn_breaks )  ! pp_K_Cn_breaks 
  IF ( ALLOCATED(InData%pp_K_Cn_coefs) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Cn_coefs )  ! pp_K_Cn_coefs 
  IF ( ALLOCATED(InData%pp_K_Cm_breaks) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Cm_breaks )  ! pp_K_Cm_breaks 
  IF ( ALLOCATED(InData%pp_K_Cm_coefs) )   Db_BufSz    = Db_BufSz    + SIZE( InData%pp_K_Cm_coefs )  ! pp_K_Cm_coefs 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%A1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%A1))-1 ) =  PACK(InData%A1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%A1)
  ENDIF
  IF ( ALLOCATED(InData%A2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%A2))-1 ) =  PACK(InData%A2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%A2)
  ENDIF
  IF ( ALLOCATED(InData%b1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%b1))-1 ) =  PACK(InData%b1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%b1)
  ENDIF
  IF ( ALLOCATED(InData%b2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%b2))-1 ) =  PACK(InData%b2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%b2)
  ENDIF
  IF ( ALLOCATED(InData%Tp) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Tp))-1 ) =  PACK(InData%Tp ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Tp)
  ENDIF
  IF ( ALLOCATED(InData%Tf) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Tf))-1 ) =  PACK(InData%Tf ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Tf)
  ENDIF
  IF ( ALLOCATED(InData%Tv) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Tv))-1 ) =  PACK(InData%Tv ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Tv)
  ENDIF
  IF ( ALLOCATED(InData%Tvl) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Tvl))-1 ) =  PACK(InData%Tvl ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Tvl)
  ENDIF
  IF ( ALLOCATED(InData%cn) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%cn))-1 ) =  PACK(InData%cn ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%cn)
  ENDIF
  IF ( ALLOCATED(InData%ca) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%ca))-1 ) =  PACK(InData%ca ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%ca)
  ENDIF
  IF ( ALLOCATED(InData%Cn_alpha) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Cn_alpha))-1 ) =  PACK(InData%Cn_alpha ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Cn_alpha)
  ENDIF
  IF ( ALLOCATED(InData%Alpha_0) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Alpha_0))-1 ) =  PACK(InData%Alpha_0 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%Alpha_0)
  ENDIF
  IF ( ALLOCATED(InData%C_d_0) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%C_d_0))-1 ) =  PACK(InData%C_d_0 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%C_d_0)
  ENDIF
  IF ( ALLOCATED(InData%C_m_0) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%C_m_0))-1 ) =  PACK(InData%C_m_0 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%C_m_0)
  ENDIF
  IF ( ALLOCATED(InData%C_n_0) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%C_n_0))-1 ) =  PACK(InData%C_n_0 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%C_n_0)
  ENDIF
  IF ( ALLOCATED(InData%alpha_1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%alpha_1))-1 ) =  PACK(InData%alpha_1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%alpha_1)
  ENDIF
  IF ( ALLOCATED(InData%alpha_2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%alpha_2))-1 ) =  PACK(InData%alpha_2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%alpha_2)
  ENDIF
  IF ( ALLOCATED(InData%a) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%a))-1 ) =  PACK(InData%a ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%a)
  ENDIF
  IF ( ALLOCATED(InData%S) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%S))-1 ) =  PACK(InData%S ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%S)
  ENDIF
  IF ( ALLOCATED(InData%c) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%c))-1 ) =  PACK(InData%c ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%c)
  ENDIF
  IF ( ALLOCATED(InData%recovery_factor) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%recovery_factor))-1 ) =  PACK(InData%recovery_factor ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%recovery_factor)
  ENDIF
  IF ( ALLOCATED(InData%C_n_1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%C_n_1))-1 ) =  PACK(InData%C_n_1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%C_n_1)
  ENDIF
  IF ( ALLOCATED(InData%C_n_2) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%C_n_2))-1 ) =  PACK(InData%C_n_2 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%C_n_2)
  ENDIF
  IF ( ALLOCATED(InData%ca_K1) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%ca_K1))-1 ) =  PACK(InData%ca_K1 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%ca_K1)
  ENDIF
  IF ( ALLOCATED(InData%aoa_KHn) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%aoa_KHn))-1 ) =  PACK(InData%aoa_KHn ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%aoa_KHn)
  ENDIF
  IF ( ALLOCATED(InData%aoa_KHp) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%aoa_KHp))-1 ) =  PACK(InData%aoa_KHp ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%aoa_KHp)
  ENDIF
  IF ( ALLOCATED(InData%pp_size) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%pp_size))-1 ) = PACK(InData%pp_size ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%pp_size)
  ENDIF
  IF ( ALLOCATED(InData%pp_f_breaks) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_f_breaks))-1 ) =  PACK(InData%pp_f_breaks ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_f_breaks)
  ENDIF
  IF ( ALLOCATED(InData%pp_f_coefs) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_f_coefs))-1 ) =  PACK(InData%pp_f_coefs ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_f_coefs)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Ca_breaks) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Ca_breaks))-1 ) =  PACK(InData%pp_K_Ca_breaks ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Ca_breaks)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Ca_coefs) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Ca_coefs))-1 ) =  PACK(InData%pp_K_Ca_coefs ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Ca_coefs)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Cn_breaks) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Cn_breaks))-1 ) =  PACK(InData%pp_K_Cn_breaks ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Cn_breaks)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Cn_coefs) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Cn_coefs))-1 ) =  PACK(InData%pp_K_Cn_coefs ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Cn_coefs)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Cm_breaks) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Cm_breaks))-1 ) =  PACK(InData%pp_K_Cm_breaks ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Cm_breaks)
  ENDIF
  IF ( ALLOCATED(InData%pp_K_Cm_coefs) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%pp_K_Cm_coefs))-1 ) =  PACK(InData%pp_K_Cm_coefs ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%pp_K_Cm_coefs)
  ENDIF
 END SUBROUTINE AD_Packairfoils_LB

 SUBROUTINE AD_UnPackairfoils_LB( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(airfoils_LB), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%A1) ) THEN
  ALLOCATE(mask1(SIZE(OutData%A1,1)))
  mask1 = .TRUE.
    OutData%A1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%A1))-1 ),mask1,OutData%A1)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%A1)
  ENDIF
  IF ( ALLOCATED(OutData%A2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%A2,1)))
  mask1 = .TRUE.
    OutData%A2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%A2))-1 ),mask1,OutData%A2)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%A2)
  ENDIF
  IF ( ALLOCATED(OutData%b1) ) THEN
  ALLOCATE(mask1(SIZE(OutData%b1,1)))
  mask1 = .TRUE.
    OutData%b1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%b1))-1 ),mask1,OutData%b1)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%b1)
  ENDIF
  IF ( ALLOCATED(OutData%b2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%b2,1)))
  mask1 = .TRUE.
    OutData%b2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%b2))-1 ),mask1,OutData%b2)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%b2)
  ENDIF
  IF ( ALLOCATED(OutData%Tp) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Tp,1)))
  mask1 = .TRUE.
    OutData%Tp = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Tp))-1 ),mask1,OutData%Tp)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Tp)
  ENDIF
  IF ( ALLOCATED(OutData%Tf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Tf,1)))
  mask1 = .TRUE.
    OutData%Tf = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Tf))-1 ),mask1,OutData%Tf)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Tf)
  ENDIF
  IF ( ALLOCATED(OutData%Tv) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Tv,1)))
  mask1 = .TRUE.
    OutData%Tv = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Tv))-1 ),mask1,OutData%Tv)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Tv)
  ENDIF
  IF ( ALLOCATED(OutData%Tvl) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Tvl,1)))
  mask1 = .TRUE.
    OutData%Tvl = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Tvl))-1 ),mask1,OutData%Tvl)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Tvl)
  ENDIF
  IF ( ALLOCATED(OutData%cn) ) THEN
  ALLOCATE(mask2(SIZE(OutData%cn,1),SIZE(OutData%cn,2)))
  mask2 = .TRUE.
    OutData%cn = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%cn))-1 ),mask2,OutData%cn)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%cn)
  ENDIF
  IF ( ALLOCATED(OutData%ca) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ca,1),SIZE(OutData%ca,2)))
  mask2 = .TRUE.
    OutData%ca = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%ca))-1 ),mask2,OutData%ca)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%ca)
  ENDIF
  IF ( ALLOCATED(OutData%Cn_alpha) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Cn_alpha,1)))
  mask1 = .TRUE.
    OutData%Cn_alpha = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Cn_alpha))-1 ),mask1,OutData%Cn_alpha)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Cn_alpha)
  ENDIF
  IF ( ALLOCATED(OutData%Alpha_0) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Alpha_0,1)))
  mask1 = .TRUE.
    OutData%Alpha_0 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Alpha_0))-1 ),mask1,OutData%Alpha_0)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%Alpha_0)
  ENDIF
  IF ( ALLOCATED(OutData%C_d_0) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C_d_0,1)))
  mask1 = .TRUE.
    OutData%C_d_0 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%C_d_0))-1 ),mask1,OutData%C_d_0)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%C_d_0)
  ENDIF
  IF ( ALLOCATED(OutData%C_m_0) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C_m_0,1)))
  mask1 = .TRUE.
    OutData%C_m_0 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%C_m_0))-1 ),mask1,OutData%C_m_0)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%C_m_0)
  ENDIF
  IF ( ALLOCATED(OutData%C_n_0) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C_n_0,1)))
  mask1 = .TRUE.
    OutData%C_n_0 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%C_n_0))-1 ),mask1,OutData%C_n_0)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%C_n_0)
  ENDIF
  IF ( ALLOCATED(OutData%alpha_1) ) THEN
  ALLOCATE(mask1(SIZE(OutData%alpha_1,1)))
  mask1 = .TRUE.
    OutData%alpha_1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%alpha_1))-1 ),mask1,OutData%alpha_1)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%alpha_1)
  ENDIF
  IF ( ALLOCATED(OutData%alpha_2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%alpha_2,1)))
  mask1 = .TRUE.
    OutData%alpha_2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%alpha_2))-1 ),mask1,OutData%alpha_2)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%alpha_2)
  ENDIF
  IF ( ALLOCATED(OutData%a) ) THEN
  ALLOCATE(mask2(SIZE(OutData%a,1),SIZE(OutData%a,2)))
  mask2 = .TRUE.
    OutData%a = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%a))-1 ),mask2,OutData%a)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%a)
  ENDIF
  IF ( ALLOCATED(OutData%S) ) THEN
  ALLOCATE(mask2(SIZE(OutData%S,1),SIZE(OutData%S,2)))
  mask2 = .TRUE.
    OutData%S = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%S))-1 ),mask2,OutData%S)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%S)
  ENDIF
  IF ( ALLOCATED(OutData%c) ) THEN
  ALLOCATE(mask2(SIZE(OutData%c,1),SIZE(OutData%c,2)))
  mask2 = .TRUE.
    OutData%c = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%c))-1 ),mask2,OutData%c)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%c)
  ENDIF
  IF ( ALLOCATED(OutData%recovery_factor) ) THEN
  ALLOCATE(mask1(SIZE(OutData%recovery_factor,1)))
  mask1 = .TRUE.
    OutData%recovery_factor = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%recovery_factor))-1 ),mask1,OutData%recovery_factor)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%recovery_factor)
  ENDIF
  IF ( ALLOCATED(OutData%C_n_1) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C_n_1,1)))
  mask1 = .TRUE.
    OutData%C_n_1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%C_n_1))-1 ),mask1,OutData%C_n_1)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%C_n_1)
  ENDIF
  IF ( ALLOCATED(OutData%C_n_2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C_n_2,1)))
  mask1 = .TRUE.
    OutData%C_n_2 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%C_n_2))-1 ),mask1,OutData%C_n_2)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%C_n_2)
  ENDIF
  IF ( ALLOCATED(OutData%ca_K1) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ca_K1,1)))
  mask1 = .TRUE.
    OutData%ca_K1 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%ca_K1))-1 ),mask1,OutData%ca_K1)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%ca_K1)
  ENDIF
  IF ( ALLOCATED(OutData%aoa_KHn) ) THEN
  ALLOCATE(mask1(SIZE(OutData%aoa_KHn,1)))
  mask1 = .TRUE.
    OutData%aoa_KHn = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%aoa_KHn))-1 ),mask1,OutData%aoa_KHn)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%aoa_KHn)
  ENDIF
  IF ( ALLOCATED(OutData%aoa_KHp) ) THEN
  ALLOCATE(mask1(SIZE(OutData%aoa_KHp,1)))
  mask1 = .TRUE.
    OutData%aoa_KHp = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%aoa_KHp))-1 ),mask1,OutData%aoa_KHp)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%aoa_KHp)
  ENDIF
  IF ( ALLOCATED(OutData%pp_size) ) THEN
  ALLOCATE(mask2(SIZE(OutData%pp_size,1),SIZE(OutData%pp_size,2)))
  mask2 = .TRUE.
    OutData%pp_size = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%pp_size))-1 ),mask2,OutData%pp_size)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%pp_size)
  ENDIF
  IF ( ALLOCATED(OutData%pp_f_breaks) ) THEN
  ALLOCATE(mask2(SIZE(OutData%pp_f_breaks,1),SIZE(OutData%pp_f_breaks,2)))
  mask2 = .TRUE.
    OutData%pp_f_breaks = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_f_breaks))-1 ),mask2,OutData%pp_f_breaks)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_f_breaks)
  ENDIF
  IF ( ALLOCATED(OutData%pp_f_coefs) ) THEN
  ALLOCATE(mask3(SIZE(OutData%pp_f_coefs,1),SIZE(OutData%pp_f_coefs,2),SIZE(OutData%pp_f_coefs,3)))
  mask3 = .TRUE.
    OutData%pp_f_coefs = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_f_coefs))-1 ),mask3,OutData%pp_f_coefs)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_f_coefs)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Ca_breaks) ) THEN
  ALLOCATE(mask2(SIZE(OutData%pp_K_Ca_breaks,1),SIZE(OutData%pp_K_Ca_breaks,2)))
  mask2 = .TRUE.
    OutData%pp_K_Ca_breaks = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Ca_breaks))-1 ),mask2,OutData%pp_K_Ca_breaks)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Ca_breaks)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Ca_coefs) ) THEN
  ALLOCATE(mask3(SIZE(OutData%pp_K_Ca_coefs,1),SIZE(OutData%pp_K_Ca_coefs,2),SIZE(OutData%pp_K_Ca_coefs,3)))
  mask3 = .TRUE.
    OutData%pp_K_Ca_coefs = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Ca_coefs))-1 ),mask3,OutData%pp_K_Ca_coefs)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Ca_coefs)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Cn_breaks) ) THEN
  ALLOCATE(mask2(SIZE(OutData%pp_K_Cn_breaks,1),SIZE(OutData%pp_K_Cn_breaks,2)))
  mask2 = .TRUE.
    OutData%pp_K_Cn_breaks = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Cn_breaks))-1 ),mask2,OutData%pp_K_Cn_breaks)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Cn_breaks)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Cn_coefs) ) THEN
  ALLOCATE(mask3(SIZE(OutData%pp_K_Cn_coefs,1),SIZE(OutData%pp_K_Cn_coefs,2),SIZE(OutData%pp_K_Cn_coefs,3)))
  mask3 = .TRUE.
    OutData%pp_K_Cn_coefs = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Cn_coefs))-1 ),mask3,OutData%pp_K_Cn_coefs)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Cn_coefs)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Cm_breaks) ) THEN
  ALLOCATE(mask2(SIZE(OutData%pp_K_Cm_breaks,1),SIZE(OutData%pp_K_Cm_breaks,2)))
  mask2 = .TRUE.
    OutData%pp_K_Cm_breaks = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Cm_breaks))-1 ),mask2,OutData%pp_K_Cm_breaks)
  DEALLOCATE(mask2)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Cm_breaks)
  ENDIF
  IF ( ALLOCATED(OutData%pp_K_Cm_coefs) ) THEN
  ALLOCATE(mask3(SIZE(OutData%pp_K_Cm_coefs,1),SIZE(OutData%pp_K_Cm_coefs,2),SIZE(OutData%pp_K_Cm_coefs,3)))
  mask3 = .TRUE.
    OutData%pp_K_Cm_coefs = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%pp_K_Cm_coefs))-1 ),mask3,OutData%pp_K_Cm_coefs)
  DEALLOCATE(mask3)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%pp_K_Cm_coefs)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackairfoils_LB

 SUBROUTINE AD_CopyTime_other( SrcTime_otherData, DstTime_otherData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Time_other), INTENT(IN) :: SrcTime_otherData
   TYPE(Time_other), INTENT(INOUT) :: DstTime_otherData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstTime_otherData%Time_Total = SrcTime_otherData%Time_Total
   DstTime_otherData%Time_biotsavart = SrcTime_otherData%Time_biotsavart
   DstTime_otherData%Time_biotsavart_Acce = SrcTime_otherData%Time_biotsavart_Acce
 END SUBROUTINE AD_CopyTime_other

 SUBROUTINE AD_DestroyTime_other( Time_otherData, ErrStat, ErrMsg )
  TYPE(Time_other), INTENT(INOUT) :: Time_otherData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyTime_other

 SUBROUTINE AD_PackTime_other( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Time_other),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! Time_Total
  Db_BufSz   = Db_BufSz   + 1  ! Time_biotsavart
  Db_BufSz   = Db_BufSz   + 1  ! Time_biotsavart_Acce
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Time_Total )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Time_biotsavart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Time_biotsavart_Acce )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackTime_other

 SUBROUTINE AD_UnPackTime_other( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Time_other), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Time_Total = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%Time_biotsavart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%Time_biotsavart_Acce = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackTime_other

 SUBROUTINE AD_CopyFVM_OtherStateTYPE( SrcFVM_OtherStateTYPEData, DstFVM_OtherStateTYPEData, CtrlCode, ErrStat, ErrMsg )
   TYPE(FVM_OtherStateTYPE), INTENT(IN) :: SrcFVM_OtherStateTYPEData
   TYPE(FVM_OtherStateTYPE), INTENT(INOUT) :: DstFVM_OtherStateTYPEData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstFVM_OtherStateTYPEData%FullDIR = SrcFVM_OtherStateTYPEData%FullDIR
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_AEROCENT)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_AEROCENT,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_AEROCENT)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_AEROCENT(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_AEROCENT.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_AEROCENT = SrcFVM_OtherStateTYPEData%POS_AEROCENT
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_LEAD)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_LEAD,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_LEAD)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_LEAD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_LEAD.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_LEAD = SrcFVM_OtherStateTYPEData%POS_LEAD
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_BOUND)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_BOUND,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_BOUND)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_BOUND(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_BOUND.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_BOUND = SrcFVM_OtherStateTYPEData%POS_BOUND
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_COLLOC)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_COLLOC,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_COLLOC)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_COLLOC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_COLLOC.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_COLLOC = SrcFVM_OtherStateTYPEData%POS_COLLOC
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_QUARTER)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_QUARTER,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_QUARTER)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_QUARTER(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_QUARTER.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_QUARTER = SrcFVM_OtherStateTYPEData%POS_QUARTER
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_TRAIL = SrcFVM_OtherStateTYPEData%POS_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_END)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_END,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_END,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_END,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_END,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_END,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_END,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_END,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_END,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_END,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_END,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_END)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_END(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_END.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_END = SrcFVM_OtherStateTYPEData%POS_END
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_NODES_BXN)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BXN,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_NODES_BXN)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_NODES_BXN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_NODES_BXN.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_NODES_BXN = SrcFVM_OtherStateTYPEData%POS_NODES_BXN
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_NODES_BYN)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BYN,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_NODES_BYN)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_NODES_BYN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_NODES_BYN.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_NODES_BYN = SrcFVM_OtherStateTYPEData%POS_NODES_BYN
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%POS_NODES_BZN)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%POS_NODES_BZN,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%POS_NODES_BZN)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%POS_NODES_BZN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%POS_NODES_BZN.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%POS_NODES_BZN = SrcFVM_OtherStateTYPEData%POS_NODES_BZN
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_CL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_CL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_CL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_CL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_CL = SrcFVM_OtherStateTYPEData%PERF_CL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_CD)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CD,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_CD)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_CD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_CD.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_CD = SrcFVM_OtherStateTYPEData%PERF_CD
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_AOA)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AOA,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_AOA)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_AOA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_AOA.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_AOA = SrcFVM_OtherStateTYPEData%PERF_AOA
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_PHI)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_PHI,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_PHI)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_PHI(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_PHI.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_PHI = SrcFVM_OtherStateTYPEData%PERF_PHI
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_A)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_A,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_A,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_A,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_A,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_A,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_A,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_A,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_A,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_A,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_A,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_A)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_A(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_A.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_A = SrcFVM_OtherStateTYPEData%PERF_A
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_AAP)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AAP,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_AAP)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_AAP(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_AAP.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_AAP = SrcFVM_OtherStateTYPEData%PERF_AAP
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_AP)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_AP,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_AP)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_AP(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_AP.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_AP = SrcFVM_OtherStateTYPEData%PERF_AP
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_TSR)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_TSR,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_TSR)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_TSR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_TSR.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_TSR = SrcFVM_OtherStateTYPEData%PERF_TSR
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_DCZ)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCZ,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_DCZ)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_DCZ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_DCZ.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_DCZ = SrcFVM_OtherStateTYPEData%PERF_DCZ
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_DCX)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_DCX,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_DCX)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_DCX(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_DCX.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_DCX = SrcFVM_OtherStateTYPEData%PERF_DCX
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PERF_CM)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PERF_CM,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PERF_CM)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PERF_CM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PERF_CM.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PERF_CM = SrcFVM_OtherStateTYPEData%PERF_CM
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_AEROCENT)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_AEROCENT,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_AEROCENT)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_AEROCENT(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_AEROCENT.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_AEROCENT = SrcFVM_OtherStateTYPEData%VEL_AEROCENT
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_BOUND)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BOUND,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_BOUND)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_BOUND(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_BOUND.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_BOUND = SrcFVM_OtherStateTYPEData%VEL_BOUND
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_BLADE)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_BLADE,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_BLADE)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_BLADE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_BLADE.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_BLADE = SrcFVM_OtherStateTYPEData%VEL_BLADE
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_DOMAIN)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_DOMAIN)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_DOMAIN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_DOMAIN.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_DOMAIN = SrcFVM_OtherStateTYPEData%VEL_DOMAIN
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_DOMAIN_RK)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_DOMAIN_RK(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_DOMAIN_RK.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_DOMAIN_RK = SrcFVM_OtherStateTYPEData%VEL_DOMAIN_RK
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND = SrcFVM_OtherStateTYPEData%VEL_UIND
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB = SrcFVM_OtherStateTYPEData%VEL_UINDB
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_RK)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_RK,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_RK)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_RK(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_RK.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_RK = SrcFVM_OtherStateTYPEData%VEL_UIND_RK
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_GROUND)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_GROUND(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_GROUND.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_GROUND = SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_GROUND)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_GROUND(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_GROUND.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_GROUND = SrcFVM_OtherStateTYPEData%VEL_UINDB_GROUND
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_MIRROR)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_MIRROR.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_MIRROR = SrcFVM_OtherStateTYPEData%VEL_UIND_MIRROR
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_MIRROR)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_MIRROR(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_MIRROR.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_MIRROR = SrcFVM_OtherStateTYPEData%VEL_UINDB_MIRROR
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_SHED = SrcFVM_OtherStateTYPEData%VEL_UIND_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL = SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL = SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_SHED = SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre = SrcFVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre = SrcFVM_OtherStateTYPEData%VEL_UINDB_SHED_pre
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P = SrcFVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P = SrcFVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_GROUND_P)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_GROUND_P(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_GROUND_P.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_GROUND_P = SrcFVM_OtherStateTYPEData%VEL_UIND_GROUND_P
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%VEL_UIND_TOWER)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%VEL_UIND_TOWER(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%VEL_UIND_TOWER.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%VEL_UIND_TOWER = SrcFVM_OtherStateTYPEData%VEL_UIND_TOWER
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_DOMAIN,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_DOMAIN)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_DOMAIN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_DOMAIN.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_DOMAIN = SrcFVM_OtherStateTYPEData%WAKE_DOMAIN
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RE_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RE_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RE_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RE_SHED = SrcFVM_OtherStateTYPEData%WAKE_RE_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RE_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RE_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RE_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RE_TRAIL = SrcFVM_OtherStateTYPEData%WAKE_RE_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RC_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RC_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RC_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RC_SHED = SrcFVM_OtherStateTYPEData%WAKE_RC_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RC_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RC_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RC_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RC_TRAIL = SrcFVM_OtherStateTYPEData%WAKE_RC_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_LENGTH_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_LENGTH_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_LENGTH_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_LENGTH_SHED = SrcFVM_OtherStateTYPEData%WAKE_LENGTH_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL = SrcFVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED = SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL = SrcFVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_GAMMA_SHED)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_GAMMA_SHED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_GAMMA_SHED.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_GAMMA_SHED = SrcFVM_OtherStateTYPEData%WAKE_GAMMA_SHED
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL = SrcFVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WIND_INFTY)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTY,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WIND_INFTY)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WIND_INFTY(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WIND_INFTY.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WIND_INFTY = SrcFVM_OtherStateTYPEData%WIND_INFTY
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WIND_INFTYM)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%WIND_INFTYM,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WIND_INFTYM)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WIND_INFTYM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WIND_INFTYM.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WIND_INFTYM = SrcFVM_OtherStateTYPEData%WIND_INFTYM
ENDIF
   DstFVM_OtherStateTYPEData%Wind_Mean = SrcFVM_OtherStateTYPEData%Wind_Mean
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%StoredForces)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredForces,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredForces,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredForces,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredForces,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredForces,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredForces,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredForces,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredForces,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredForces,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredForces,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%StoredForces)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%StoredForces(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%StoredForces.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%StoredForces = SrcFVM_OtherStateTYPEData%StoredForces
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%StoredMoments)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%StoredMoments,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%StoredMoments)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%StoredMoments(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%StoredMoments.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%StoredMoments = SrcFVM_OtherStateTYPEData%StoredMoments
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PreviousForces)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousForces,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PreviousForces)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PreviousForces(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PreviousForces.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PreviousForces = SrcFVM_OtherStateTYPEData%PreviousForces
ENDIF
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%PreviousMoments)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,1)
   i2_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,2)
   i2_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,2)
   i3_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,3)
   i3_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,3)
   i4_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,4)
   i4_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,4)
   i5_l = LBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,5)
   i5_u = UBOUND(SrcFVM_OtherStateTYPEData%PreviousMoments,5)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%PreviousMoments)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%PreviousMoments(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%PreviousMoments.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%PreviousMoments = SrcFVM_OtherStateTYPEData%PreviousMoments
ENDIF
   DstFVM_OtherStateTYPEData%TipSpdRat = SrcFVM_OtherStateTYPEData%TipSpdRat
   DstFVM_OtherStateTYPEData%AzimuthAngle = SrcFVM_OtherStateTYPEData%AzimuthAngle
IF (ALLOCATED(SrcFVM_OtherStateTYPEData%WAKE_R0)) THEN
   i1_l = LBOUND(SrcFVM_OtherStateTYPEData%WAKE_R0,1)
   i1_u = UBOUND(SrcFVM_OtherStateTYPEData%WAKE_R0,1)
   IF (.NOT. ALLOCATED(DstFVM_OtherStateTYPEData%WAKE_R0)) THEN 
      ALLOCATE(DstFVM_OtherStateTYPEData%WAKE_R0(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstFVM_OtherStateTYPEData%WAKE_R0.', ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE')
         RETURN
      END IF
   END IF
   DstFVM_OtherStateTYPEData%WAKE_R0 = SrcFVM_OtherStateTYPEData%WAKE_R0
ENDIF
   DstFVM_OtherStateTYPEData%RK_counter = SrcFVM_OtherStateTYPEData%RK_counter
      CALL AD_Copyground_other( SrcFVM_OtherStateTYPEData%Ground, DstFVM_OtherStateTYPEData%Ground, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE:Ground')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copykj_iter( SrcFVM_OtherStateTYPEData%KJ, DstFVM_OtherStateTYPEData%KJ, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE:KJ')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyds_other( SrcFVM_OtherStateTYPEData%DS, DstFVM_OtherStateTYPEData%DS, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE:DS')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyairfoils_lb( SrcFVM_OtherStateTYPEData%airfoils_LB, DstFVM_OtherStateTYPEData%airfoils_LB, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE:airfoils_LB')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copytime_other( SrcFVM_OtherStateTYPEData%TIME, DstFVM_OtherStateTYPEData%TIME, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyFVM_OtherStateTYPE:TIME')
         IF (ErrStat>=AbortErrLev) RETURN
   DstFVM_OtherStateTYPEData%NTW = SrcFVM_OtherStateTYPEData%NTW
   DstFVM_OtherStateTYPEData%ntroll = SrcFVM_OtherStateTYPEData%ntroll
   DstFVM_OtherStateTYPEData%StrtTime = SrcFVM_OtherStateTYPEData%StrtTime
   DstFVM_OtherStateTYPEData%UsrTime1 = SrcFVM_OtherStateTYPEData%UsrTime1
   DstFVM_OtherStateTYPEData%UsrTime2 = SrcFVM_OtherStateTYPEData%UsrTime2
   DstFVM_OtherStateTYPEData%SimStrtTime = SrcFVM_OtherStateTYPEData%SimStrtTime
   DstFVM_OtherStateTYPEData%ZTime = SrcFVM_OtherStateTYPEData%ZTime
 END SUBROUTINE AD_CopyFVM_OtherStateTYPE

 SUBROUTINE AD_DestroyFVM_OtherStateTYPE( FVM_OtherStateTYPEData, ErrStat, ErrMsg )
  TYPE(FVM_OtherStateTYPE), INTENT(INOUT) :: FVM_OtherStateTYPEData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_AEROCENT)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_AEROCENT)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_LEAD)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_LEAD)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_BOUND)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_BOUND)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_COLLOC)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_COLLOC)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_QUARTER)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_QUARTER)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_END)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_END)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_NODES_BXN)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_NODES_BXN)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_NODES_BYN)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_NODES_BYN)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%POS_NODES_BZN)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%POS_NODES_BZN)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_CL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_CL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_CD)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_CD)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_AOA)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_AOA)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_PHI)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_PHI)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_A)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_A)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_AAP)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_AAP)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_AP)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_AP)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_TSR)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_TSR)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_DCZ)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_DCZ)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_DCX)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_DCX)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PERF_CM)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PERF_CM)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_AEROCENT)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_AEROCENT)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_BOUND)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_BOUND)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_BLADE)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_BLADE)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_DOMAIN)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_DOMAIN)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_DOMAIN_RK)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_DOMAIN_RK)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_RK)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_RK)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_GROUND)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_GROUND)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_GROUND)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_GROUND)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_MIRROR)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_MIRROR)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_MIRROR)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_MIRROR)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_TRAIL_pre)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UINDB_SHED_pre)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UINDB_SHED_pre)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_SHED_GROUND_P)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_TRAIL_GROUND_P)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_GROUND_P)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_GROUND_P)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%VEL_UIND_TOWER)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%VEL_UIND_TOWER)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_DOMAIN)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_DOMAIN)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RE_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RE_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RE_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RE_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RC_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RC_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RC_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RC_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_LENGTH_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_LENGTH_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_LENGTH_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RC_EFF_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RC_EFF_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_RC_EFF_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_GAMMA_SHED)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_GAMMA_SHED)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_GAMMA_TRAIL)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WIND_INFTY)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WIND_INFTY)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WIND_INFTYM)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WIND_INFTYM)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%StoredForces)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%StoredForces)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%StoredMoments)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%StoredMoments)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PreviousForces)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PreviousForces)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%PreviousMoments)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%PreviousMoments)
ENDIF
IF (ALLOCATED(FVM_OtherStateTYPEData%WAKE_R0)) THEN
   DEALLOCATE(FVM_OtherStateTYPEData%WAKE_R0)
ENDIF
  CALL AD_Destroyground_other( FVM_OtherStateTYPEData%Ground, ErrStat, ErrMsg )
  CALL AD_Destroykj_iter( FVM_OtherStateTYPEData%KJ, ErrStat, ErrMsg )
  CALL AD_Destroyds_other( FVM_OtherStateTYPEData%DS, ErrStat, ErrMsg )
  CALL AD_Destroyairfoils_lb( FVM_OtherStateTYPEData%airfoils_LB, ErrStat, ErrMsg )
  CALL AD_Destroytime_other( FVM_OtherStateTYPEData%TIME, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyFVM_OtherStateTYPE

 SUBROUTINE AD_PackFVM_OtherStateTYPE( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(FVM_OtherStateTYPE),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ground_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ground_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ground_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_KJ_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_KJ_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_KJ_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DS_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DS_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DS_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_airfoils_LB_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_airfoils_LB_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_airfoils_LB_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TIME_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TIME_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TIME_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for FullDIR
  IF ( ALLOCATED(InData%POS_AEROCENT) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_AEROCENT )  ! POS_AEROCENT 
  IF ( ALLOCATED(InData%POS_LEAD) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_LEAD )  ! POS_LEAD 
  IF ( ALLOCATED(InData%POS_BOUND) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_BOUND )  ! POS_BOUND 
  IF ( ALLOCATED(InData%POS_COLLOC) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_COLLOC )  ! POS_COLLOC 
  IF ( ALLOCATED(InData%POS_QUARTER) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_QUARTER )  ! POS_QUARTER 
  IF ( ALLOCATED(InData%POS_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_TRAIL )  ! POS_TRAIL 
  IF ( ALLOCATED(InData%POS_END) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_END )  ! POS_END 
  IF ( ALLOCATED(InData%POS_NODES_BXN) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_NODES_BXN )  ! POS_NODES_BXN 
  IF ( ALLOCATED(InData%POS_NODES_BYN) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_NODES_BYN )  ! POS_NODES_BYN 
  IF ( ALLOCATED(InData%POS_NODES_BZN) )   Db_BufSz    = Db_BufSz    + SIZE( InData%POS_NODES_BZN )  ! POS_NODES_BZN 
  IF ( ALLOCATED(InData%PERF_CL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_CL )  ! PERF_CL 
  IF ( ALLOCATED(InData%PERF_CD) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_CD )  ! PERF_CD 
  IF ( ALLOCATED(InData%PERF_AOA) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_AOA )  ! PERF_AOA 
  IF ( ALLOCATED(InData%PERF_PHI) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_PHI )  ! PERF_PHI 
  IF ( ALLOCATED(InData%PERF_A) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_A )  ! PERF_A 
  IF ( ALLOCATED(InData%PERF_AAP) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_AAP )  ! PERF_AAP 
  IF ( ALLOCATED(InData%PERF_AP) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_AP )  ! PERF_AP 
  IF ( ALLOCATED(InData%PERF_TSR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_TSR )  ! PERF_TSR 
  IF ( ALLOCATED(InData%PERF_DCZ) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_DCZ )  ! PERF_DCZ 
  IF ( ALLOCATED(InData%PERF_DCX) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_DCX )  ! PERF_DCX 
  IF ( ALLOCATED(InData%PERF_CM) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PERF_CM )  ! PERF_CM 
  IF ( ALLOCATED(InData%VEL_AEROCENT) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_AEROCENT )  ! VEL_AEROCENT 
  IF ( ALLOCATED(InData%VEL_BOUND) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_BOUND )  ! VEL_BOUND 
  IF ( ALLOCATED(InData%VEL_BLADE) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_BLADE )  ! VEL_BLADE 
  IF ( ALLOCATED(InData%VEL_DOMAIN) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_DOMAIN )  ! VEL_DOMAIN 
  IF ( ALLOCATED(InData%VEL_DOMAIN_RK) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_DOMAIN_RK )  ! VEL_DOMAIN_RK 
  IF ( ALLOCATED(InData%VEL_UIND) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND )  ! VEL_UIND 
  IF ( ALLOCATED(InData%VEL_UINDB) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB )  ! VEL_UINDB 
  IF ( ALLOCATED(InData%VEL_UIND_RK) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_RK )  ! VEL_UIND_RK 
  IF ( ALLOCATED(InData%VEL_UIND_GROUND) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_GROUND )  ! VEL_UIND_GROUND 
  IF ( ALLOCATED(InData%VEL_UINDB_GROUND) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_GROUND )  ! VEL_UINDB_GROUND 
  IF ( ALLOCATED(InData%VEL_UIND_MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_MIRROR )  ! VEL_UIND_MIRROR 
  IF ( ALLOCATED(InData%VEL_UINDB_MIRROR) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_MIRROR )  ! VEL_UINDB_MIRROR 
  IF ( ALLOCATED(InData%VEL_UIND_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_SHED )  ! VEL_UIND_SHED 
  IF ( ALLOCATED(InData%VEL_UIND_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_TRAIL )  ! VEL_UIND_TRAIL 
  IF ( ALLOCATED(InData%VEL_UINDB_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_TRAIL )  ! VEL_UINDB_TRAIL 
  IF ( ALLOCATED(InData%VEL_UINDB_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_SHED )  ! VEL_UINDB_SHED 
  IF ( ALLOCATED(InData%VEL_UINDB_TRAIL_pre) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_TRAIL_pre )  ! VEL_UINDB_TRAIL_pre 
  IF ( ALLOCATED(InData%VEL_UINDB_SHED_pre) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UINDB_SHED_pre )  ! VEL_UINDB_SHED_pre 
  IF ( ALLOCATED(InData%VEL_UIND_SHED_GROUND_P) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_SHED_GROUND_P )  ! VEL_UIND_SHED_GROUND_P 
  IF ( ALLOCATED(InData%VEL_UIND_TRAIL_GROUND_P) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_TRAIL_GROUND_P )  ! VEL_UIND_TRAIL_GROUND_P 
  IF ( ALLOCATED(InData%VEL_UIND_GROUND_P) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_GROUND_P )  ! VEL_UIND_GROUND_P 
  IF ( ALLOCATED(InData%VEL_UIND_TOWER) )   Db_BufSz    = Db_BufSz    + SIZE( InData%VEL_UIND_TOWER )  ! VEL_UIND_TOWER 
  IF ( ALLOCATED(InData%WAKE_DOMAIN) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_DOMAIN )  ! WAKE_DOMAIN 
  IF ( ALLOCATED(InData%WAKE_RE_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RE_SHED )  ! WAKE_RE_SHED 
  IF ( ALLOCATED(InData%WAKE_RE_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RE_TRAIL )  ! WAKE_RE_TRAIL 
  IF ( ALLOCATED(InData%WAKE_RC_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RC_SHED )  ! WAKE_RC_SHED 
  IF ( ALLOCATED(InData%WAKE_RC_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RC_TRAIL )  ! WAKE_RC_TRAIL 
  IF ( ALLOCATED(InData%WAKE_LENGTH_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_LENGTH_SHED )  ! WAKE_LENGTH_SHED 
  IF ( ALLOCATED(InData%WAKE_LENGTH_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_LENGTH_TRAIL )  ! WAKE_LENGTH_TRAIL 
  IF ( ALLOCATED(InData%WAKE_RC_EFF_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RC_EFF_SHED )  ! WAKE_RC_EFF_SHED 
  IF ( ALLOCATED(InData%WAKE_RC_EFF_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_RC_EFF_TRAIL )  ! WAKE_RC_EFF_TRAIL 
  IF ( ALLOCATED(InData%WAKE_GAMMA_SHED) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_GAMMA_SHED )  ! WAKE_GAMMA_SHED 
  IF ( ALLOCATED(InData%WAKE_GAMMA_TRAIL) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_GAMMA_TRAIL )  ! WAKE_GAMMA_TRAIL 
  IF ( ALLOCATED(InData%WIND_INFTY) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WIND_INFTY )  ! WIND_INFTY 
  IF ( ALLOCATED(InData%WIND_INFTYM) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WIND_INFTYM )  ! WIND_INFTYM 
  Db_BufSz    = Db_BufSz    + SIZE( InData%Wind_Mean )  ! Wind_Mean 
  IF ( ALLOCATED(InData%StoredForces) )   Db_BufSz    = Db_BufSz    + SIZE( InData%StoredForces )  ! StoredForces 
  IF ( ALLOCATED(InData%StoredMoments) )   Db_BufSz    = Db_BufSz    + SIZE( InData%StoredMoments )  ! StoredMoments 
  IF ( ALLOCATED(InData%PreviousForces) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PreviousForces )  ! PreviousForces 
  IF ( ALLOCATED(InData%PreviousMoments) )   Db_BufSz    = Db_BufSz    + SIZE( InData%PreviousMoments )  ! PreviousMoments 
  Db_BufSz   = Db_BufSz   + 1  ! TipSpdRat
  Db_BufSz   = Db_BufSz   + 1  ! AzimuthAngle
  IF ( ALLOCATED(InData%WAKE_R0) )   Db_BufSz    = Db_BufSz    + SIZE( InData%WAKE_R0 )  ! WAKE_R0 
  Int_BufSz  = Int_BufSz  + 1  ! RK_counter
  CALL AD_Packground_other( Re_Ground_Buf, Db_Ground_Buf, Int_Ground_Buf, InData%Ground, ErrStat, ErrMsg, .TRUE. ) ! Ground 
  IF(ALLOCATED(Re_Ground_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ground_Buf  ) ! Ground
  IF(ALLOCATED(Db_Ground_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ground_Buf  ) ! Ground
  IF(ALLOCATED(Int_Ground_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ground_Buf ) ! Ground
  IF(ALLOCATED(Re_Ground_Buf))  DEALLOCATE(Re_Ground_Buf)
  IF(ALLOCATED(Db_Ground_Buf))  DEALLOCATE(Db_Ground_Buf)
  IF(ALLOCATED(Int_Ground_Buf)) DEALLOCATE(Int_Ground_Buf)
  CALL AD_Packkj_iter( Re_KJ_Buf, Db_KJ_Buf, Int_KJ_Buf, InData%KJ, ErrStat, ErrMsg, .TRUE. ) ! KJ 
  IF(ALLOCATED(Re_KJ_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_KJ_Buf  ) ! KJ
  IF(ALLOCATED(Db_KJ_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_KJ_Buf  ) ! KJ
  IF(ALLOCATED(Int_KJ_Buf))Int_BufSz = Int_BufSz + SIZE( Int_KJ_Buf ) ! KJ
  IF(ALLOCATED(Re_KJ_Buf))  DEALLOCATE(Re_KJ_Buf)
  IF(ALLOCATED(Db_KJ_Buf))  DEALLOCATE(Db_KJ_Buf)
  IF(ALLOCATED(Int_KJ_Buf)) DEALLOCATE(Int_KJ_Buf)
  CALL AD_Packds_other( Re_DS_Buf, Db_DS_Buf, Int_DS_Buf, InData%DS, ErrStat, ErrMsg, .TRUE. ) ! DS 
  IF(ALLOCATED(Re_DS_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DS_Buf  ) ! DS
  IF(ALLOCATED(Db_DS_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DS_Buf  ) ! DS
  IF(ALLOCATED(Int_DS_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DS_Buf ) ! DS
  IF(ALLOCATED(Re_DS_Buf))  DEALLOCATE(Re_DS_Buf)
  IF(ALLOCATED(Db_DS_Buf))  DEALLOCATE(Db_DS_Buf)
  IF(ALLOCATED(Int_DS_Buf)) DEALLOCATE(Int_DS_Buf)
  CALL AD_Packairfoils_lb( Re_airfoils_LB_Buf, Db_airfoils_LB_Buf, Int_airfoils_LB_Buf, InData%airfoils_LB, ErrStat, ErrMsg, .TRUE. ) ! airfoils_LB 
  IF(ALLOCATED(Re_airfoils_LB_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_airfoils_LB_Buf  ) ! airfoils_LB
  IF(ALLOCATED(Db_airfoils_LB_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_airfoils_LB_Buf  ) ! airfoils_LB
  IF(ALLOCATED(Int_airfoils_LB_Buf))Int_BufSz = Int_BufSz + SIZE( Int_airfoils_LB_Buf ) ! airfoils_LB
  IF(ALLOCATED(Re_airfoils_LB_Buf))  DEALLOCATE(Re_airfoils_LB_Buf)
  IF(ALLOCATED(Db_airfoils_LB_Buf))  DEALLOCATE(Db_airfoils_LB_Buf)
  IF(ALLOCATED(Int_airfoils_LB_Buf)) DEALLOCATE(Int_airfoils_LB_Buf)
  CALL AD_Packtime_other( Re_TIME_Buf, Db_TIME_Buf, Int_TIME_Buf, InData%TIME, ErrStat, ErrMsg, .TRUE. ) ! TIME 
  IF(ALLOCATED(Re_TIME_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TIME_Buf  ) ! TIME
  IF(ALLOCATED(Db_TIME_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TIME_Buf  ) ! TIME
  IF(ALLOCATED(Int_TIME_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TIME_Buf ) ! TIME
  IF(ALLOCATED(Re_TIME_Buf))  DEALLOCATE(Re_TIME_Buf)
  IF(ALLOCATED(Db_TIME_Buf))  DEALLOCATE(Db_TIME_Buf)
  IF(ALLOCATED(Int_TIME_Buf)) DEALLOCATE(Int_TIME_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NTW
  Int_BufSz  = Int_BufSz  + 1  ! ntroll
  Int_BufSz   = Int_BufSz   + SIZE( InData%StrtTime )  ! StrtTime 
  Db_BufSz   = Db_BufSz   + 1  ! UsrTime1
  Db_BufSz   = Db_BufSz   + 1  ! UsrTime2
  Int_BufSz   = Int_BufSz   + SIZE( InData%SimStrtTime )  ! SimStrtTime 
  Db_BufSz   = Db_BufSz   + 1  ! ZTime
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%POS_AEROCENT) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_AEROCENT))-1 ) =  PACK(InData%POS_AEROCENT ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_AEROCENT)
  ENDIF
  IF ( ALLOCATED(InData%POS_LEAD) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_LEAD))-1 ) =  PACK(InData%POS_LEAD ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_LEAD)
  ENDIF
  IF ( ALLOCATED(InData%POS_BOUND) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_BOUND))-1 ) =  PACK(InData%POS_BOUND ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_BOUND)
  ENDIF
  IF ( ALLOCATED(InData%POS_COLLOC) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_COLLOC))-1 ) =  PACK(InData%POS_COLLOC ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_COLLOC)
  ENDIF
  IF ( ALLOCATED(InData%POS_QUARTER) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_QUARTER))-1 ) =  PACK(InData%POS_QUARTER ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_QUARTER)
  ENDIF
  IF ( ALLOCATED(InData%POS_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_TRAIL))-1 ) =  PACK(InData%POS_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%POS_END) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_END))-1 ) =  PACK(InData%POS_END ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_END)
  ENDIF
  IF ( ALLOCATED(InData%POS_NODES_BXN) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_NODES_BXN))-1 ) =  PACK(InData%POS_NODES_BXN ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_NODES_BXN)
  ENDIF
  IF ( ALLOCATED(InData%POS_NODES_BYN) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_NODES_BYN))-1 ) =  PACK(InData%POS_NODES_BYN ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_NODES_BYN)
  ENDIF
  IF ( ALLOCATED(InData%POS_NODES_BZN) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%POS_NODES_BZN))-1 ) =  PACK(InData%POS_NODES_BZN ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%POS_NODES_BZN)
  ENDIF
  IF ( ALLOCATED(InData%PERF_CL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_CL))-1 ) =  PACK(InData%PERF_CL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_CL)
  ENDIF
  IF ( ALLOCATED(InData%PERF_CD) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_CD))-1 ) =  PACK(InData%PERF_CD ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_CD)
  ENDIF
  IF ( ALLOCATED(InData%PERF_AOA) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_AOA))-1 ) =  PACK(InData%PERF_AOA ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_AOA)
  ENDIF
  IF ( ALLOCATED(InData%PERF_PHI) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_PHI))-1 ) =  PACK(InData%PERF_PHI ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_PHI)
  ENDIF
  IF ( ALLOCATED(InData%PERF_A) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_A))-1 ) =  PACK(InData%PERF_A ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_A)
  ENDIF
  IF ( ALLOCATED(InData%PERF_AAP) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_AAP))-1 ) =  PACK(InData%PERF_AAP ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_AAP)
  ENDIF
  IF ( ALLOCATED(InData%PERF_AP) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_AP))-1 ) =  PACK(InData%PERF_AP ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_AP)
  ENDIF
  IF ( ALLOCATED(InData%PERF_TSR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_TSR))-1 ) =  PACK(InData%PERF_TSR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_TSR)
  ENDIF
  IF ( ALLOCATED(InData%PERF_DCZ) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_DCZ))-1 ) =  PACK(InData%PERF_DCZ ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_DCZ)
  ENDIF
  IF ( ALLOCATED(InData%PERF_DCX) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_DCX))-1 ) =  PACK(InData%PERF_DCX ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_DCX)
  ENDIF
  IF ( ALLOCATED(InData%PERF_CM) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PERF_CM))-1 ) =  PACK(InData%PERF_CM ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PERF_CM)
  ENDIF
  IF ( ALLOCATED(InData%VEL_AEROCENT) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_AEROCENT))-1 ) =  PACK(InData%VEL_AEROCENT ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_AEROCENT)
  ENDIF
  IF ( ALLOCATED(InData%VEL_BOUND) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_BOUND))-1 ) =  PACK(InData%VEL_BOUND ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_BOUND)
  ENDIF
  IF ( ALLOCATED(InData%VEL_BLADE) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_BLADE))-1 ) =  PACK(InData%VEL_BLADE ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_BLADE)
  ENDIF
  IF ( ALLOCATED(InData%VEL_DOMAIN) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_DOMAIN))-1 ) =  PACK(InData%VEL_DOMAIN ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_DOMAIN)
  ENDIF
  IF ( ALLOCATED(InData%VEL_DOMAIN_RK) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_DOMAIN_RK))-1 ) =  PACK(InData%VEL_DOMAIN_RK ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_DOMAIN_RK)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND))-1 ) =  PACK(InData%VEL_UIND ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB))-1 ) =  PACK(InData%VEL_UINDB ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_RK) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_RK))-1 ) =  PACK(InData%VEL_UIND_RK ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_RK)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_GROUND) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_GROUND))-1 ) =  PACK(InData%VEL_UIND_GROUND ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_GROUND)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_GROUND) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_GROUND))-1 ) =  PACK(InData%VEL_UINDB_GROUND ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_GROUND)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_MIRROR))-1 ) =  PACK(InData%VEL_UIND_MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_MIRROR)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_MIRROR) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_MIRROR))-1 ) =  PACK(InData%VEL_UINDB_MIRROR ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_MIRROR)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_SHED))-1 ) =  PACK(InData%VEL_UIND_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_SHED)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_TRAIL))-1 ) =  PACK(InData%VEL_UIND_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_TRAIL))-1 ) =  PACK(InData%VEL_UINDB_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_SHED))-1 ) =  PACK(InData%VEL_UINDB_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_SHED)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_TRAIL_pre) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_TRAIL_pre))-1 ) =  PACK(InData%VEL_UINDB_TRAIL_pre ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_TRAIL_pre)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UINDB_SHED_pre) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UINDB_SHED_pre))-1 ) =  PACK(InData%VEL_UINDB_SHED_pre ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UINDB_SHED_pre)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_SHED_GROUND_P) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_SHED_GROUND_P))-1 ) =  PACK(InData%VEL_UIND_SHED_GROUND_P ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_SHED_GROUND_P)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_TRAIL_GROUND_P) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_TRAIL_GROUND_P))-1 ) =  PACK(InData%VEL_UIND_TRAIL_GROUND_P ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_TRAIL_GROUND_P)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_GROUND_P) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_GROUND_P))-1 ) =  PACK(InData%VEL_UIND_GROUND_P ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_GROUND_P)
  ENDIF
  IF ( ALLOCATED(InData%VEL_UIND_TOWER) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%VEL_UIND_TOWER))-1 ) =  PACK(InData%VEL_UIND_TOWER ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%VEL_UIND_TOWER)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_DOMAIN) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_DOMAIN))-1 ) =  PACK(InData%WAKE_DOMAIN ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_DOMAIN)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RE_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RE_SHED))-1 ) =  PACK(InData%WAKE_RE_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RE_SHED)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RE_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RE_TRAIL))-1 ) =  PACK(InData%WAKE_RE_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RE_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RC_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RC_SHED))-1 ) =  PACK(InData%WAKE_RC_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RC_SHED)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RC_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RC_TRAIL))-1 ) =  PACK(InData%WAKE_RC_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RC_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_LENGTH_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_LENGTH_SHED))-1 ) =  PACK(InData%WAKE_LENGTH_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_LENGTH_SHED)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_LENGTH_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_LENGTH_TRAIL))-1 ) =  PACK(InData%WAKE_LENGTH_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_LENGTH_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RC_EFF_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RC_EFF_SHED))-1 ) =  PACK(InData%WAKE_RC_EFF_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RC_EFF_SHED)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_RC_EFF_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_RC_EFF_TRAIL))-1 ) =  PACK(InData%WAKE_RC_EFF_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_RC_EFF_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_GAMMA_SHED) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_GAMMA_SHED))-1 ) =  PACK(InData%WAKE_GAMMA_SHED ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_GAMMA_SHED)
  ENDIF
  IF ( ALLOCATED(InData%WAKE_GAMMA_TRAIL) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_GAMMA_TRAIL))-1 ) =  PACK(InData%WAKE_GAMMA_TRAIL ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_GAMMA_TRAIL)
  ENDIF
  IF ( ALLOCATED(InData%WIND_INFTY) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WIND_INFTY))-1 ) =  PACK(InData%WIND_INFTY ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WIND_INFTY)
  ENDIF
  IF ( ALLOCATED(InData%WIND_INFTYM) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WIND_INFTYM))-1 ) =  PACK(InData%WIND_INFTYM ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WIND_INFTYM)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%Wind_Mean))-1 ) =  PACK(InData%Wind_Mean ,.TRUE.)
  Db_Xferred   = Db_Xferred   + SIZE(InData%Wind_Mean)
  IF ( ALLOCATED(InData%StoredForces) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%StoredForces))-1 ) =  PACK(InData%StoredForces ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%StoredForces)
  ENDIF
  IF ( ALLOCATED(InData%StoredMoments) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%StoredMoments))-1 ) =  PACK(InData%StoredMoments ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%StoredMoments)
  ENDIF
  IF ( ALLOCATED(InData%PreviousForces) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PreviousForces))-1 ) =  PACK(InData%PreviousForces ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PreviousForces)
  ENDIF
  IF ( ALLOCATED(InData%PreviousMoments) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%PreviousMoments))-1 ) =  PACK(InData%PreviousMoments ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%PreviousMoments)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TipSpdRat )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%AzimuthAngle )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%WAKE_R0) ) THEN
    IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(SIZE(InData%WAKE_R0))-1 ) =  PACK(InData%WAKE_R0 ,.TRUE.)
    Db_Xferred   = Db_Xferred   + SIZE(InData%WAKE_R0)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RK_counter )
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packground_other( Re_Ground_Buf, Db_Ground_Buf, Int_Ground_Buf, InData%Ground, ErrStat, ErrMsg, OnlySize ) ! Ground 
  IF(ALLOCATED(Re_Ground_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ground_Buf)-1 ) = Re_Ground_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ground_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ground_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ground_Buf)-1 ) = Db_Ground_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ground_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ground_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ground_Buf)-1 ) = Int_Ground_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ground_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ground_Buf) )  DEALLOCATE(Re_Ground_Buf)
  IF( ALLOCATED(Db_Ground_Buf) )  DEALLOCATE(Db_Ground_Buf)
  IF( ALLOCATED(Int_Ground_Buf) ) DEALLOCATE(Int_Ground_Buf)
  CALL AD_Packkj_iter( Re_KJ_Buf, Db_KJ_Buf, Int_KJ_Buf, InData%KJ, ErrStat, ErrMsg, OnlySize ) ! KJ 
  IF(ALLOCATED(Re_KJ_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_KJ_Buf)-1 ) = Re_KJ_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_KJ_Buf)
  ENDIF
  IF(ALLOCATED(Db_KJ_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_KJ_Buf)-1 ) = Db_KJ_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_KJ_Buf)
  ENDIF
  IF(ALLOCATED(Int_KJ_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_KJ_Buf)-1 ) = Int_KJ_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_KJ_Buf)
  ENDIF
  IF( ALLOCATED(Re_KJ_Buf) )  DEALLOCATE(Re_KJ_Buf)
  IF( ALLOCATED(Db_KJ_Buf) )  DEALLOCATE(Db_KJ_Buf)
  IF( ALLOCATED(Int_KJ_Buf) ) DEALLOCATE(Int_KJ_Buf)
  CALL AD_Packds_other( Re_DS_Buf, Db_DS_Buf, Int_DS_Buf, InData%DS, ErrStat, ErrMsg, OnlySize ) ! DS 
  IF(ALLOCATED(Re_DS_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DS_Buf)-1 ) = Re_DS_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DS_Buf)
  ENDIF
  IF(ALLOCATED(Db_DS_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DS_Buf)-1 ) = Db_DS_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DS_Buf)
  ENDIF
  IF(ALLOCATED(Int_DS_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DS_Buf)-1 ) = Int_DS_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DS_Buf)
  ENDIF
  IF( ALLOCATED(Re_DS_Buf) )  DEALLOCATE(Re_DS_Buf)
  IF( ALLOCATED(Db_DS_Buf) )  DEALLOCATE(Db_DS_Buf)
  IF( ALLOCATED(Int_DS_Buf) ) DEALLOCATE(Int_DS_Buf)
  CALL AD_Packairfoils_lb( Re_airfoils_LB_Buf, Db_airfoils_LB_Buf, Int_airfoils_LB_Buf, InData%airfoils_LB, ErrStat, ErrMsg, OnlySize ) ! airfoils_LB 
  IF(ALLOCATED(Re_airfoils_LB_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_airfoils_LB_Buf)-1 ) = Re_airfoils_LB_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_airfoils_LB_Buf)
  ENDIF
  IF(ALLOCATED(Db_airfoils_LB_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_airfoils_LB_Buf)-1 ) = Db_airfoils_LB_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_airfoils_LB_Buf)
  ENDIF
  IF(ALLOCATED(Int_airfoils_LB_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_airfoils_LB_Buf)-1 ) = Int_airfoils_LB_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_airfoils_LB_Buf)
  ENDIF
  IF( ALLOCATED(Re_airfoils_LB_Buf) )  DEALLOCATE(Re_airfoils_LB_Buf)
  IF( ALLOCATED(Db_airfoils_LB_Buf) )  DEALLOCATE(Db_airfoils_LB_Buf)
  IF( ALLOCATED(Int_airfoils_LB_Buf) ) DEALLOCATE(Int_airfoils_LB_Buf)
  CALL AD_Packtime_other( Re_TIME_Buf, Db_TIME_Buf, Int_TIME_Buf, InData%TIME, ErrStat, ErrMsg, OnlySize ) ! TIME 
  IF(ALLOCATED(Re_TIME_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TIME_Buf)-1 ) = Re_TIME_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TIME_Buf)
  ENDIF
  IF(ALLOCATED(Db_TIME_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TIME_Buf)-1 ) = Db_TIME_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TIME_Buf)
  ENDIF
  IF(ALLOCATED(Int_TIME_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TIME_Buf)-1 ) = Int_TIME_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TIME_Buf)
  ENDIF
  IF( ALLOCATED(Re_TIME_Buf) )  DEALLOCATE(Re_TIME_Buf)
  IF( ALLOCATED(Db_TIME_Buf) )  DEALLOCATE(Db_TIME_Buf)
  IF( ALLOCATED(Int_TIME_Buf) ) DEALLOCATE(Int_TIME_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTW )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%ntroll )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%StrtTime))-1 ) = PACK(InData%StrtTime ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%StrtTime)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%UsrTime1 )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%UsrTime2 )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SimStrtTime))-1 ) = PACK(InData%SimStrtTime ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%SimStrtTime)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%ZTime )
  Db_Xferred   = Db_Xferred   + 1
 END SUBROUTINE AD_PackFVM_OtherStateTYPE

 SUBROUTINE AD_UnPackFVM_OtherStateTYPE( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(FVM_OtherStateTYPE), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ground_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ground_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ground_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_KJ_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_KJ_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_KJ_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DS_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DS_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DS_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_airfoils_LB_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_airfoils_LB_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_airfoils_LB_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TIME_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TIME_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TIME_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%POS_AEROCENT) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_AEROCENT,1),SIZE(OutData%POS_AEROCENT,2),SIZE(OutData%POS_AEROCENT,3),SIZE(OutData%POS_AEROCENT,4),SIZE(OutData%POS_AEROCENT,5)))
  mask5 = .TRUE.
    OutData%POS_AEROCENT = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_AEROCENT))-1 ),mask5,OutData%POS_AEROCENT)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_AEROCENT)
  ENDIF
  IF ( ALLOCATED(OutData%POS_LEAD) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_LEAD,1),SIZE(OutData%POS_LEAD,2),SIZE(OutData%POS_LEAD,3),SIZE(OutData%POS_LEAD,4),SIZE(OutData%POS_LEAD,5)))
  mask5 = .TRUE.
    OutData%POS_LEAD = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_LEAD))-1 ),mask5,OutData%POS_LEAD)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_LEAD)
  ENDIF
  IF ( ALLOCATED(OutData%POS_BOUND) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_BOUND,1),SIZE(OutData%POS_BOUND,2),SIZE(OutData%POS_BOUND,3),SIZE(OutData%POS_BOUND,4),SIZE(OutData%POS_BOUND,5)))
  mask5 = .TRUE.
    OutData%POS_BOUND = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_BOUND))-1 ),mask5,OutData%POS_BOUND)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_BOUND)
  ENDIF
  IF ( ALLOCATED(OutData%POS_COLLOC) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_COLLOC,1),SIZE(OutData%POS_COLLOC,2),SIZE(OutData%POS_COLLOC,3),SIZE(OutData%POS_COLLOC,4),SIZE(OutData%POS_COLLOC,5)))
  mask5 = .TRUE.
    OutData%POS_COLLOC = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_COLLOC))-1 ),mask5,OutData%POS_COLLOC)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_COLLOC)
  ENDIF
  IF ( ALLOCATED(OutData%POS_QUARTER) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_QUARTER,1),SIZE(OutData%POS_QUARTER,2),SIZE(OutData%POS_QUARTER,3),SIZE(OutData%POS_QUARTER,4),SIZE(OutData%POS_QUARTER,5)))
  mask5 = .TRUE.
    OutData%POS_QUARTER = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_QUARTER))-1 ),mask5,OutData%POS_QUARTER)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_QUARTER)
  ENDIF
  IF ( ALLOCATED(OutData%POS_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_TRAIL,1),SIZE(OutData%POS_TRAIL,2),SIZE(OutData%POS_TRAIL,3),SIZE(OutData%POS_TRAIL,4),SIZE(OutData%POS_TRAIL,5)))
  mask5 = .TRUE.
    OutData%POS_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_TRAIL))-1 ),mask5,OutData%POS_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%POS_END) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_END,1),SIZE(OutData%POS_END,2),SIZE(OutData%POS_END,3),SIZE(OutData%POS_END,4),SIZE(OutData%POS_END,5)))
  mask5 = .TRUE.
    OutData%POS_END = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_END))-1 ),mask5,OutData%POS_END)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_END)
  ENDIF
  IF ( ALLOCATED(OutData%POS_NODES_BXN) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_NODES_BXN,1),SIZE(OutData%POS_NODES_BXN,2),SIZE(OutData%POS_NODES_BXN,3),SIZE(OutData%POS_NODES_BXN,4),SIZE(OutData%POS_NODES_BXN,5)))
  mask5 = .TRUE.
    OutData%POS_NODES_BXN = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_NODES_BXN))-1 ),mask5,OutData%POS_NODES_BXN)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_NODES_BXN)
  ENDIF
  IF ( ALLOCATED(OutData%POS_NODES_BYN) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_NODES_BYN,1),SIZE(OutData%POS_NODES_BYN,2),SIZE(OutData%POS_NODES_BYN,3),SIZE(OutData%POS_NODES_BYN,4),SIZE(OutData%POS_NODES_BYN,5)))
  mask5 = .TRUE.
    OutData%POS_NODES_BYN = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_NODES_BYN))-1 ),mask5,OutData%POS_NODES_BYN)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_NODES_BYN)
  ENDIF
  IF ( ALLOCATED(OutData%POS_NODES_BZN) ) THEN
  ALLOCATE(mask5(SIZE(OutData%POS_NODES_BZN,1),SIZE(OutData%POS_NODES_BZN,2),SIZE(OutData%POS_NODES_BZN,3),SIZE(OutData%POS_NODES_BZN,4),SIZE(OutData%POS_NODES_BZN,5)))
  mask5 = .TRUE.
    OutData%POS_NODES_BZN = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%POS_NODES_BZN))-1 ),mask5,OutData%POS_NODES_BZN)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%POS_NODES_BZN)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_CL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_CL,1),SIZE(OutData%PERF_CL,2),SIZE(OutData%PERF_CL,3),SIZE(OutData%PERF_CL,4),SIZE(OutData%PERF_CL,5)))
  mask5 = .TRUE.
    OutData%PERF_CL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_CL))-1 ),mask5,OutData%PERF_CL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_CL)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_CD) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_CD,1),SIZE(OutData%PERF_CD,2),SIZE(OutData%PERF_CD,3),SIZE(OutData%PERF_CD,4),SIZE(OutData%PERF_CD,5)))
  mask5 = .TRUE.
    OutData%PERF_CD = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_CD))-1 ),mask5,OutData%PERF_CD)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_CD)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_AOA) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_AOA,1),SIZE(OutData%PERF_AOA,2),SIZE(OutData%PERF_AOA,3),SIZE(OutData%PERF_AOA,4),SIZE(OutData%PERF_AOA,5)))
  mask5 = .TRUE.
    OutData%PERF_AOA = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_AOA))-1 ),mask5,OutData%PERF_AOA)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_AOA)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_PHI) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_PHI,1),SIZE(OutData%PERF_PHI,2),SIZE(OutData%PERF_PHI,3),SIZE(OutData%PERF_PHI,4),SIZE(OutData%PERF_PHI,5)))
  mask5 = .TRUE.
    OutData%PERF_PHI = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_PHI))-1 ),mask5,OutData%PERF_PHI)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_PHI)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_A) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_A,1),SIZE(OutData%PERF_A,2),SIZE(OutData%PERF_A,3),SIZE(OutData%PERF_A,4),SIZE(OutData%PERF_A,5)))
  mask5 = .TRUE.
    OutData%PERF_A = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_A))-1 ),mask5,OutData%PERF_A)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_A)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_AAP) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_AAP,1),SIZE(OutData%PERF_AAP,2),SIZE(OutData%PERF_AAP,3),SIZE(OutData%PERF_AAP,4),SIZE(OutData%PERF_AAP,5)))
  mask5 = .TRUE.
    OutData%PERF_AAP = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_AAP))-1 ),mask5,OutData%PERF_AAP)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_AAP)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_AP) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_AP,1),SIZE(OutData%PERF_AP,2),SIZE(OutData%PERF_AP,3),SIZE(OutData%PERF_AP,4),SIZE(OutData%PERF_AP,5)))
  mask5 = .TRUE.
    OutData%PERF_AP = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_AP))-1 ),mask5,OutData%PERF_AP)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_AP)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_TSR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_TSR,1),SIZE(OutData%PERF_TSR,2),SIZE(OutData%PERF_TSR,3),SIZE(OutData%PERF_TSR,4),SIZE(OutData%PERF_TSR,5)))
  mask5 = .TRUE.
    OutData%PERF_TSR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_TSR))-1 ),mask5,OutData%PERF_TSR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_TSR)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_DCZ) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_DCZ,1),SIZE(OutData%PERF_DCZ,2),SIZE(OutData%PERF_DCZ,3),SIZE(OutData%PERF_DCZ,4),SIZE(OutData%PERF_DCZ,5)))
  mask5 = .TRUE.
    OutData%PERF_DCZ = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_DCZ))-1 ),mask5,OutData%PERF_DCZ)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_DCZ)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_DCX) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_DCX,1),SIZE(OutData%PERF_DCX,2),SIZE(OutData%PERF_DCX,3),SIZE(OutData%PERF_DCX,4),SIZE(OutData%PERF_DCX,5)))
  mask5 = .TRUE.
    OutData%PERF_DCX = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_DCX))-1 ),mask5,OutData%PERF_DCX)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_DCX)
  ENDIF
  IF ( ALLOCATED(OutData%PERF_CM) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PERF_CM,1),SIZE(OutData%PERF_CM,2),SIZE(OutData%PERF_CM,3),SIZE(OutData%PERF_CM,4),SIZE(OutData%PERF_CM,5)))
  mask5 = .TRUE.
    OutData%PERF_CM = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PERF_CM))-1 ),mask5,OutData%PERF_CM)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PERF_CM)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_AEROCENT) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_AEROCENT,1),SIZE(OutData%VEL_AEROCENT,2),SIZE(OutData%VEL_AEROCENT,3),SIZE(OutData%VEL_AEROCENT,4),SIZE(OutData%VEL_AEROCENT,5)))
  mask5 = .TRUE.
    OutData%VEL_AEROCENT = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_AEROCENT))-1 ),mask5,OutData%VEL_AEROCENT)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_AEROCENT)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_BOUND) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_BOUND,1),SIZE(OutData%VEL_BOUND,2),SIZE(OutData%VEL_BOUND,3),SIZE(OutData%VEL_BOUND,4),SIZE(OutData%VEL_BOUND,5)))
  mask5 = .TRUE.
    OutData%VEL_BOUND = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_BOUND))-1 ),mask5,OutData%VEL_BOUND)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_BOUND)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_BLADE) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_BLADE,1),SIZE(OutData%VEL_BLADE,2),SIZE(OutData%VEL_BLADE,3),SIZE(OutData%VEL_BLADE,4),SIZE(OutData%VEL_BLADE,5)))
  mask5 = .TRUE.
    OutData%VEL_BLADE = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_BLADE))-1 ),mask5,OutData%VEL_BLADE)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_BLADE)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_DOMAIN) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_DOMAIN,1),SIZE(OutData%VEL_DOMAIN,2),SIZE(OutData%VEL_DOMAIN,3),SIZE(OutData%VEL_DOMAIN,4),SIZE(OutData%VEL_DOMAIN,5)))
  mask5 = .TRUE.
    OutData%VEL_DOMAIN = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_DOMAIN))-1 ),mask5,OutData%VEL_DOMAIN)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_DOMAIN)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_DOMAIN_RK) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_DOMAIN_RK,1),SIZE(OutData%VEL_DOMAIN_RK,2),SIZE(OutData%VEL_DOMAIN_RK,3),SIZE(OutData%VEL_DOMAIN_RK,4),SIZE(OutData%VEL_DOMAIN_RK,5)))
  mask5 = .TRUE.
    OutData%VEL_DOMAIN_RK = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_DOMAIN_RK))-1 ),mask5,OutData%VEL_DOMAIN_RK)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_DOMAIN_RK)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND,1),SIZE(OutData%VEL_UIND,2),SIZE(OutData%VEL_UIND,3),SIZE(OutData%VEL_UIND,4),SIZE(OutData%VEL_UIND,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND))-1 ),mask5,OutData%VEL_UIND)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB,1),SIZE(OutData%VEL_UINDB,2),SIZE(OutData%VEL_UINDB,3),SIZE(OutData%VEL_UINDB,4),SIZE(OutData%VEL_UINDB,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB))-1 ),mask5,OutData%VEL_UINDB)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_RK) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_RK,1),SIZE(OutData%VEL_UIND_RK,2),SIZE(OutData%VEL_UIND_RK,3),SIZE(OutData%VEL_UIND_RK,4),SIZE(OutData%VEL_UIND_RK,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_RK = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_RK))-1 ),mask5,OutData%VEL_UIND_RK)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_RK)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_GROUND) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_GROUND,1),SIZE(OutData%VEL_UIND_GROUND,2),SIZE(OutData%VEL_UIND_GROUND,3),SIZE(OutData%VEL_UIND_GROUND,4),SIZE(OutData%VEL_UIND_GROUND,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_GROUND = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_GROUND))-1 ),mask5,OutData%VEL_UIND_GROUND)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_GROUND)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_GROUND) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_GROUND,1),SIZE(OutData%VEL_UINDB_GROUND,2),SIZE(OutData%VEL_UINDB_GROUND,3),SIZE(OutData%VEL_UINDB_GROUND,4),SIZE(OutData%VEL_UINDB_GROUND,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_GROUND = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_GROUND))-1 ),mask5,OutData%VEL_UINDB_GROUND)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_GROUND)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_MIRROR,1),SIZE(OutData%VEL_UIND_MIRROR,2),SIZE(OutData%VEL_UIND_MIRROR,3),SIZE(OutData%VEL_UIND_MIRROR,4),SIZE(OutData%VEL_UIND_MIRROR,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_MIRROR))-1 ),mask5,OutData%VEL_UIND_MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_MIRROR)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_MIRROR) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_MIRROR,1),SIZE(OutData%VEL_UINDB_MIRROR,2),SIZE(OutData%VEL_UINDB_MIRROR,3),SIZE(OutData%VEL_UINDB_MIRROR,4),SIZE(OutData%VEL_UINDB_MIRROR,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_MIRROR = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_MIRROR))-1 ),mask5,OutData%VEL_UINDB_MIRROR)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_MIRROR)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_SHED,1),SIZE(OutData%VEL_UIND_SHED,2),SIZE(OutData%VEL_UIND_SHED,3),SIZE(OutData%VEL_UIND_SHED,4),SIZE(OutData%VEL_UIND_SHED,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_SHED))-1 ),mask5,OutData%VEL_UIND_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_TRAIL,1),SIZE(OutData%VEL_UIND_TRAIL,2),SIZE(OutData%VEL_UIND_TRAIL,3),SIZE(OutData%VEL_UIND_TRAIL,4),SIZE(OutData%VEL_UIND_TRAIL,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_TRAIL))-1 ),mask5,OutData%VEL_UIND_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_TRAIL,1),SIZE(OutData%VEL_UINDB_TRAIL,2),SIZE(OutData%VEL_UINDB_TRAIL,3),SIZE(OutData%VEL_UINDB_TRAIL,4),SIZE(OutData%VEL_UINDB_TRAIL,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_TRAIL))-1 ),mask5,OutData%VEL_UINDB_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_SHED,1),SIZE(OutData%VEL_UINDB_SHED,2),SIZE(OutData%VEL_UINDB_SHED,3),SIZE(OutData%VEL_UINDB_SHED,4),SIZE(OutData%VEL_UINDB_SHED,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_SHED))-1 ),mask5,OutData%VEL_UINDB_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_TRAIL_pre) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_TRAIL_pre,1),SIZE(OutData%VEL_UINDB_TRAIL_pre,2),SIZE(OutData%VEL_UINDB_TRAIL_pre,3),SIZE(OutData%VEL_UINDB_TRAIL_pre,4),SIZE(OutData%VEL_UINDB_TRAIL_pre,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_TRAIL_pre = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_TRAIL_pre))-1 ),mask5,OutData%VEL_UINDB_TRAIL_pre)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_TRAIL_pre)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UINDB_SHED_pre) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UINDB_SHED_pre,1),SIZE(OutData%VEL_UINDB_SHED_pre,2),SIZE(OutData%VEL_UINDB_SHED_pre,3),SIZE(OutData%VEL_UINDB_SHED_pre,4),SIZE(OutData%VEL_UINDB_SHED_pre,5)))
  mask5 = .TRUE.
    OutData%VEL_UINDB_SHED_pre = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UINDB_SHED_pre))-1 ),mask5,OutData%VEL_UINDB_SHED_pre)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UINDB_SHED_pre)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_SHED_GROUND_P) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_SHED_GROUND_P,1),SIZE(OutData%VEL_UIND_SHED_GROUND_P,2),SIZE(OutData%VEL_UIND_SHED_GROUND_P,3),SIZE(OutData%VEL_UIND_SHED_GROUND_P,4),SIZE(OutData%VEL_UIND_SHED_GROUND_P,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_SHED_GROUND_P = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_SHED_GROUND_P))-1 ),mask5,OutData%VEL_UIND_SHED_GROUND_P)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_SHED_GROUND_P)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_TRAIL_GROUND_P) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_TRAIL_GROUND_P,1),SIZE(OutData%VEL_UIND_TRAIL_GROUND_P,2),SIZE(OutData%VEL_UIND_TRAIL_GROUND_P,3),SIZE(OutData%VEL_UIND_TRAIL_GROUND_P,4),SIZE(OutData%VEL_UIND_TRAIL_GROUND_P,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_TRAIL_GROUND_P = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_TRAIL_GROUND_P))-1 ),mask5,OutData%VEL_UIND_TRAIL_GROUND_P)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_TRAIL_GROUND_P)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_GROUND_P) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_GROUND_P,1),SIZE(OutData%VEL_UIND_GROUND_P,2),SIZE(OutData%VEL_UIND_GROUND_P,3),SIZE(OutData%VEL_UIND_GROUND_P,4),SIZE(OutData%VEL_UIND_GROUND_P,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_GROUND_P = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_GROUND_P))-1 ),mask5,OutData%VEL_UIND_GROUND_P)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_GROUND_P)
  ENDIF
  IF ( ALLOCATED(OutData%VEL_UIND_TOWER) ) THEN
  ALLOCATE(mask5(SIZE(OutData%VEL_UIND_TOWER,1),SIZE(OutData%VEL_UIND_TOWER,2),SIZE(OutData%VEL_UIND_TOWER,3),SIZE(OutData%VEL_UIND_TOWER,4),SIZE(OutData%VEL_UIND_TOWER,5)))
  mask5 = .TRUE.
    OutData%VEL_UIND_TOWER = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%VEL_UIND_TOWER))-1 ),mask5,OutData%VEL_UIND_TOWER)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%VEL_UIND_TOWER)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_DOMAIN) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_DOMAIN,1),SIZE(OutData%WAKE_DOMAIN,2),SIZE(OutData%WAKE_DOMAIN,3),SIZE(OutData%WAKE_DOMAIN,4),SIZE(OutData%WAKE_DOMAIN,5)))
  mask5 = .TRUE.
    OutData%WAKE_DOMAIN = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_DOMAIN))-1 ),mask5,OutData%WAKE_DOMAIN)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_DOMAIN)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RE_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RE_SHED,1),SIZE(OutData%WAKE_RE_SHED,2),SIZE(OutData%WAKE_RE_SHED,3),SIZE(OutData%WAKE_RE_SHED,4),SIZE(OutData%WAKE_RE_SHED,5)))
  mask5 = .TRUE.
    OutData%WAKE_RE_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RE_SHED))-1 ),mask5,OutData%WAKE_RE_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RE_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RE_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RE_TRAIL,1),SIZE(OutData%WAKE_RE_TRAIL,2),SIZE(OutData%WAKE_RE_TRAIL,3),SIZE(OutData%WAKE_RE_TRAIL,4),SIZE(OutData%WAKE_RE_TRAIL,5)))
  mask5 = .TRUE.
    OutData%WAKE_RE_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RE_TRAIL))-1 ),mask5,OutData%WAKE_RE_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RE_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RC_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RC_SHED,1),SIZE(OutData%WAKE_RC_SHED,2),SIZE(OutData%WAKE_RC_SHED,3),SIZE(OutData%WAKE_RC_SHED,4),SIZE(OutData%WAKE_RC_SHED,5)))
  mask5 = .TRUE.
    OutData%WAKE_RC_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RC_SHED))-1 ),mask5,OutData%WAKE_RC_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RC_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RC_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RC_TRAIL,1),SIZE(OutData%WAKE_RC_TRAIL,2),SIZE(OutData%WAKE_RC_TRAIL,3),SIZE(OutData%WAKE_RC_TRAIL,4),SIZE(OutData%WAKE_RC_TRAIL,5)))
  mask5 = .TRUE.
    OutData%WAKE_RC_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RC_TRAIL))-1 ),mask5,OutData%WAKE_RC_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RC_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_LENGTH_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_LENGTH_SHED,1),SIZE(OutData%WAKE_LENGTH_SHED,2),SIZE(OutData%WAKE_LENGTH_SHED,3),SIZE(OutData%WAKE_LENGTH_SHED,4),SIZE(OutData%WAKE_LENGTH_SHED,5)))
  mask5 = .TRUE.
    OutData%WAKE_LENGTH_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_LENGTH_SHED))-1 ),mask5,OutData%WAKE_LENGTH_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_LENGTH_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_LENGTH_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_LENGTH_TRAIL,1),SIZE(OutData%WAKE_LENGTH_TRAIL,2),SIZE(OutData%WAKE_LENGTH_TRAIL,3),SIZE(OutData%WAKE_LENGTH_TRAIL,4),SIZE(OutData%WAKE_LENGTH_TRAIL,5)))
  mask5 = .TRUE.
    OutData%WAKE_LENGTH_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_LENGTH_TRAIL))-1 ),mask5,OutData%WAKE_LENGTH_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_LENGTH_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RC_EFF_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RC_EFF_SHED,1),SIZE(OutData%WAKE_RC_EFF_SHED,2),SIZE(OutData%WAKE_RC_EFF_SHED,3),SIZE(OutData%WAKE_RC_EFF_SHED,4),SIZE(OutData%WAKE_RC_EFF_SHED,5)))
  mask5 = .TRUE.
    OutData%WAKE_RC_EFF_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RC_EFF_SHED))-1 ),mask5,OutData%WAKE_RC_EFF_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RC_EFF_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_RC_EFF_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_RC_EFF_TRAIL,1),SIZE(OutData%WAKE_RC_EFF_TRAIL,2),SIZE(OutData%WAKE_RC_EFF_TRAIL,3),SIZE(OutData%WAKE_RC_EFF_TRAIL,4),SIZE(OutData%WAKE_RC_EFF_TRAIL,5)))
  mask5 = .TRUE.
    OutData%WAKE_RC_EFF_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_RC_EFF_TRAIL))-1 ),mask5,OutData%WAKE_RC_EFF_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_RC_EFF_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_GAMMA_SHED) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_GAMMA_SHED,1),SIZE(OutData%WAKE_GAMMA_SHED,2),SIZE(OutData%WAKE_GAMMA_SHED,3),SIZE(OutData%WAKE_GAMMA_SHED,4),SIZE(OutData%WAKE_GAMMA_SHED,5)))
  mask5 = .TRUE.
    OutData%WAKE_GAMMA_SHED = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_GAMMA_SHED))-1 ),mask5,OutData%WAKE_GAMMA_SHED)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_GAMMA_SHED)
  ENDIF
  IF ( ALLOCATED(OutData%WAKE_GAMMA_TRAIL) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WAKE_GAMMA_TRAIL,1),SIZE(OutData%WAKE_GAMMA_TRAIL,2),SIZE(OutData%WAKE_GAMMA_TRAIL,3),SIZE(OutData%WAKE_GAMMA_TRAIL,4),SIZE(OutData%WAKE_GAMMA_TRAIL,5)))
  mask5 = .TRUE.
    OutData%WAKE_GAMMA_TRAIL = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_GAMMA_TRAIL))-1 ),mask5,OutData%WAKE_GAMMA_TRAIL)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_GAMMA_TRAIL)
  ENDIF
  IF ( ALLOCATED(OutData%WIND_INFTY) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WIND_INFTY,1),SIZE(OutData%WIND_INFTY,2),SIZE(OutData%WIND_INFTY,3),SIZE(OutData%WIND_INFTY,4),SIZE(OutData%WIND_INFTY,5)))
  mask5 = .TRUE.
    OutData%WIND_INFTY = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WIND_INFTY))-1 ),mask5,OutData%WIND_INFTY)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WIND_INFTY)
  ENDIF
  IF ( ALLOCATED(OutData%WIND_INFTYM) ) THEN
  ALLOCATE(mask5(SIZE(OutData%WIND_INFTYM,1),SIZE(OutData%WIND_INFTYM,2),SIZE(OutData%WIND_INFTYM,3),SIZE(OutData%WIND_INFTYM,4),SIZE(OutData%WIND_INFTYM,5)))
  mask5 = .TRUE.
    OutData%WIND_INFTYM = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WIND_INFTYM))-1 ),mask5,OutData%WIND_INFTYM)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WIND_INFTYM)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%Wind_Mean,1)))
  mask1 = .TRUE.
  OutData%Wind_Mean = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%Wind_Mean))-1 ),mask1,OutData%Wind_Mean)
  DEALLOCATE(mask1)
  Db_Xferred   = Db_Xferred   + SIZE(OutData%Wind_Mean)
  IF ( ALLOCATED(OutData%StoredForces) ) THEN
  ALLOCATE(mask5(SIZE(OutData%StoredForces,1),SIZE(OutData%StoredForces,2),SIZE(OutData%StoredForces,3),SIZE(OutData%StoredForces,4),SIZE(OutData%StoredForces,5)))
  mask5 = .TRUE.
    OutData%StoredForces = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%StoredForces))-1 ),mask5,OutData%StoredForces)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%StoredForces)
  ENDIF
  IF ( ALLOCATED(OutData%StoredMoments) ) THEN
  ALLOCATE(mask5(SIZE(OutData%StoredMoments,1),SIZE(OutData%StoredMoments,2),SIZE(OutData%StoredMoments,3),SIZE(OutData%StoredMoments,4),SIZE(OutData%StoredMoments,5)))
  mask5 = .TRUE.
    OutData%StoredMoments = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%StoredMoments))-1 ),mask5,OutData%StoredMoments)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%StoredMoments)
  ENDIF
  IF ( ALLOCATED(OutData%PreviousForces) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PreviousForces,1),SIZE(OutData%PreviousForces,2),SIZE(OutData%PreviousForces,3),SIZE(OutData%PreviousForces,4),SIZE(OutData%PreviousForces,5)))
  mask5 = .TRUE.
    OutData%PreviousForces = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PreviousForces))-1 ),mask5,OutData%PreviousForces)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PreviousForces)
  ENDIF
  IF ( ALLOCATED(OutData%PreviousMoments) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PreviousMoments,1),SIZE(OutData%PreviousMoments,2),SIZE(OutData%PreviousMoments,3),SIZE(OutData%PreviousMoments,4),SIZE(OutData%PreviousMoments,5)))
  mask5 = .TRUE.
    OutData%PreviousMoments = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%PreviousMoments))-1 ),mask5,OutData%PreviousMoments)
  DEALLOCATE(mask5)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%PreviousMoments)
  ENDIF
  OutData%TipSpdRat = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%AzimuthAngle = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%WAKE_R0) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WAKE_R0,1)))
  mask1 = .TRUE.
    OutData%WAKE_R0 = UNPACK(DbKiBuf( Db_Xferred:Re_Xferred+(SIZE(OutData%WAKE_R0))-1 ),mask1,OutData%WAKE_R0)
  DEALLOCATE(mask1)
    Db_Xferred   = Db_Xferred   + SIZE(OutData%WAKE_R0)
  ENDIF
  OutData%RK_counter = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packground_other to get correctly sized buffers for unpacking
  CALL AD_Packground_other( Re_Ground_Buf, Db_Ground_Buf, Int_Ground_Buf, OutData%Ground, ErrStat, ErrMsg, .TRUE. ) ! Ground 
  IF(ALLOCATED(Re_Ground_Buf)) THEN
    Re_Ground_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ground_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ground_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ground_Buf)) THEN
    Db_Ground_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ground_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ground_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ground_Buf)) THEN
    Int_Ground_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ground_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ground_Buf)
  ENDIF
  CALL AD_UnPackground_other( Re_Ground_Buf, Db_Ground_Buf, Int_Ground_Buf, OutData%Ground, ErrStat, ErrMsg ) ! Ground 
 ! first call AD_Packkj_iter to get correctly sized buffers for unpacking
  CALL AD_Packkj_iter( Re_KJ_Buf, Db_KJ_Buf, Int_KJ_Buf, OutData%KJ, ErrStat, ErrMsg, .TRUE. ) ! KJ 
  IF(ALLOCATED(Re_KJ_Buf)) THEN
    Re_KJ_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_KJ_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_KJ_Buf)
  ENDIF
  IF(ALLOCATED(Db_KJ_Buf)) THEN
    Db_KJ_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_KJ_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_KJ_Buf)
  ENDIF
  IF(ALLOCATED(Int_KJ_Buf)) THEN
    Int_KJ_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_KJ_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_KJ_Buf)
  ENDIF
  CALL AD_UnPackkj_iter( Re_KJ_Buf, Db_KJ_Buf, Int_KJ_Buf, OutData%KJ, ErrStat, ErrMsg ) ! KJ 
 ! first call AD_Packds_other to get correctly sized buffers for unpacking
  CALL AD_Packds_other( Re_DS_Buf, Db_DS_Buf, Int_DS_Buf, OutData%DS, ErrStat, ErrMsg, .TRUE. ) ! DS 
  IF(ALLOCATED(Re_DS_Buf)) THEN
    Re_DS_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DS_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DS_Buf)
  ENDIF
  IF(ALLOCATED(Db_DS_Buf)) THEN
    Db_DS_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DS_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DS_Buf)
  ENDIF
  IF(ALLOCATED(Int_DS_Buf)) THEN
    Int_DS_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DS_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DS_Buf)
  ENDIF
  CALL AD_UnPackds_other( Re_DS_Buf, Db_DS_Buf, Int_DS_Buf, OutData%DS, ErrStat, ErrMsg ) ! DS 
 ! first call AD_Packairfoils_lb to get correctly sized buffers for unpacking
  CALL AD_Packairfoils_lb( Re_airfoils_LB_Buf, Db_airfoils_LB_Buf, Int_airfoils_LB_Buf, OutData%airfoils_LB, ErrStat, ErrMsg, .TRUE. ) ! airfoils_LB 
  IF(ALLOCATED(Re_airfoils_LB_Buf)) THEN
    Re_airfoils_LB_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_airfoils_LB_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_airfoils_LB_Buf)
  ENDIF
  IF(ALLOCATED(Db_airfoils_LB_Buf)) THEN
    Db_airfoils_LB_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_airfoils_LB_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_airfoils_LB_Buf)
  ENDIF
  IF(ALLOCATED(Int_airfoils_LB_Buf)) THEN
    Int_airfoils_LB_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_airfoils_LB_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_airfoils_LB_Buf)
  ENDIF
  CALL AD_UnPackairfoils_lb( Re_airfoils_LB_Buf, Db_airfoils_LB_Buf, Int_airfoils_LB_Buf, OutData%airfoils_LB, ErrStat, ErrMsg ) ! airfoils_LB 
 ! first call AD_Packtime_other to get correctly sized buffers for unpacking
  CALL AD_Packtime_other( Re_TIME_Buf, Db_TIME_Buf, Int_TIME_Buf, OutData%TIME, ErrStat, ErrMsg, .TRUE. ) ! TIME 
  IF(ALLOCATED(Re_TIME_Buf)) THEN
    Re_TIME_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TIME_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TIME_Buf)
  ENDIF
  IF(ALLOCATED(Db_TIME_Buf)) THEN
    Db_TIME_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TIME_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TIME_Buf)
  ENDIF
  IF(ALLOCATED(Int_TIME_Buf)) THEN
    Int_TIME_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TIME_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TIME_Buf)
  ENDIF
  CALL AD_UnPacktime_other( Re_TIME_Buf, Db_TIME_Buf, Int_TIME_Buf, OutData%TIME, ErrStat, ErrMsg ) ! TIME 
  OutData%NTW = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ntroll = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%StrtTime,1)))
  mask1 = .TRUE.
  OutData%StrtTime = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%StrtTime))-1 ),mask1,OutData%StrtTime)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%StrtTime)
  OutData%UsrTime1 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%UsrTime2 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%SimStrtTime,1)))
  mask1 = .TRUE.
  OutData%SimStrtTime = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SimStrtTime))-1 ),mask1,OutData%SimStrtTime)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%SimStrtTime)
  OutData%ZTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackFVM_OtherStateTYPE

 SUBROUTINE AD_CopyPositionType( SrcPositionTypeData, DstPositionTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(PositionType), INTENT(IN) :: SrcPositionTypeData
   TYPE(PositionType), INTENT(INOUT) :: DstPositionTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstPositionTypeData%Pos = SrcPositionTypeData%Pos
 END SUBROUTINE AD_CopyPositionType

 SUBROUTINE AD_DestroyPositionType( PositionTypeData, ErrStat, ErrMsg )
  TYPE(PositionType), INTENT(INOUT) :: PositionTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyPositionType

 SUBROUTINE AD_PackPositionType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(PositionType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Pos )  ! Pos 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Pos))-1 ) =  PACK(InData%Pos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Pos)
 END SUBROUTINE AD_PackPositionType

 SUBROUTINE AD_UnPackPositionType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(PositionType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Pos,1)))
  mask1 = .TRUE.
  OutData%Pos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Pos))-1 ),mask1,OutData%Pos)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Pos)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackPositionType

 SUBROUTINE AD_CopyOrientationType( SrcOrientationTypeData, DstOrientationTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(OrientationType), INTENT(IN) :: SrcOrientationTypeData
   TYPE(OrientationType), INTENT(INOUT) :: DstOrientationTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOrientationTypeData%Orient = SrcOrientationTypeData%Orient
 END SUBROUTINE AD_CopyOrientationType

 SUBROUTINE AD_DestroyOrientationType( OrientationTypeData, ErrStat, ErrMsg )
  TYPE(OrientationType), INTENT(INOUT) :: OrientationTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyOrientationType

 SUBROUTINE AD_PackOrientationType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(OrientationType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orient )  ! Orient 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orient))-1 ) =  PACK(InData%Orient ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orient)
 END SUBROUTINE AD_PackOrientationType

 SUBROUTINE AD_UnPackOrientationType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(OrientationType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%Orient,1),SIZE(OutData%Orient,2)))
  mask2 = .TRUE.
  OutData%Orient = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orient))-1 ),mask2,OutData%Orient)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orient)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOrientationType

 SUBROUTINE AD_CopyInitInput( SrcInitInputData, DstInitInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InitInputType), INTENT(IN) :: SrcInitInputData
   TYPE(AD_InitInputType), INTENT(INOUT) :: DstInitInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInitInputData%Title = SrcInitInputData%Title
   DstInitInputData%OutRootName = SrcInitInputData%OutRootName
   DstInitInputData%ADFileName = SrcInitInputData%ADFileName
   DstInitInputData%WindFileName = SrcInitInputData%WindFileName
   DstInitInputData%WrSumFile = SrcInitInputData%WrSumFile
   DstInitInputData%NumBl = SrcInitInputData%NumBl
   DstInitInputData%BladeLength = SrcInitInputData%BladeLength
   DstInitInputData%LinearizeFlag = SrcInitInputData%LinearizeFlag
   DstInitInputData%UseDWM = SrcInitInputData%UseDWM
      CALL AD_Copyaeroconfig( SrcInitInputData%TurbineComponents, DstInitInputData%TurbineComponents, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:TurbineComponents')
         IF (ErrStat>=AbortErrLev) RETURN
   DstInitInputData%NumTwrNodes = SrcInitInputData%NumTwrNodes
IF (ALLOCATED(SrcInitInputData%TwrNodeLocs)) THEN
   i1_l = LBOUND(SrcInitInputData%TwrNodeLocs,1)
   i1_u = UBOUND(SrcInitInputData%TwrNodeLocs,1)
   i2_l = LBOUND(SrcInitInputData%TwrNodeLocs,2)
   i2_u = UBOUND(SrcInitInputData%TwrNodeLocs,2)
   IF (.NOT. ALLOCATED(DstInitInputData%TwrNodeLocs)) THEN 
      ALLOCATE(DstInitInputData%TwrNodeLocs(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInitInputData%TwrNodeLocs.', ErrStat, ErrMsg,'AD_CopyInitInput')
         RETURN
      END IF
   END IF
   DstInitInputData%TwrNodeLocs = SrcInitInputData%TwrNodeLocs
ENDIF
      CALL IfW_CopyInitInput( SrcInitInputData%IfW_InitInputs, DstInitInputData%IfW_InitInputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:IfW_InitInputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInitInput( SrcInitInputData%DWM_InitInputs, DstInitInputData%DWM_InitInputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:DWM_InitInputs')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyInitInput

 SUBROUTINE AD_DestroyInitInput( InitInputData, ErrStat, ErrMsg )
  TYPE(AD_InitInputType), INTENT(INOUT) :: InitInputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyaeroconfig( InitInputData%TurbineComponents, ErrStat, ErrMsg )
IF (ALLOCATED(InitInputData%TwrNodeLocs)) THEN
   DEALLOCATE(InitInputData%TwrNodeLocs)
ENDIF
  CALL IfW_DestroyInitInput( InitInputData%IfW_InitInputs, ErrStat, ErrMsg )
  CALL DWM_DestroyInitInput( InitInputData%DWM_InitInputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitInput

 SUBROUTINE AD_PackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InitInputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_InitInputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_InitInputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_InitInputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for Title
!  missing buffer for OutRootName
!  missing buffer for ADFileName
!  missing buffer for WindFileName
  Int_BufSz  = Int_BufSz  + 1  ! WrSumFile
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  Int_BufSz  = Int_BufSz  + 1  ! LinearizeFlag
  Int_BufSz  = Int_BufSz  + 1  ! UseDWM
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  IF ( ALLOCATED(InData%TwrNodeLocs) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeLocs )  ! TwrNodeLocs 
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Int_IfW_InitInputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitInputs_Buf ) ! IfW_InitInputs
  IF(ALLOCATED(Re_IfW_InitInputs_Buf))  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF(ALLOCATED(Db_IfW_InitInputs_Buf))  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) DEALLOCATE(Int_IfW_InitInputs_Buf)
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, InData%DWM_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_InitInputs_Buf  ) ! DWM_InitInputs
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_InitInputs_Buf  ) ! DWM_InitInputs
  IF(ALLOCATED(Int_DWM_InitInputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_InitInputs_Buf ) ! DWM_InitInputs
  IF(ALLOCATED(Re_DWM_InitInputs_Buf))  DEALLOCATE(Re_DWM_InitInputs_Buf)
  IF(ALLOCATED(Db_DWM_InitInputs_Buf))  DEALLOCATE(Db_DWM_InitInputs_Buf)
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) DEALLOCATE(Int_DWM_InitInputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrSumFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%LinearizeFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseDWM ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeLocs) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeLocs))-1 ) =  PACK(InData%TwrNodeLocs ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeLocs)
  ENDIF
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, OnlySize ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 ) = Re_IfW_InitInputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 ) = Db_IfW_InitInputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 ) = Int_IfW_InitInputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitInputs_Buf) )  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF( ALLOCATED(Db_IfW_InitInputs_Buf) )  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF( ALLOCATED(Int_IfW_InitInputs_Buf) ) DEALLOCATE(Int_IfW_InitInputs_Buf)
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, InData%DWM_InitInputs, ErrStat, ErrMsg, OnlySize ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitInputs_Buf)-1 ) = Re_DWM_InitInputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitInputs_Buf)-1 ) = Db_DWM_InitInputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitInputs_Buf)-1 ) = Int_DWM_InitInputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitInputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_InitInputs_Buf) )  DEALLOCATE(Re_DWM_InitInputs_Buf)
  IF( ALLOCATED(Db_DWM_InitInputs_Buf) )  DEALLOCATE(Db_DWM_InitInputs_Buf)
  IF( ALLOCATED(Int_DWM_InitInputs_Buf) ) DEALLOCATE(Int_DWM_InitInputs_Buf)
 END SUBROUTINE AD_PackInitInput

 SUBROUTINE AD_UnPackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InitInputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_InitInputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_InitInputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_InitInputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeLocs) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrNodeLocs,1),SIZE(OutData%TwrNodeLocs,2)))
  mask2 = .TRUE.
    OutData%TwrNodeLocs = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeLocs))-1 ),mask2,OutData%TwrNodeLocs)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeLocs)
  ENDIF
 ! first call IfW_PackInitInput to get correctly sized buffers for unpacking
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    Re_IfW_InitInputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    Db_IfW_InitInputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    Int_IfW_InitInputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  CALL IfW_UnPackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg ) ! IfW_InitInputs 
 ! first call DWM_PackInitInput to get correctly sized buffers for unpacking
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, OutData%DWM_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) THEN
    Re_DWM_InitInputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitInputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) THEN
    Db_DWM_InitInputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitInputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) THEN
    Int_DWM_InitInputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitInputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitInputs_Buf)
  ENDIF
  CALL DWM_UnPackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, OutData%DWM_InitInputs, ErrStat, ErrMsg ) ! DWM_InitInputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitInput

 SUBROUTINE AD_CopyInitOutput( SrcInitOutputData, DstInitOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InitOutputType), INTENT(IN) :: SrcInitOutputData
   TYPE(AD_InitOutputType), INTENT(INOUT) :: DstInitOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL NWTC_Library_Copyprogdesc( SrcInitOutputData%Ver, DstInitOutputData%Ver, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:Ver')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyInitOutput( SrcInitOutputData%IfW_InitOutput, DstInitOutputData%IfW_InitOutput, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:IfW_InitOutput')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInitOutput( SrcInitOutputData%DWM_InitOutput, DstInitOutputData%DWM_InitOutput, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:DWM_InitOutput')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyInitOutput

 SUBROUTINE AD_DestroyInitOutput( InitOutputData, ErrStat, ErrMsg )
  TYPE(AD_InitOutputType), INTENT(INOUT) :: InitOutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL NWTC_Library_Destroyprogdesc( InitOutputData%Ver, ErrStat, ErrMsg )
  CALL IfW_DestroyInitOutput( InitOutputData%IfW_InitOutput, ErrStat, ErrMsg )
  CALL DWM_DestroyInitOutput( InitOutputData%DWM_InitOutput, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitOutput

 SUBROUTINE AD_PackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InitOutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_InitOutput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_InitOutput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_InitOutput_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Db_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Int_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ver_Buf ) ! Ver
  IF(ALLOCATED(Re_Ver_Buf))  DEALLOCATE(Re_Ver_Buf)
  IF(ALLOCATED(Db_Ver_Buf))  DEALLOCATE(Db_Ver_Buf)
  IF(ALLOCATED(Int_Ver_Buf)) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Int_IfW_InitOutput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitOutput_Buf ) ! IfW_InitOutput
  IF(ALLOCATED(Re_IfW_InitOutput_Buf))  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF(ALLOCATED(Db_IfW_InitOutput_Buf))  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) DEALLOCATE(Int_IfW_InitOutput_Buf)
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, InData%DWM_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_InitOutput_Buf  ) ! DWM_InitOutput
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_InitOutput_Buf  ) ! DWM_InitOutput
  IF(ALLOCATED(Int_DWM_InitOutput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_InitOutput_Buf ) ! DWM_InitOutput
  IF(ALLOCATED(Re_DWM_InitOutput_Buf))  DEALLOCATE(Re_DWM_InitOutput_Buf)
  IF(ALLOCATED(Db_DWM_InitOutput_Buf))  DEALLOCATE(Db_DWM_InitOutput_Buf)
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) DEALLOCATE(Int_DWM_InitOutput_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, OnlySize ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 ) = Re_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 ) = Db_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 ) = Int_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ver_Buf) )  DEALLOCATE(Re_Ver_Buf)
  IF( ALLOCATED(Db_Ver_Buf) )  DEALLOCATE(Db_Ver_Buf)
  IF( ALLOCATED(Int_Ver_Buf) ) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, OnlySize ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 ) = Re_IfW_InitOutput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 ) = Db_IfW_InitOutput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 ) = Int_IfW_InitOutput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitOutput_Buf) )  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF( ALLOCATED(Db_IfW_InitOutput_Buf) )  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF( ALLOCATED(Int_IfW_InitOutput_Buf) ) DEALLOCATE(Int_IfW_InitOutput_Buf)
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, InData%DWM_InitOutput, ErrStat, ErrMsg, OnlySize ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitOutput_Buf)-1 ) = Re_DWM_InitOutput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitOutput_Buf)-1 ) = Db_DWM_InitOutput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitOutput_Buf)-1 ) = Int_DWM_InitOutput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitOutput_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_InitOutput_Buf) )  DEALLOCATE(Re_DWM_InitOutput_Buf)
  IF( ALLOCATED(Db_DWM_InitOutput_Buf) )  DEALLOCATE(Db_DWM_InitOutput_Buf)
  IF( ALLOCATED(Int_DWM_InitOutput_Buf) ) DEALLOCATE(Int_DWM_InitOutput_Buf)
 END SUBROUTINE AD_PackInitOutput

 SUBROUTINE AD_UnPackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InitOutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_InitOutput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_InitOutput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_InitOutput_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    Re_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    Db_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    Int_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg ) ! Ver 
 ! first call IfW_PackInitOutput to get correctly sized buffers for unpacking
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    Re_IfW_InitOutput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    Db_IfW_InitOutput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    Int_IfW_InitOutput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  CALL IfW_UnPackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg ) ! IfW_InitOutput 
 ! first call DWM_PackInitOutput to get correctly sized buffers for unpacking
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, OutData%DWM_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) THEN
    Re_DWM_InitOutput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitOutput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) THEN
    Db_DWM_InitOutput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitOutput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) THEN
    Int_DWM_InitOutput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitOutput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitOutput_Buf)
  ENDIF
  CALL DWM_UnPackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, OutData%DWM_InitOutput, ErrStat, ErrMsg ) ! DWM_InitOutput 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitOutput

 SUBROUTINE AD_CopyContState( SrcContStateData, DstContStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ContinuousStateType), INTENT(IN) :: SrcContStateData
   TYPE(AD_ContinuousStateType), INTENT(INOUT) :: DstContStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyContState( SrcContStateData%IfW_ContStates, DstContStateData%IfW_ContStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyContState:IfW_ContStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyContState( SrcContStateData%DWM_ContStates, DstContStateData%DWM_ContStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyContState:DWM_ContStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyContState

 SUBROUTINE AD_DestroyContState( ContStateData, ErrStat, ErrMsg )
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: ContStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyContState( ContStateData%IfW_ContStates, ErrStat, ErrMsg )
  CALL DWM_DestroyContState( ContStateData%DWM_ContStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyContState

 SUBROUTINE AD_PackContState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ContinuousStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_ContStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_ContStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_ContStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Int_IfW_ContStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ContStates_Buf ) ! IfW_ContStates
  IF(ALLOCATED(Re_IfW_ContStates_Buf))  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF(ALLOCATED(Db_IfW_ContStates_Buf))  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) DEALLOCATE(Int_IfW_ContStates_Buf)
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, InData%DWM_ContStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_ContStates_Buf  ) ! DWM_ContStates
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_ContStates_Buf  ) ! DWM_ContStates
  IF(ALLOCATED(Int_DWM_ContStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_ContStates_Buf ) ! DWM_ContStates
  IF(ALLOCATED(Re_DWM_ContStates_Buf))  DEALLOCATE(Re_DWM_ContStates_Buf)
  IF(ALLOCATED(Db_DWM_ContStates_Buf))  DEALLOCATE(Db_DWM_ContStates_Buf)
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) DEALLOCATE(Int_DWM_ContStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 ) = Re_IfW_ContStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 ) = Db_IfW_ContStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 ) = Int_IfW_ContStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ContStates_Buf) )  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF( ALLOCATED(Db_IfW_ContStates_Buf) )  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF( ALLOCATED(Int_IfW_ContStates_Buf) ) DEALLOCATE(Int_IfW_ContStates_Buf)
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, InData%DWM_ContStates, ErrStat, ErrMsg, OnlySize ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ContStates_Buf)-1 ) = Re_DWM_ContStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ContStates_Buf)-1 ) = Db_DWM_ContStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ContStates_Buf)-1 ) = Int_DWM_ContStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ContStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_ContStates_Buf) )  DEALLOCATE(Re_DWM_ContStates_Buf)
  IF( ALLOCATED(Db_DWM_ContStates_Buf) )  DEALLOCATE(Db_DWM_ContStates_Buf)
  IF( ALLOCATED(Int_DWM_ContStates_Buf) ) DEALLOCATE(Int_DWM_ContStates_Buf)
 END SUBROUTINE AD_PackContState

 SUBROUTINE AD_UnPackContState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_ContStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_ContStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_ContStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackContState to get correctly sized buffers for unpacking
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    Re_IfW_ContStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    Db_IfW_ContStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    Int_IfW_ContStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  CALL IfW_UnPackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg ) ! IfW_ContStates 
 ! first call DWM_PackContState to get correctly sized buffers for unpacking
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, OutData%DWM_ContStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) THEN
    Re_DWM_ContStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ContStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) THEN
    Db_DWM_ContStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ContStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) THEN
    Int_DWM_ContStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ContStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ContStates_Buf)
  ENDIF
  CALL DWM_UnPackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, OutData%DWM_ContStates, ErrStat, ErrMsg ) ! DWM_ContStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackContState

 SUBROUTINE AD_CopyDiscState( SrcDiscStateData, DstDiscStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_DiscreteStateType), INTENT(IN) :: SrcDiscStateData
   TYPE(AD_DiscreteStateType), INTENT(INOUT) :: DstDiscStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyDiscState( SrcDiscStateData%IfW_DiscStates, DstDiscStateData%IfW_DiscStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyDiscState:IfW_DiscStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyDiscState( SrcDiscStateData%DWM_DiscStates, DstDiscStateData%DWM_DiscStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyDiscState:DWM_DiscStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyDiscState

 SUBROUTINE AD_DestroyDiscState( DiscStateData, ErrStat, ErrMsg )
  TYPE(AD_DiscreteStateType), INTENT(INOUT) :: DiscStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyDiscState( DiscStateData%IfW_DiscStates, ErrStat, ErrMsg )
  CALL DWM_DestroyDiscState( DiscStateData%DWM_DiscStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyDiscState

 SUBROUTINE AD_PackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_DiscreteStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_DiscStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_DiscStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_DiscStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Int_IfW_DiscStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_DiscStates_Buf ) ! IfW_DiscStates
  IF(ALLOCATED(Re_IfW_DiscStates_Buf))  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF(ALLOCATED(Db_IfW_DiscStates_Buf))  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) DEALLOCATE(Int_IfW_DiscStates_Buf)
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, InData%DWM_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_DiscStates_Buf  ) ! DWM_DiscStates
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_DiscStates_Buf  ) ! DWM_DiscStates
  IF(ALLOCATED(Int_DWM_DiscStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_DiscStates_Buf ) ! DWM_DiscStates
  IF(ALLOCATED(Re_DWM_DiscStates_Buf))  DEALLOCATE(Re_DWM_DiscStates_Buf)
  IF(ALLOCATED(Db_DWM_DiscStates_Buf))  DEALLOCATE(Db_DWM_DiscStates_Buf)
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) DEALLOCATE(Int_DWM_DiscStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, OnlySize ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 ) = Re_IfW_DiscStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 ) = Db_IfW_DiscStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 ) = Int_IfW_DiscStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_DiscStates_Buf) )  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF( ALLOCATED(Db_IfW_DiscStates_Buf) )  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF( ALLOCATED(Int_IfW_DiscStates_Buf) ) DEALLOCATE(Int_IfW_DiscStates_Buf)
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, InData%DWM_DiscStates, ErrStat, ErrMsg, OnlySize ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_DiscStates_Buf)-1 ) = Re_DWM_DiscStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_DiscStates_Buf)-1 ) = Db_DWM_DiscStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_DiscStates_Buf)-1 ) = Int_DWM_DiscStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_DiscStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_DiscStates_Buf) )  DEALLOCATE(Re_DWM_DiscStates_Buf)
  IF( ALLOCATED(Db_DWM_DiscStates_Buf) )  DEALLOCATE(Db_DWM_DiscStates_Buf)
  IF( ALLOCATED(Int_DWM_DiscStates_Buf) ) DEALLOCATE(Int_DWM_DiscStates_Buf)
 END SUBROUTINE AD_PackDiscState

 SUBROUTINE AD_UnPackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_DiscreteStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_DiscStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_DiscStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_DiscStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackDiscState to get correctly sized buffers for unpacking
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    Re_IfW_DiscStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    Db_IfW_DiscStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    Int_IfW_DiscStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  CALL IfW_UnPackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg ) ! IfW_DiscStates 
 ! first call DWM_PackDiscState to get correctly sized buffers for unpacking
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, OutData%DWM_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) THEN
    Re_DWM_DiscStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_DiscStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) THEN
    Db_DWM_DiscStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_DiscStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) THEN
    Int_DWM_DiscStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_DiscStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_DiscStates_Buf)
  ENDIF
  CALL DWM_UnPackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, OutData%DWM_DiscStates, ErrStat, ErrMsg ) ! DWM_DiscStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDiscState

 SUBROUTINE AD_CopyConstrState( SrcConstrStateData, DstConstrStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ConstraintStateType), INTENT(IN) :: SrcConstrStateData
   TYPE(AD_ConstraintStateType), INTENT(INOUT) :: DstConstrStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyConstrState( SrcConstrStateData%IfW_ConstrStates, DstConstrStateData%IfW_ConstrStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyConstrState:IfW_ConstrStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyConstrState( SrcConstrStateData%DWM_ConstrStates, DstConstrStateData%DWM_ConstrStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyConstrState:DWM_ConstrStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyConstrState

 SUBROUTINE AD_DestroyConstrState( ConstrStateData, ErrStat, ErrMsg )
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyConstrState( ConstrStateData%IfW_ConstrStates, ErrStat, ErrMsg )
  CALL DWM_DestroyConstrState( ConstrStateData%DWM_ConstrStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyConstrState

 SUBROUTINE AD_PackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ConstraintStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_ConstrStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_ConstrStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_ConstrStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ConstrStates_Buf ) ! IfW_ConstrStates
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf))  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf))  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) DEALLOCATE(Int_IfW_ConstrStates_Buf)
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, InData%DWM_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_ConstrStates_Buf  ) ! DWM_ConstrStates
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_ConstrStates_Buf  ) ! DWM_ConstrStates
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_ConstrStates_Buf ) ! DWM_ConstrStates
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf))  DEALLOCATE(Re_DWM_ConstrStates_Buf)
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf))  DEALLOCATE(Db_DWM_ConstrStates_Buf)
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) DEALLOCATE(Int_DWM_ConstrStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 ) = Re_IfW_ConstrStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 ) = Db_IfW_ConstrStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 ) = Int_IfW_ConstrStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ConstrStates_Buf) )  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Db_IfW_ConstrStates_Buf) )  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Int_IfW_ConstrStates_Buf) ) DEALLOCATE(Int_IfW_ConstrStates_Buf)
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, InData%DWM_ConstrStates, ErrStat, ErrMsg, OnlySize ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ConstrStates_Buf)-1 ) = Re_DWM_ConstrStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ConstrStates_Buf)-1 ) = Db_DWM_ConstrStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ConstrStates_Buf)-1 ) = Int_DWM_ConstrStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ConstrStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_ConstrStates_Buf) )  DEALLOCATE(Re_DWM_ConstrStates_Buf)
  IF( ALLOCATED(Db_DWM_ConstrStates_Buf) )  DEALLOCATE(Db_DWM_ConstrStates_Buf)
  IF( ALLOCATED(Int_DWM_ConstrStates_Buf) ) DEALLOCATE(Int_DWM_ConstrStates_Buf)
 END SUBROUTINE AD_PackConstrState

 SUBROUTINE AD_UnPackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_ConstrStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_ConstrStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_ConstrStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackConstrState to get correctly sized buffers for unpacking
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    Re_IfW_ConstrStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    Db_IfW_ConstrStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    Int_IfW_ConstrStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  CALL IfW_UnPackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg ) ! IfW_ConstrStates 
 ! first call DWM_PackConstrState to get correctly sized buffers for unpacking
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, OutData%DWM_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) THEN
    Re_DWM_ConstrStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ConstrStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) THEN
    Db_DWM_ConstrStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ConstrStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) THEN
    Int_DWM_ConstrStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ConstrStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ConstrStates_Buf)
  ENDIF
  CALL DWM_UnPackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, OutData%DWM_ConstrStates, ErrStat, ErrMsg ) ! DWM_ConstrStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackConstrState

 SUBROUTINE AD_CopyOtherState( SrcOtherStateData, DstOtherStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_OtherStateType), INTENT(IN) :: SrcOtherStateData
   TYPE(AD_OtherStateType), INTENT(INOUT) :: DstOtherStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOtherStateData%DT = SrcOtherStateData%DT
IF (ALLOCATED(SrcOtherStateData%ElPrNum)) THEN
   i1_l = LBOUND(SrcOtherStateData%ElPrNum,1)
   i1_u = UBOUND(SrcOtherStateData%ElPrNum,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%ElPrNum)) THEN 
      ALLOCATE(DstOtherStateData%ElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%ElPrNum.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%ElPrNum = SrcOtherStateData%ElPrNum
ENDIF
   DstOtherStateData%OldTime = SrcOtherStateData%OldTime
   DstOtherStateData%HubLoss = SrcOtherStateData%HubLoss
   DstOtherStateData%Loss = SrcOtherStateData%Loss
   DstOtherStateData%TipLoss = SrcOtherStateData%TipLoss
   DstOtherStateData%TLpt7 = SrcOtherStateData%TLpt7
   DstOtherStateData%FirstPassGTL = SrcOtherStateData%FirstPassGTL
   DstOtherStateData%SuperSonic = SrcOtherStateData%SuperSonic
   DstOtherStateData%AFLAGVinderr = SrcOtherStateData%AFLAGVinderr
   DstOtherStateData%AFLAGTwrInflu = SrcOtherStateData%AFLAGTwrInflu
   DstOtherStateData%OnePassDynDbg = SrcOtherStateData%OnePassDynDbg
   DstOtherStateData%NoLoadsCalculated = SrcOtherStateData%NoLoadsCalculated
   DstOtherStateData%NERRORS = SrcOtherStateData%NERRORS
      CALL IfW_CopyOtherState( SrcOtherStateData%IfW_OtherStates, DstOtherStateData%IfW_OtherStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:IfW_OtherStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyOtherState( SrcOtherStateData%DWM_OtherStates, DstOtherStateData%DWM_OtherStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DWM_OtherStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyairfoil( SrcOtherStateData%AirFoil, DstOtherStateData%AirFoil, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:AirFoil')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybeddoes( SrcOtherStateData%Beddoes, DstOtherStateData%Beddoes, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Beddoes')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copydyninflow( SrcOtherStateData%DynInflow, DstOtherStateData%DynInflow, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DynInflow')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyelement( SrcOtherStateData%Element, DstOtherStateData%Element, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Element')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyrotor( SrcOtherStateData%Rotor, DstOtherStateData%Rotor, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Rotor')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copywind( SrcOtherStateData%Wind, DstOtherStateData%Wind, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Wind')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyinducedvel( SrcOtherStateData%InducedVel, DstOtherStateData%InducedVel, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:InducedVel')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcOtherStateData%StoredForces)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredForces,1)
   i1_u = UBOUND(SrcOtherStateData%StoredForces,1)
   i2_l = LBOUND(SrcOtherStateData%StoredForces,2)
   i2_u = UBOUND(SrcOtherStateData%StoredForces,2)
   i3_l = LBOUND(SrcOtherStateData%StoredForces,3)
   i3_u = UBOUND(SrcOtherStateData%StoredForces,3)
   IF (.NOT. ALLOCATED(DstOtherStateData%StoredForces)) THEN 
      ALLOCATE(DstOtherStateData%StoredForces(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%StoredForces.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredForces = SrcOtherStateData%StoredForces
ENDIF
IF (ALLOCATED(SrcOtherStateData%StoredMoments)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredMoments,1)
   i1_u = UBOUND(SrcOtherStateData%StoredMoments,1)
   i2_l = LBOUND(SrcOtherStateData%StoredMoments,2)
   i2_u = UBOUND(SrcOtherStateData%StoredMoments,2)
   i3_l = LBOUND(SrcOtherStateData%StoredMoments,3)
   i3_u = UBOUND(SrcOtherStateData%StoredMoments,3)
   IF (.NOT. ALLOCATED(DstOtherStateData%StoredMoments)) THEN 
      ALLOCATE(DstOtherStateData%StoredMoments(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%StoredMoments.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredMoments = SrcOtherStateData%StoredMoments
ENDIF
   DstOtherStateData%FirstWarn = SrcOtherStateData%FirstWarn
      CALL AD_Copyeloutparms( SrcOtherStateData%ElOut, DstOtherStateData%ElOut, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:ElOut')
         IF (ErrStat>=AbortErrLev) RETURN
   DstOtherStateData%Skew = SrcOtherStateData%Skew
   DstOtherStateData%DynInit = SrcOtherStateData%DynInit
      CALL IfW_CopyInput( SrcOtherStateData%IfW_Inputs, DstOtherStateData%IfW_Inputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:IfW_Inputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInput( SrcOtherStateData%DWM_Inputs, DstOtherStateData%DWM_Inputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DWM_Inputs')
         IF (ErrStat>=AbortErrLev) RETURN
   DstOtherStateData%Aerodyn_Timestep = SrcOtherStateData%Aerodyn_Timestep
   DstOtherStateData%WINDS_Timestep = SrcOtherStateData%WINDS_Timestep
      CALL AD_Copyfvm_otherstatetype( SrcOtherStateData%FVM_Other, DstOtherStateData%FVM_Other, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:FVM_Other')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyOtherState

 SUBROUTINE AD_DestroyOtherState( OtherStateData, ErrStat, ErrMsg )
  TYPE(AD_OtherStateType), INTENT(INOUT) :: OtherStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OtherStateData%ElPrNum)) THEN
   DEALLOCATE(OtherStateData%ElPrNum)
ENDIF
  CALL IfW_DestroyOtherState( OtherStateData%IfW_OtherStates, ErrStat, ErrMsg )
  CALL DWM_DestroyOtherState( OtherStateData%DWM_OtherStates, ErrStat, ErrMsg )
  CALL AD_Destroyairfoil( OtherStateData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybeddoes( OtherStateData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflow( OtherStateData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelement( OtherStateData%Element, ErrStat, ErrMsg )
  CALL AD_Destroyrotor( OtherStateData%Rotor, ErrStat, ErrMsg )
  CALL AD_Destroywind( OtherStateData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvel( OtherStateData%InducedVel, ErrStat, ErrMsg )
IF (ALLOCATED(OtherStateData%StoredForces)) THEN
   DEALLOCATE(OtherStateData%StoredForces)
ENDIF
IF (ALLOCATED(OtherStateData%StoredMoments)) THEN
   DEALLOCATE(OtherStateData%StoredMoments)
ENDIF
  CALL AD_Destroyeloutparms( OtherStateData%ElOut, ErrStat, ErrMsg )
  CALL IfW_DestroyInput( OtherStateData%IfW_Inputs, ErrStat, ErrMsg )
  CALL DWM_DestroyInput( OtherStateData%DWM_Inputs, ErrStat, ErrMsg )
  CALL AD_Destroyfvm_otherstatetype( OtherStateData%FVM_Other, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOtherState

 SUBROUTINE AD_PackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_OtherStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_OtherStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_OtherStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_OtherStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ElOut_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Inputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Inputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Inputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_FVM_Other_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_FVM_Other_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_FVM_Other_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  IF ( ALLOCATED(InData%ElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Db_BufSz   = Db_BufSz   + 1  ! OldTime
  Re_BufSz   = Re_BufSz   + 1  ! HubLoss
  Re_BufSz   = Re_BufSz   + 1  ! Loss
  Re_BufSz   = Re_BufSz   + 1  ! TipLoss
  Re_BufSz   = Re_BufSz   + 1  ! TLpt7
  Int_BufSz  = Int_BufSz  + 1  ! FirstPassGTL
  Int_BufSz  = Int_BufSz  + 1  ! SuperSonic
  Int_BufSz  = Int_BufSz  + 1  ! AFLAGVinderr
  Int_BufSz  = Int_BufSz  + 1  ! AFLAGTwrInflu
  Int_BufSz  = Int_BufSz  + 1  ! OnePassDynDbg
  Int_BufSz  = Int_BufSz  + 1  ! NoLoadsCalculated
  Int_BufSz  = Int_BufSz  + 1  ! NERRORS
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Int_IfW_OtherStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_OtherStates_Buf ) ! IfW_OtherStates
  IF(ALLOCATED(Re_IfW_OtherStates_Buf))  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF(ALLOCATED(Db_IfW_OtherStates_Buf))  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, InData%DWM_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_OtherStates_Buf  ) ! DWM_OtherStates
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_OtherStates_Buf  ) ! DWM_OtherStates
  IF(ALLOCATED(Int_DWM_OtherStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_OtherStates_Buf ) ! DWM_OtherStates
  IF(ALLOCATED(Re_DWM_OtherStates_Buf))  DEALLOCATE(Re_DWM_OtherStates_Buf)
  IF(ALLOCATED(Db_DWM_OtherStates_Buf))  DEALLOCATE(Db_DWM_OtherStates_Buf)
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) DEALLOCATE(Int_DWM_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  IF ( ALLOCATED(InData%StoredForces) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StoredForces )  ! StoredForces 
  IF ( ALLOCATED(InData%StoredMoments) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StoredMoments )  ! StoredMoments 
  Int_BufSz  = Int_BufSz  + 1  ! FirstWarn
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Db_ElOut_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Int_ElOut_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ElOut_Buf ) ! ElOut
  IF(ALLOCATED(Re_ElOut_Buf))  DEALLOCATE(Re_ElOut_Buf)
  IF(ALLOCATED(Db_ElOut_Buf))  DEALLOCATE(Db_ElOut_Buf)
  IF(ALLOCATED(Int_ElOut_Buf)) DEALLOCATE(Int_ElOut_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! Skew
  Int_BufSz  = Int_BufSz  + 1  ! DynInit
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Int_IfW_Inputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Inputs_Buf ) ! IfW_Inputs
  IF(ALLOCATED(Re_IfW_Inputs_Buf))  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF(ALLOCATED(Db_IfW_Inputs_Buf))  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) DEALLOCATE(Int_IfW_Inputs_Buf)
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, InData%DWM_Inputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Inputs_Buf  ) ! DWM_Inputs
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Inputs_Buf  ) ! DWM_Inputs
  IF(ALLOCATED(Int_DWM_Inputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Inputs_Buf ) ! DWM_Inputs
  IF(ALLOCATED(Re_DWM_Inputs_Buf))  DEALLOCATE(Re_DWM_Inputs_Buf)
  IF(ALLOCATED(Db_DWM_Inputs_Buf))  DEALLOCATE(Db_DWM_Inputs_Buf)
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) DEALLOCATE(Int_DWM_Inputs_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! Aerodyn_Timestep
  Int_BufSz  = Int_BufSz  + 1  ! WINDS_Timestep
  CALL AD_Packfvm_otherstatetype( Re_FVM_Other_Buf, Db_FVM_Other_Buf, Int_FVM_Other_Buf, InData%FVM_Other, ErrStat, ErrMsg, .TRUE. ) ! FVM_Other 
  IF(ALLOCATED(Re_FVM_Other_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_FVM_Other_Buf  ) ! FVM_Other
  IF(ALLOCATED(Db_FVM_Other_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_FVM_Other_Buf  ) ! FVM_Other
  IF(ALLOCATED(Int_FVM_Other_Buf))Int_BufSz = Int_BufSz + SIZE( Int_FVM_Other_Buf ) ! FVM_Other
  IF(ALLOCATED(Re_FVM_Other_Buf))  DEALLOCATE(Re_FVM_Other_Buf)
  IF(ALLOCATED(Db_FVM_Other_Buf))  DEALLOCATE(Db_FVM_Other_Buf)
  IF(ALLOCATED(Int_FVM_Other_Buf)) DEALLOCATE(Int_FVM_Other_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%OldTime )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Loss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TLpt7 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FirstPassGTL ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SuperSonic ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%AFLAGVinderr ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%AFLAGTwrInflu ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%OnePassDynDbg ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%NoLoadsCalculated ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NERRORS )
  Int_Xferred   = Int_Xferred   + 1
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, OnlySize ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 ) = Re_IfW_OtherStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 ) = Db_IfW_OtherStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 ) = Int_IfW_OtherStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_OtherStates_Buf) )  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF( ALLOCATED(Db_IfW_OtherStates_Buf) )  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF( ALLOCATED(Int_IfW_OtherStates_Buf) ) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, InData%DWM_OtherStates, ErrStat, ErrMsg, OnlySize ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_OtherStates_Buf)-1 ) = Re_DWM_OtherStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_OtherStates_Buf)-1 ) = Db_DWM_OtherStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_OtherStates_Buf)-1 ) = Int_DWM_OtherStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_OtherStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_OtherStates_Buf) )  DEALLOCATE(Re_DWM_OtherStates_Buf)
  IF( ALLOCATED(Db_DWM_OtherStates_Buf) )  DEALLOCATE(Db_DWM_OtherStates_Buf)
  IF( ALLOCATED(Int_DWM_OtherStates_Buf) ) DEALLOCATE(Int_DWM_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  IF ( ALLOCATED(InData%StoredForces) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredForces))-1 ) =  PACK(InData%StoredForces ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredForces)
  ENDIF
  IF ( ALLOCATED(InData%StoredMoments) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredMoments))-1 ) =  PACK(InData%StoredMoments ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredMoments)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FirstWarn ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, OnlySize ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 ) = Re_ElOut_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 ) = Db_ElOut_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 ) = Int_ElOut_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  IF( ALLOCATED(Re_ElOut_Buf) )  DEALLOCATE(Re_ElOut_Buf)
  IF( ALLOCATED(Db_ElOut_Buf) )  DEALLOCATE(Db_ElOut_Buf)
  IF( ALLOCATED(Int_ElOut_Buf) ) DEALLOCATE(Int_ElOut_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Skew ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DynInit ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 ) = Re_IfW_Inputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 ) = Db_IfW_Inputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 ) = Int_IfW_Inputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Inputs_Buf) )  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF( ALLOCATED(Db_IfW_Inputs_Buf) )  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF( ALLOCATED(Int_IfW_Inputs_Buf) ) DEALLOCATE(Int_IfW_Inputs_Buf)
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, InData%DWM_Inputs, ErrStat, ErrMsg, OnlySize ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Inputs_Buf)-1 ) = Re_DWM_Inputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Inputs_Buf)-1 ) = Db_DWM_Inputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Inputs_Buf)-1 ) = Int_DWM_Inputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Inputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Inputs_Buf) )  DEALLOCATE(Re_DWM_Inputs_Buf)
  IF( ALLOCATED(Db_DWM_Inputs_Buf) )  DEALLOCATE(Db_DWM_Inputs_Buf)
  IF( ALLOCATED(Int_DWM_Inputs_Buf) ) DEALLOCATE(Int_DWM_Inputs_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%Aerodyn_Timestep )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%WINDS_Timestep )
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packfvm_otherstatetype( Re_FVM_Other_Buf, Db_FVM_Other_Buf, Int_FVM_Other_Buf, InData%FVM_Other, ErrStat, ErrMsg, OnlySize ) ! FVM_Other 
  IF(ALLOCATED(Re_FVM_Other_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_FVM_Other_Buf)-1 ) = Re_FVM_Other_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_FVM_Other_Buf)
  ENDIF
  IF(ALLOCATED(Db_FVM_Other_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_FVM_Other_Buf)-1 ) = Db_FVM_Other_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_FVM_Other_Buf)
  ENDIF
  IF(ALLOCATED(Int_FVM_Other_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_FVM_Other_Buf)-1 ) = Int_FVM_Other_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_FVM_Other_Buf)
  ENDIF
  IF( ALLOCATED(Re_FVM_Other_Buf) )  DEALLOCATE(Re_FVM_Other_Buf)
  IF( ALLOCATED(Db_FVM_Other_Buf) )  DEALLOCATE(Db_FVM_Other_Buf)
  IF( ALLOCATED(Int_FVM_Other_Buf) ) DEALLOCATE(Int_FVM_Other_Buf)
 END SUBROUTINE AD_PackOtherState

 SUBROUTINE AD_UnPackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_OtherStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_OtherStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_OtherStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_OtherStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ElOut_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Inputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Inputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Inputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_FVM_Other_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_FVM_Other_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_FVM_Other_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1)))
  mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%OldTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Loss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TLpt7 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NERRORS = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call IfW_PackOtherState to get correctly sized buffers for unpacking
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    Re_IfW_OtherStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    Db_IfW_OtherStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    Int_IfW_OtherStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  CALL IfW_UnPackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg ) ! IfW_OtherStates 
 ! first call DWM_PackOtherState to get correctly sized buffers for unpacking
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, OutData%DWM_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) THEN
    Re_DWM_OtherStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_OtherStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) THEN
    Db_DWM_OtherStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_OtherStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) THEN
    Int_DWM_OtherStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_OtherStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_OtherStates_Buf)
  ENDIF
  CALL DWM_UnPackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, OutData%DWM_OtherStates, ErrStat, ErrMsg ) ! DWM_OtherStates 
 ! first call AD_Packairfoil to get correctly sized buffers for unpacking
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbeddoes to get correctly sized buffers for unpacking
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflow to get correctly sized buffers for unpacking
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelement to get correctly sized buffers for unpacking
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packrotor to get correctly sized buffers for unpacking
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call AD_Packwind to get correctly sized buffers for unpacking
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packinducedvel to get correctly sized buffers for unpacking
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
  IF ( ALLOCATED(OutData%StoredForces) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredForces,1),SIZE(OutData%StoredForces,2),SIZE(OutData%StoredForces,3)))
  mask3 = .TRUE.
    OutData%StoredForces = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredForces))-1 ),mask3,OutData%StoredForces)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredForces)
  ENDIF
  IF ( ALLOCATED(OutData%StoredMoments) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredMoments,1),SIZE(OutData%StoredMoments,2),SIZE(OutData%StoredMoments,3)))
  mask3 = .TRUE.
    OutData%StoredMoments = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredMoments))-1 ),mask3,OutData%StoredMoments)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredMoments)
  ENDIF
 ! first call AD_Packeloutparms to get correctly sized buffers for unpacking
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    Re_ElOut_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    Db_ElOut_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    Int_ElOut_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  CALL AD_UnPackeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg ) ! ElOut 
 ! first call IfW_PackInput to get correctly sized buffers for unpacking
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    Re_IfW_Inputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    Db_IfW_Inputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    Int_IfW_Inputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  CALL IfW_UnPackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg ) ! IfW_Inputs 
 ! first call DWM_PackInput to get correctly sized buffers for unpacking
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, OutData%DWM_Inputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) THEN
    Re_DWM_Inputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Inputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) THEN
    Db_DWM_Inputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Inputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) THEN
    Int_DWM_Inputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Inputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Inputs_Buf)
  ENDIF
  CALL DWM_UnPackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, OutData%DWM_Inputs, ErrStat, ErrMsg ) ! DWM_Inputs 
  OutData%Aerodyn_Timestep = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%WINDS_Timestep = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packfvm_otherstatetype to get correctly sized buffers for unpacking
  CALL AD_Packfvm_otherstatetype( Re_FVM_Other_Buf, Db_FVM_Other_Buf, Int_FVM_Other_Buf, OutData%FVM_Other, ErrStat, ErrMsg, .TRUE. ) ! FVM_Other 
  IF(ALLOCATED(Re_FVM_Other_Buf)) THEN
    Re_FVM_Other_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_FVM_Other_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_FVM_Other_Buf)
  ENDIF
  IF(ALLOCATED(Db_FVM_Other_Buf)) THEN
    Db_FVM_Other_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_FVM_Other_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_FVM_Other_Buf)
  ENDIF
  IF(ALLOCATED(Int_FVM_Other_Buf)) THEN
    Int_FVM_Other_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_FVM_Other_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_FVM_Other_Buf)
  ENDIF
  CALL AD_UnPackfvm_otherstatetype( Re_FVM_Other_Buf, Db_FVM_Other_Buf, Int_FVM_Other_Buf, OutData%FVM_Other, ErrStat, ErrMsg ) ! FVM_Other 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOtherState

 SUBROUTINE AD_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ParameterType), INTENT(IN) :: SrcParamData
   TYPE(AD_ParameterType), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%Title = SrcParamData%Title
   DstParamData%WindFileName = SrcParamData%WindFileName
   DstParamData%SIUnit = SrcParamData%SIUnit
   DstParamData%Echo = SrcParamData%Echo
   DstParamData%MultiTab = SrcParamData%MultiTab
   DstParamData%LinearizeFlag = SrcParamData%LinearizeFlag
   DstParamData%OutputPlottingInfo = SrcParamData%OutputPlottingInfo
   DstParamData%Initialized = SrcParamData%Initialized
   DstParamData%UseDWM = SrcParamData%UseDWM
   DstParamData%TwoPiNB = SrcParamData%TwoPiNB
   DstParamData%NumBl = SrcParamData%NumBl
   DstParamData%NBlInpSt = SrcParamData%NBlInpSt
   DstParamData%ElemPrn = SrcParamData%ElemPrn
   DstParamData%DStall = SrcParamData%DStall
   DstParamData%PMoment = SrcParamData%PMoment
   DstParamData%Reynolds = SrcParamData%Reynolds
   DstParamData%DynInfl = SrcParamData%DynInfl
   DstParamData%Wake = SrcParamData%Wake
   DstParamData%Swirl = SrcParamData%Swirl
   DstParamData%DtAero = SrcParamData%DtAero
   DstParamData%HubRad = SrcParamData%HubRad
   DstParamData%UnEc = SrcParamData%UnEc
   DstParamData%UnElem = SrcParamData%UnElem
   DstParamData%UnWndOut = SrcParamData%UnWndOut
   DstParamData%MAXICOUNT = SrcParamData%MAXICOUNT
   DstParamData%WrOptFile = SrcParamData%WrOptFile
   DstParamData%DEFAULT_Wind = SrcParamData%DEFAULT_Wind
      CALL AD_Copyairfoilparms( SrcParamData%AirFoil, DstParamData%AirFoil, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:AirFoil')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybladeparms( SrcParamData%Blade, DstParamData%Blade, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Blade')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybeddoesparms( SrcParamData%Beddoes, DstParamData%Beddoes, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Beddoes')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copydyninflowparms( SrcParamData%DynInflow, DstParamData%DynInflow, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:DynInflow')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyelementparms( SrcParamData%Element, DstParamData%Element, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Element')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copytwrpropsparms( SrcParamData%TwrProps, DstParamData%TwrProps, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:TwrProps')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyinducedvelparms( SrcParamData%InducedVel, DstParamData%InducedVel, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:InducedVel')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copywindparms( SrcParamData%Wind, DstParamData%Wind, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Wind')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyrotorparms( SrcParamData%Rotor, DstParamData%Rotor, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Rotor')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyParam( SrcParamData%IfW_Params, DstParamData%IfW_Params, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:IfW_Params')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyParam( SrcParamData%DWM_Params, DstParamData%DWM_Params, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:DWM_Params')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyfvmparmstype( SrcParamData%FVM, DstParamData%FVM, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:FVM')
         IF (ErrStat>=AbortErrLev) RETURN
   DstParamData%n_TMax_m1 = SrcParamData%n_TMax_m1
 END SUBROUTINE AD_CopyParam

 SUBROUTINE AD_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(AD_ParameterType), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyairfoilparms( ParamData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybladeparms( ParamData%Blade, ErrStat, ErrMsg )
  CALL AD_Destroybeddoesparms( ParamData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflowparms( ParamData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelementparms( ParamData%Element, ErrStat, ErrMsg )
  CALL AD_Destroytwrpropsparms( ParamData%TwrProps, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvelparms( ParamData%InducedVel, ErrStat, ErrMsg )
  CALL AD_Destroywindparms( ParamData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyrotorparms( ParamData%Rotor, ErrStat, ErrMsg )
  CALL IfW_DestroyParam( ParamData%IfW_Params, ErrStat, ErrMsg )
  CALL DWM_DestroyParam( ParamData%DWM_Params, ErrStat, ErrMsg )
  CALL AD_Destroyfvmparmstype( ParamData%FVM, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyParam

 SUBROUTINE AD_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ParameterType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Params_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Params_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Params_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Params_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_FVM_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_FVM_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_FVM_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for Title
!  missing buffer for WindFileName
  Int_BufSz  = Int_BufSz  + 1  ! SIUnit
  Int_BufSz  = Int_BufSz  + 1  ! Echo
  Int_BufSz  = Int_BufSz  + 1  ! MultiTab
  Int_BufSz  = Int_BufSz  + 1  ! LinearizeFlag
  Int_BufSz  = Int_BufSz  + 1  ! OutputPlottingInfo
  Int_BufSz  = Int_BufSz  + 1  ! Initialized
  Int_BufSz  = Int_BufSz  + 1  ! UseDWM
  Re_BufSz   = Re_BufSz   + 1  ! TwoPiNB
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Int_BufSz  = Int_BufSz  + 1  ! NBlInpSt
  Int_BufSz  = Int_BufSz  + 1  ! ElemPrn
  Int_BufSz  = Int_BufSz  + 1  ! DStall
  Int_BufSz  = Int_BufSz  + 1  ! PMoment
  Int_BufSz  = Int_BufSz  + 1  ! Reynolds
  Int_BufSz  = Int_BufSz  + 1  ! DynInfl
  Int_BufSz  = Int_BufSz  + 1  ! Wake
  Int_BufSz  = Int_BufSz  + 1  ! Swirl
  Db_BufSz   = Db_BufSz   + 1  ! DtAero
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Int_BufSz  = Int_BufSz  + 1  ! UnEc
  Int_BufSz  = Int_BufSz  + 1  ! UnElem
  Int_BufSz  = Int_BufSz  + 1  ! UnWndOut
  Int_BufSz  = Int_BufSz  + 1  ! MAXICOUNT
  Int_BufSz  = Int_BufSz  + 1  ! WrOptFile
  Int_BufSz  = Int_BufSz  + 1  ! DEFAULT_Wind
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Db_TwrProps_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Int_TwrProps_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TwrProps_Buf ) ! TwrProps
  IF(ALLOCATED(Re_TwrProps_Buf))  DEALLOCATE(Re_TwrProps_Buf)
  IF(ALLOCATED(Db_TwrProps_Buf))  DEALLOCATE(Db_TwrProps_Buf)
  IF(ALLOCATED(Int_TwrProps_Buf)) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Db_IfW_Params_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Int_IfW_Params_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Params_Buf ) ! IfW_Params
  IF(ALLOCATED(Re_IfW_Params_Buf))  DEALLOCATE(Re_IfW_Params_Buf)
  IF(ALLOCATED(Db_IfW_Params_Buf))  DEALLOCATE(Db_IfW_Params_Buf)
  IF(ALLOCATED(Int_IfW_Params_Buf)) DEALLOCATE(Int_IfW_Params_Buf)
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, InData%DWM_Params, ErrStat, ErrMsg, .TRUE. ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Params_Buf  ) ! DWM_Params
  IF(ALLOCATED(Db_DWM_Params_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Params_Buf  ) ! DWM_Params
  IF(ALLOCATED(Int_DWM_Params_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Params_Buf ) ! DWM_Params
  IF(ALLOCATED(Re_DWM_Params_Buf))  DEALLOCATE(Re_DWM_Params_Buf)
  IF(ALLOCATED(Db_DWM_Params_Buf))  DEALLOCATE(Db_DWM_Params_Buf)
  IF(ALLOCATED(Int_DWM_Params_Buf)) DEALLOCATE(Int_DWM_Params_Buf)
  CALL AD_Packfvmparmstype( Re_FVM_Buf, Db_FVM_Buf, Int_FVM_Buf, InData%FVM, ErrStat, ErrMsg, .TRUE. ) ! FVM 
  IF(ALLOCATED(Re_FVM_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_FVM_Buf  ) ! FVM
  IF(ALLOCATED(Db_FVM_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_FVM_Buf  ) ! FVM
  IF(ALLOCATED(Int_FVM_Buf))Int_BufSz = Int_BufSz + SIZE( Int_FVM_Buf ) ! FVM
  IF(ALLOCATED(Re_FVM_Buf))  DEALLOCATE(Re_FVM_Buf)
  IF(ALLOCATED(Db_FVM_Buf))  DEALLOCATE(Db_FVM_Buf)
  IF(ALLOCATED(Int_FVM_Buf)) DEALLOCATE(Int_FVM_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! n_TMax_m1
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SIUnit ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Echo ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%MultiTab ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%LinearizeFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%OutputPlottingInfo ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Initialized ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseDWM ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwoPiNB )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%ElemPrn ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DStall ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PMoment ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Reynolds ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DynInfl ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Wake ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Swirl ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DtAero )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnEc )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnElem )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnWndOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXICOUNT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrOptFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DEFAULT_Wind )
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, OnlySize ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 ) = Re_TwrProps_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 ) = Db_TwrProps_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 ) = Int_TwrProps_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  IF( ALLOCATED(Re_TwrProps_Buf) )  DEALLOCATE(Re_TwrProps_Buf)
  IF( ALLOCATED(Db_TwrProps_Buf) )  DEALLOCATE(Db_TwrProps_Buf)
  IF( ALLOCATED(Int_TwrProps_Buf) ) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, OnlySize ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 ) = Re_IfW_Params_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 ) = Db_IfW_Params_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 ) = Int_IfW_Params_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Params_Buf) )  DEALLOCATE(Re_IfW_Params_Buf)
  IF( ALLOCATED(Db_IfW_Params_Buf) )  DEALLOCATE(Db_IfW_Params_Buf)
  IF( ALLOCATED(Int_IfW_Params_Buf) ) DEALLOCATE(Int_IfW_Params_Buf)
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, InData%DWM_Params, ErrStat, ErrMsg, OnlySize ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Params_Buf)-1 ) = Re_DWM_Params_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Params_Buf)-1 ) = Db_DWM_Params_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Params_Buf)-1 ) = Int_DWM_Params_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Params_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Params_Buf) )  DEALLOCATE(Re_DWM_Params_Buf)
  IF( ALLOCATED(Db_DWM_Params_Buf) )  DEALLOCATE(Db_DWM_Params_Buf)
  IF( ALLOCATED(Int_DWM_Params_Buf) ) DEALLOCATE(Int_DWM_Params_Buf)
  CALL AD_Packfvmparmstype( Re_FVM_Buf, Db_FVM_Buf, Int_FVM_Buf, InData%FVM, ErrStat, ErrMsg, OnlySize ) ! FVM 
  IF(ALLOCATED(Re_FVM_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_FVM_Buf)-1 ) = Re_FVM_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_FVM_Buf)
  ENDIF
  IF(ALLOCATED(Db_FVM_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_FVM_Buf)-1 ) = Db_FVM_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_FVM_Buf)
  ENDIF
  IF(ALLOCATED(Int_FVM_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_FVM_Buf)-1 ) = Int_FVM_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_FVM_Buf)
  ENDIF
  IF( ALLOCATED(Re_FVM_Buf) )  DEALLOCATE(Re_FVM_Buf)
  IF( ALLOCATED(Db_FVM_Buf) )  DEALLOCATE(Db_FVM_Buf)
  IF( ALLOCATED(Int_FVM_Buf) ) DEALLOCATE(Int_FVM_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n_TMax_m1 )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackParam

 SUBROUTINE AD_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ParameterType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Params_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Params_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Params_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Params_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_FVM_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_FVM_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_FVM_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TwoPiNB = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NBlInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DtAero = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UnEc = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnElem = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnWndOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%MAXICOUNT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DEFAULT_Wind = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packairfoilparms to get correctly sized buffers for unpacking
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbladeparms to get correctly sized buffers for unpacking
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg ) ! Blade 
 ! first call AD_Packbeddoesparms to get correctly sized buffers for unpacking
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflowparms to get correctly sized buffers for unpacking
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelementparms to get correctly sized buffers for unpacking
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packtwrpropsparms to get correctly sized buffers for unpacking
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    Re_TwrProps_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    Db_TwrProps_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    Int_TwrProps_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  CALL AD_UnPacktwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg ) ! TwrProps 
 ! first call AD_Packinducedvelparms to get correctly sized buffers for unpacking
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
 ! first call AD_Packwindparms to get correctly sized buffers for unpacking
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packrotorparms to get correctly sized buffers for unpacking
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call IfW_PackParam to get correctly sized buffers for unpacking
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    Re_IfW_Params_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    Db_IfW_Params_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    Int_IfW_Params_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  CALL IfW_UnPackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg ) ! IfW_Params 
 ! first call DWM_PackParam to get correctly sized buffers for unpacking
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, OutData%DWM_Params, ErrStat, ErrMsg, .TRUE. ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) THEN
    Re_DWM_Params_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Params_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Params_Buf)) THEN
    Db_DWM_Params_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Params_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Params_Buf)) THEN
    Int_DWM_Params_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Params_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Params_Buf)
  ENDIF
  CALL DWM_UnPackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, OutData%DWM_Params, ErrStat, ErrMsg ) ! DWM_Params 
 ! first call AD_Packfvmparmstype to get correctly sized buffers for unpacking
  CALL AD_Packfvmparmstype( Re_FVM_Buf, Db_FVM_Buf, Int_FVM_Buf, OutData%FVM, ErrStat, ErrMsg, .TRUE. ) ! FVM 
  IF(ALLOCATED(Re_FVM_Buf)) THEN
    Re_FVM_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_FVM_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_FVM_Buf)
  ENDIF
  IF(ALLOCATED(Db_FVM_Buf)) THEN
    Db_FVM_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_FVM_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_FVM_Buf)
  ENDIF
  IF(ALLOCATED(Int_FVM_Buf)) THEN
    Int_FVM_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_FVM_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_FVM_Buf)
  ENDIF
  CALL AD_UnPackfvmparmstype( Re_FVM_Buf, Db_FVM_Buf, Int_FVM_Buf, OutData%FVM, ErrStat, ErrMsg ) ! FVM 
  OutData%n_TMax_m1 = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackParam

 SUBROUTINE AD_CopyInput( SrcInputData, DstInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InputType), INTENT(INOUT) :: SrcInputData
   TYPE(AD_InputType), INTENT(INOUT) :: DstInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInputData%InputMarkers)) THEN
   i1_l = LBOUND(SrcInputData%InputMarkers,1)
   i1_u = UBOUND(SrcInputData%InputMarkers,1)
   IF (.NOT. ALLOCATED(DstInputData%InputMarkers)) THEN 
      ALLOCATE(DstInputData%InputMarkers(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%InputMarkers.', ErrStat, ErrMsg,'AD_CopyInput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputData%InputMarkers,1), UBOUND(SrcInputData%InputMarkers,1)
     CALL MeshCopy( SrcInputData%InputMarkers(i1), DstInputData%InputMarkers(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:InputMarkers(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcInputData%Twr_InputMarkers, DstInputData%Twr_InputMarkers, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyaeroconfig( SrcInputData%TurbineComponents, DstInputData%TurbineComponents, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:TurbineComponents')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcInputData%MulTabLoc)) THEN
   i1_l = LBOUND(SrcInputData%MulTabLoc,1)
   i1_u = UBOUND(SrcInputData%MulTabLoc,1)
   i2_l = LBOUND(SrcInputData%MulTabLoc,2)
   i2_u = UBOUND(SrcInputData%MulTabLoc,2)
   IF (.NOT. ALLOCATED(DstInputData%MulTabLoc)) THEN 
      ALLOCATE(DstInputData%MulTabLoc(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%MulTabLoc.', ErrStat, ErrMsg,'AD_CopyInput')
         RETURN
      END IF
   END IF
   DstInputData%MulTabLoc = SrcInputData%MulTabLoc
ENDIF
 END SUBROUTINE AD_CopyInput

 SUBROUTINE AD_DestroyInput( InputData, ErrStat, ErrMsg )
  TYPE(AD_InputType), INTENT(INOUT) :: InputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InputData%InputMarkers)) THEN
DO i1 = LBOUND(InputData%InputMarkers,1), UBOUND(InputData%InputMarkers,1)
  CALL MeshDestroy( InputData%InputMarkers(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputData%InputMarkers)
ENDIF
  CALL MeshDestroy( InputData%Twr_InputMarkers, ErrStat, ErrMsg )
  CALL AD_Destroyaeroconfig( InputData%TurbineComponents, ErrStat, ErrMsg )
IF (ALLOCATED(InputData%MulTabLoc)) THEN
   DEALLOCATE(InputData%MulTabLoc)
ENDIF
 END SUBROUTINE AD_DestroyInput

 SUBROUTINE AD_PackInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Db_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Int_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InputMarkers_Buf ) ! InputMarkers
  IF(ALLOCATED(Re_InputMarkers_Buf))  DEALLOCATE(Re_InputMarkers_Buf)
  IF(ALLOCATED(Db_InputMarkers_Buf))  DEALLOCATE(Db_InputMarkers_Buf)
  IF(ALLOCATED(Int_InputMarkers_Buf)) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_InputMarkers_Buf ) ! Twr_InputMarkers
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf))  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf))  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( ALLOCATED(InData%MulTabLoc) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabLoc )  ! MulTabLoc 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 ) = Re_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 ) = Db_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 ) = Int_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 ) = Re_Twr_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 ) = Db_Twr_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 ) = Int_Twr_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( ALLOCATED(InData%MulTabLoc) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabLoc))-1 ) =  PACK(InData%MulTabLoc ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabLoc)
  ENDIF
 END SUBROUTINE AD_PackInput

 SUBROUTINE AD_UnPackInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%InputMarkers,1), UBOUND(OutData%InputMarkers,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    Re_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    Db_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    Int_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg ) ! InputMarkers 
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    Re_Twr_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    Db_Twr_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    Int_Twr_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg ) ! Twr_InputMarkers 
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
  IF ( ALLOCATED(OutData%MulTabLoc) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabLoc,1),SIZE(OutData%MulTabLoc,2)))
  mask2 = .TRUE.
    OutData%MulTabLoc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabLoc))-1 ),mask2,OutData%MulTabLoc)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabLoc)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInput

 SUBROUTINE AD_CopyOutput( SrcOutputData, DstOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_OutputType), INTENT(INOUT) :: SrcOutputData
   TYPE(AD_OutputType), INTENT(INOUT) :: DstOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcOutputData%OutputLoads)) THEN
   i1_l = LBOUND(SrcOutputData%OutputLoads,1)
   i1_u = UBOUND(SrcOutputData%OutputLoads,1)
   IF (.NOT. ALLOCATED(DstOutputData%OutputLoads)) THEN 
      ALLOCATE(DstOutputData%OutputLoads(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputData%OutputLoads.', ErrStat, ErrMsg,'AD_CopyOutput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcOutputData%OutputLoads,1), UBOUND(SrcOutputData%OutputLoads,1)
     CALL MeshCopy( SrcOutputData%OutputLoads(i1), DstOutputData%OutputLoads(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:OutputLoads(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcOutputData%Twr_OutputLoads, DstOutputData%Twr_OutputLoads, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyOutput( SrcOutputData%IfW_Outputs, DstOutputData%IfW_Outputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:IfW_Outputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyOutput( SrcOutputData%DWM_Outputs, DstOutputData%DWM_Outputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:DWM_Outputs')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyOutput

 SUBROUTINE AD_DestroyOutput( OutputData, ErrStat, ErrMsg )
  TYPE(AD_OutputType), INTENT(INOUT) :: OutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OutputData%OutputLoads)) THEN
DO i1 = LBOUND(OutputData%OutputLoads,1), UBOUND(OutputData%OutputLoads,1)
  CALL MeshDestroy( OutputData%OutputLoads(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(OutputData%OutputLoads)
ENDIF
  CALL MeshDestroy( OutputData%Twr_OutputLoads, ErrStat, ErrMsg )
  CALL IfW_DestroyOutput( OutputData%IfW_Outputs, ErrStat, ErrMsg )
  CALL DWM_DestroyOutput( OutputData%DWM_Outputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOutput

 SUBROUTINE AD_PackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_OutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Outputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Outputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Outputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Db_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Int_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OutputLoads_Buf ) ! OutputLoads
  IF(ALLOCATED(Re_OutputLoads_Buf))  DEALLOCATE(Re_OutputLoads_Buf)
  IF(ALLOCATED(Db_OutputLoads_Buf))  DEALLOCATE(Db_OutputLoads_Buf)
  IF(ALLOCATED(Int_OutputLoads_Buf)) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_OutputLoads_Buf ) ! Twr_OutputLoads
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf))  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf))  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Int_IfW_Outputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Outputs_Buf ) ! IfW_Outputs
  IF(ALLOCATED(Re_IfW_Outputs_Buf))  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF(ALLOCATED(Db_IfW_Outputs_Buf))  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) DEALLOCATE(Int_IfW_Outputs_Buf)
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, InData%DWM_Outputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Outputs_Buf  ) ! DWM_Outputs
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Outputs_Buf  ) ! DWM_Outputs
  IF(ALLOCATED(Int_DWM_Outputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Outputs_Buf ) ! DWM_Outputs
  IF(ALLOCATED(Re_DWM_Outputs_Buf))  DEALLOCATE(Re_DWM_Outputs_Buf)
  IF(ALLOCATED(Db_DWM_Outputs_Buf))  DEALLOCATE(Db_DWM_Outputs_Buf)
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) DEALLOCATE(Int_DWM_Outputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 ) = Re_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 ) = Db_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 ) = Int_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 ) = Re_Twr_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 ) = Db_Twr_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 ) = Int_Twr_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 ) = Re_IfW_Outputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 ) = Db_IfW_Outputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 ) = Int_IfW_Outputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Outputs_Buf) )  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF( ALLOCATED(Db_IfW_Outputs_Buf) )  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF( ALLOCATED(Int_IfW_Outputs_Buf) ) DEALLOCATE(Int_IfW_Outputs_Buf)
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, InData%DWM_Outputs, ErrStat, ErrMsg, OnlySize ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Outputs_Buf)-1 ) = Re_DWM_Outputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Outputs_Buf)-1 ) = Db_DWM_Outputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Outputs_Buf)-1 ) = Int_DWM_Outputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Outputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Outputs_Buf) )  DEALLOCATE(Re_DWM_Outputs_Buf)
  IF( ALLOCATED(Db_DWM_Outputs_Buf) )  DEALLOCATE(Db_DWM_Outputs_Buf)
  IF( ALLOCATED(Int_DWM_Outputs_Buf) ) DEALLOCATE(Int_DWM_Outputs_Buf)
 END SUBROUTINE AD_PackOutput

 SUBROUTINE AD_UnPackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_OutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Outputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Outputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Outputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%OutputLoads,1), UBOUND(OutData%OutputLoads,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    Re_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    Db_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    Int_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg ) ! OutputLoads 
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    Re_Twr_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    Db_Twr_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    Int_Twr_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg ) ! Twr_OutputLoads 
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
 ! first call IfW_PackOutput to get correctly sized buffers for unpacking
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    Re_IfW_Outputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    Db_IfW_Outputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    Int_IfW_Outputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  CALL IfW_UnPackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg ) ! IfW_Outputs 
 ! first call DWM_PackOutput to get correctly sized buffers for unpacking
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, OutData%DWM_Outputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) THEN
    Re_DWM_Outputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Outputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) THEN
    Db_DWM_Outputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Outputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) THEN
    Int_DWM_Outputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Outputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Outputs_Buf)
  ENDIF
  CALL DWM_UnPackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, OutData%DWM_Outputs, ErrStat, ErrMsg ) ! DWM_Outputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOutput


 SUBROUTINE AD_Input_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_inputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_inputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Input_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshCopy(u(1)%InputMarkers(i01), u_out%InputMarkers(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_InputMarkers, u_out%Twr_InputMarkers, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel
  ENDDO
END IF ! check if allocated
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  u_out%MulTabLoc = u(1)%MulTabLoc
END IF ! check if allocated
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp1(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position)/t(2)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation)/t(2)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = -(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position)/t(2)
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation)/t(2)
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel)/t(2)
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel)/t(2)
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position)/t(2)
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation)/t(2)
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position)/t(2)
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation)/t(2)
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel)/t(2)
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel)/t(2)
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position)/t(2)
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation)/t(2)
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel)/t(2)
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel)/t(2)
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = -(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position)/t(2)
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation)/t(2)
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel)/t(2)
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel)/t(2)
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position)/t(2)
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation)/t(2)
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel)/t(2)
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel)/t(2)
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position)/t(2)
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation)/t(2)
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel)/t(2)
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel)/t(2)
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength)/t(2)
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = -(u(1)%MulTabLoc - u(2)%MulTabLoc)/t(2)
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp2(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), u(3)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, u(3)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Position + u(3)%TurbineComponents%Blade(i11)%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Position + t(3)*u(2)%TurbineComponents%Blade(i11)%Position - t(2)*u(3)%TurbineComponents%Blade(i11)%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Orientation + u(3)%TurbineComponents%Blade(i11)%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Orientation + t(3)*u(2)%TurbineComponents%Blade(i11)%Orientation - t(2)*u(3)%TurbineComponents%Blade(i11)%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%TranslationVel + u(3)%TurbineComponents%Blade(i11)%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%TranslationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%TranslationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%RotationVel + u(3)%TurbineComponents%Blade(i11)%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%RotationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%RotationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position) + t(2)**2*(-u(1)%TurbineComponents%Hub%Position + u(3)%TurbineComponents%Hub%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Position + t(3)*u(2)%TurbineComponents%Hub%Position - t(2)*u(3)%TurbineComponents%Hub%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Hub%Orientation + u(3)%TurbineComponents%Hub%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Orientation + t(3)*u(2)%TurbineComponents%Hub%Orientation - t(2)*u(3)%TurbineComponents%Hub%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%TranslationVel + u(3)%TurbineComponents%Hub%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%TranslationVel + t(3)*u(2)%TurbineComponents%Hub%TranslationVel - t(2)*u(3)%TurbineComponents%Hub%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%RotationVel + u(3)%TurbineComponents%Hub%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%RotationVel + t(3)*u(2)%TurbineComponents%Hub%RotationVel - t(2)*u(3)%TurbineComponents%Hub%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Position + u(3)%TurbineComponents%RotorFurl%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Position + t(3)*u(2)%TurbineComponents%RotorFurl%Position - t(2)*u(3)%TurbineComponents%RotorFurl%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Orientation + u(3)%TurbineComponents%RotorFurl%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Orientation + t(3)*u(2)%TurbineComponents%RotorFurl%Orientation - t(2)*u(3)%TurbineComponents%RotorFurl%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%TranslationVel + u(3)%TurbineComponents%RotorFurl%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%TranslationVel + t(3)*u(2)%TurbineComponents%RotorFurl%TranslationVel - t(2)*u(3)%TurbineComponents%RotorFurl%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%RotationVel + u(3)%TurbineComponents%RotorFurl%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%RotationVel + t(3)*u(2)%TurbineComponents%RotorFurl%RotationVel - t(2)*u(3)%TurbineComponents%RotorFurl%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Position + u(3)%TurbineComponents%Nacelle%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Position + t(3)*u(2)%TurbineComponents%Nacelle%Position - t(2)*u(3)%TurbineComponents%Nacelle%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Orientation + u(3)%TurbineComponents%Nacelle%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Orientation + t(3)*u(2)%TurbineComponents%Nacelle%Orientation - t(2)*u(3)%TurbineComponents%Nacelle%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%TranslationVel + u(3)%TurbineComponents%Nacelle%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%TranslationVel + t(3)*u(2)%TurbineComponents%Nacelle%TranslationVel - t(2)*u(3)%TurbineComponents%Nacelle%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%RotationVel + u(3)%TurbineComponents%Nacelle%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%RotationVel + t(3)*u(2)%TurbineComponents%Nacelle%RotationVel - t(2)*u(3)%TurbineComponents%Nacelle%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Position + u(3)%TurbineComponents%TailFin%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Position + t(3)*u(2)%TurbineComponents%TailFin%Position - t(2)*u(3)%TurbineComponents%TailFin%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Orientation + u(3)%TurbineComponents%TailFin%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Orientation + t(3)*u(2)%TurbineComponents%TailFin%Orientation - t(2)*u(3)%TurbineComponents%TailFin%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%TranslationVel + u(3)%TurbineComponents%TailFin%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%TranslationVel + t(3)*u(2)%TurbineComponents%TailFin%TranslationVel - t(2)*u(3)%TurbineComponents%TailFin%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%RotationVel + u(3)%TurbineComponents%TailFin%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%RotationVel + t(3)*u(2)%TurbineComponents%TailFin%RotationVel - t(2)*u(3)%TurbineComponents%TailFin%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position) + t(2)**2*(-u(1)%TurbineComponents%Tower%Position + u(3)%TurbineComponents%Tower%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Position + t(3)*u(2)%TurbineComponents%Tower%Position - t(2)*u(3)%TurbineComponents%Tower%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Tower%Orientation + u(3)%TurbineComponents%Tower%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Orientation + t(3)*u(2)%TurbineComponents%Tower%Orientation - t(2)*u(3)%TurbineComponents%Tower%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%TranslationVel + u(3)%TurbineComponents%Tower%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%TranslationVel + t(3)*u(2)%TurbineComponents%Tower%TranslationVel - t(2)*u(3)%TurbineComponents%Tower%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%RotationVel + u(3)%TurbineComponents%Tower%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%RotationVel + t(3)*u(2)%TurbineComponents%Tower%RotationVel - t(2)*u(3)%TurbineComponents%Tower%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Position + u(3)%TurbineComponents%SubStructure%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Position + t(3)*u(2)%TurbineComponents%SubStructure%Position - t(2)*u(3)%TurbineComponents%SubStructure%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Orientation + u(3)%TurbineComponents%SubStructure%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Orientation + t(3)*u(2)%TurbineComponents%SubStructure%Orientation - t(2)*u(3)%TurbineComponents%SubStructure%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%TranslationVel + u(3)%TurbineComponents%SubStructure%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%TranslationVel + t(3)*u(2)%TurbineComponents%SubStructure%TranslationVel - t(2)*u(3)%TurbineComponents%SubStructure%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%RotationVel + u(3)%TurbineComponents%SubStructure%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%RotationVel + t(3)*u(2)%TurbineComponents%SubStructure%RotationVel - t(2)*u(3)%TurbineComponents%SubStructure%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Position + u(3)%TurbineComponents%Foundation%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Position + t(3)*u(2)%TurbineComponents%Foundation%Position - t(2)*u(3)%TurbineComponents%Foundation%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Orientation + u(3)%TurbineComponents%Foundation%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Orientation + t(3)*u(2)%TurbineComponents%Foundation%Orientation - t(2)*u(3)%TurbineComponents%Foundation%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%TranslationVel + u(3)%TurbineComponents%Foundation%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%TranslationVel + t(3)*u(2)%TurbineComponents%Foundation%TranslationVel - t(2)*u(3)%TurbineComponents%Foundation%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%RotationVel + u(3)%TurbineComponents%Foundation%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%RotationVel + t(3)*u(2)%TurbineComponents%Foundation%RotationVel - t(2)*u(3)%TurbineComponents%Foundation%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength) + t(2)**2*(-u(1)%TurbineComponents%BladeLength + u(3)%TurbineComponents%BladeLength))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%TurbineComponents%BladeLength + t(3)*u(2)%TurbineComponents%BladeLength - t(2)*u(3)%TurbineComponents%BladeLength ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out + c0 * t_out**2
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = (t(3)**2*(u(1)%MulTabLoc - u(2)%MulTabLoc) + t(2)**2*(-u(1)%MulTabLoc + u(3)%MulTabLoc))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%MulTabLoc + t(3)*u(2)%MulTabLoc - t(2)*u(3)%MulTabLoc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Input_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Input_ExtrapInterp


 SUBROUTINE AD_Output_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_outputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_outputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Output_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshCopy(u(1)%OutputLoads(i01), u_out%OutputLoads(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_OutputLoads, u_out%Twr_OutputLoads, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp1(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp2(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), u(3)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, u(3)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Output_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Output_ExtrapInterp

END MODULE AeroDyn_Types
!ENDOFREGISTRYGENERATEDFILE
