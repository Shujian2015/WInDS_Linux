!STARTOFREGISTRYGENERATEDFILE './ElastoDyn_Types.f90'
!
! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
! FAST Registry (v2.05.00, 14-Jan-2015)
!*********************************************************************************************************************************
! ElastoDyn_Types
!.................................................................................................................................
! This file is part of ElastoDyn.
!
! Copyright (C) 2012-2015 National Renewable Energy Laboratory
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE ElastoDyn_Types
! This module contains all of the user-defined types needed in ElastoDyn. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE NWTC_Library
IMPLICIT NONE
    INTEGER(IntKi), PUBLIC, PARAMETER  :: ED_NMX = 4      ! Used in updating predictor-corrector values (size of state history) [-]
! =========  ED_InitInputType  =======
  TYPE, PUBLIC :: ED_InitInputType
    CHARACTER(1024)  :: InputFile      ! Name of the input file [-]
    CHARACTER(1024)  :: ADInputFile      ! Name of the AeroDyn input file (in this verison, that is where we'll get the blade mesh info [-]
    LOGICAL  :: CompElast      ! flag to determine if ElastoDyn is computing blade loads (true) or BeamDyn is (false) [-]
    CHARACTER(1024)  :: RootName      ! RootName for writing output files [-]
  END TYPE ED_InitInputType
! =======================
! =========  ED_InitOutputType  =======
  TYPE, PUBLIC :: ED_InitOutputType
    CHARACTER(ChanLen) , DIMENSION(:), ALLOCATABLE  :: WriteOutputHdr      ! Names of the output-to-file channels [-]
    CHARACTER(ChanLen) , DIMENSION(:), ALLOCATABLE  :: WriteOutputUnt      ! Units of the output-to-file channels [-]
    TYPE(ProgDesc)  :: Ver      ! This module's name, version, and date [-]
    INTEGER(IntKi)  :: NumBl      ! Number of blades on the turbine [-]
    REAL(ReKi)  :: Gravity      ! Gravitational acceleration [m/s^2]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch      ! Initial blade pitch angles [radians]
    REAL(ReKi)  :: BladeLength      ! Blade length (for AeroDyn) [meters]
    REAL(ReKi)  :: HubHt      ! Height of the hub [meters]
    REAL(ReKi) , DIMENSION(1:6)  :: PlatformPos      ! Initial platform position (6 DOFs) [-]
  END TYPE ED_InitOutputType
! =======================
! =========  BladeInputData  =======
  TYPE, PUBLIC :: BladeInputData
    INTEGER(IntKi)  :: NBlInpSt      ! Number of blade input stations [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlFract      ! Blade fractional radius for distributed input data [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PitchAx      ! Pitch axis for distributed input data [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StrcTwst      ! Structural twist for distributed input data [radians]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BMassDen      ! Blade mass density for distributed input data [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpStff      ! Blade flap stiffness for distributed input data [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgStff      ! Blade edge stiffness for distributed input data [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: GJStff      ! Blade torsional stiffness for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EAStff      ! Blade extensional stiffness for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Alpha      ! Blade coupling coefficient between flap and twist for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpIner      ! Blade flap (about local structural yb-axis) mass inertia per unit length for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgIner      ! Blade edge (about local structural xb-axis) mass inertia per unit length for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PrecrvRef      ! Offset for defining the reference axis from the pitch axis for precurved blades at a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PreswpRef      ! Offset for defining the reference axis from the pitch axis for preswept blades at a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpcgOf      ! Blade flap (along local aerodynamic xb-axis) mass cg offset for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgcgOf      ! Blade edge (along local aerodynamic yb-axis) mass cg offset for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FlpEAOf      ! Blade flap (along local aerodynamic xb-axis) elastic axis offset for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: EdgEAOf      ! Blade edge (along local aerodynamic yb-axis) elastic axis offset for a given input station [-]
    REAL(ReKi) , DIMENSION(1:2)  :: BldFlDmp      ! Blade structural damping ratios in flapwise direction [-]
    REAL(ReKi) , DIMENSION(1:1)  :: BldEdDmp      ! Blade structural damping ratios in edgewise direction [-]
    REAL(ReKi) , DIMENSION(1:2)  :: FlStTunr      ! Blade flapwise modal stiffness tuners (input) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldFl1Sh      ! Blade-flap-mode-1 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldFl2Sh      ! Blade-flap-mode-2 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldEdgSh      ! Blade-edge-mode shape coefficients [-]
  END TYPE BladeInputData
! =======================
! =========  ED_BladeMeshInputData  =======
  TYPE, PUBLIC :: ED_BladeMeshInputData
    INTEGER(IntKi)  :: BldNodes      ! Number of blade nodes used for analysis [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodes      ! Radius to analysis nodes relative to hub ( 0 < RNodes(:) < BldFlexL ) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AeroTwst      ! Aerodynamic twist of the blade at the analysis nodes [radians]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Chord      ! Chord of the blade at the analysis nodes [-]
  END TYPE ED_BladeMeshInputData
! =======================
! =========  ED_InputFile  =======
  TYPE, PUBLIC :: ED_InputFile
    REAL(DbKi)  :: DT      ! Requested integration time for ElastoDyn [seconds]
    REAL(ReKi)  :: Gravity      ! Gravitational acceleration [m/s^2]
    LOGICAL  :: FlapDOF1      ! First flapwise blade mode DOF [-]
    LOGICAL  :: FlapDOF2      ! Second flapwise blade mode DOF [-]
    LOGICAL  :: EdgeDOF      ! Edgewise blade mode DOF [-]
    LOGICAL  :: TeetDOF      ! Rotor-teeter DOF [-]
    LOGICAL  :: DrTrDOF      ! Drivetrain rotational-flexibility DOF [-]
    LOGICAL  :: GenDOF      ! Generator DOF [-]
    LOGICAL  :: YawDOF      ! Nacelle-yaw DOF [-]
    LOGICAL  :: TwFADOF1      ! First tower fore-aft bending-mode DOF [-]
    LOGICAL  :: TwFADOF2      ! Second tower fore-aft bending-mode DOF [-]
    LOGICAL  :: TwSSDOF1      ! First tower side-to-side bending-mode DOF [-]
    LOGICAL  :: TwSSDOF2      ! Second tower side-to-side bending-mode DOF [-]
    LOGICAL  :: PtfmSgDOF      ! Platform horizontal surge translation DOF [-]
    LOGICAL  :: PtfmSwDOF      ! Platform horizontal sway translation DOF [-]
    LOGICAL  :: PtfmHvDOF      ! Platform vertical heave translation DOF [-]
    LOGICAL  :: PtfmRDOF      ! Platform roll tilt rotation DOF [-]
    LOGICAL  :: PtfmPDOF      ! Platform pitch tilt rotation DOF [-]
    LOGICAL  :: PtfmYDOF      ! Platform yaw rotation DOF [-]
    REAL(ReKi)  :: OoPDefl      ! Initial out-of-plane blade-tip displacement [meters]
    REAL(ReKi)  :: IPDefl      ! Initial in-plane blade-tip deflection [meters]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch      ! Initial blade pitch angles [radians]
    REAL(ReKi)  :: TeetDefl      ! Initial teeter angle [radians]
    REAL(ReKi)  :: Azimuth      ! Initial azimuth angle for blade 1 [radians]
    REAL(ReKi)  :: RotSpeed      ! Initial rotor speed [rad/s]
    REAL(ReKi)  :: NacYaw      ! Initial nacelle-yaw angle [radians]
    REAL(ReKi)  :: TTDspFA      ! Initial fore-aft tower-top displacement [meters]
    REAL(ReKi)  :: TTDspSS      ! Initial side-to-side tower-top displacement [meters]
    REAL(ReKi)  :: PtfmSurge      ! Initial horizontal surge translational displacement of platform [meters]
    REAL(ReKi)  :: PtfmSway      ! Initial horizontal sway translational displacement of platform [meters]
    REAL(ReKi)  :: PtfmHeave      ! Initial vertical heave translational displacement of platform [meters]
    REAL(ReKi)  :: PtfmRoll      ! Initial roll tilt rotational displacement of platform [radians]
    REAL(ReKi)  :: PtfmPitch      ! Initial pitch tilt rotational displacement of platform [radians]
    REAL(ReKi)  :: PtfmYaw      ! Initial yaw rotational displacement of platform [radians]
    INTEGER(IntKi)  :: NumBl      ! Number of blades [-]
    REAL(ReKi)  :: TipRad      ! Preconed blade-tip radius (distance from the rotor apex to the blade tip) [meters]
    REAL(ReKi)  :: HubRad      ! Preconed hub radius (distance from the rotor apex to the blade root) [meters]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PreCone      ! Rotor precone angles [radians]
    REAL(ReKi)  :: HubCM      ! Distance from rotor apex to hub mass [meters]
    REAL(ReKi)  :: UndSling      ! Undersling length [meters]
    REAL(ReKi)  :: Delta3      ! Delta-3 angle for teetering rotors [radians]
    REAL(ReKi)  :: AzimB1Up      ! Azimuth value to use for I/O when blade 1 points up [radians]
    REAL(ReKi)  :: OverHang      ! Distance from yaw axis to rotor apex or teeter pin [meters]
    REAL(ReKi)  :: ShftGagL      ! Distance from hub or teeter pin to shaft strain gages [meters]
    REAL(ReKi)  :: ShftTilt      ! Rotor shaft tilt angle [radians]
    REAL(ReKi)  :: NacCMxn      ! Downwind distance from tower-top to nacelle CM [meters]
    REAL(ReKi)  :: NacCMyn      ! Lateral distance from tower-top to nacelle CM [meters]
    REAL(ReKi)  :: NacCMzn      ! Vertical distance from tower-top to nacelle CM [meters]
    REAL(ReKi)  :: NcIMUxn      ! Downwind distance from the tower-top to the nacelle IMU [meters]
    REAL(ReKi)  :: NcIMUyn      ! Lateral distance from the tower-top to the nacelle IMU [meters]
    REAL(ReKi)  :: NcIMUzn      ! Vertical distance from the tower-top to the nacelle IMU [meters]
    REAL(ReKi)  :: Twr2Shft      ! Vertical distance from the tower-top to the rotor shaft [meters]
    REAL(ReKi)  :: TowerHt      ! Height of tower above ground level [onshore] or MSL [offshore] [meters]
    REAL(ReKi)  :: TowerBsHt      ! Height of tower base above ground level [onshore] or MSL [offshore] [meters]
    REAL(ReKi)  :: PtfmCMxt      ! Downwind distance from the ground [onshore] or MSL [offshore] to the platform CM [meters]
    REAL(ReKi)  :: PtfmCMyt      ! Lateral distance from the ground [onshore] or MSL [offshore] to the platform CM [meters]
    REAL(ReKi)  :: PtfmCMzt      ! Vertical distance from the ground [onshore] or MSL [offshore] to the platform CM [meters]
    REAL(ReKi)  :: PtfmRefzt      ! Vertical distance from the ground [onshore] or MSL [offshore] to the platform reference point [meters]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TipMass      ! Tip-brake masses [kg]
    REAL(ReKi)  :: HubMass      ! Hub mass [kg]
    REAL(ReKi)  :: HubIner      ! Hub inertia about teeter axis (2-blader) or rotor axis (3-blader) [kg m^2]
    REAL(ReKi)  :: GenIner      ! Generator inertia about HSS [kg m^2]
    REAL(ReKi)  :: NacMass      ! Nacelle mass [kg]
    REAL(ReKi)  :: NacYIner      ! Nacelle yaw inertia [kg m^2]
    REAL(ReKi)  :: YawBrMass      ! Yaw bearing mass [kg]
    REAL(ReKi)  :: PtfmMass      ! Platform mass [kg]
    REAL(ReKi)  :: PtfmRIner      ! Platform inertia for roll tilt rotation about the platform CM [kg m^2]
    REAL(ReKi)  :: PtfmPIner      ! Platform inertia for pitch tilt rotation about the platform CM [kg m^2]
    REAL(ReKi)  :: PtfmYIner      ! Platform inertia for yaw rotation about the platform CM [kg m^2]
    TYPE(ED_BladeMeshInputData) , DIMENSION(:), ALLOCATABLE  :: InpBlMesh      ! Input data for blade discretizations (could be on each blade) [see BladeMeshInputData]
    TYPE(BladeInputData) , DIMENSION(:), ALLOCATABLE  :: InpBl      ! Input data for individual blades [see BladeInputData type]
    INTEGER(IntKi)  :: TeetMod      ! Rotor-teeter spring/damper model switch [-]
    REAL(ReKi)  :: TeetDmpP      ! Rotor-teeter damper position [radians]
    REAL(ReKi)  :: TeetDmp      ! Rotor-teeter damping constant [N-m/(rad/s)]
    REAL(ReKi)  :: TeetCDmp      ! Rotor-teeter rate-independent Coulomb-damping [N-m]
    REAL(ReKi)  :: TeetSStP      ! Rotor-teeter soft-stop position [radians]
    REAL(ReKi)  :: TeetHStP      ! Rotor-teeter hard-stop position [radians]
    REAL(ReKi)  :: TeetSSSp      ! Rotor-teeter soft-stop linear-spring constant [N-m/rad]
    REAL(ReKi)  :: TeetHSSp      ! Rotor-teeter hard-stop linear-spring constant [N-m/rad]
    REAL(ReKi)  :: GBoxEff      ! Gearbox efficiency [%]
    REAL(ReKi)  :: GBRatio      ! Gearbox ratio [-]
    REAL(ReKi)  :: DTTorSpr      ! Drivetrain torsional spring [N-m/rad]
    REAL(ReKi)  :: DTTorDmp      ! Drivetrain torsional damper [N-m/(rad/s)]
    LOGICAL  :: Furling      ! Use Additional Furling parameters? [-]
    INTEGER(IntKi)  :: TwrNodes      ! Number of tower nodes used in the analysis [-]
    LOGICAL  :: SumPrint      ! Print summary data to <RootName>.sum [-]
    INTEGER(IntKi)  :: OutFile      ! Switch to determine where output will be placed: (1: in module output file only; 2: in glue code output file only; 3: both) [-]
    LOGICAL  :: TabDelim      ! Flag to cause tab-delimited text output (delimited by space otherwise) [-]
    CHARACTER(20)  :: OutFmt      ! Format used for module's text tabular output (except time); resulting field should be 10 characters [-]
    REAL(DbKi)  :: Tstart      ! Time to start module's tabular output [seconds]
    INTEGER(IntKi)  :: DecFact      ! Decimation factor for module's tabular output (1=output every step) [-]
    INTEGER(IntKi)  :: NTwGages      ! Number of tower strain gages [-]
    INTEGER(IntKi) , DIMENSION(1:9)  :: TwrGagNd      ! Nodes closest to the tower strain gages [-]
    INTEGER(IntKi)  :: NBlGages      ! Number of blade strain gages [-]
    INTEGER(IntKi) , DIMENSION(1:9)  :: BldGagNd      ! Nodes closest to the blade strain gages [-]
    INTEGER(IntKi)  :: NumOuts      ! Number of parameters in the output list (number of outputs requested) [-]
    CHARACTER(ChanLen) , DIMENSION(:), ALLOCATABLE  :: OutList      ! List of user-requested output channels [-]
    INTEGER(IntKi)  :: NTwInpSt      ! Number of tower input stations [-]
    REAL(ReKi) , DIMENSION(1:2)  :: TwrFADmp      ! Tower fore-aft structural damping ratios [%]
    REAL(ReKi) , DIMENSION(1:2)  :: TwrSSDmp      ! Tower side-to-side structural damping ratios [%]
    REAL(ReKi) , DIMENSION(1:2)  :: FAStTunr      ! Tower fore-aft modal stiffness tuners [-]
    REAL(ReKi) , DIMENSION(1:2)  :: SSStTunr      ! Tower side-to-side modal stiffness tuners [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HtFract      ! Fractional height of the flexible portion of tower for a given input station [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TMassDen      ! Tower mass density for a given input station [kg/m]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAStif      ! Tower fore-aft stiffness for a given input station [Nm^2]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSStif      ! Tower side-to-side stiffness for a given input station [Nm^2]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAM1Sh      ! Tower fore-aft mode-1 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAM2Sh      ! Tower fore-aft mode-2 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSM1Sh      ! Tower side-to-side mode-1 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSM2Sh      ! Tower side-to-side mode-2 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwGJStif      ! Tower torsional stiffness for a given input station [Nm^2]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwEAStif      ! Tower extensional stiffness for a given input station [N]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAIner      ! Tower fore-aft (about yt-axis) mass inertia per unit length for a given input station [kg m]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSSIner      ! Tower side-to-side (about xt-axis) mass inertia per unit length for a given input station [kg m]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwFAcgOf      ! Tower fore-aft (along the xt-axis) mass cg offset for a given input station [meters]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwSScgOf      ! Tower fore-aft (along the yt-axis) mass cg offset for a given input station [meters]
    LOGICAL  :: RFrlDOF      ! Rotor-furl DOF [-]
    LOGICAL  :: TFrlDOF      ! Tail-furl DOF [-]
    REAL(ReKi)  :: RotFurl      ! Initial or fixed rotor-furl angle [radians]
    REAL(ReKi)  :: TailFurl      ! Initial or fixed tail-furl angle [radians]
    REAL(ReKi)  :: Yaw2Shft      ! Lateral distance from the yaw axis to the rotor shaft [meters]
    REAL(ReKi)  :: ShftSkew      ! Rotor shaft skew angle [radians]
    REAL(ReKi)  :: RFrlCMxn      ! Downwind distance from tower-top to rotor-furl CM [meters]
    REAL(ReKi)  :: RFrlCMyn      ! Lateral distance from tower-top to rotor-furl CM [meters]
    REAL(ReKi)  :: RFrlCMzn      ! Vertical distance from tower-top to rotor-furl CM [meters]
    REAL(ReKi)  :: BoomCMxn      ! Downwind distance from tower-top to tail boom CM [meters]
    REAL(ReKi)  :: BoomCMyn      ! Lateral distance from tower-top to tail boom CM [meters]
    REAL(ReKi)  :: BoomCMzn      ! Vertical distance from tower-top to tail boom CM [meters]
    REAL(ReKi)  :: TFinCMxn      ! Downwind distance from tower-top to tail fin CM [meters]
    REAL(ReKi)  :: TFinCMyn      ! Lateral distance from tower-top to tail fin CM [meters]
    REAL(ReKi)  :: TFinCMzn      ! Vertical distance from tower-top to tail fin CM [meters]
    REAL(ReKi)  :: TFinCPxn      ! Downwind distance from tower-top to tail fin CP [meters]
    REAL(ReKi)  :: TFinCPyn      ! Lateral distance from tower-top to tail fin CP [meters]
    REAL(ReKi)  :: TFinCPzn      ! Vertical distance from tower-top to tail fin CP [meters]
    REAL(ReKi)  :: TFinSkew      ! Tail fin chordline skew angle [radians]
    REAL(ReKi)  :: TFinTilt      ! Tail fin chordline tilt angle [radians]
    REAL(ReKi)  :: TFinBank      ! Tail fin planform bank angle [radians]
    REAL(ReKi)  :: RFrlPntxn      ! Downwind distance from tower-top to arbitrary point on rotor-furl axis [meters]
    REAL(ReKi)  :: RFrlPntyn      ! Lateral distance from tower-top to arbitrary point on rotor-furl axis [meters]
    REAL(ReKi)  :: RFrlPntzn      ! Vertical distance from tower-top to arbitrary point on rotor-furl axis [meters]
    REAL(ReKi)  :: RFrlSkew      ! Rotor-furl axis skew angle [radians]
    REAL(ReKi)  :: RFrlTilt      ! Rotor-furl axis tilt angle [radians]
    REAL(ReKi)  :: TFrlPntxn      ! Downwind distance from tower-top to arbitrary point on tail-furl axis [meters]
    REAL(ReKi)  :: TFrlPntyn      ! Lateral distance from tower-top to arbitrary point on tail-furl axis [meters]
    REAL(ReKi)  :: TFrlPntzn      ! Vertical distance from tower-top to arbitrary point on tail-furl axis [meters]
    REAL(ReKi)  :: TFrlSkew      ! Rotor-furl axis skew angle [radians]
    REAL(ReKi)  :: TFrlTilt      ! Rotor-furl axis tilt angle [radians]
    REAL(ReKi)  :: RFrlMass      ! Rotor-furl mass [kg]
    REAL(ReKi)  :: BoomMass      ! Tail boom mass [kg]
    REAL(ReKi)  :: TFinMass      ! Tail fin mass [kg]
    REAL(ReKi)  :: RFrlIner      ! Rotor-furl inertia about rotor-furl axis [kg m^2]
    REAL(ReKi)  :: TFrlIner      ! Tail boom inertia about tail-furl axis [kg m^2]
    INTEGER(IntKi)  :: RFrlMod      ! Rotor-furl spring/damper model switch [-]
    REAL(ReKi)  :: RFrlSpr      ! Rotor-furl spring constant [N-m/rad]
    REAL(ReKi)  :: RFrlDmp      ! Rotor-furl damping constant [N-m/(rad/s)]
    REAL(ReKi)  :: RFrlCDmp      ! Rotor-furl rate-independent Coulomb-damping moment [N-m]
    REAL(ReKi)  :: RFrlUSSP      ! Rotor-furl up-stop spring position [radians]
    REAL(ReKi)  :: RFrlDSSP      ! Rotor-furl down-stop spring position [radians]
    REAL(ReKi)  :: RFrlUSSpr      ! Rotor-furl up-stop spring constant [N-m/rad]
    REAL(ReKi)  :: RFrlDSSpr      ! Rotor-furl down-stop spring constant [N-m/rad]
    REAL(ReKi)  :: RFrlUSDP      ! Rotor-furl up-stop damper position [radians]
    REAL(ReKi)  :: RFrlDSDP      ! Rotor-furl down-stop damper position [radians]
    REAL(ReKi)  :: RFrlUSDmp      ! Rotor-furl up-stop damping constant [N-m/(rad/s)]
    REAL(ReKi)  :: RFrlDSDmp      ! Rotor-furl down-stop damping constant [N-m/(rad/s)]
    INTEGER(IntKi)  :: TFrlMod      ! Tail-furl spring/damper model switch [-]
    REAL(ReKi)  :: TFrlSpr      ! Tail-furl spring constant [N-m/rad]
    REAL(ReKi)  :: TFrlDmp      ! Tail-furl damping constant [N-m/(rad/s)]
    REAL(ReKi)  :: TFrlCDmp      ! Tail-furl rate-independent Coulomb-damping moment [N-m]
    REAL(ReKi)  :: TFrlUSSP      ! Tail-furl up-stop spring position [radians]
    REAL(ReKi)  :: TFrlDSSP      ! Tail-furl down-stop spring position [radians]
    REAL(ReKi)  :: TFrlUSSpr      ! Tail-furl up-stop spring constant [N-m/rad]
    REAL(ReKi)  :: TFrlDSSpr      ! Tail-furl down-stop spring constant [N-m/rad]
    REAL(ReKi)  :: TFrlUSDP      ! Tail-furl up-stop damper position [radians]
    REAL(ReKi)  :: TFrlDSDP      ! Tail-furl down-stop damper position [radians]
    REAL(ReKi)  :: TFrlUSDmp      ! Tail-furl up-stop damping constant [N-m/(rad/s)]
    REAL(ReKi)  :: TFrlDSDmp      ! Tail-furl down-stop damping constant [N-m/(rad/s)]
    INTEGER(IntKi)  :: method      ! Identifier for integration method (1 [RK4], 2 [AB4], or 3 [ABM4]) [-]
  END TYPE ED_InputFile
! =======================
! =========  ED_CoordSys  =======
  TYPE, PUBLIC :: ED_CoordSys
    REAL(ReKi) , DIMENSION(1:3)  :: a1      ! Vector / direction a1 (=  xt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: a2      ! Vector / direction a2 (=  zt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: a3      ! Vector / direction a3 (= -yt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: b1      ! Vector / direction b1 (=  xp from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: b2      ! Vector / direction b2 (=  zp from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: b3      ! Vector / direction b3 (= -yp from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: c1      ! Vector / direction c1 (=  xs from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: c2      ! Vector / direction c2 (=  zs from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: c3      ! Vector / direction c3 (= -ys from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: d1      ! Vector / direction d1 (=  xn from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: d2      ! Vector / direction d2 (=  zn from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: d3      ! Vector / direction d3 (= -yn from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: e1      ! Vector / direction e1 (=  xa from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: e2      ! Vector / direction e2 (=  ya from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: e3      ! Vector / direction e3 (=  za from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: f1      ! Vector / direction f1 [-]
    REAL(ReKi) , DIMENSION(1:3)  :: f2      ! Vector / direction f2 [-]
    REAL(ReKi) , DIMENSION(1:3)  :: f3      ! Vector / direction f3 [-]
    REAL(ReKi) , DIMENSION(1:3)  :: g1      ! Vector / direction g1 (=  xh from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: g2      ! Vector / direction g2 (=  yh from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: g3      ! Vector / direction g3 (=  zh from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i1      ! i1(K,:) = vector / direction i1 for blade K (=  xcK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i2      ! i2(K,:) = vector / direction i2 for blade K (=  ycK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: i3      ! i3(K,:) = vector / direction i3 for blade K (=  zcK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j1      ! j1(K,:) = vector / direction j1 for blade K (=  xbK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j2      ! j2(K,:) = vector / direction j2 for blade K (=  ybK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: j3      ! j3(K,:) = vector / direction j3 for blade K (=  zbK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m1      ! m1(K,J,:) = vector / direction m1 for node J of blade K (used to calc. and return aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m2      ! m2(K,J,:) = vector / direction m2 for node J of blade K (used to calc. and return aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: m3      ! m3(K,J,:) = vector / direction m3 for node J of blade K (used to calc. and return aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n1      ! n1(K,J,:) = vector / direction n1 for node J of blade K (= LxbK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n2      ! n2(K,J,:) = vector / direction n2 for node J of blade K (= LybK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: n3      ! n3(K,J,:) = vector / direction n3 for node J of blade K (= LzbK from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: p1      ! Vector / direction p1 (used to calc. and return tail aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: p2      ! Vector / direction p2 (used to calc. and return tail aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: p3      ! Vector / direction p3 (used to calc. and return tail aerodynamic loads from AeroDyn) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: rf1      ! Vector / direction rf1 (rotor-furl coordinate system = d1 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: rf2      ! Vector / direction rf2 (rotor-furl coordinate system = d2 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: rf3      ! Vector / direction rf3 (rotor-furl coordinate system = d3 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: rfa      ! Vector / direction of the rotor-furl axis [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t1      ! Vector / direction t1 for tower node J (=  Lxt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t2      ! Vector / direction t2 for tower node J (=  Lzt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: t3      ! Vector / direction t3 for tower node J (= -Lyt from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te1      ! te1(K,J,:) = vector / direction te1 for node J of blade K (used to calc. noise) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te2      ! te2(K,J,:) = vector / direction te2 for node J of blade K (used to calc. noise) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: te3      ! te3(K,J,:) = vector / direction te3 for node J of blade K (used to calc. noise) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: tf1      ! Vector / direction tf1 (tail-furl coordinate system = d1 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: tf2      ! Vector / direction tf2 (tail-furl coordinate system = d2 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: tf3      ! Vector / direction tf3 (tail-furl coordinate system = d3 when rotor-furl angle = 0) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: tfa      ! Vector / direction of the tail-furl axis [-]
    REAL(ReKi) , DIMENSION(1:3)  :: z1      ! Vector / direction z1 (=  xi from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: z2      ! Vector / direction z2 (=  zi from the IEC coord. system) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: z3      ! Vector / direction z3 (= -yi from the IEC coord. system) [-]
  END TYPE ED_CoordSys
! =======================
! =========  ED_ActiveDOFs  =======
  TYPE, PUBLIC :: ED_ActiveDOFs
    INTEGER(IntKi)  :: NActvDOF      ! The number of active (enabled) DOFs in the model [-]
    INTEGER(IntKi)  :: NPCE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the hub center of mass (point C) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPDE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the center of mass of the structure that furls with the rotor (not including rotor) (point D) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPIE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the tail boom center of mass (point I) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPTE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the tower nodes (point T) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPTTE      ! Number of tower DOFs that contribute to the QD2T-related linear accelerations of the tower nodes (point T) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NPSBE      ! Number of blade DOFs that contribute to the QD2T-related linear accelerations of the blade nodes (point S) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NPSE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the blade nodes (point S) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPUE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the nacelle center of mass (point U) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi)  :: NPYE      ! Number of DOFs that contribute to the QD2T-related linear accelerations of the platform center of mass (point Y) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PCE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the hub center of mass (point C) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PDE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the center of mass of the structure that furls with the rotor (not including rotor) (point D) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PIE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the tail boom center of mass (point I) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PTE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the tower nodes (point T) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PTTE      ! Array of tower DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the tower nodes (point T) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PS      ! Array of DOF indices (pointers) to the active (enabled) DOFs/states [-]
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PSBE      ! Array of blade DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the blade nodes (point S) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PSE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the blade nodes (point S) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PUE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the nacelle center of mass (point U) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PYE      ! Array of DOF indices (pointers) that contribute to the QD2T-related linear accelerations of the platform center of mass (point Y) in the inertia frame, based on which DOFs are presently enabled [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: SrtPS      ! Sorted (from smallest to largest DOF index) version of PS() [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: SrtPSNAUG      ! SrtPS() with the additional value of NAUG [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: Diag      ! Array containing the indices of SrtPS() associated with each enabled DOF; that is, SrtPS(Diag(I)) = I [-]
  END TYPE ED_ActiveDOFs
! =======================
! =========  ED_RtHndSide  =======
  TYPE, PUBLIC :: ED_RtHndSide
    REAL(ReKi) , DIMENSION(1:3)  :: rO      ! Position vector from inertial frame origin to tower-top / base plate (point O) [m]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rQS      ! Position vector from the apex of rotation (point Q) to a point on a blade (point S) [m]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rS      ! Position vector from inertial frame origin to a point on a blade (point S) [m]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rS0S      ! Position vector from the blade root (point S(0)) to a point on a blade (point S) [m]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rT      ! Position vector from inertial frame origin to the current node (point T(HNodes(J)) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rT0O      ! Position vector from the tower base (point T(0)) to tower-top / base plate (point O) [m]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rT0T      ! Position vector from a height of TowerBsHt (base of flexible portion of tower) (point T(0)) to a point on the tower (point T) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rZ      ! Position vector from inertia frame origin to platform reference (point Z) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rZO      ! Position vector from platform reference (point Z) to tower-top / base plate (point O) [m]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rZT      ! Position vector from platform reference (point Z) to a point on a tower (point T) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rPQ      ! Position vector from teeter pin (point P) to apex of rotation (point Q) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rP      ! Position vector from inertial frame origin to teeter pin (point P) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rV      ! Position vector from inertial frame origin to specified point on rotor-furl axis (point V) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rZY      ! Position vector from platform reference (point Z) to platform mass center (point Y) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rOU      ! Position vector from tower-top / base plate (point O) to nacelle center of mass (point U). [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rOV      ! Position vector from tower-top / base plate (point O) to specified point on rotor-furl axis (point V) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rVD      ! Position vector from specified point on rotor-furl axis (point V) to center of mass of structure that furls with the rotor (not including rotor) (point D) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rOW      ! Position vector from tower-top / base plate (point O) to specified point on  tail-furl axis (point W) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rPC      ! Position vector from teeter pin (point P) to hub center of mass (point C) [m]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rPS0      ! Position vector from teeter pin (point P) to blade root (point S(0)) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rQ      ! Position vector from inertial frame origin to apex of rotation (point Q) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rQC      ! Position vector from apex of rotation (point Q) to hub center of mass (point C) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rVIMU      ! Position vector from specified point on rotor-furl axis (point V) to nacelle IMU (point IMU) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rVP      ! Position vector from specified point on rotor-furl axis (point V) to teeter pin (point P) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rWI      ! Position vector from specified point on  tail-furl axis (point W) to tail boom center of mass     (point I) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rWJ      ! Position vector from specified point on  tail-furl axis (point W) to tail fin  center of mass     (point J) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rWK      ! Position vector from specified point on  tail-furl axis (point W) to tail fin  center of pressure (point K) [m]
    REAL(ReKi) , DIMENSION(1:3)  :: rZT0      ! Position vector from platform reference (point Z) to tower base (point T(0)) [m]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngPosEF      ! Angular position of the current point on the tower (body F) in the inertial frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngPosXF      ! Angular position of the current point on the tower (body F) in the platform (body X) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AngPosHM      ! Angular position of eleMent J of blade K (body M) in the hub (body H) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngPosXB      ! Angular position of the base plate (body B) in the platform (body X) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngPosEX      ! Angular position of the platform                   (body X) in the inertial frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEA      ! Partial angular velocity (and its 1st time derivative) of the tail (body A) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: PAngVelEF      ! Partial angular velocity (and its 1st time derivative) of tower element J (body F) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEG      ! Partial angular velocity (and its 1st time derivative) of the generator (body G) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEH      ! Partial angular velocity (and its 1st time derivative) of the hub (body H) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEL      ! Partial angular velocity (and its 1st time derivative) of the low-speed shaft (body L) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PAngVelEM      ! Partial angular velocity (and its 1st time derivative) of eleMent J of blade K (body M) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEN      ! Partial angular velocity (and its 1st time derivative) of the nacelle (body N) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEA      ! Angular velocity of the tail (body A) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEB      ! Partial angular velocity (and its 1st time derivative) of the base plate (body B) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelER      ! Partial angular velocity (and its 1st time derivative) of the structure that furls with the rotor (not including rotor) (body R) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PAngVelEX      ! Partial angular velocity (and its 1st time derivative) of the platform (body B) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEG      ! Angular velocity of the generator (body G) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEH      ! Angular velocity of the hub (body H) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEL      ! Angular velocity of the low-speed shaft (body L) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEN      ! Angular velocity of the nacelle (body N) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEB      ! Angular velocity of the base plate (body B) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelER      ! Angular velocity of the structure that furls with the rotor (not including rotor) (body R) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngVelEX      ! Angular velocity of the platform (body X) in the inertia frame (body E for earth) [-]
    REAL(ReKi)  :: TeetAngVel      ! Angular velocity of the teeter motion [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEBt      ! Portion of the angular acceleration of the base plate (body B) in the inertia frame (body E for earth) associated with everything but the QD2T()s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccERt      ! Portion of the angular acceleration of the structure that furls with the rotor (not including rotor) (body R) in the inertia frame (body E for earth) associated with everything but the QD2T()s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEXt      ! Portion of the angular acceleration of the platform (body X) in the inertia frame (body E for earth) associated with everything but the QD2T()s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngAccEFt      ! Portion of the angular acceleration of tower element J (body F) in the inertia frame (body E for earth) associated with everything but the QD2T()s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AngVelEF      ! Angular velocity of the current point on the tower (body F) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEAt      ! Portion of the angular acceleration of the tail (body A) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEGt      ! Portion of the angular acceleration of the generator (body G) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccEHt      ! Portion of the angular acceleration of the hub (body H) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: AngAccENt      ! Portion of the angular acceleration of the nacelle (body N) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccECt      ! Portion of the linear acceleration of the hub center of mass (point C) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEDt      ! Portion of the linear acceleration of the center of mass of the structure that furls with the rotor (not including rotor) (point D) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEIt      ! Portion of the linear acceleration of the tail boom center of mass (point I) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEJt      ! Portion of the linear acceleration of the tail fin  center of mass (point J) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEUt      ! Portion of the linear acceleration of the nacelle center of mass (point U) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEYt      ! Portion of the linear acceleration of the platform center of mass (point Y) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: LinVelES      ! Linear velocity of current point on the current blade (point S) in the inertia frame [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: LinVelET      ! Linear velocity of current point on the tower (point T) in the inertia frame [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: LinVelESm2      ! The m2-component (closest to tip) of LinVelES [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEIMU      ! Partial linear velocity (and its 1st time derivative) of the nacelle IMU (point IMU) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEO      ! Partial linear velocity (and its 1st time derivative) of the base plate (point O) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: PLinVelES      ! Partial linear velocity (and its 1st time derivative) of a point on a blade (point S) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: PLinVelET      ! Partial linear velocity (and its 1st time derivative) of a point on the tower (point T) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEZ      ! Partial linear velocity (and its 1st time derivative) of the platform reference point (point Z) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEC      ! Partial linear velocity (and its 1st time derivative) of the hub center of mass (point C) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelED      ! Partial linear velocity (and its 1st time derivative) of the center of mass of the structure that furls with the rotor (not including rotor) (point D) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEI      ! Partial linear velocity (and its 1st time derivative) of the tail boom center of mass (point I) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEJ      ! Partial linear velocity (and its 1st time derivative) of the tail fin center of mass (point J) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEK      ! Partial linear velocity (and its 1st time derivative) of the tail fin center of pressure(point K) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEP      ! Partial linear velocity (and its 1st time derivative) of the teeter pin (point P) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEQ      ! Partial linear velocity (and its 1st time derivative) of the apex of rotation (point Q) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEU      ! Partial linear velocity (and its 1st time derivative) of the nacelle center of mass (point U) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEV      ! Partial linear velocity (and its 1st time derivative) of the selected point on the rotor-furl axis (point V) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEW      ! Partial linear velocity (and its 1st time derivative) of the selected point on the tail-furl axis (point W) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PLinVelEY      ! Partial linear velocity (and its 1st time derivative) of the platform mass center (point Y) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEIMUt      ! Portion of the linear acceleration of the nacelle IMU (point IMU) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEOt      ! Portion of the linear acceleration of the base plate (point O) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: LinAccESt      ! Portion of the linear acceleration of a point on a blade (point S) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: LinAccETt      ! Portion of the linear acceleration of a point on the tower (point T) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinAccEZt      ! Portion of the linear acceleration of the platform reference (point Z) in the inertia frame (body E for earth) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinVelEIMU      ! Linear velocity of the nacelle IMU (point IMU) in the inertia frame [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinVelEZ      ! Linear velocity of platform reference (point Z) in the inertia frame [-]
    REAL(ReKi) , DIMENSION(1:3)  :: LinVelEO      ! Linear velocity of the base plate (point O) in the inertia frame (body E for earth) [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcONcRtt      ! Portion of the force at yaw bearing (point O) due to the nacelle, generator, and rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcPRott      ! Portion of the force at the teeter pin (point P) due to the rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FrcS0Bt      ! Portion of the force at the blade root (point S(0)) due to the blade associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcT0Trbt      ! Portion of the force at tower base (point T(0)) due to the turbine associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FSAero      ! The aerodynamic force per unit span acting on a blade at point S [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSTipDrag      ! The aerodynamic force at a blade tip resulting from tip drag [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FTHydrot      ! Portion of the hydrodynamic force (& all other external forces, including aerodynamic) per unit length acting on the tower at point T associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FZHydrot      ! Portion of the platform hydrodynamic force at the platform reference (point Z) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MFHydrot      ! Portion of the hydrodynamic moment (and all other external moments, including aerodynamic) per unit length acting on a tower element (body F) at point T associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomBNcRtt      ! Portion of the moment at the base plate (body B) / yaw bearing (point O) due to the nacelle, generator, and rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MomH0Bt      ! Portion of the moment at the hub (body H) / blade root (point S(0)) due to the blade associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomLPRott      ! Portion of the moment at the teeter pin (point P) on the low-speed shaft (body L) due to the rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomNGnRtt      ! Portion of the moment at the nacelle (body N) / selected point on rotor-furl axis (point V) due the structure that furls with the rotor, generator, and rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomNTailt      ! Portion of the moment at the nacelle (body N) / selected point on tail-furl axis (point W) due the tail associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomX0Trbt      ! Portion of the moment at the platform (body X) / tower base (point T(0)) due to the turbine associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: MMAero      ! The aerodynamic moment per unit span acting on a blade at point S [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MXHydrot      ! Portion of the platform hydrodynamic moment acting at the platform (body X) / platform reference (point Z) associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcONcRt      ! Partial force at the yaw bearing (point O) due to the nacelle, generator, and rotor [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcPRot      ! Partial force at the teeter pin (point P) due to the rotor [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PFrcS0B      ! Partial force at the blade root (point S(0)) due to the blade [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcT0Trb      ! Partial force at the tower base (point T(0)) due to the turbine [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PFTHydro      ! Partial hydrodynamic force per unit length acting on the tower at point T [-]
    REAL(ReKi) , DIMENSION(1:6,1:3)  :: PFZHydro      ! Partial platform hydrodynamic force at the platform reference (point Z) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PMFHydro      ! Partial hydrodynamic moment per unit length acting on a tower element (body F) at point T [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomBNcRt      ! Partial moment at the base plate (body B) / yaw bearing (point O) due the nacelle, generator, and rotor [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: PMomH0B      ! Partial moment at the hub (body H) / blade root (point S(0)) due to the blade [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomLPRot      ! Partial moment at the teeter pin (point P) on the low-speed shaft (body L) due to the rotor [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomNGnRt      ! Partial moment at the nacelle (body N) / selected point on rotor-furl axis (point V) due the structure that furls with the rotor, generator, and rotor [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomNTail      ! Partial moment at the nacelle (body N) / selected point on tail-furl axis (point W) due the tail [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomX0Trb      ! Partial moment at the platform (body X) / tower base (point T(0)) due to the turbine [-]
    REAL(ReKi) , DIMENSION(1:6,1:3)  :: PMXHydro      ! Partial platform hydrodynamic moment at the platform (body X) / platform reference (point Z) [-]
    REAL(ReKi)  :: TeetAng      ! Current teeter angle = QT(DOF_Teet) for 2-blader or 0 for 3-blader (this is used in place of QT(DOF_Teet) throughout RtHS() [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcVGnRtt      ! Portion of the force at the rotor-furl axis (point V) due to the structure that furls with the rotor, generator, and rotor associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcWTailt      ! Portion of the force at the tail-furl axis (point W) due to the tail associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: FrcZAllt      ! Portion of the force at platform reference (point Z) due to everything associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(1:3)  :: MomXAllt      ! Portion of the moment at the platform (body X) / platform reference (point Z) due to everything associated with everything but the QD2T()'s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcVGnRt      ! Partial force at the rotor-furl axis (point V) due to the structure that furls with the rotor, generator, and rotor [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcWTail      ! Partial force at the tail-furl axis (point W) due to the tail [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PFrcZAll      ! Partial force at the platform reference (point Z) due to everything [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PMomXAll      ! Partial moment at the platform (body X) / platform reference (point Z) due to the everything [-]
    REAL(ReKi)  :: TeetMom      ! The total moment supplied by the stop, spring, and damper of the teeter mechanism [-]
    REAL(ReKi)  :: TFrlMom      ! The total tail-furl spring and damper moment [-]
    REAL(ReKi)  :: RFrlMom      ! The total rotor-furl spring and damper moment [-]
    REAL(ReKi)  :: GBoxEffFac      ! The factor used to apply the gearbox efficiency effects to the equation associated with the generator DOF [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: rSAerCen      ! aerodynamic pitching moment arm (i.e., the position vector from point S on the blade to the aerodynamic center of the element) [-]
  END TYPE ED_RtHndSide
! =======================
! =========  ED_ContinuousStateType  =======
  TYPE, PUBLIC :: ED_ContinuousStateType
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QT      ! Current estimate of Q (displacement matrix) for each degree of freedom [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QDT      ! Current estimate of QD (velocity matrix) for each degree of freedom [-]
  END TYPE ED_ContinuousStateType
! =======================
! =========  ED_DiscreteStateType  =======
  TYPE, PUBLIC :: ED_DiscreteStateType
    REAL(ReKi)  :: DummyDiscState      ! Remove this variable if you have discrete states [-]
  END TYPE ED_DiscreteStateType
! =======================
! =========  ED_ConstraintStateType  =======
  TYPE, PUBLIC :: ED_ConstraintStateType
    REAL(ReKi)  :: DummyConstrState      ! Remove this variable if you have constraint states [-]
  END TYPE ED_ConstraintStateType
! =======================
! =========  ED_OtherStateType  =======
  TYPE, PUBLIC :: ED_OtherStateType
    TYPE(ED_CoordSys)  :: CoordSys      ! Coordinate systems in the FAST framework [-]
    TYPE(ED_RtHndSide)  :: RtHS      ! Values used in calculating the right-hand-side RtHS (and outputs) [-]
    INTEGER(IntKi)  :: n      ! tracks time step for which OtherState was updated [-]
    TYPE(ED_ContinuousStateType) , DIMENSION(ED_NMX)  :: xdot      ! previous state deriv for multi-step [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: IC      ! Array which stores pointers to predictor-corrector results [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: QD2T      ! Solution (acceleration) vector; the first time derivative of QDT [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch      ! Current blade pitch angles [radians]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AugMat      ! The augmented matrix used for the solution of the QD2T()s [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AugMat_factor      ! factored version of AugMat matrix [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SolnVec      ! b in the equation Ax=b (last column of AugMat) [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: AugMat_pivot      ! Pivot column for AugMat in LAPACK factorization [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AllOuts      ! An array holding the value of all of the calculated (not only selected) output channels [see OutListParameters.xlsx spreadsheet]
    REAL(ReKi)  :: HSSBrTrq      ! HSSBrTrq from update states; a hack to get this working with a single integrator [-]
    REAL(ReKi)  :: HSSBrTrqC      ! Commanded HSS brake torque (adjusted for sign) [N-m]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: OgnlGeAzRo      ! Original DOF_GeAz row in AugMat [-]
    INTEGER(IntKi)  :: SgnPrvLSTQ      ! The sign of the low-speed shaft torque from the previous call to RtHS().  This is calculated at the end of RtHS().  NOTE: The low-speed shaft torque is assumed to be positive at the beginning of the run! [-]
    INTEGER(IntKi) , DIMENSION(ED_NMX)  :: SgnLSTQ      ! history of sign of LSTQ [-]
  END TYPE ED_OtherStateType
! =======================
! =========  ED_ParameterType  =======
  TYPE, PUBLIC :: ED_ParameterType
    REAL(DbKi)  :: DT      ! Time step for continuous state integration & discrete state update [seconds]
    REAL(DbKi)  :: DT24      ! =DT/24 (used in loose coupling) [seconds]
    INTEGER(IntKi)  :: BldNodes      ! Number of blade nodes used in the analysis [-]
    INTEGER(IntKi)  :: TipNode      ! Index of the additional node located at the blade tip = BldNodes + 1 [-]
    INTEGER(IntKi)  :: NDOF      ! Number of total degrees of freedom (DOFs) [-]
    REAL(ReKi)  :: TwoPiNB      ! Two pi divided by the number of blades [radians]
    INTEGER(IntKi)  :: NAug      ! Dimension of augmented solution matrix [-]
    INTEGER(IntKi)  :: NPH      ! Number of DOFs that contribute to the angular velocity of the hub (body H) in the inertia frame [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: PH      ! Array of DOF indices (pointers) that contribute to the angular velocity of the hub (body H) in the inertia frame [-]
    INTEGER(IntKi)  :: NPM      ! Number of DOFs that contribute to the angular velocity of the blade elements (body M) in the inertia frame [-]
    INTEGER(IntKi) , DIMENSION(:,:), ALLOCATABLE  :: PM      ! Array of DOF indices (pointers) that contribute to the angular velocity of the blade elements (body M) in the inertia frame [-]
    LOGICAL , DIMENSION(:), ALLOCATABLE  :: DOF_Flag      ! Array which stores values of the feature flags for each DOF [-]
    CHARACTER(99) , DIMENSION(:), ALLOCATABLE  :: DOF_Desc      ! Array which stores descriptions of each DOF [-]
    TYPE(ED_ActiveDOFs)  :: DOFs      ! Active degrees of freedom in the model [-]
    INTEGER(IntKi)  :: NumOuts = 0      ! Number of parameters in the output list (number of outputs requested) [-]
    CHARACTER(20)  :: OutFmt      ! Output format for tabular data [-]
    INTEGER(IntKi)  :: NBlGages = 0      ! Number of blade strain gages [-]
    INTEGER(IntKi)  :: NTwGages = 0      ! Number of tower strain gages [-]
    TYPE(OutParmType) , DIMENSION(:), ALLOCATABLE  :: OutParam      ! Names and units (and other characteristics) of all requested output parameters [-]
    CHARACTER(1)  :: Delim      ! Column delimiter for output text files [-]
    REAL(ReKi)  :: AvgNrmTpRd      ! Average tip radius normal to the shaft [meters]
    REAL(ReKi)  :: AzimB1Up      ! Azimuth value to use for I/O when blade 1 points up [radians]
    REAL(ReKi)  :: CosDel3 = 1.0      ! Cosine of the Delta-3 angle for teetering rotors [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CosPreC      ! Cosines of the precone angles [-]
    REAL(ReKi)  :: CRFrlSkew      ! Cosine of the rotor-furl axis skew angle [-]
    REAL(ReKi)  :: CRFrlSkw2      ! Cosine-squared of the rotor-furl axis skew angle [-]
    REAL(ReKi)  :: CRFrlTilt      ! Cosine of the rotor-furl axis tilt angle [-]
    REAL(ReKi)  :: CRFrlTlt2      ! Cosine-squared of the rotor-furl axis tilt angle [-]
    REAL(ReKi)  :: CShftSkew      ! Cosine of the shaft skew angle [-]
    REAL(ReKi)  :: CShftTilt      ! Cosine of the shaft tilt angle [-]
    REAL(ReKi)  :: CSRFrlSkw      ! Cosine*Sine of the rotor-furl axis skew angle [-]
    REAL(ReKi)  :: CSRFrlTlt      ! Cosine*Sine of the rotor-furl axis tilt angle [-]
    REAL(ReKi)  :: CSTFrlSkw      ! Cosine*Sine of the tail-furl axis skew angle [-]
    REAL(ReKi)  :: CSTFrlTlt      ! Cosine*Sine of the tail-furl axis tilt angle [-]
    REAL(ReKi)  :: CTFinBank      ! Cosine of the tail fin planform bank angle [-]
    REAL(ReKi)  :: CTFinSkew      ! Cosine of the tail fin chordline skew angle [-]
    REAL(ReKi)  :: CTFinTilt      ! Cosine of the tail fin chordline tilt angle [-]
    REAL(ReKi)  :: CTFrlSkew      ! Cosine of the tail-furl axis skew angle [-]
    REAL(ReKi)  :: CTFrlSkw2      ! Cosine-squared of the tail-furl axis skew angle [-]
    REAL(ReKi)  :: CTFrlTilt      ! Cosine of the tail-furl axis tilt angle [-]
    REAL(ReKi)  :: CTFrlTlt2      ! Cosine-squared of the tail-furl axis tilt angle [-]
    REAL(ReKi)  :: HubHt      ! Hub-height as computed using FAST inputs [= TowerHt + Twr2Shft + OverHang*SIN( ShftTilt ) ] (was FASTHH) [-]
    REAL(ReKi)  :: HubCM      ! Distance from rotor apex to hub mass [-]
    REAL(ReKi)  :: HubRad      ! Preconed hub radius [-]
    REAL(ReKi)  :: NacCMxn      ! Downwind distance from tower-top to nacelle CM [-]
    REAL(ReKi)  :: NacCMyn      ! Lateral distance from tower-top to nacelle CM [-]
    REAL(ReKi)  :: NacCMzn      ! Vertical distance from tower-top to nacelle CM [-]
    REAL(ReKi)  :: OverHang      ! Distance from yaw axis to rotor apex or teeter pin [-]
    REAL(ReKi)  :: ProjArea      ! Swept area of the rotor projected onto the rotor plane (the plane normal to the low-speed shaft) [-]
    REAL(ReKi)  :: PtfmRefzt      ! Vertical distance from the ground [onshore] or MSL [offshore] to the platform reference point [-]
    REAL(ReKi)  :: RefTwrHt      ! Vertical distance between FAST's undisplaced tower height (variable TowerHt) and FAST's inertia frame reference point (variable PtfmRef); that is, RefTwrHt = TowerHt - PtfmRefzt [-]
    REAL(ReKi)  :: RFrlPntxn      ! Downwind distance from tower-top to arbitrary point on rotor-furl axis [-]
    REAL(ReKi)  :: RFrlPntyn      ! Lateral distance from tower-top to arbitrary point on rotor-furl axis [-]
    REAL(ReKi)  :: RFrlPntzn      ! Vertical distance from tower-top to arbitrary point on rotor-furl axis [-]
    REAL(ReKi)  :: rVDxn      ! xn-component of position vector Rvd [-]
    REAL(ReKi)  :: rVDyn      ! yn-component of position vector rVD [-]
    REAL(ReKi)  :: rVDzn      ! zn-component of position vector rVD [-]
    REAL(ReKi)  :: rVIMUxn      ! xn-component of position vector rVIMU [-]
    REAL(ReKi)  :: rVIMUyn      ! yn-component of position vector rVIMU [-]
    REAL(ReKi)  :: rVIMUzn      ! zn-component of position vector rVIMU [-]
    REAL(ReKi)  :: rVPxn      ! xn-component of position vector rVP [-]
    REAL(ReKi)  :: rVPyn      ! yn-component of position vector rVP [-]
    REAL(ReKi)  :: rVPzn      ! zn-component of position vector rVP [-]
    REAL(ReKi)  :: rWIxn      ! xn-component of position vector rWI [-]
    REAL(ReKi)  :: rWIyn      ! yn-component of position vector rWI [-]
    REAL(ReKi)  :: rWIzn      ! zn-component of position vector rWI [-]
    REAL(ReKi)  :: rWJxn      ! xn-component of position vector rWJ [-]
    REAL(ReKi)  :: rWJyn      ! yn-component of position vector rWJ [-]
    REAL(ReKi)  :: rWJzn      ! zn-component of position vector rWJ [-]
    REAL(ReKi)  :: rWKxn      ! xn-component of position vector rWK [-]
    REAL(ReKi)  :: rWKyn      ! yn-component of position vector rWK [-]
    REAL(ReKi)  :: rWKzn      ! zn-component of position vector rWK [-]
    REAL(ReKi)  :: rZT0zt      ! zt-component of position vector rZT0 [-]
    REAL(ReKi)  :: rZYzt      ! zt-component of position vector rZY [-]
    REAL(ReKi)  :: SinDel3      ! Sine of the Delta-3 angle for teetering rotors [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SinPreC      ! Sines of the precone angles [-]
    REAL(ReKi)  :: SRFrlSkew      ! Sine of the rotor-furl axis skew angle [-]
    REAL(ReKi)  :: SRFrlSkw2      ! Sine-squared of the rotor-furl axis skew angle [-]
    REAL(ReKi)  :: SRFrlTilt      ! Sine of the rotor-furl axis tilt angle [-]
    REAL(ReKi)  :: SRFrlTlt2      ! Sine-squared of the rotor-furl axis tilt angle [-]
    REAL(ReKi)  :: SShftSkew      ! Sine of the shaft skew angle [-]
    REAL(ReKi)  :: SShftTilt      ! Sine of the shaft tilt angle [-]
    REAL(ReKi)  :: STFinBank      ! Sine of the tail fin planform bank angle [-]
    REAL(ReKi)  :: STFinSkew      ! Sine of the tail fin chordline skew angle [-]
    REAL(ReKi)  :: STFinTilt      ! Sine of the tail fin chordline tilt angle [-]
    REAL(ReKi)  :: STFrlSkew      ! Sine of the tail-furl axis skew angle [-]
    REAL(ReKi)  :: STFrlSkw2      ! Sine-squared of the tail-furl axis skew angle [-]
    REAL(ReKi)  :: STFrlTilt      ! Sine of the tail-furl axis tilt angle [-]
    REAL(ReKi)  :: STFrlTlt2      ! Sine-squared of the tail-furl axis tilt angle [-]
    REAL(ReKi)  :: TFrlPntxn      ! Downwind distance from tower-top to arbitrary point on tail-furl axis [-]
    REAL(ReKi)  :: TFrlPntyn      ! Lateral distance from tower-top to arbitrary point on tail-furl axis [-]
    REAL(ReKi)  :: TFrlPntzn      ! Vertical distance from tower-top to arbitrary point on tail-furl axis [-]
    REAL(ReKi)  :: TipRad      ! Preconed blade-tip radius [-]
    REAL(ReKi)  :: TowerHt      ! Height of tower above ground level [-]
    REAL(ReKi)  :: TowerBsHt      ! Height of tower base above ground level [onshore] or MSL [offshore] [meters]
    REAL(ReKi)  :: UndSling      ! Undersling length [-]
    INTEGER(IntKi)  :: NumBl      ! Number of turbine blades [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AxRedTFA      ! The axial-reduction terms for the fore-aft tower mode shapes [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: AxRedTSS      ! The axial-reduction terms for the side-to-side tower mode shapes [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: CTFA      ! Generalized damping of tower in fore-aft direction [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: CTSS      ! Generalized damping of tower in side-to-side direction [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DHNodes      ! Length of variable-length tower elements [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HNodes      ! Location of variable-spaced tower nodes (relative to the tower rigid base height [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HNodesNorm      ! Normalized location of variable-spaced tower nodes (relative to the tower rigid base height) (0 < HNodesNorm(:) < 1) [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: KTFA      ! Generalized stiffness of tower in fore-aft direction [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: KTSS      ! Generalized stiffness of tower in side-to-side direction [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: MassT      ! Interpolated lineal mass density of tower [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTSS      ! Interpolated side-side tower stiffness [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrFASF      ! Tower fore-aft shape functions [-]
    REAL(ReKi)  :: TwrFlexL      ! Height / length of the flexible portion of the tower [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrSSSF      ! Tower side-to-side shape functions [-]
    INTEGER(IntKi)  :: TTopNode      ! Index of the additional node located at the tower-top = TwrNodes + 1 [-]
    INTEGER(IntKi)  :: TwrNodes      ! Number of tower nodes used in the analysis [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: InerTFA      ! Interpolated tower fore-aft (about yt-axis) mass inertia per unit length [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: InerTSS      ! Interpolated tower side-to-side (about xt-axis) mass inertia per unit length [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTGJ      ! Interpolated tower torsional stiffness [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTEA      ! Interpolated tower extensional stiffness [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: StiffTFA      ! Interpolated fore-aft tower stiffness [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: cgOffTFA      ! Interpolated tower fore-aft mass cg offset [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: cgOffTSS      ! Interpolated tower side-to-side mass cg offset [-]
    REAL(ReKi)  :: AtfaIner      ! Inertia of tail boom about the tail-furl axis whose origin is the tail boom center of mass [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldCG      ! Blade center of mass wrt the blade root [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BldMass      ! Blade masses [-]
    REAL(ReKi)  :: BoomMass      ! Tail boom mass [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: FirstMom      ! First mass moment of inertia of blades wrt the root [-]
    REAL(ReKi)  :: GenIner      ! Generator inertia about HSS [-]
    REAL(ReKi)  :: Hubg1Iner      ! Inertia of hub about g1-axis (rotor centerline) [-]
    REAL(ReKi)  :: Hubg2Iner      ! Inertia of hub about g2-axis (transverse to the cyclinder and passing through its c.g.) [-]
    REAL(ReKi)  :: HubMass      ! Hub mass [-]
    REAL(ReKi)  :: Nacd2Iner      ! Inertia of nacelle about the d2-axis whose origin is the nacelle center of mass [-]
    REAL(ReKi)  :: NacMass      ! Nacelle mass [-]
    REAL(ReKi)  :: PtfmMass      ! Platform mass [-]
    REAL(ReKi)  :: PtfmPIner      ! Platform inertia for pitch tilt rotation about the platform CM. [-]
    REAL(ReKi)  :: PtfmRIner      ! Platform inertia for roll tilt rotation about the platform CM. [-]
    REAL(ReKi)  :: PtfmYIner      ! Platform inertia for yaw rotation about the platform CM. [-]
    REAL(ReKi)  :: RFrlMass      ! Rotor-furl mass [-]
    REAL(ReKi)  :: RotIner      ! Inertia of rotor about its centerline [-]
    REAL(ReKi)  :: RotMass      ! Rotor mass (blades, tips, and hub) [-]
    REAL(ReKi)  :: RrfaIner      ! Inertia of structure that furls with the rotor (not including rotor) about the rotor-furl axis whose origin is the center of mass of the structure that furls with the rotor (not including rotor) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SecondMom      ! Second mass moment of inertia of blades wrt the root [-]
    REAL(ReKi)  :: TFinMass      ! Tail fin mass [-]
    REAL(ReKi)  :: TFrlIner      ! Tail boom inertia about tail-furl axis [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TipMass      ! Tip-brake masses [-]
    REAL(ReKi)  :: TurbMass      ! Mass of turbine (tower + rotor + nacelle) [-]
    REAL(ReKi)  :: TwrMass      ! Mass of tower [-]
    REAL(ReKi)  :: TwrTpMass      ! Tower-top mass (rotor + nacelle) [-]
    REAL(ReKi)  :: YawBrMass      ! Yaw bearing mass [-]
    REAL(ReKi)  :: Gravity      ! Gravitational acceleration [m/s^2]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: PitchAxis      ! Pitch axis for analysis nodes [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AeroTwst      ! Aerodynamic twist of the blade at the analysis nodes [-]
    REAL(ReKi) , DIMENSION(:,:,:,:), ALLOCATABLE  :: AxRedBld      ! The axial-reduction terms of the blade shape function [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BAlpha      ! Interpolated blade coupling coefficient between flap and twist [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldEDamp      ! Blade edgewise damping coefficients [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFDamp      ! Blade flapwise damping coefficients [-]
    REAL(ReKi)  :: BldFlexL      ! Flexible blade length [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CAeroTwst      ! Cosine of the aerodynamic twist of the blade at the analysis nodes [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CBE      ! Generalized edgewise damping of the blades [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CBF      ! Generalized flapwise damping of the blades [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: cgOffBEdg      ! Interpolated blade edge (along local aerodynamic yb-axis) mass cg offset [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: cgOffBFlp      ! Interpolated blade flap (along local aerodynamic xb-axis) mass cg offset [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: Chord      ! Chord of the blade at the analysis nodes [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CThetaS      ! COS( ThetaS ) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DRNodes      ! Length of variable-spaced blade elements [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: EAOffBEdg      ! Interpolated blade edge (along local aerodynamic yb-axis) elastic axis offset [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: EAOffBFlp      ! Interpolated blade flap (along local aerodynamic xb-axis) elastic axis offset [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FStTunr      ! Blade flapwise modal stiffness tuners (stored for all blades) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: InerBEdg      ! Interpolated blade edge (about local structural xb-axis) mass inertia per unit length [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: InerBFlp      ! Interpolated blade flap (about local structural yb-axis) mass inertia per unit length [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: KBE      ! Generalized edgewise stiffness of the blades [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: KBF      ! Generalized flapwise stiffness of the blades [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MassB      ! Interpolated lineal blade mass density [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: RefAxisxb      ! Interpolated Offset for defining the reference axis from the pitch axis for precurved blades at a given input station (along xb-axis) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: RefAxisyb      ! Interpolated Offset for defining the reference axis from the pitch axis for preswept blades at a given input station (along yb-axis) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodes      ! Radius to analysis nodes relative to hub ( 0 < RNodes(:) < BldFlexL ) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RNodesNorm      ! Normalized radius to analysis nodes relative to hub ( 0 < RNodesNorm(:) < 1 ) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rSAerCenn1      ! Distance from point S on a blade to the aerodynamic center in the n1 direction (m) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: rSAerCenn2      ! Distance from point S on a blade to the aerodynamic center in the n2 direction (m) [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: SAeroTwst      ! Sine of the aerodynamic twist of the blade at the analysis nodes [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBE      ! Interpolated edgewise blade stiffness [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBEA      ! Interpolated blade extensional stiffness [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBF      ! Interpolated flapwise blade stiffness [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: StiffBGJ      ! Interpolated blade torsional stiffness [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SThetaS      ! SIN( ThetaS ) [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ThetaS      ! Structural twist for analysis nodes [radians]
    REAL(ReKi) , DIMENSION(:,:,:,:,:), ALLOCATABLE  :: TwistedSF      ! Interpolated lineal blade mass density [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFl1Sh      ! Blade-flap-mode-1 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldFl2Sh      ! Blade-flap-mode-2 shape coefficients [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BldEdgSh      ! Blade-edge-mode shape coefficients [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FreqBE      ! Blade edgewise natural frequencies (both w/ and w/o centrifugal stiffening) [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FreqBF      ! Blade flapwise natural frequencies (both w/ and w/o centrifugal stiffening) [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: FreqTFA      ! Computed fore-aft tower natural frequencies [-]
    REAL(ReKi) , DIMENSION(1:2,1:2)  :: FreqTSS      ! Computed side-to-side tower natural frequencies [-]
    REAL(ReKi)  :: TeetCDmp      ! Rotor-teeter rate-independent Coulomb-damping [-]
    REAL(ReKi)  :: TeetDmp      ! Rotor-teeter damping constant [-]
    REAL(ReKi)  :: TeetDmpP      ! Rotor-teeter damper position [-]
    REAL(ReKi)  :: TeetHSSp      ! Rotor-teeter hard-stop linear-spring constant [-]
    REAL(ReKi)  :: TeetHStP      ! Rotor-teeter hard-stop position [-]
    REAL(ReKi)  :: TeetSSSp      ! Rotor-teeter soft-stop linear-spring constant [-]
    REAL(ReKi)  :: TeetSStP      ! Rotor-teeter soft-stop position [-]
    INTEGER(IntKi)  :: TeetMod      ! Rotor-teeter spring/damper model switch [-]
    REAL(ReKi)  :: TFrlCDmp      ! Tail-furl rate-independent Coulomb-damping moment [-]
    REAL(ReKi)  :: TFrlDmp      ! Tail-furl damping constant [-]
    REAL(ReKi)  :: TFrlDSDmp      ! Tail-furl down-stop damping constant [-]
    REAL(ReKi)  :: TFrlDSDP      ! Tail-furl down-stop damper position [-]
    REAL(ReKi)  :: TFrlDSSP      ! Tail-furl down-stop spring position [-]
    REAL(ReKi)  :: TFrlDSSpr      ! Tail-furl down-stop spring constant [-]
    REAL(ReKi)  :: TFrlSpr      ! Tail-furl spring constant [-]
    REAL(ReKi)  :: TFrlUSDmp      ! Tail-furl up-stop damping constant [-]
    REAL(ReKi)  :: TFrlUSDP      ! Tail-furl up-stop damper position [-]
    REAL(ReKi)  :: TFrlUSSP      ! Tail-furl up-stop spring position [-]
    REAL(ReKi)  :: TFrlUSSpr      ! Tail-furl up-stop spring constant [-]
    INTEGER(IntKi)  :: TFrlMod      ! Tail-furl spring/damper model switch [-]
    REAL(ReKi)  :: RFrlCDmp      ! Rotor-furl rate-independent Coulomb-damping moment [-]
    REAL(ReKi)  :: RFrlDmp      ! Rotor-furl damping constant [-]
    REAL(ReKi)  :: RFrlDSDmp      ! Rotor-furl down-stop damping constant [-]
    REAL(ReKi)  :: RFrlDSDP      ! Rotor-furl down-stop damper position [-]
    REAL(ReKi)  :: RFrlDSSP      ! Rotor-furl down-stop spring position [-]
    REAL(ReKi)  :: RFrlDSSpr      ! Rotor-furl down-stop spring constant [-]
    REAL(ReKi)  :: RFrlSpr      ! Rotor-furl spring constant [-]
    REAL(ReKi)  :: RFrlUSDmp      ! Rotor-furl up-stop damping constant [-]
    REAL(ReKi)  :: RFrlUSDP      ! Rotor-furl up-stop damper position [-]
    REAL(ReKi)  :: RFrlUSSP      ! Rotor-furl up-stop spring position [-]
    REAL(ReKi)  :: RFrlUSSpr      ! Rotor-furl up-stop spring constant [-]
    INTEGER(IntKi)  :: RFrlMod      ! Rotor-furl spring/damper model switch [-]
    REAL(ReKi)  :: ShftGagL      ! Distance from hub or teeter pin to shaft strain gages [-]
    INTEGER(IntKi) , DIMENSION(1:9)  :: BldGagNd      ! Nodes closest to the blade strain gages [-]
    INTEGER(IntKi) , DIMENSION(1:9)  :: TwrGagNd      ! Nodes closest to the tower strain gages [-]
    REAL(DbKi)  :: TStart      ! Time to begin tabular output [-]
    REAL(ReKi)  :: DTTorDmp      ! Drivetrain torsional damper [-]
    REAL(ReKi)  :: DTTorSpr      ! Drivetrain torsional spring [-]
    REAL(ReKi)  :: GBRatio      ! Gearbox ratio [-]
    REAL(ReKi)  :: GBoxEff      ! Gearbox efficiency [-]
    REAL(ReKi)  :: RotSpeed      ! Initial or fixed rotor speed [rad/s]
    CHARACTER(1024)  :: RootName      ! RootName for writing output files [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: BElmntMass      ! Mass of the blade elements [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TElmntMass      ! Mass of the tower elements [-]
    INTEGER(IntKi)  :: method      ! Identifier for integration method (1 [RK4], 2 [AB4], or 3 [ABM4]) [-]
    REAL(ReKi)  :: PtfmCMxt      ! Downwind distance from the ground [onshore] or MSL [offshore] to the platform CM [meters]
    REAL(ReKi)  :: PtfmCMyt      ! Lateral distance from the ground [onshore] or MSL [offshore] to the platform CM [meters]
    LOGICAL  :: BD4Blades      ! flag to determine if BeamDyn is computing blade loads (true) or ElastoDyn is (false) [-]
  END TYPE ED_ParameterType
! =======================
! =========  ED_InputType  =======
  TYPE, PUBLIC :: ED_InputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: BladeLn2Mesh      ! A mesh on each blade, containing aerodynamic forces and moments (formerly AeroBladeForce and AeroBladeMoment) [-]
    TYPE(MeshType)  :: PlatformPtMesh      ! A mesh at the platform reference (point Z), containing force: surge/xi (1), sway/yi (2), and heave/zi (3)-components; and moments: roll/xi (1), pitch/yi (2), and yaw/zi (3)-components acting at the platform (body X) / platform reference (point Z) associated with everything but the QD2T()s [N]
    TYPE(MeshType)  :: TowerLn2Mesh      ! Tower line2 mesh with forces: surge/xi (1), sway/yi (2), and heave/zi (3)-components of the portion of the tower force at the current tower node (point T); and moments: roll/xi (1), pitch/yi (2), and yaw/zi (3)-components of the portion of the tower moment acting at the current tower node [N/m]
    TYPE(MeshType)  :: NacelleLoads      ! From ServoDyn/TMD: loads on the nacelle. [-]
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: TwrAddedMass      ! 6-by-6 added mass matrix of the tower elements, per unit length-bjj: place on a mesh [per unit length]
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: PtfmAddedMass      ! Platform added mass matrix [kg, kg-m, kg-m^2]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitchCom      ! Commanded blade pitch angles [radians]
    REAL(ReKi)  :: YawMom      ! Torque transmitted through the yaw bearing [N-m]
    REAL(ReKi)  :: GenTrq      ! Electrical generator torque [N-m]
    REAL(ReKi)  :: HSSBrTrqC      ! Commanded HSS brake torque [N-m]
  END TYPE ED_InputType
! =======================
! =========  ED_OutputType  =======
  TYPE, PUBLIC :: ED_OutputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: BladeLn2Mesh      ! A mesh on each blade, containing positions and orientations of the blade elements [-]
    TYPE(MeshType)  :: PlatformPtMesh      ! Platform reference point positions/orientations/velocities/accelerations [-]
    TYPE(MeshType)  :: TowerLn2Mesh      ! Tower line2 mesh with positions/orientations/velocities/accelerations [-]
    TYPE(MeshType)  :: RotorApexMotion      ! For nacelle-mounted lidar; when AeroDyn is fixed, this will be the same as the HubPtMotion mesh [-]
    TYPE(MeshType)  :: HubPtMotion      ! For AeroDyn: motions of the hub [-]
    TYPE(MeshType)  :: BladeRootMotions      ! For AeroDyn: motions of the blade roots [-]
    TYPE(MeshType)  :: RotorFurlMotion      ! For AeroDyn: motions of the rotor furl point. [-]
    TYPE(MeshType)  :: NacelleMotion      ! For AeroDyn & ServoDyn/TMD: motions of the nacelle. [-]
    TYPE(MeshType)  :: TowerMotion      ! For AeroDyn: motions of the tower [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: WriteOutput      ! Data to be written to an output file: see WriteOutputHdr for names of each variable [see WriteOutputUnt]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: BlPitch      ! Current blade pitch angles [radians]
    REAL(ReKi)  :: Yaw      ! Current nacelle yaw [radians]
    REAL(ReKi)  :: YawRate      ! Current nacelle yaw rate [rad/s]
    REAL(ReKi)  :: LSS_Spd      ! Low-speed shaft (LSS) speed at entrance to gearbox [rad/s]
    REAL(ReKi)  :: HSS_Spd      ! High-speed shaft (HSS) speed [rad/s]
    REAL(ReKi)  :: RotSpeed      ! Rotor azimuth angular speed [rad/s]
    REAL(ReKi)  :: TwrAccel      ! Tower acceleration for tower feedback control (user routine only) [m/s^2]
    REAL(ReKi)  :: YawAngle      ! Yaw angle to be used for yaw error calculations [radians]
    REAL(ReKi) , DIMENSION(1:3)  :: RootMyc      ! Out-of-plane moment (i.e., the moment caused by out-of-plane forces) at the blade root for each of the blades (max 3) [N-m]
    REAL(ReKi)  :: YawBrTAxp      ! Tower-top / yaw bearing fore-aft (translational) acceleration (absolute) [m/s^2]
    REAL(ReKi)  :: YawBrTAyp      ! Tower-top / yaw bearing side-to-side (translational) acceleration (absolute) [m/s^2]
    REAL(ReKi)  :: LSSTipPxa      ! Rotor azimuth angle (position) [radians]
    REAL(ReKi) , DIMENSION(1:3)  :: RootMxc      ! In-plane moment (i.e., the moment caused by in-plane forces) at the blade root [N-m]
    REAL(ReKi)  :: LSSTipMya      ! Rotating low-speed shaft bending moment at the shaft tip (teeter pin for 2-blader, apex of rotation for 3-blader) [N-m]
    REAL(ReKi)  :: LSSTipMza      ! Rotating low-speed shaft bending moment at the shaft tip (teeter pin for 2-blader, apex of rotation for 3-blader) [N-m]
    REAL(ReKi)  :: LSSTipMys      ! Nonrotating low-speed shaft bending moment at the shaft tip (teeter pin for 2-blader, apex of rotation for 3-blader) [N-m]
    REAL(ReKi)  :: LSSTipMzs      ! Nonrotating low-speed shaft bending moment at the shaft tip (teeter pin for 2-blader, apex of rotation for 3-blader) [N-m]
    REAL(ReKi)  :: YawBrMyn      ! Rotating (with nacelle) tower-top / yaw bearing pitch moment [N-m]
    REAL(ReKi)  :: YawBrMzn      ! Tower-top / yaw bearing yaw moment [N-m]
    REAL(ReKi)  :: NcIMURAxs      ! Nacelle inertial measurement unit angular (rotational) acceleration (absolute) [rad/s^2]
    REAL(ReKi)  :: NcIMURAys      ! Nacelle inertial measurement unit angular (rotational) acceleration (absolute) [rad/s^2]
    REAL(ReKi)  :: NcIMURAzs      ! Nacelle inertial measurement unit angular (rotational) acceleration (absolute) [rad/s^2]
    REAL(ReKi)  :: RotPwr      ! Rotor power (this is equivalent to the low-speed shaft power) [W]
  END TYPE ED_OutputType
! =======================
CONTAINS
 SUBROUTINE ED_CopyInitInput( SrcInitInputData, DstInitInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_InitInputType), INTENT(IN) :: SrcInitInputData
   TYPE(ED_InitInputType), INTENT(INOUT) :: DstInitInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInitInputData%InputFile = SrcInitInputData%InputFile
   DstInitInputData%ADInputFile = SrcInitInputData%ADInputFile
   DstInitInputData%CompElast = SrcInitInputData%CompElast
   DstInitInputData%RootName = SrcInitInputData%RootName
 END SUBROUTINE ED_CopyInitInput

 SUBROUTINE ED_DestroyInitInput( InitInputData, ErrStat, ErrMsg )
  TYPE(ED_InitInputType), INTENT(INOUT) :: InitInputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyInitInput

 SUBROUTINE ED_PackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_InitInputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for InputFile
!  missing buffer for ADInputFile
  Int_BufSz  = Int_BufSz  + 1  ! CompElast
!  missing buffer for RootName
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%CompElast ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE ED_PackInitInput

 SUBROUTINE ED_UnPackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_InitInputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInitInput

 SUBROUTINE ED_CopyInitOutput( SrcInitOutputData, DstInitOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_InitOutputType), INTENT(IN) :: SrcInitOutputData
   TYPE(ED_InitOutputType), INTENT(INOUT) :: DstInitOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInitOutputData%WriteOutputHdr)) THEN
   i1_l = LBOUND(SrcInitOutputData%WriteOutputHdr,1)
   i1_u = UBOUND(SrcInitOutputData%WriteOutputHdr,1)
   IF (.NOT. ALLOCATED(DstInitOutputData%WriteOutputHdr)) THEN 
      ALLOCATE(DstInitOutputData%WriteOutputHdr(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInitOutputData%WriteOutputHdr.', ErrStat, ErrMsg,'ED_CopyInitOutput')
         RETURN
      END IF
   END IF
   DstInitOutputData%WriteOutputHdr = SrcInitOutputData%WriteOutputHdr
ENDIF
IF (ALLOCATED(SrcInitOutputData%WriteOutputUnt)) THEN
   i1_l = LBOUND(SrcInitOutputData%WriteOutputUnt,1)
   i1_u = UBOUND(SrcInitOutputData%WriteOutputUnt,1)
   IF (.NOT. ALLOCATED(DstInitOutputData%WriteOutputUnt)) THEN 
      ALLOCATE(DstInitOutputData%WriteOutputUnt(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInitOutputData%WriteOutputUnt.', ErrStat, ErrMsg,'ED_CopyInitOutput')
         RETURN
      END IF
   END IF
   DstInitOutputData%WriteOutputUnt = SrcInitOutputData%WriteOutputUnt
ENDIF
      CALL NWTC_Library_Copyprogdesc( SrcInitOutputData%Ver, DstInitOutputData%Ver, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInitOutput:Ver')
         IF (ErrStat>=AbortErrLev) RETURN
   DstInitOutputData%NumBl = SrcInitOutputData%NumBl
   DstInitOutputData%Gravity = SrcInitOutputData%Gravity
IF (ALLOCATED(SrcInitOutputData%BlPitch)) THEN
   i1_l = LBOUND(SrcInitOutputData%BlPitch,1)
   i1_u = UBOUND(SrcInitOutputData%BlPitch,1)
   IF (.NOT. ALLOCATED(DstInitOutputData%BlPitch)) THEN 
      ALLOCATE(DstInitOutputData%BlPitch(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInitOutputData%BlPitch.', ErrStat, ErrMsg,'ED_CopyInitOutput')
         RETURN
      END IF
   END IF
   DstInitOutputData%BlPitch = SrcInitOutputData%BlPitch
ENDIF
   DstInitOutputData%BladeLength = SrcInitOutputData%BladeLength
   DstInitOutputData%HubHt = SrcInitOutputData%HubHt
   DstInitOutputData%PlatformPos = SrcInitOutputData%PlatformPos
 END SUBROUTINE ED_CopyInitOutput

 SUBROUTINE ED_DestroyInitOutput( InitOutputData, ErrStat, ErrMsg )
  TYPE(ED_InitOutputType), INTENT(INOUT) :: InitOutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InitOutputData%WriteOutputHdr)) THEN
   DEALLOCATE(InitOutputData%WriteOutputHdr)
ENDIF
IF (ALLOCATED(InitOutputData%WriteOutputUnt)) THEN
   DEALLOCATE(InitOutputData%WriteOutputUnt)
ENDIF
  CALL NWTC_Library_Destroyprogdesc( InitOutputData%Ver, ErrStat, ErrMsg )
IF (ALLOCATED(InitOutputData%BlPitch)) THEN
   DEALLOCATE(InitOutputData%BlPitch)
ENDIF
 END SUBROUTINE ED_DestroyInitOutput

 SUBROUTINE ED_PackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_InitOutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ver_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for WriteOutputHdr
!  missing buffer for WriteOutputUnt
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Db_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Int_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ver_Buf ) ! Ver
  IF(ALLOCATED(Re_Ver_Buf))  DEALLOCATE(Re_Ver_Buf)
  IF(ALLOCATED(Db_Ver_Buf))  DEALLOCATE(Db_Ver_Buf)
  IF(ALLOCATED(Int_Ver_Buf)) DEALLOCATE(Int_Ver_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  IF ( ALLOCATED(InData%BlPitch) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  Re_BufSz   = Re_BufSz   + 1  ! HubHt
  Re_BufSz    = Re_BufSz    + SIZE( InData%PlatformPos )  ! PlatformPos 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, OnlySize ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 ) = Re_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 ) = Db_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 ) = Int_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ver_Buf) )  DEALLOCATE(Re_Ver_Buf)
  IF( ALLOCATED(Db_Ver_Buf) )  DEALLOCATE(Db_Ver_Buf)
  IF( ALLOCATED(Int_Ver_Buf) ) DEALLOCATE(Int_Ver_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PlatformPos))-1 ) =  PACK(InData%PlatformPos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PlatformPos)
 END SUBROUTINE ED_PackInitOutput

 SUBROUTINE ED_UnPackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_InitOutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ver_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    Re_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    Db_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    Int_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg ) ! Ver 
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1)))
  mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%PlatformPos,1)))
  mask1 = .TRUE.
  OutData%PlatformPos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PlatformPos))-1 ),mask1,OutData%PlatformPos)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PlatformPos)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInitOutput

 SUBROUTINE ED_CopyBladeInputData( SrcBladeInputDataData, DstBladeInputDataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BladeInputData), INTENT(IN) :: SrcBladeInputDataData
   TYPE(BladeInputData), INTENT(INOUT) :: DstBladeInputDataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstBladeInputDataData%NBlInpSt = SrcBladeInputDataData%NBlInpSt
IF (ALLOCATED(SrcBladeInputDataData%BlFract)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%BlFract,1)
   i1_u = UBOUND(SrcBladeInputDataData%BlFract,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%BlFract)) THEN 
      ALLOCATE(DstBladeInputDataData%BlFract(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%BlFract.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%BlFract = SrcBladeInputDataData%BlFract
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%PitchAx)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%PitchAx,1)
   i1_u = UBOUND(SrcBladeInputDataData%PitchAx,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%PitchAx)) THEN 
      ALLOCATE(DstBladeInputDataData%PitchAx(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%PitchAx.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%PitchAx = SrcBladeInputDataData%PitchAx
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%StrcTwst)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%StrcTwst,1)
   i1_u = UBOUND(SrcBladeInputDataData%StrcTwst,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%StrcTwst)) THEN 
      ALLOCATE(DstBladeInputDataData%StrcTwst(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%StrcTwst.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%StrcTwst = SrcBladeInputDataData%StrcTwst
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%BMassDen)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%BMassDen,1)
   i1_u = UBOUND(SrcBladeInputDataData%BMassDen,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%BMassDen)) THEN 
      ALLOCATE(DstBladeInputDataData%BMassDen(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%BMassDen.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%BMassDen = SrcBladeInputDataData%BMassDen
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%FlpStff)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%FlpStff,1)
   i1_u = UBOUND(SrcBladeInputDataData%FlpStff,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%FlpStff)) THEN 
      ALLOCATE(DstBladeInputDataData%FlpStff(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%FlpStff.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%FlpStff = SrcBladeInputDataData%FlpStff
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%EdgStff)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%EdgStff,1)
   i1_u = UBOUND(SrcBladeInputDataData%EdgStff,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%EdgStff)) THEN 
      ALLOCATE(DstBladeInputDataData%EdgStff(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%EdgStff.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%EdgStff = SrcBladeInputDataData%EdgStff
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%GJStff)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%GJStff,1)
   i1_u = UBOUND(SrcBladeInputDataData%GJStff,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%GJStff)) THEN 
      ALLOCATE(DstBladeInputDataData%GJStff(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%GJStff.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%GJStff = SrcBladeInputDataData%GJStff
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%EAStff)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%EAStff,1)
   i1_u = UBOUND(SrcBladeInputDataData%EAStff,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%EAStff)) THEN 
      ALLOCATE(DstBladeInputDataData%EAStff(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%EAStff.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%EAStff = SrcBladeInputDataData%EAStff
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%Alpha)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%Alpha,1)
   i1_u = UBOUND(SrcBladeInputDataData%Alpha,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%Alpha)) THEN 
      ALLOCATE(DstBladeInputDataData%Alpha(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%Alpha.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%Alpha = SrcBladeInputDataData%Alpha
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%FlpIner)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%FlpIner,1)
   i1_u = UBOUND(SrcBladeInputDataData%FlpIner,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%FlpIner)) THEN 
      ALLOCATE(DstBladeInputDataData%FlpIner(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%FlpIner.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%FlpIner = SrcBladeInputDataData%FlpIner
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%EdgIner)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%EdgIner,1)
   i1_u = UBOUND(SrcBladeInputDataData%EdgIner,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%EdgIner)) THEN 
      ALLOCATE(DstBladeInputDataData%EdgIner(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%EdgIner.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%EdgIner = SrcBladeInputDataData%EdgIner
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%PrecrvRef)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%PrecrvRef,1)
   i1_u = UBOUND(SrcBladeInputDataData%PrecrvRef,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%PrecrvRef)) THEN 
      ALLOCATE(DstBladeInputDataData%PrecrvRef(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%PrecrvRef.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%PrecrvRef = SrcBladeInputDataData%PrecrvRef
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%PreswpRef)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%PreswpRef,1)
   i1_u = UBOUND(SrcBladeInputDataData%PreswpRef,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%PreswpRef)) THEN 
      ALLOCATE(DstBladeInputDataData%PreswpRef(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%PreswpRef.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%PreswpRef = SrcBladeInputDataData%PreswpRef
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%FlpcgOf)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%FlpcgOf,1)
   i1_u = UBOUND(SrcBladeInputDataData%FlpcgOf,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%FlpcgOf)) THEN 
      ALLOCATE(DstBladeInputDataData%FlpcgOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%FlpcgOf.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%FlpcgOf = SrcBladeInputDataData%FlpcgOf
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%EdgcgOf)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%EdgcgOf,1)
   i1_u = UBOUND(SrcBladeInputDataData%EdgcgOf,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%EdgcgOf)) THEN 
      ALLOCATE(DstBladeInputDataData%EdgcgOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%EdgcgOf.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%EdgcgOf = SrcBladeInputDataData%EdgcgOf
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%FlpEAOf)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%FlpEAOf,1)
   i1_u = UBOUND(SrcBladeInputDataData%FlpEAOf,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%FlpEAOf)) THEN 
      ALLOCATE(DstBladeInputDataData%FlpEAOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%FlpEAOf.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%FlpEAOf = SrcBladeInputDataData%FlpEAOf
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%EdgEAOf)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%EdgEAOf,1)
   i1_u = UBOUND(SrcBladeInputDataData%EdgEAOf,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%EdgEAOf)) THEN 
      ALLOCATE(DstBladeInputDataData%EdgEAOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%EdgEAOf.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%EdgEAOf = SrcBladeInputDataData%EdgEAOf
ENDIF
   DstBladeInputDataData%BldFlDmp = SrcBladeInputDataData%BldFlDmp
   DstBladeInputDataData%BldEdDmp = SrcBladeInputDataData%BldEdDmp
   DstBladeInputDataData%FlStTunr = SrcBladeInputDataData%FlStTunr
IF (ALLOCATED(SrcBladeInputDataData%BldFl1Sh)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%BldFl1Sh,1)
   i1_u = UBOUND(SrcBladeInputDataData%BldFl1Sh,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%BldFl1Sh)) THEN 
      ALLOCATE(DstBladeInputDataData%BldFl1Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%BldFl1Sh.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%BldFl1Sh = SrcBladeInputDataData%BldFl1Sh
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%BldFl2Sh)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%BldFl2Sh,1)
   i1_u = UBOUND(SrcBladeInputDataData%BldFl2Sh,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%BldFl2Sh)) THEN 
      ALLOCATE(DstBladeInputDataData%BldFl2Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%BldFl2Sh.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%BldFl2Sh = SrcBladeInputDataData%BldFl2Sh
ENDIF
IF (ALLOCATED(SrcBladeInputDataData%BldEdgSh)) THEN
   i1_l = LBOUND(SrcBladeInputDataData%BldEdgSh,1)
   i1_u = UBOUND(SrcBladeInputDataData%BldEdgSh,1)
   IF (.NOT. ALLOCATED(DstBladeInputDataData%BldEdgSh)) THEN 
      ALLOCATE(DstBladeInputDataData%BldEdgSh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeInputDataData%BldEdgSh.', ErrStat, ErrMsg,'ED_CopyBladeInputData')
         RETURN
      END IF
   END IF
   DstBladeInputDataData%BldEdgSh = SrcBladeInputDataData%BldEdgSh
ENDIF
 END SUBROUTINE ED_CopyBladeInputData

 SUBROUTINE ED_DestroyBladeInputData( BladeInputDataData, ErrStat, ErrMsg )
  TYPE(BladeInputData), INTENT(INOUT) :: BladeInputDataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BladeInputDataData%BlFract)) THEN
   DEALLOCATE(BladeInputDataData%BlFract)
ENDIF
IF (ALLOCATED(BladeInputDataData%PitchAx)) THEN
   DEALLOCATE(BladeInputDataData%PitchAx)
ENDIF
IF (ALLOCATED(BladeInputDataData%StrcTwst)) THEN
   DEALLOCATE(BladeInputDataData%StrcTwst)
ENDIF
IF (ALLOCATED(BladeInputDataData%BMassDen)) THEN
   DEALLOCATE(BladeInputDataData%BMassDen)
ENDIF
IF (ALLOCATED(BladeInputDataData%FlpStff)) THEN
   DEALLOCATE(BladeInputDataData%FlpStff)
ENDIF
IF (ALLOCATED(BladeInputDataData%EdgStff)) THEN
   DEALLOCATE(BladeInputDataData%EdgStff)
ENDIF
IF (ALLOCATED(BladeInputDataData%GJStff)) THEN
   DEALLOCATE(BladeInputDataData%GJStff)
ENDIF
IF (ALLOCATED(BladeInputDataData%EAStff)) THEN
   DEALLOCATE(BladeInputDataData%EAStff)
ENDIF
IF (ALLOCATED(BladeInputDataData%Alpha)) THEN
   DEALLOCATE(BladeInputDataData%Alpha)
ENDIF
IF (ALLOCATED(BladeInputDataData%FlpIner)) THEN
   DEALLOCATE(BladeInputDataData%FlpIner)
ENDIF
IF (ALLOCATED(BladeInputDataData%EdgIner)) THEN
   DEALLOCATE(BladeInputDataData%EdgIner)
ENDIF
IF (ALLOCATED(BladeInputDataData%PrecrvRef)) THEN
   DEALLOCATE(BladeInputDataData%PrecrvRef)
ENDIF
IF (ALLOCATED(BladeInputDataData%PreswpRef)) THEN
   DEALLOCATE(BladeInputDataData%PreswpRef)
ENDIF
IF (ALLOCATED(BladeInputDataData%FlpcgOf)) THEN
   DEALLOCATE(BladeInputDataData%FlpcgOf)
ENDIF
IF (ALLOCATED(BladeInputDataData%EdgcgOf)) THEN
   DEALLOCATE(BladeInputDataData%EdgcgOf)
ENDIF
IF (ALLOCATED(BladeInputDataData%FlpEAOf)) THEN
   DEALLOCATE(BladeInputDataData%FlpEAOf)
ENDIF
IF (ALLOCATED(BladeInputDataData%EdgEAOf)) THEN
   DEALLOCATE(BladeInputDataData%EdgEAOf)
ENDIF
IF (ALLOCATED(BladeInputDataData%BldFl1Sh)) THEN
   DEALLOCATE(BladeInputDataData%BldFl1Sh)
ENDIF
IF (ALLOCATED(BladeInputDataData%BldFl2Sh)) THEN
   DEALLOCATE(BladeInputDataData%BldFl2Sh)
ENDIF
IF (ALLOCATED(BladeInputDataData%BldEdgSh)) THEN
   DEALLOCATE(BladeInputDataData%BldEdgSh)
ENDIF
 END SUBROUTINE ED_DestroyBladeInputData

 SUBROUTINE ED_PackBladeInputData( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BladeInputData),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NBlInpSt
  IF ( ALLOCATED(InData%BlFract) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlFract )  ! BlFract 
  IF ( ALLOCATED(InData%PitchAx) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PitchAx )  ! PitchAx 
  IF ( ALLOCATED(InData%StrcTwst) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StrcTwst )  ! StrcTwst 
  IF ( ALLOCATED(InData%BMassDen) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BMassDen )  ! BMassDen 
  IF ( ALLOCATED(InData%FlpStff) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FlpStff )  ! FlpStff 
  IF ( ALLOCATED(InData%EdgStff) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EdgStff )  ! EdgStff 
  IF ( ALLOCATED(InData%GJStff) )   Re_BufSz    = Re_BufSz    + SIZE( InData%GJStff )  ! GJStff 
  IF ( ALLOCATED(InData%EAStff) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EAStff )  ! EAStff 
  IF ( ALLOCATED(InData%Alpha) )   Re_BufSz    = Re_BufSz    + SIZE( InData%Alpha )  ! Alpha 
  IF ( ALLOCATED(InData%FlpIner) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FlpIner )  ! FlpIner 
  IF ( ALLOCATED(InData%EdgIner) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EdgIner )  ! EdgIner 
  IF ( ALLOCATED(InData%PrecrvRef) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PrecrvRef )  ! PrecrvRef 
  IF ( ALLOCATED(InData%PreswpRef) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PreswpRef )  ! PreswpRef 
  IF ( ALLOCATED(InData%FlpcgOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FlpcgOf )  ! FlpcgOf 
  IF ( ALLOCATED(InData%EdgcgOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EdgcgOf )  ! EdgcgOf 
  IF ( ALLOCATED(InData%FlpEAOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FlpEAOf )  ! FlpEAOf 
  IF ( ALLOCATED(InData%EdgEAOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EdgEAOf )  ! EdgEAOf 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldFlDmp )  ! BldFlDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdDmp )  ! BldEdDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FlStTunr )  ! FlStTunr 
  IF ( ALLOCATED(InData%BldFl1Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl1Sh )  ! BldFl1Sh 
  IF ( ALLOCATED(InData%BldFl2Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl2Sh )  ! BldFl2Sh 
  IF ( ALLOCATED(InData%BldEdgSh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdgSh )  ! BldEdgSh 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%BlFract) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlFract))-1 ) =  PACK(InData%BlFract ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlFract)
  ENDIF
  IF ( ALLOCATED(InData%PitchAx) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PitchAx))-1 ) =  PACK(InData%PitchAx ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PitchAx)
  ENDIF
  IF ( ALLOCATED(InData%StrcTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StrcTwst))-1 ) =  PACK(InData%StrcTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StrcTwst)
  ENDIF
  IF ( ALLOCATED(InData%BMassDen) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BMassDen))-1 ) =  PACK(InData%BMassDen ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BMassDen)
  ENDIF
  IF ( ALLOCATED(InData%FlpStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpStff))-1 ) =  PACK(InData%FlpStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpStff)
  ENDIF
  IF ( ALLOCATED(InData%EdgStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgStff))-1 ) =  PACK(InData%EdgStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgStff)
  ENDIF
  IF ( ALLOCATED(InData%GJStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%GJStff))-1 ) =  PACK(InData%GJStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%GJStff)
  ENDIF
  IF ( ALLOCATED(InData%EAStff) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAStff))-1 ) =  PACK(InData%EAStff ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAStff)
  ENDIF
  IF ( ALLOCATED(InData%Alpha) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Alpha))-1 ) =  PACK(InData%Alpha ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Alpha)
  ENDIF
  IF ( ALLOCATED(InData%FlpIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpIner))-1 ) =  PACK(InData%FlpIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpIner)
  ENDIF
  IF ( ALLOCATED(InData%EdgIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgIner))-1 ) =  PACK(InData%EdgIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgIner)
  ENDIF
  IF ( ALLOCATED(InData%PrecrvRef) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PrecrvRef))-1 ) =  PACK(InData%PrecrvRef ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PrecrvRef)
  ENDIF
  IF ( ALLOCATED(InData%PreswpRef) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PreswpRef))-1 ) =  PACK(InData%PreswpRef ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PreswpRef)
  ENDIF
  IF ( ALLOCATED(InData%FlpcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpcgOf))-1 ) =  PACK(InData%FlpcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpcgOf)
  ENDIF
  IF ( ALLOCATED(InData%EdgcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgcgOf))-1 ) =  PACK(InData%EdgcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgcgOf)
  ENDIF
  IF ( ALLOCATED(InData%FlpEAOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlpEAOf))-1 ) =  PACK(InData%FlpEAOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FlpEAOf)
  ENDIF
  IF ( ALLOCATED(InData%EdgEAOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EdgEAOf))-1 ) =  PACK(InData%EdgEAOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EdgEAOf)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFlDmp))-1 ) =  PACK(InData%BldFlDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%BldFlDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdDmp))-1 ) =  PACK(InData%BldEdDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FlStTunr))-1 ) =  PACK(InData%FlStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FlStTunr)
  IF ( ALLOCATED(InData%BldFl1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl1Sh))-1 ) =  PACK(InData%BldFl1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldFl2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl2Sh))-1 ) =  PACK(InData%BldFl2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldEdgSh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdgSh))-1 ) =  PACK(InData%BldEdgSh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdgSh)
  ENDIF
 END SUBROUTINE ED_PackBladeInputData

 SUBROUTINE ED_UnPackBladeInputData( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BladeInputData), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NBlInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%BlFract) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlFract,1)))
  mask1 = .TRUE.
    OutData%BlFract = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlFract))-1 ),mask1,OutData%BlFract)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlFract)
  ENDIF
  IF ( ALLOCATED(OutData%PitchAx) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PitchAx,1)))
  mask1 = .TRUE.
    OutData%PitchAx = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PitchAx))-1 ),mask1,OutData%PitchAx)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PitchAx)
  ENDIF
  IF ( ALLOCATED(OutData%StrcTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StrcTwst,1)))
  mask1 = .TRUE.
    OutData%StrcTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StrcTwst))-1 ),mask1,OutData%StrcTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StrcTwst)
  ENDIF
  IF ( ALLOCATED(OutData%BMassDen) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BMassDen,1)))
  mask1 = .TRUE.
    OutData%BMassDen = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BMassDen))-1 ),mask1,OutData%BMassDen)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BMassDen)
  ENDIF
  IF ( ALLOCATED(OutData%FlpStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpStff,1)))
  mask1 = .TRUE.
    OutData%FlpStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpStff))-1 ),mask1,OutData%FlpStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpStff)
  ENDIF
  IF ( ALLOCATED(OutData%EdgStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgStff,1)))
  mask1 = .TRUE.
    OutData%EdgStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgStff))-1 ),mask1,OutData%EdgStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgStff)
  ENDIF
  IF ( ALLOCATED(OutData%GJStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%GJStff,1)))
  mask1 = .TRUE.
    OutData%GJStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%GJStff))-1 ),mask1,OutData%GJStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%GJStff)
  ENDIF
  IF ( ALLOCATED(OutData%EAStff) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EAStff,1)))
  mask1 = .TRUE.
    OutData%EAStff = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAStff))-1 ),mask1,OutData%EAStff)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAStff)
  ENDIF
  IF ( ALLOCATED(OutData%Alpha) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Alpha,1)))
  mask1 = .TRUE.
    OutData%Alpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Alpha))-1 ),mask1,OutData%Alpha)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Alpha)
  ENDIF
  IF ( ALLOCATED(OutData%FlpIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpIner,1)))
  mask1 = .TRUE.
    OutData%FlpIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpIner))-1 ),mask1,OutData%FlpIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpIner)
  ENDIF
  IF ( ALLOCATED(OutData%EdgIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgIner,1)))
  mask1 = .TRUE.
    OutData%EdgIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgIner))-1 ),mask1,OutData%EdgIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgIner)
  ENDIF
  IF ( ALLOCATED(OutData%PrecrvRef) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PrecrvRef,1)))
  mask1 = .TRUE.
    OutData%PrecrvRef = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PrecrvRef))-1 ),mask1,OutData%PrecrvRef)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PrecrvRef)
  ENDIF
  IF ( ALLOCATED(OutData%PreswpRef) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PreswpRef,1)))
  mask1 = .TRUE.
    OutData%PreswpRef = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PreswpRef))-1 ),mask1,OutData%PreswpRef)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PreswpRef)
  ENDIF
  IF ( ALLOCATED(OutData%FlpcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpcgOf,1)))
  mask1 = .TRUE.
    OutData%FlpcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpcgOf))-1 ),mask1,OutData%FlpcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%EdgcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgcgOf,1)))
  mask1 = .TRUE.
    OutData%EdgcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgcgOf))-1 ),mask1,OutData%EdgcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%FlpEAOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FlpEAOf,1)))
  mask1 = .TRUE.
    OutData%FlpEAOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlpEAOf))-1 ),mask1,OutData%FlpEAOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FlpEAOf)
  ENDIF
  IF ( ALLOCATED(OutData%EdgEAOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%EdgEAOf,1)))
  mask1 = .TRUE.
    OutData%EdgEAOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EdgEAOf))-1 ),mask1,OutData%EdgEAOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EdgEAOf)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%BldFlDmp,1)))
  mask1 = .TRUE.
  OutData%BldFlDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFlDmp))-1 ),mask1,OutData%BldFlDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFlDmp)
  ALLOCATE(mask1(SIZE(OutData%BldEdDmp,1)))
  mask1 = .TRUE.
  OutData%BldEdDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdDmp))-1 ),mask1,OutData%BldEdDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdDmp)
  ALLOCATE(mask1(SIZE(OutData%FlStTunr,1)))
  mask1 = .TRUE.
  OutData%FlStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FlStTunr))-1 ),mask1,OutData%FlStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FlStTunr)
  IF ( ALLOCATED(OutData%BldFl1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldFl1Sh,1)))
  mask1 = .TRUE.
    OutData%BldFl1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl1Sh))-1 ),mask1,OutData%BldFl1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldFl2Sh,1)))
  mask1 = .TRUE.
    OutData%BldFl2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl2Sh))-1 ),mask1,OutData%BldFl2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldEdgSh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldEdgSh,1)))
  mask1 = .TRUE.
    OutData%BldEdgSh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdgSh))-1 ),mask1,OutData%BldEdgSh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdgSh)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackBladeInputData

 SUBROUTINE ED_CopyBladeMeshInputData( SrcBladeMeshInputDataData, DstBladeMeshInputDataData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_BladeMeshInputData), INTENT(IN) :: SrcBladeMeshInputDataData
   TYPE(ED_BladeMeshInputData), INTENT(INOUT) :: DstBladeMeshInputDataData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstBladeMeshInputDataData%BldNodes = SrcBladeMeshInputDataData%BldNodes
IF (ALLOCATED(SrcBladeMeshInputDataData%RNodes)) THEN
   i1_l = LBOUND(SrcBladeMeshInputDataData%RNodes,1)
   i1_u = UBOUND(SrcBladeMeshInputDataData%RNodes,1)
   IF (.NOT. ALLOCATED(DstBladeMeshInputDataData%RNodes)) THEN 
      ALLOCATE(DstBladeMeshInputDataData%RNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeMeshInputDataData%RNodes.', ErrStat, ErrMsg,'ED_CopyBladeMeshInputData')
         RETURN
      END IF
   END IF
   DstBladeMeshInputDataData%RNodes = SrcBladeMeshInputDataData%RNodes
ENDIF
IF (ALLOCATED(SrcBladeMeshInputDataData%AeroTwst)) THEN
   i1_l = LBOUND(SrcBladeMeshInputDataData%AeroTwst,1)
   i1_u = UBOUND(SrcBladeMeshInputDataData%AeroTwst,1)
   IF (.NOT. ALLOCATED(DstBladeMeshInputDataData%AeroTwst)) THEN 
      ALLOCATE(DstBladeMeshInputDataData%AeroTwst(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeMeshInputDataData%AeroTwst.', ErrStat, ErrMsg,'ED_CopyBladeMeshInputData')
         RETURN
      END IF
   END IF
   DstBladeMeshInputDataData%AeroTwst = SrcBladeMeshInputDataData%AeroTwst
ENDIF
IF (ALLOCATED(SrcBladeMeshInputDataData%Chord)) THEN
   i1_l = LBOUND(SrcBladeMeshInputDataData%Chord,1)
   i1_u = UBOUND(SrcBladeMeshInputDataData%Chord,1)
   IF (.NOT. ALLOCATED(DstBladeMeshInputDataData%Chord)) THEN 
      ALLOCATE(DstBladeMeshInputDataData%Chord(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeMeshInputDataData%Chord.', ErrStat, ErrMsg,'ED_CopyBladeMeshInputData')
         RETURN
      END IF
   END IF
   DstBladeMeshInputDataData%Chord = SrcBladeMeshInputDataData%Chord
ENDIF
 END SUBROUTINE ED_CopyBladeMeshInputData

 SUBROUTINE ED_DestroyBladeMeshInputData( BladeMeshInputDataData, ErrStat, ErrMsg )
  TYPE(ED_BladeMeshInputData), INTENT(INOUT) :: BladeMeshInputDataData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BladeMeshInputDataData%RNodes)) THEN
   DEALLOCATE(BladeMeshInputDataData%RNodes)
ENDIF
IF (ALLOCATED(BladeMeshInputDataData%AeroTwst)) THEN
   DEALLOCATE(BladeMeshInputDataData%AeroTwst)
ENDIF
IF (ALLOCATED(BladeMeshInputDataData%Chord)) THEN
   DEALLOCATE(BladeMeshInputDataData%Chord)
ENDIF
 END SUBROUTINE ED_DestroyBladeMeshInputData

 SUBROUTINE ED_PackBladeMeshInputData( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_BladeMeshInputData),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! BldNodes
  IF ( ALLOCATED(InData%RNodes) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RNodes )  ! RNodes 
  IF ( ALLOCATED(InData%AeroTwst) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AeroTwst )  ! AeroTwst 
  IF ( ALLOCATED(InData%Chord) )   Re_BufSz    = Re_BufSz    + SIZE( InData%Chord )  ! Chord 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%BldNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%RNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodes))-1 ) =  PACK(InData%RNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodes)
  ENDIF
  IF ( ALLOCATED(InData%AeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroTwst))-1 ) =  PACK(InData%AeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%Chord) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Chord))-1 ) =  PACK(InData%Chord ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Chord)
  ENDIF
 END SUBROUTINE ED_PackBladeMeshInputData

 SUBROUTINE ED_UnPackBladeMeshInputData( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_BladeMeshInputData), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%BldNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%RNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodes,1)))
  mask1 = .TRUE.
    OutData%RNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodes))-1 ),mask1,OutData%RNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodes)
  ENDIF
  IF ( ALLOCATED(OutData%AeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AeroTwst,1)))
  mask1 = .TRUE.
    OutData%AeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroTwst))-1 ),mask1,OutData%AeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%Chord) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Chord,1)))
  mask1 = .TRUE.
    OutData%Chord = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Chord))-1 ),mask1,OutData%Chord)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Chord)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackBladeMeshInputData

 SUBROUTINE ED_CopyInputFile( SrcInputFileData, DstInputFileData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_InputFile), INTENT(IN) :: SrcInputFileData
   TYPE(ED_InputFile), INTENT(INOUT) :: DstInputFileData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInputFileData%DT = SrcInputFileData%DT
   DstInputFileData%Gravity = SrcInputFileData%Gravity
   DstInputFileData%FlapDOF1 = SrcInputFileData%FlapDOF1
   DstInputFileData%FlapDOF2 = SrcInputFileData%FlapDOF2
   DstInputFileData%EdgeDOF = SrcInputFileData%EdgeDOF
   DstInputFileData%TeetDOF = SrcInputFileData%TeetDOF
   DstInputFileData%DrTrDOF = SrcInputFileData%DrTrDOF
   DstInputFileData%GenDOF = SrcInputFileData%GenDOF
   DstInputFileData%YawDOF = SrcInputFileData%YawDOF
   DstInputFileData%TwFADOF1 = SrcInputFileData%TwFADOF1
   DstInputFileData%TwFADOF2 = SrcInputFileData%TwFADOF2
   DstInputFileData%TwSSDOF1 = SrcInputFileData%TwSSDOF1
   DstInputFileData%TwSSDOF2 = SrcInputFileData%TwSSDOF2
   DstInputFileData%PtfmSgDOF = SrcInputFileData%PtfmSgDOF
   DstInputFileData%PtfmSwDOF = SrcInputFileData%PtfmSwDOF
   DstInputFileData%PtfmHvDOF = SrcInputFileData%PtfmHvDOF
   DstInputFileData%PtfmRDOF = SrcInputFileData%PtfmRDOF
   DstInputFileData%PtfmPDOF = SrcInputFileData%PtfmPDOF
   DstInputFileData%PtfmYDOF = SrcInputFileData%PtfmYDOF
   DstInputFileData%OoPDefl = SrcInputFileData%OoPDefl
   DstInputFileData%IPDefl = SrcInputFileData%IPDefl
IF (ALLOCATED(SrcInputFileData%BlPitch)) THEN
   i1_l = LBOUND(SrcInputFileData%BlPitch,1)
   i1_u = UBOUND(SrcInputFileData%BlPitch,1)
   IF (.NOT. ALLOCATED(DstInputFileData%BlPitch)) THEN 
      ALLOCATE(DstInputFileData%BlPitch(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%BlPitch.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%BlPitch = SrcInputFileData%BlPitch
ENDIF
   DstInputFileData%TeetDefl = SrcInputFileData%TeetDefl
   DstInputFileData%Azimuth = SrcInputFileData%Azimuth
   DstInputFileData%RotSpeed = SrcInputFileData%RotSpeed
   DstInputFileData%NacYaw = SrcInputFileData%NacYaw
   DstInputFileData%TTDspFA = SrcInputFileData%TTDspFA
   DstInputFileData%TTDspSS = SrcInputFileData%TTDspSS
   DstInputFileData%PtfmSurge = SrcInputFileData%PtfmSurge
   DstInputFileData%PtfmSway = SrcInputFileData%PtfmSway
   DstInputFileData%PtfmHeave = SrcInputFileData%PtfmHeave
   DstInputFileData%PtfmRoll = SrcInputFileData%PtfmRoll
   DstInputFileData%PtfmPitch = SrcInputFileData%PtfmPitch
   DstInputFileData%PtfmYaw = SrcInputFileData%PtfmYaw
   DstInputFileData%NumBl = SrcInputFileData%NumBl
   DstInputFileData%TipRad = SrcInputFileData%TipRad
   DstInputFileData%HubRad = SrcInputFileData%HubRad
IF (ALLOCATED(SrcInputFileData%PreCone)) THEN
   i1_l = LBOUND(SrcInputFileData%PreCone,1)
   i1_u = UBOUND(SrcInputFileData%PreCone,1)
   IF (.NOT. ALLOCATED(DstInputFileData%PreCone)) THEN 
      ALLOCATE(DstInputFileData%PreCone(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%PreCone.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%PreCone = SrcInputFileData%PreCone
ENDIF
   DstInputFileData%HubCM = SrcInputFileData%HubCM
   DstInputFileData%UndSling = SrcInputFileData%UndSling
   DstInputFileData%Delta3 = SrcInputFileData%Delta3
   DstInputFileData%AzimB1Up = SrcInputFileData%AzimB1Up
   DstInputFileData%OverHang = SrcInputFileData%OverHang
   DstInputFileData%ShftGagL = SrcInputFileData%ShftGagL
   DstInputFileData%ShftTilt = SrcInputFileData%ShftTilt
   DstInputFileData%NacCMxn = SrcInputFileData%NacCMxn
   DstInputFileData%NacCMyn = SrcInputFileData%NacCMyn
   DstInputFileData%NacCMzn = SrcInputFileData%NacCMzn
   DstInputFileData%NcIMUxn = SrcInputFileData%NcIMUxn
   DstInputFileData%NcIMUyn = SrcInputFileData%NcIMUyn
   DstInputFileData%NcIMUzn = SrcInputFileData%NcIMUzn
   DstInputFileData%Twr2Shft = SrcInputFileData%Twr2Shft
   DstInputFileData%TowerHt = SrcInputFileData%TowerHt
   DstInputFileData%TowerBsHt = SrcInputFileData%TowerBsHt
   DstInputFileData%PtfmCMxt = SrcInputFileData%PtfmCMxt
   DstInputFileData%PtfmCMyt = SrcInputFileData%PtfmCMyt
   DstInputFileData%PtfmCMzt = SrcInputFileData%PtfmCMzt
   DstInputFileData%PtfmRefzt = SrcInputFileData%PtfmRefzt
IF (ALLOCATED(SrcInputFileData%TipMass)) THEN
   i1_l = LBOUND(SrcInputFileData%TipMass,1)
   i1_u = UBOUND(SrcInputFileData%TipMass,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TipMass)) THEN 
      ALLOCATE(DstInputFileData%TipMass(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TipMass.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TipMass = SrcInputFileData%TipMass
ENDIF
   DstInputFileData%HubMass = SrcInputFileData%HubMass
   DstInputFileData%HubIner = SrcInputFileData%HubIner
   DstInputFileData%GenIner = SrcInputFileData%GenIner
   DstInputFileData%NacMass = SrcInputFileData%NacMass
   DstInputFileData%NacYIner = SrcInputFileData%NacYIner
   DstInputFileData%YawBrMass = SrcInputFileData%YawBrMass
   DstInputFileData%PtfmMass = SrcInputFileData%PtfmMass
   DstInputFileData%PtfmRIner = SrcInputFileData%PtfmRIner
   DstInputFileData%PtfmPIner = SrcInputFileData%PtfmPIner
   DstInputFileData%PtfmYIner = SrcInputFileData%PtfmYIner
IF (ALLOCATED(SrcInputFileData%InpBlMesh)) THEN
   i1_l = LBOUND(SrcInputFileData%InpBlMesh,1)
   i1_u = UBOUND(SrcInputFileData%InpBlMesh,1)
   IF (.NOT. ALLOCATED(DstInputFileData%InpBlMesh)) THEN 
      ALLOCATE(DstInputFileData%InpBlMesh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%InpBlMesh.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputFileData%InpBlMesh,1), UBOUND(SrcInputFileData%InpBlMesh,1)
      CALL ED_Copyblademeshinputdata( SrcInputFileData%InpBlMesh(i1), DstInputFileData%InpBlMesh(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInputFile:InpBlMesh(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
IF (ALLOCATED(SrcInputFileData%InpBl)) THEN
   i1_l = LBOUND(SrcInputFileData%InpBl,1)
   i1_u = UBOUND(SrcInputFileData%InpBl,1)
   IF (.NOT. ALLOCATED(DstInputFileData%InpBl)) THEN 
      ALLOCATE(DstInputFileData%InpBl(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%InpBl.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputFileData%InpBl,1), UBOUND(SrcInputFileData%InpBl,1)
      CALL ED_Copybladeinputdata( SrcInputFileData%InpBl(i1), DstInputFileData%InpBl(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInputFile:InpBl(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
   DstInputFileData%TeetMod = SrcInputFileData%TeetMod
   DstInputFileData%TeetDmpP = SrcInputFileData%TeetDmpP
   DstInputFileData%TeetDmp = SrcInputFileData%TeetDmp
   DstInputFileData%TeetCDmp = SrcInputFileData%TeetCDmp
   DstInputFileData%TeetSStP = SrcInputFileData%TeetSStP
   DstInputFileData%TeetHStP = SrcInputFileData%TeetHStP
   DstInputFileData%TeetSSSp = SrcInputFileData%TeetSSSp
   DstInputFileData%TeetHSSp = SrcInputFileData%TeetHSSp
   DstInputFileData%GBoxEff = SrcInputFileData%GBoxEff
   DstInputFileData%GBRatio = SrcInputFileData%GBRatio
   DstInputFileData%DTTorSpr = SrcInputFileData%DTTorSpr
   DstInputFileData%DTTorDmp = SrcInputFileData%DTTorDmp
   DstInputFileData%Furling = SrcInputFileData%Furling
   DstInputFileData%TwrNodes = SrcInputFileData%TwrNodes
   DstInputFileData%SumPrint = SrcInputFileData%SumPrint
   DstInputFileData%OutFile = SrcInputFileData%OutFile
   DstInputFileData%TabDelim = SrcInputFileData%TabDelim
   DstInputFileData%OutFmt = SrcInputFileData%OutFmt
   DstInputFileData%Tstart = SrcInputFileData%Tstart
   DstInputFileData%DecFact = SrcInputFileData%DecFact
   DstInputFileData%NTwGages = SrcInputFileData%NTwGages
   DstInputFileData%TwrGagNd = SrcInputFileData%TwrGagNd
   DstInputFileData%NBlGages = SrcInputFileData%NBlGages
   DstInputFileData%BldGagNd = SrcInputFileData%BldGagNd
   DstInputFileData%NumOuts = SrcInputFileData%NumOuts
IF (ALLOCATED(SrcInputFileData%OutList)) THEN
   i1_l = LBOUND(SrcInputFileData%OutList,1)
   i1_u = UBOUND(SrcInputFileData%OutList,1)
   IF (.NOT. ALLOCATED(DstInputFileData%OutList)) THEN 
      ALLOCATE(DstInputFileData%OutList(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%OutList.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%OutList = SrcInputFileData%OutList
ENDIF
   DstInputFileData%NTwInpSt = SrcInputFileData%NTwInpSt
   DstInputFileData%TwrFADmp = SrcInputFileData%TwrFADmp
   DstInputFileData%TwrSSDmp = SrcInputFileData%TwrSSDmp
   DstInputFileData%FAStTunr = SrcInputFileData%FAStTunr
   DstInputFileData%SSStTunr = SrcInputFileData%SSStTunr
IF (ALLOCATED(SrcInputFileData%HtFract)) THEN
   i1_l = LBOUND(SrcInputFileData%HtFract,1)
   i1_u = UBOUND(SrcInputFileData%HtFract,1)
   IF (.NOT. ALLOCATED(DstInputFileData%HtFract)) THEN 
      ALLOCATE(DstInputFileData%HtFract(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%HtFract.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%HtFract = SrcInputFileData%HtFract
ENDIF
IF (ALLOCATED(SrcInputFileData%TMassDen)) THEN
   i1_l = LBOUND(SrcInputFileData%TMassDen,1)
   i1_u = UBOUND(SrcInputFileData%TMassDen,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TMassDen)) THEN 
      ALLOCATE(DstInputFileData%TMassDen(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TMassDen.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TMassDen = SrcInputFileData%TMassDen
ENDIF
IF (ALLOCATED(SrcInputFileData%TwFAStif)) THEN
   i1_l = LBOUND(SrcInputFileData%TwFAStif,1)
   i1_u = UBOUND(SrcInputFileData%TwFAStif,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwFAStif)) THEN 
      ALLOCATE(DstInputFileData%TwFAStif(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwFAStif.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwFAStif = SrcInputFileData%TwFAStif
ENDIF
IF (ALLOCATED(SrcInputFileData%TwSSStif)) THEN
   i1_l = LBOUND(SrcInputFileData%TwSSStif,1)
   i1_u = UBOUND(SrcInputFileData%TwSSStif,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwSSStif)) THEN 
      ALLOCATE(DstInputFileData%TwSSStif(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwSSStif.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwSSStif = SrcInputFileData%TwSSStif
ENDIF
IF (ALLOCATED(SrcInputFileData%TwFAM1Sh)) THEN
   i1_l = LBOUND(SrcInputFileData%TwFAM1Sh,1)
   i1_u = UBOUND(SrcInputFileData%TwFAM1Sh,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwFAM1Sh)) THEN 
      ALLOCATE(DstInputFileData%TwFAM1Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwFAM1Sh.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwFAM1Sh = SrcInputFileData%TwFAM1Sh
ENDIF
IF (ALLOCATED(SrcInputFileData%TwFAM2Sh)) THEN
   i1_l = LBOUND(SrcInputFileData%TwFAM2Sh,1)
   i1_u = UBOUND(SrcInputFileData%TwFAM2Sh,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwFAM2Sh)) THEN 
      ALLOCATE(DstInputFileData%TwFAM2Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwFAM2Sh.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwFAM2Sh = SrcInputFileData%TwFAM2Sh
ENDIF
IF (ALLOCATED(SrcInputFileData%TwSSM1Sh)) THEN
   i1_l = LBOUND(SrcInputFileData%TwSSM1Sh,1)
   i1_u = UBOUND(SrcInputFileData%TwSSM1Sh,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwSSM1Sh)) THEN 
      ALLOCATE(DstInputFileData%TwSSM1Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwSSM1Sh.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwSSM1Sh = SrcInputFileData%TwSSM1Sh
ENDIF
IF (ALLOCATED(SrcInputFileData%TwSSM2Sh)) THEN
   i1_l = LBOUND(SrcInputFileData%TwSSM2Sh,1)
   i1_u = UBOUND(SrcInputFileData%TwSSM2Sh,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwSSM2Sh)) THEN 
      ALLOCATE(DstInputFileData%TwSSM2Sh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwSSM2Sh.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwSSM2Sh = SrcInputFileData%TwSSM2Sh
ENDIF
IF (ALLOCATED(SrcInputFileData%TwGJStif)) THEN
   i1_l = LBOUND(SrcInputFileData%TwGJStif,1)
   i1_u = UBOUND(SrcInputFileData%TwGJStif,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwGJStif)) THEN 
      ALLOCATE(DstInputFileData%TwGJStif(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwGJStif.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwGJStif = SrcInputFileData%TwGJStif
ENDIF
IF (ALLOCATED(SrcInputFileData%TwEAStif)) THEN
   i1_l = LBOUND(SrcInputFileData%TwEAStif,1)
   i1_u = UBOUND(SrcInputFileData%TwEAStif,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwEAStif)) THEN 
      ALLOCATE(DstInputFileData%TwEAStif(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwEAStif.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwEAStif = SrcInputFileData%TwEAStif
ENDIF
IF (ALLOCATED(SrcInputFileData%TwFAIner)) THEN
   i1_l = LBOUND(SrcInputFileData%TwFAIner,1)
   i1_u = UBOUND(SrcInputFileData%TwFAIner,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwFAIner)) THEN 
      ALLOCATE(DstInputFileData%TwFAIner(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwFAIner.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwFAIner = SrcInputFileData%TwFAIner
ENDIF
IF (ALLOCATED(SrcInputFileData%TwSSIner)) THEN
   i1_l = LBOUND(SrcInputFileData%TwSSIner,1)
   i1_u = UBOUND(SrcInputFileData%TwSSIner,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwSSIner)) THEN 
      ALLOCATE(DstInputFileData%TwSSIner(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwSSIner.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwSSIner = SrcInputFileData%TwSSIner
ENDIF
IF (ALLOCATED(SrcInputFileData%TwFAcgOf)) THEN
   i1_l = LBOUND(SrcInputFileData%TwFAcgOf,1)
   i1_u = UBOUND(SrcInputFileData%TwFAcgOf,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwFAcgOf)) THEN 
      ALLOCATE(DstInputFileData%TwFAcgOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwFAcgOf.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwFAcgOf = SrcInputFileData%TwFAcgOf
ENDIF
IF (ALLOCATED(SrcInputFileData%TwSScgOf)) THEN
   i1_l = LBOUND(SrcInputFileData%TwSScgOf,1)
   i1_u = UBOUND(SrcInputFileData%TwSScgOf,1)
   IF (.NOT. ALLOCATED(DstInputFileData%TwSScgOf)) THEN 
      ALLOCATE(DstInputFileData%TwSScgOf(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputFileData%TwSScgOf.', ErrStat, ErrMsg,'ED_CopyInputFile')
         RETURN
      END IF
   END IF
   DstInputFileData%TwSScgOf = SrcInputFileData%TwSScgOf
ENDIF
   DstInputFileData%RFrlDOF = SrcInputFileData%RFrlDOF
   DstInputFileData%TFrlDOF = SrcInputFileData%TFrlDOF
   DstInputFileData%RotFurl = SrcInputFileData%RotFurl
   DstInputFileData%TailFurl = SrcInputFileData%TailFurl
   DstInputFileData%Yaw2Shft = SrcInputFileData%Yaw2Shft
   DstInputFileData%ShftSkew = SrcInputFileData%ShftSkew
   DstInputFileData%RFrlCMxn = SrcInputFileData%RFrlCMxn
   DstInputFileData%RFrlCMyn = SrcInputFileData%RFrlCMyn
   DstInputFileData%RFrlCMzn = SrcInputFileData%RFrlCMzn
   DstInputFileData%BoomCMxn = SrcInputFileData%BoomCMxn
   DstInputFileData%BoomCMyn = SrcInputFileData%BoomCMyn
   DstInputFileData%BoomCMzn = SrcInputFileData%BoomCMzn
   DstInputFileData%TFinCMxn = SrcInputFileData%TFinCMxn
   DstInputFileData%TFinCMyn = SrcInputFileData%TFinCMyn
   DstInputFileData%TFinCMzn = SrcInputFileData%TFinCMzn
   DstInputFileData%TFinCPxn = SrcInputFileData%TFinCPxn
   DstInputFileData%TFinCPyn = SrcInputFileData%TFinCPyn
   DstInputFileData%TFinCPzn = SrcInputFileData%TFinCPzn
   DstInputFileData%TFinSkew = SrcInputFileData%TFinSkew
   DstInputFileData%TFinTilt = SrcInputFileData%TFinTilt
   DstInputFileData%TFinBank = SrcInputFileData%TFinBank
   DstInputFileData%RFrlPntxn = SrcInputFileData%RFrlPntxn
   DstInputFileData%RFrlPntyn = SrcInputFileData%RFrlPntyn
   DstInputFileData%RFrlPntzn = SrcInputFileData%RFrlPntzn
   DstInputFileData%RFrlSkew = SrcInputFileData%RFrlSkew
   DstInputFileData%RFrlTilt = SrcInputFileData%RFrlTilt
   DstInputFileData%TFrlPntxn = SrcInputFileData%TFrlPntxn
   DstInputFileData%TFrlPntyn = SrcInputFileData%TFrlPntyn
   DstInputFileData%TFrlPntzn = SrcInputFileData%TFrlPntzn
   DstInputFileData%TFrlSkew = SrcInputFileData%TFrlSkew
   DstInputFileData%TFrlTilt = SrcInputFileData%TFrlTilt
   DstInputFileData%RFrlMass = SrcInputFileData%RFrlMass
   DstInputFileData%BoomMass = SrcInputFileData%BoomMass
   DstInputFileData%TFinMass = SrcInputFileData%TFinMass
   DstInputFileData%RFrlIner = SrcInputFileData%RFrlIner
   DstInputFileData%TFrlIner = SrcInputFileData%TFrlIner
   DstInputFileData%RFrlMod = SrcInputFileData%RFrlMod
   DstInputFileData%RFrlSpr = SrcInputFileData%RFrlSpr
   DstInputFileData%RFrlDmp = SrcInputFileData%RFrlDmp
   DstInputFileData%RFrlCDmp = SrcInputFileData%RFrlCDmp
   DstInputFileData%RFrlUSSP = SrcInputFileData%RFrlUSSP
   DstInputFileData%RFrlDSSP = SrcInputFileData%RFrlDSSP
   DstInputFileData%RFrlUSSpr = SrcInputFileData%RFrlUSSpr
   DstInputFileData%RFrlDSSpr = SrcInputFileData%RFrlDSSpr
   DstInputFileData%RFrlUSDP = SrcInputFileData%RFrlUSDP
   DstInputFileData%RFrlDSDP = SrcInputFileData%RFrlDSDP
   DstInputFileData%RFrlUSDmp = SrcInputFileData%RFrlUSDmp
   DstInputFileData%RFrlDSDmp = SrcInputFileData%RFrlDSDmp
   DstInputFileData%TFrlMod = SrcInputFileData%TFrlMod
   DstInputFileData%TFrlSpr = SrcInputFileData%TFrlSpr
   DstInputFileData%TFrlDmp = SrcInputFileData%TFrlDmp
   DstInputFileData%TFrlCDmp = SrcInputFileData%TFrlCDmp
   DstInputFileData%TFrlUSSP = SrcInputFileData%TFrlUSSP
   DstInputFileData%TFrlDSSP = SrcInputFileData%TFrlDSSP
   DstInputFileData%TFrlUSSpr = SrcInputFileData%TFrlUSSpr
   DstInputFileData%TFrlDSSpr = SrcInputFileData%TFrlDSSpr
   DstInputFileData%TFrlUSDP = SrcInputFileData%TFrlUSDP
   DstInputFileData%TFrlDSDP = SrcInputFileData%TFrlDSDP
   DstInputFileData%TFrlUSDmp = SrcInputFileData%TFrlUSDmp
   DstInputFileData%TFrlDSDmp = SrcInputFileData%TFrlDSDmp
   DstInputFileData%method = SrcInputFileData%method
 END SUBROUTINE ED_CopyInputFile

 SUBROUTINE ED_DestroyInputFile( InputFileData, ErrStat, ErrMsg )
  TYPE(ED_InputFile), INTENT(INOUT) :: InputFileData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InputFileData%BlPitch)) THEN
   DEALLOCATE(InputFileData%BlPitch)
ENDIF
IF (ALLOCATED(InputFileData%PreCone)) THEN
   DEALLOCATE(InputFileData%PreCone)
ENDIF
IF (ALLOCATED(InputFileData%TipMass)) THEN
   DEALLOCATE(InputFileData%TipMass)
ENDIF
IF (ALLOCATED(InputFileData%InpBlMesh)) THEN
DO i1 = LBOUND(InputFileData%InpBlMesh,1), UBOUND(InputFileData%InpBlMesh,1)
  CALL ED_Destroyblademeshinputdata( InputFileData%InpBlMesh(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputFileData%InpBlMesh)
ENDIF
IF (ALLOCATED(InputFileData%InpBl)) THEN
DO i1 = LBOUND(InputFileData%InpBl,1), UBOUND(InputFileData%InpBl,1)
  CALL ED_Destroybladeinputdata( InputFileData%InpBl(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputFileData%InpBl)
ENDIF
IF (ALLOCATED(InputFileData%OutList)) THEN
   DEALLOCATE(InputFileData%OutList)
ENDIF
IF (ALLOCATED(InputFileData%HtFract)) THEN
   DEALLOCATE(InputFileData%HtFract)
ENDIF
IF (ALLOCATED(InputFileData%TMassDen)) THEN
   DEALLOCATE(InputFileData%TMassDen)
ENDIF
IF (ALLOCATED(InputFileData%TwFAStif)) THEN
   DEALLOCATE(InputFileData%TwFAStif)
ENDIF
IF (ALLOCATED(InputFileData%TwSSStif)) THEN
   DEALLOCATE(InputFileData%TwSSStif)
ENDIF
IF (ALLOCATED(InputFileData%TwFAM1Sh)) THEN
   DEALLOCATE(InputFileData%TwFAM1Sh)
ENDIF
IF (ALLOCATED(InputFileData%TwFAM2Sh)) THEN
   DEALLOCATE(InputFileData%TwFAM2Sh)
ENDIF
IF (ALLOCATED(InputFileData%TwSSM1Sh)) THEN
   DEALLOCATE(InputFileData%TwSSM1Sh)
ENDIF
IF (ALLOCATED(InputFileData%TwSSM2Sh)) THEN
   DEALLOCATE(InputFileData%TwSSM2Sh)
ENDIF
IF (ALLOCATED(InputFileData%TwGJStif)) THEN
   DEALLOCATE(InputFileData%TwGJStif)
ENDIF
IF (ALLOCATED(InputFileData%TwEAStif)) THEN
   DEALLOCATE(InputFileData%TwEAStif)
ENDIF
IF (ALLOCATED(InputFileData%TwFAIner)) THEN
   DEALLOCATE(InputFileData%TwFAIner)
ENDIF
IF (ALLOCATED(InputFileData%TwSSIner)) THEN
   DEALLOCATE(InputFileData%TwSSIner)
ENDIF
IF (ALLOCATED(InputFileData%TwFAcgOf)) THEN
   DEALLOCATE(InputFileData%TwFAcgOf)
ENDIF
IF (ALLOCATED(InputFileData%TwSScgOf)) THEN
   DEALLOCATE(InputFileData%TwSScgOf)
ENDIF
 END SUBROUTINE ED_DestroyInputFile

 SUBROUTINE ED_PackInputFile( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_InputFile),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_InpBlMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InpBlMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InpBlMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InpBl_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InpBl_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InpBl_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  Int_BufSz  = Int_BufSz  + 1  ! FlapDOF1
  Int_BufSz  = Int_BufSz  + 1  ! FlapDOF2
  Int_BufSz  = Int_BufSz  + 1  ! EdgeDOF
  Int_BufSz  = Int_BufSz  + 1  ! TeetDOF
  Int_BufSz  = Int_BufSz  + 1  ! DrTrDOF
  Int_BufSz  = Int_BufSz  + 1  ! GenDOF
  Int_BufSz  = Int_BufSz  + 1  ! YawDOF
  Int_BufSz  = Int_BufSz  + 1  ! TwFADOF1
  Int_BufSz  = Int_BufSz  + 1  ! TwFADOF2
  Int_BufSz  = Int_BufSz  + 1  ! TwSSDOF1
  Int_BufSz  = Int_BufSz  + 1  ! TwSSDOF2
  Int_BufSz  = Int_BufSz  + 1  ! PtfmSgDOF
  Int_BufSz  = Int_BufSz  + 1  ! PtfmSwDOF
  Int_BufSz  = Int_BufSz  + 1  ! PtfmHvDOF
  Int_BufSz  = Int_BufSz  + 1  ! PtfmRDOF
  Int_BufSz  = Int_BufSz  + 1  ! PtfmPDOF
  Int_BufSz  = Int_BufSz  + 1  ! PtfmYDOF
  Re_BufSz   = Re_BufSz   + 1  ! OoPDefl
  Re_BufSz   = Re_BufSz   + 1  ! IPDefl
  IF ( ALLOCATED(InData%BlPitch) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz   = Re_BufSz   + 1  ! TeetDefl
  Re_BufSz   = Re_BufSz   + 1  ! Azimuth
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
  Re_BufSz   = Re_BufSz   + 1  ! NacYaw
  Re_BufSz   = Re_BufSz   + 1  ! TTDspFA
  Re_BufSz   = Re_BufSz   + 1  ! TTDspSS
  Re_BufSz   = Re_BufSz   + 1  ! PtfmSurge
  Re_BufSz   = Re_BufSz   + 1  ! PtfmSway
  Re_BufSz   = Re_BufSz   + 1  ! PtfmHeave
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRoll
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPitch
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYaw
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! TipRad
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  IF ( ALLOCATED(InData%PreCone) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PreCone )  ! PreCone 
  Re_BufSz   = Re_BufSz   + 1  ! HubCM
  Re_BufSz   = Re_BufSz   + 1  ! UndSling
  Re_BufSz   = Re_BufSz   + 1  ! Delta3
  Re_BufSz   = Re_BufSz   + 1  ! AzimB1Up
  Re_BufSz   = Re_BufSz   + 1  ! OverHang
  Re_BufSz   = Re_BufSz   + 1  ! ShftGagL
  Re_BufSz   = Re_BufSz   + 1  ! ShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! NacCMxn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMyn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMzn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUxn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUyn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMUzn
  Re_BufSz   = Re_BufSz   + 1  ! Twr2Shft
  Re_BufSz   = Re_BufSz   + 1  ! TowerHt
  Re_BufSz   = Re_BufSz   + 1  ! TowerBsHt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMxt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMyt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMzt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRefzt
  IF ( ALLOCATED(InData%TipMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TipMass )  ! TipMass 
  Re_BufSz   = Re_BufSz   + 1  ! HubMass
  Re_BufSz   = Re_BufSz   + 1  ! HubIner
  Re_BufSz   = Re_BufSz   + 1  ! GenIner
  Re_BufSz   = Re_BufSz   + 1  ! NacMass
  Re_BufSz   = Re_BufSz   + 1  ! NacYIner
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYIner
DO i1 = LBOUND(InData%InpBlMesh,1), UBOUND(InData%InpBlMesh,1)
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, InData%InpBlMesh(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InpBlMesh_Buf  ) ! InpBlMesh
  IF(ALLOCATED(Db_InpBlMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InpBlMesh_Buf  ) ! InpBlMesh
  IF(ALLOCATED(Int_InpBlMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InpBlMesh_Buf ) ! InpBlMesh
  IF(ALLOCATED(Re_InpBlMesh_Buf))  DEALLOCATE(Re_InpBlMesh_Buf)
  IF(ALLOCATED(Db_InpBlMesh_Buf))  DEALLOCATE(Db_InpBlMesh_Buf)
  IF(ALLOCATED(Int_InpBlMesh_Buf)) DEALLOCATE(Int_InpBlMesh_Buf)
ENDDO
DO i1 = LBOUND(InData%InpBl,1), UBOUND(InData%InpBl,1)
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, InData%InpBl(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InpBl_Buf  ) ! InpBl
  IF(ALLOCATED(Db_InpBl_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InpBl_Buf  ) ! InpBl
  IF(ALLOCATED(Int_InpBl_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InpBl_Buf ) ! InpBl
  IF(ALLOCATED(Re_InpBl_Buf))  DEALLOCATE(Re_InpBl_Buf)
  IF(ALLOCATED(Db_InpBl_Buf))  DEALLOCATE(Db_InpBl_Buf)
  IF(ALLOCATED(Int_InpBl_Buf)) DEALLOCATE(Int_InpBl_Buf)
ENDDO
  Int_BufSz  = Int_BufSz  + 1  ! TeetMod
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmpP
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetSStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetHStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetSSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetHSSp
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEff
  Re_BufSz   = Re_BufSz   + 1  ! GBRatio
  Re_BufSz   = Re_BufSz   + 1  ! DTTorSpr
  Re_BufSz   = Re_BufSz   + 1  ! DTTorDmp
  Int_BufSz  = Int_BufSz  + 1  ! Furling
  Int_BufSz  = Int_BufSz  + 1  ! TwrNodes
  Int_BufSz  = Int_BufSz  + 1  ! SumPrint
  Int_BufSz  = Int_BufSz  + 1  ! OutFile
  Int_BufSz  = Int_BufSz  + 1  ! TabDelim
!  missing buffer for OutFmt
  Db_BufSz   = Db_BufSz   + 1  ! Tstart
  Int_BufSz  = Int_BufSz  + 1  ! DecFact
  Int_BufSz  = Int_BufSz  + 1  ! NTwGages
  Int_BufSz   = Int_BufSz   + SIZE( InData%TwrGagNd )  ! TwrGagNd 
  Int_BufSz  = Int_BufSz  + 1  ! NBlGages
  Int_BufSz   = Int_BufSz   + SIZE( InData%BldGagNd )  ! BldGagNd 
  Int_BufSz  = Int_BufSz  + 1  ! NumOuts
!  missing buffer for OutList
  Int_BufSz  = Int_BufSz  + 1  ! NTwInpSt
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrFADmp )  ! TwrFADmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrSSDmp )  ! TwrSSDmp 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FAStTunr )  ! FAStTunr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SSStTunr )  ! SSStTunr 
  IF ( ALLOCATED(InData%HtFract) )   Re_BufSz    = Re_BufSz    + SIZE( InData%HtFract )  ! HtFract 
  IF ( ALLOCATED(InData%TMassDen) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TMassDen )  ! TMassDen 
  IF ( ALLOCATED(InData%TwFAStif) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAStif )  ! TwFAStif 
  IF ( ALLOCATED(InData%TwSSStif) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSStif )  ! TwSSStif 
  IF ( ALLOCATED(InData%TwFAM1Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAM1Sh )  ! TwFAM1Sh 
  IF ( ALLOCATED(InData%TwFAM2Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAM2Sh )  ! TwFAM2Sh 
  IF ( ALLOCATED(InData%TwSSM1Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSM1Sh )  ! TwSSM1Sh 
  IF ( ALLOCATED(InData%TwSSM2Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSM2Sh )  ! TwSSM2Sh 
  IF ( ALLOCATED(InData%TwGJStif) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwGJStif )  ! TwGJStif 
  IF ( ALLOCATED(InData%TwEAStif) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwEAStif )  ! TwEAStif 
  IF ( ALLOCATED(InData%TwFAIner) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAIner )  ! TwFAIner 
  IF ( ALLOCATED(InData%TwSSIner) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwSSIner )  ! TwSSIner 
  IF ( ALLOCATED(InData%TwFAcgOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwFAcgOf )  ! TwFAcgOf 
  IF ( ALLOCATED(InData%TwSScgOf) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwSScgOf )  ! TwSScgOf 
  Int_BufSz  = Int_BufSz  + 1  ! RFrlDOF
  Int_BufSz  = Int_BufSz  + 1  ! TFrlDOF
  Re_BufSz   = Re_BufSz   + 1  ! RotFurl
  Re_BufSz   = Re_BufSz   + 1  ! TailFurl
  Re_BufSz   = Re_BufSz   + 1  ! Yaw2Shft
  Re_BufSz   = Re_BufSz   + 1  ! ShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCMzn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMxn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMyn
  Re_BufSz   = Re_BufSz   + 1  ! BoomCMzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMxn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMyn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCMzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPxn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPyn
  Re_BufSz   = Re_BufSz   + 1  ! TFinCPzn
  Re_BufSz   = Re_BufSz   + 1  ! TFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! TFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! TFinBank
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! RFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! TFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMass
  Re_BufSz   = Re_BufSz   + 1  ! BoomMass
  Re_BufSz   = Re_BufSz   + 1  ! TFinMass
  Re_BufSz   = Re_BufSz   + 1  ! RFrlIner
  Re_BufSz   = Re_BufSz   + 1  ! TFrlIner
  Int_BufSz  = Int_BufSz  + 1  ! RFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDmp
  Int_BufSz  = Int_BufSz  + 1  ! TFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDmp
  Int_BufSz  = Int_BufSz  + 1  ! method
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FlapDOF1 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FlapDOF2 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%EdgeDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TeetDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DrTrDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%GenDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%YawDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwFADOF1 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwFADOF2 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwSSDOF1 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwSSDOF2 ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmSgDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmSwDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmHvDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmRDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmPDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PtfmYDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OoPDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%IPDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDefl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Azimuth )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TTDspFA )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TTDspSS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmSurge )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmSway )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmHeave )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRoll )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPitch )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%PreCone) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PreCone))-1 ) =  PACK(InData%PreCone ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PreCone)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubCM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UndSling )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Delta3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AzimB1Up )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OverHang )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftGagL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMUzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Twr2Shft )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerBsHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMxt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMyt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRefzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TipMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TipMass))-1 ) =  PACK(InData%TipMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TipMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacYIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYIner )
  Re_Xferred   = Re_Xferred   + 1
DO i1 = LBOUND(InData%InpBlMesh,1), UBOUND(InData%InpBlMesh,1)
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, InData%InpBlMesh(i1), ErrStat, ErrMsg, OnlySize ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBlMesh_Buf)-1 ) = Re_InpBlMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBlMesh_Buf)-1 ) = Db_InpBlMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBlMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBlMesh_Buf)-1 ) = Int_InpBlMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InpBlMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_InpBlMesh_Buf) )  DEALLOCATE(Re_InpBlMesh_Buf)
  IF( ALLOCATED(Db_InpBlMesh_Buf) )  DEALLOCATE(Db_InpBlMesh_Buf)
  IF( ALLOCATED(Int_InpBlMesh_Buf) ) DEALLOCATE(Int_InpBlMesh_Buf)
ENDDO
DO i1 = LBOUND(InData%InpBl,1), UBOUND(InData%InpBl,1)
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, InData%InpBl(i1), ErrStat, ErrMsg, OnlySize ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBl_Buf)-1 ) = Re_InpBl_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBl_Buf)-1 ) = Db_InpBl_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBl_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBl_Buf)-1 ) = Int_InpBl_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InpBl_Buf)
  ENDIF
  IF( ALLOCATED(Re_InpBl_Buf) )  DEALLOCATE(Re_InpBl_Buf)
  IF( ALLOCATED(Db_InpBl_Buf) )  DEALLOCATE(Db_InpBl_Buf)
  IF( ALLOCATED(Int_InpBl_Buf) ) DEALLOCATE(Int_InpBl_Buf)
ENDDO
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TeetMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmpP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEff )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBRatio )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Furling ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SumPrint ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%OutFile )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TabDelim ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Tstart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DecFact )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%TwrGagNd))-1 ) = PACK(InData%TwrGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%TwrGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BldGagNd))-1 ) = PACK(InData%BldGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%BldGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumOuts )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrFADmp))-1 ) =  PACK(InData%TwrFADmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TwrFADmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrSSDmp))-1 ) =  PACK(InData%TwrSSDmp ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TwrSSDmp)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FAStTunr))-1 ) =  PACK(InData%FAStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FAStTunr)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SSStTunr))-1 ) =  PACK(InData%SSStTunr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%SSStTunr)
  IF ( ALLOCATED(InData%HtFract) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HtFract))-1 ) =  PACK(InData%HtFract ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HtFract)
  ENDIF
  IF ( ALLOCATED(InData%TMassDen) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TMassDen))-1 ) =  PACK(InData%TMassDen ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TMassDen)
  ENDIF
  IF ( ALLOCATED(InData%TwFAStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAStif))-1 ) =  PACK(InData%TwFAStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAStif)
  ENDIF
  IF ( ALLOCATED(InData%TwSSStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSStif))-1 ) =  PACK(InData%TwSSStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSStif)
  ENDIF
  IF ( ALLOCATED(InData%TwFAM1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAM1Sh))-1 ) =  PACK(InData%TwFAM1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAM1Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwFAM2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAM2Sh))-1 ) =  PACK(InData%TwFAM2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAM2Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwSSM1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSM1Sh))-1 ) =  PACK(InData%TwSSM1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSM1Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwSSM2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSM2Sh))-1 ) =  PACK(InData%TwSSM2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSM2Sh)
  ENDIF
  IF ( ALLOCATED(InData%TwGJStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwGJStif))-1 ) =  PACK(InData%TwGJStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwGJStif)
  ENDIF
  IF ( ALLOCATED(InData%TwEAStif) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwEAStif))-1 ) =  PACK(InData%TwEAStif ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwEAStif)
  ENDIF
  IF ( ALLOCATED(InData%TwFAIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAIner))-1 ) =  PACK(InData%TwFAIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAIner)
  ENDIF
  IF ( ALLOCATED(InData%TwSSIner) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSSIner))-1 ) =  PACK(InData%TwSSIner ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSSIner)
  ENDIF
  IF ( ALLOCATED(InData%TwFAcgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwFAcgOf))-1 ) =  PACK(InData%TwFAcgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwFAcgOf)
  ENDIF
  IF ( ALLOCATED(InData%TwSScgOf) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwSScgOf))-1 ) =  PACK(InData%TwSScgOf ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwSScgOf)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%RFrlDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TFrlDOF ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotFurl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TailFurl )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Yaw2Shft )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinCPzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%method )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE ED_PackInputFile

 SUBROUTINE ED_UnPackInputFile( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_InputFile), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_InpBlMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InpBlMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InpBlMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InpBl_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InpBl_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InpBl_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OoPDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%IPDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1)))
  mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  OutData%TeetDefl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Azimuth = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TTDspFA = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TTDspSS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmSurge = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmSway = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmHeave = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRoll = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPitch = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TipRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%PreCone) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PreCone,1)))
  mask1 = .TRUE.
    OutData%PreCone = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PreCone))-1 ),mask1,OutData%PreCone)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PreCone)
  ENDIF
  OutData%HubCM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UndSling = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Delta3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%AzimB1Up = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OverHang = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftGagL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMUzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Twr2Shft = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerBsHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMxt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMyt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRefzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TipMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TipMass,1)))
  mask1 = .TRUE.
    OutData%TipMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TipMass))-1 ),mask1,OutData%TipMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TipMass)
  ENDIF
  OutData%HubMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GenIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
DO i1 = LBOUND(OutData%InpBlMesh,1), UBOUND(OutData%InpBlMesh,1)
 ! first call ED_Packblademeshinputdata to get correctly sized buffers for unpacking
  CALL ED_Packblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, OutData%InpBlMesh(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBlMesh 
  IF(ALLOCATED(Re_InpBlMesh_Buf)) THEN
    Re_InpBlMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBlMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBlMesh_Buf)) THEN
    Db_InpBlMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBlMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InpBlMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBlMesh_Buf)) THEN
    Int_InpBlMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBlMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InpBlMesh_Buf)
  ENDIF
  CALL ED_UnPackblademeshinputdata( Re_InpBlMesh_Buf, Db_InpBlMesh_Buf, Int_InpBlMesh_Buf, OutData%InpBlMesh(i1), ErrStat, ErrMsg ) ! InpBlMesh 
ENDDO
DO i1 = LBOUND(OutData%InpBl,1), UBOUND(OutData%InpBl,1)
 ! first call ED_Packbladeinputdata to get correctly sized buffers for unpacking
  CALL ED_Packbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, OutData%InpBl(i1), ErrStat, ErrMsg, .TRUE. ) ! InpBl 
  IF(ALLOCATED(Re_InpBl_Buf)) THEN
    Re_InpBl_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InpBl_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Db_InpBl_Buf)) THEN
    Db_InpBl_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InpBl_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InpBl_Buf)
  ENDIF
  IF(ALLOCATED(Int_InpBl_Buf)) THEN
    Int_InpBl_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InpBl_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InpBl_Buf)
  ENDIF
  CALL ED_UnPackbladeinputdata( Re_InpBl_Buf, Db_InpBl_Buf, Int_InpBl_Buf, OutData%InpBl(i1), ErrStat, ErrMsg ) ! InpBl 
ENDDO
  OutData%TeetMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TeetDmpP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEff = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBRatio = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%OutFile = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%Tstart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DecFact = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%TwrGagNd,1)))
  mask1 = .TRUE.
  OutData%TwrGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%TwrGagNd))-1 ),mask1,OutData%TwrGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%TwrGagNd)
  OutData%NBlGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%BldGagNd,1)))
  mask1 = .TRUE.
  OutData%BldGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%BldGagNd))-1 ),mask1,OutData%BldGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%BldGagNd)
  OutData%NumOuts = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%TwrFADmp,1)))
  mask1 = .TRUE.
  OutData%TwrFADmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrFADmp))-1 ),mask1,OutData%TwrFADmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrFADmp)
  ALLOCATE(mask1(SIZE(OutData%TwrSSDmp,1)))
  mask1 = .TRUE.
  OutData%TwrSSDmp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrSSDmp))-1 ),mask1,OutData%TwrSSDmp)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrSSDmp)
  ALLOCATE(mask1(SIZE(OutData%FAStTunr,1)))
  mask1 = .TRUE.
  OutData%FAStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FAStTunr))-1 ),mask1,OutData%FAStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FAStTunr)
  ALLOCATE(mask1(SIZE(OutData%SSStTunr,1)))
  mask1 = .TRUE.
  OutData%SSStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SSStTunr))-1 ),mask1,OutData%SSStTunr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%SSStTunr)
  IF ( ALLOCATED(OutData%HtFract) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HtFract,1)))
  mask1 = .TRUE.
    OutData%HtFract = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HtFract))-1 ),mask1,OutData%HtFract)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HtFract)
  ENDIF
  IF ( ALLOCATED(OutData%TMassDen) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TMassDen,1)))
  mask1 = .TRUE.
    OutData%TMassDen = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TMassDen))-1 ),mask1,OutData%TMassDen)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TMassDen)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAStif,1)))
  mask1 = .TRUE.
    OutData%TwFAStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAStif))-1 ),mask1,OutData%TwFAStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSStif,1)))
  mask1 = .TRUE.
    OutData%TwSSStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSStif))-1 ),mask1,OutData%TwSSStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAM1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAM1Sh,1)))
  mask1 = .TRUE.
    OutData%TwFAM1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAM1Sh))-1 ),mask1,OutData%TwFAM1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAM1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAM2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAM2Sh,1)))
  mask1 = .TRUE.
    OutData%TwFAM2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAM2Sh))-1 ),mask1,OutData%TwFAM2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAM2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSM1Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSM1Sh,1)))
  mask1 = .TRUE.
    OutData%TwSSM1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSM1Sh))-1 ),mask1,OutData%TwSSM1Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSM1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSM2Sh) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSM2Sh,1)))
  mask1 = .TRUE.
    OutData%TwSSM2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSM2Sh))-1 ),mask1,OutData%TwSSM2Sh)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSM2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%TwGJStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwGJStif,1)))
  mask1 = .TRUE.
    OutData%TwGJStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwGJStif))-1 ),mask1,OutData%TwGJStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwGJStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwEAStif) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwEAStif,1)))
  mask1 = .TRUE.
    OutData%TwEAStif = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwEAStif))-1 ),mask1,OutData%TwEAStif)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwEAStif)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAIner,1)))
  mask1 = .TRUE.
    OutData%TwFAIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAIner))-1 ),mask1,OutData%TwFAIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAIner)
  ENDIF
  IF ( ALLOCATED(OutData%TwSSIner) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSSIner,1)))
  mask1 = .TRUE.
    OutData%TwSSIner = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSSIner))-1 ),mask1,OutData%TwSSIner)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSSIner)
  ENDIF
  IF ( ALLOCATED(OutData%TwFAcgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwFAcgOf,1)))
  mask1 = .TRUE.
    OutData%TwFAcgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwFAcgOf))-1 ),mask1,OutData%TwFAcgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwFAcgOf)
  ENDIF
  IF ( ALLOCATED(OutData%TwSScgOf) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwSScgOf,1)))
  mask1 = .TRUE.
    OutData%TwSScgOf = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwSScgOf))-1 ),mask1,OutData%TwSScgOf)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwSScgOf)
  ENDIF
  OutData%RotFurl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TailFurl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Yaw2Shft = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinCPzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BoomMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFinMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%RFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%method = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInputFile

 SUBROUTINE ED_CopyCoordSys( SrcCoordSysData, DstCoordSysData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_CoordSys), INTENT(IN) :: SrcCoordSysData
   TYPE(ED_CoordSys), INTENT(INOUT) :: DstCoordSysData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstCoordSysData%a1 = SrcCoordSysData%a1
   DstCoordSysData%a2 = SrcCoordSysData%a2
   DstCoordSysData%a3 = SrcCoordSysData%a3
   DstCoordSysData%b1 = SrcCoordSysData%b1
   DstCoordSysData%b2 = SrcCoordSysData%b2
   DstCoordSysData%b3 = SrcCoordSysData%b3
   DstCoordSysData%c1 = SrcCoordSysData%c1
   DstCoordSysData%c2 = SrcCoordSysData%c2
   DstCoordSysData%c3 = SrcCoordSysData%c3
   DstCoordSysData%d1 = SrcCoordSysData%d1
   DstCoordSysData%d2 = SrcCoordSysData%d2
   DstCoordSysData%d3 = SrcCoordSysData%d3
   DstCoordSysData%e1 = SrcCoordSysData%e1
   DstCoordSysData%e2 = SrcCoordSysData%e2
   DstCoordSysData%e3 = SrcCoordSysData%e3
   DstCoordSysData%f1 = SrcCoordSysData%f1
   DstCoordSysData%f2 = SrcCoordSysData%f2
   DstCoordSysData%f3 = SrcCoordSysData%f3
   DstCoordSysData%g1 = SrcCoordSysData%g1
   DstCoordSysData%g2 = SrcCoordSysData%g2
   DstCoordSysData%g3 = SrcCoordSysData%g3
IF (ALLOCATED(SrcCoordSysData%i1)) THEN
   i1_l = LBOUND(SrcCoordSysData%i1,1)
   i1_u = UBOUND(SrcCoordSysData%i1,1)
   i2_l = LBOUND(SrcCoordSysData%i1,2)
   i2_u = UBOUND(SrcCoordSysData%i1,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%i1)) THEN 
      ALLOCATE(DstCoordSysData%i1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%i1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%i1 = SrcCoordSysData%i1
ENDIF
IF (ALLOCATED(SrcCoordSysData%i2)) THEN
   i1_l = LBOUND(SrcCoordSysData%i2,1)
   i1_u = UBOUND(SrcCoordSysData%i2,1)
   i2_l = LBOUND(SrcCoordSysData%i2,2)
   i2_u = UBOUND(SrcCoordSysData%i2,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%i2)) THEN 
      ALLOCATE(DstCoordSysData%i2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%i2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%i2 = SrcCoordSysData%i2
ENDIF
IF (ALLOCATED(SrcCoordSysData%i3)) THEN
   i1_l = LBOUND(SrcCoordSysData%i3,1)
   i1_u = UBOUND(SrcCoordSysData%i3,1)
   i2_l = LBOUND(SrcCoordSysData%i3,2)
   i2_u = UBOUND(SrcCoordSysData%i3,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%i3)) THEN 
      ALLOCATE(DstCoordSysData%i3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%i3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%i3 = SrcCoordSysData%i3
ENDIF
IF (ALLOCATED(SrcCoordSysData%j1)) THEN
   i1_l = LBOUND(SrcCoordSysData%j1,1)
   i1_u = UBOUND(SrcCoordSysData%j1,1)
   i2_l = LBOUND(SrcCoordSysData%j1,2)
   i2_u = UBOUND(SrcCoordSysData%j1,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%j1)) THEN 
      ALLOCATE(DstCoordSysData%j1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%j1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%j1 = SrcCoordSysData%j1
ENDIF
IF (ALLOCATED(SrcCoordSysData%j2)) THEN
   i1_l = LBOUND(SrcCoordSysData%j2,1)
   i1_u = UBOUND(SrcCoordSysData%j2,1)
   i2_l = LBOUND(SrcCoordSysData%j2,2)
   i2_u = UBOUND(SrcCoordSysData%j2,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%j2)) THEN 
      ALLOCATE(DstCoordSysData%j2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%j2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%j2 = SrcCoordSysData%j2
ENDIF
IF (ALLOCATED(SrcCoordSysData%j3)) THEN
   i1_l = LBOUND(SrcCoordSysData%j3,1)
   i1_u = UBOUND(SrcCoordSysData%j3,1)
   i2_l = LBOUND(SrcCoordSysData%j3,2)
   i2_u = UBOUND(SrcCoordSysData%j3,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%j3)) THEN 
      ALLOCATE(DstCoordSysData%j3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%j3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%j3 = SrcCoordSysData%j3
ENDIF
IF (ALLOCATED(SrcCoordSysData%m1)) THEN
   i1_l = LBOUND(SrcCoordSysData%m1,1)
   i1_u = UBOUND(SrcCoordSysData%m1,1)
   i2_l = LBOUND(SrcCoordSysData%m1,2)
   i2_u = UBOUND(SrcCoordSysData%m1,2)
   i3_l = LBOUND(SrcCoordSysData%m1,3)
   i3_u = UBOUND(SrcCoordSysData%m1,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%m1)) THEN 
      ALLOCATE(DstCoordSysData%m1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%m1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%m1 = SrcCoordSysData%m1
ENDIF
IF (ALLOCATED(SrcCoordSysData%m2)) THEN
   i1_l = LBOUND(SrcCoordSysData%m2,1)
   i1_u = UBOUND(SrcCoordSysData%m2,1)
   i2_l = LBOUND(SrcCoordSysData%m2,2)
   i2_u = UBOUND(SrcCoordSysData%m2,2)
   i3_l = LBOUND(SrcCoordSysData%m2,3)
   i3_u = UBOUND(SrcCoordSysData%m2,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%m2)) THEN 
      ALLOCATE(DstCoordSysData%m2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%m2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%m2 = SrcCoordSysData%m2
ENDIF
IF (ALLOCATED(SrcCoordSysData%m3)) THEN
   i1_l = LBOUND(SrcCoordSysData%m3,1)
   i1_u = UBOUND(SrcCoordSysData%m3,1)
   i2_l = LBOUND(SrcCoordSysData%m3,2)
   i2_u = UBOUND(SrcCoordSysData%m3,2)
   i3_l = LBOUND(SrcCoordSysData%m3,3)
   i3_u = UBOUND(SrcCoordSysData%m3,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%m3)) THEN 
      ALLOCATE(DstCoordSysData%m3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%m3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%m3 = SrcCoordSysData%m3
ENDIF
IF (ALLOCATED(SrcCoordSysData%n1)) THEN
   i1_l = LBOUND(SrcCoordSysData%n1,1)
   i1_u = UBOUND(SrcCoordSysData%n1,1)
   i2_l = LBOUND(SrcCoordSysData%n1,2)
   i2_u = UBOUND(SrcCoordSysData%n1,2)
   i3_l = LBOUND(SrcCoordSysData%n1,3)
   i3_u = UBOUND(SrcCoordSysData%n1,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%n1)) THEN 
      ALLOCATE(DstCoordSysData%n1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%n1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%n1 = SrcCoordSysData%n1
ENDIF
IF (ALLOCATED(SrcCoordSysData%n2)) THEN
   i1_l = LBOUND(SrcCoordSysData%n2,1)
   i1_u = UBOUND(SrcCoordSysData%n2,1)
   i2_l = LBOUND(SrcCoordSysData%n2,2)
   i2_u = UBOUND(SrcCoordSysData%n2,2)
   i3_l = LBOUND(SrcCoordSysData%n2,3)
   i3_u = UBOUND(SrcCoordSysData%n2,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%n2)) THEN 
      ALLOCATE(DstCoordSysData%n2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%n2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%n2 = SrcCoordSysData%n2
ENDIF
IF (ALLOCATED(SrcCoordSysData%n3)) THEN
   i1_l = LBOUND(SrcCoordSysData%n3,1)
   i1_u = UBOUND(SrcCoordSysData%n3,1)
   i2_l = LBOUND(SrcCoordSysData%n3,2)
   i2_u = UBOUND(SrcCoordSysData%n3,2)
   i3_l = LBOUND(SrcCoordSysData%n3,3)
   i3_u = UBOUND(SrcCoordSysData%n3,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%n3)) THEN 
      ALLOCATE(DstCoordSysData%n3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%n3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%n3 = SrcCoordSysData%n3
ENDIF
   DstCoordSysData%p1 = SrcCoordSysData%p1
   DstCoordSysData%p2 = SrcCoordSysData%p2
   DstCoordSysData%p3 = SrcCoordSysData%p3
   DstCoordSysData%rf1 = SrcCoordSysData%rf1
   DstCoordSysData%rf2 = SrcCoordSysData%rf2
   DstCoordSysData%rf3 = SrcCoordSysData%rf3
   DstCoordSysData%rfa = SrcCoordSysData%rfa
IF (ALLOCATED(SrcCoordSysData%t1)) THEN
   i1_l = LBOUND(SrcCoordSysData%t1,1)
   i1_u = UBOUND(SrcCoordSysData%t1,1)
   i2_l = LBOUND(SrcCoordSysData%t1,2)
   i2_u = UBOUND(SrcCoordSysData%t1,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%t1)) THEN 
      ALLOCATE(DstCoordSysData%t1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%t1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%t1 = SrcCoordSysData%t1
ENDIF
IF (ALLOCATED(SrcCoordSysData%t2)) THEN
   i1_l = LBOUND(SrcCoordSysData%t2,1)
   i1_u = UBOUND(SrcCoordSysData%t2,1)
   i2_l = LBOUND(SrcCoordSysData%t2,2)
   i2_u = UBOUND(SrcCoordSysData%t2,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%t2)) THEN 
      ALLOCATE(DstCoordSysData%t2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%t2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%t2 = SrcCoordSysData%t2
ENDIF
IF (ALLOCATED(SrcCoordSysData%t3)) THEN
   i1_l = LBOUND(SrcCoordSysData%t3,1)
   i1_u = UBOUND(SrcCoordSysData%t3,1)
   i2_l = LBOUND(SrcCoordSysData%t3,2)
   i2_u = UBOUND(SrcCoordSysData%t3,2)
   IF (.NOT. ALLOCATED(DstCoordSysData%t3)) THEN 
      ALLOCATE(DstCoordSysData%t3(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%t3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%t3 = SrcCoordSysData%t3
ENDIF
IF (ALLOCATED(SrcCoordSysData%te1)) THEN
   i1_l = LBOUND(SrcCoordSysData%te1,1)
   i1_u = UBOUND(SrcCoordSysData%te1,1)
   i2_l = LBOUND(SrcCoordSysData%te1,2)
   i2_u = UBOUND(SrcCoordSysData%te1,2)
   i3_l = LBOUND(SrcCoordSysData%te1,3)
   i3_u = UBOUND(SrcCoordSysData%te1,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%te1)) THEN 
      ALLOCATE(DstCoordSysData%te1(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%te1.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%te1 = SrcCoordSysData%te1
ENDIF
IF (ALLOCATED(SrcCoordSysData%te2)) THEN
   i1_l = LBOUND(SrcCoordSysData%te2,1)
   i1_u = UBOUND(SrcCoordSysData%te2,1)
   i2_l = LBOUND(SrcCoordSysData%te2,2)
   i2_u = UBOUND(SrcCoordSysData%te2,2)
   i3_l = LBOUND(SrcCoordSysData%te2,3)
   i3_u = UBOUND(SrcCoordSysData%te2,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%te2)) THEN 
      ALLOCATE(DstCoordSysData%te2(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%te2.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%te2 = SrcCoordSysData%te2
ENDIF
IF (ALLOCATED(SrcCoordSysData%te3)) THEN
   i1_l = LBOUND(SrcCoordSysData%te3,1)
   i1_u = UBOUND(SrcCoordSysData%te3,1)
   i2_l = LBOUND(SrcCoordSysData%te3,2)
   i2_u = UBOUND(SrcCoordSysData%te3,2)
   i3_l = LBOUND(SrcCoordSysData%te3,3)
   i3_u = UBOUND(SrcCoordSysData%te3,3)
   IF (.NOT. ALLOCATED(DstCoordSysData%te3)) THEN 
      ALLOCATE(DstCoordSysData%te3(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstCoordSysData%te3.', ErrStat, ErrMsg,'ED_CopyCoordSys')
         RETURN
      END IF
   END IF
   DstCoordSysData%te3 = SrcCoordSysData%te3
ENDIF
   DstCoordSysData%tf1 = SrcCoordSysData%tf1
   DstCoordSysData%tf2 = SrcCoordSysData%tf2
   DstCoordSysData%tf3 = SrcCoordSysData%tf3
   DstCoordSysData%tfa = SrcCoordSysData%tfa
   DstCoordSysData%z1 = SrcCoordSysData%z1
   DstCoordSysData%z2 = SrcCoordSysData%z2
   DstCoordSysData%z3 = SrcCoordSysData%z3
 END SUBROUTINE ED_CopyCoordSys

 SUBROUTINE ED_DestroyCoordSys( CoordSysData, ErrStat, ErrMsg )
  TYPE(ED_CoordSys), INTENT(INOUT) :: CoordSysData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(CoordSysData%i1)) THEN
   DEALLOCATE(CoordSysData%i1)
ENDIF
IF (ALLOCATED(CoordSysData%i2)) THEN
   DEALLOCATE(CoordSysData%i2)
ENDIF
IF (ALLOCATED(CoordSysData%i3)) THEN
   DEALLOCATE(CoordSysData%i3)
ENDIF
IF (ALLOCATED(CoordSysData%j1)) THEN
   DEALLOCATE(CoordSysData%j1)
ENDIF
IF (ALLOCATED(CoordSysData%j2)) THEN
   DEALLOCATE(CoordSysData%j2)
ENDIF
IF (ALLOCATED(CoordSysData%j3)) THEN
   DEALLOCATE(CoordSysData%j3)
ENDIF
IF (ALLOCATED(CoordSysData%m1)) THEN
   DEALLOCATE(CoordSysData%m1)
ENDIF
IF (ALLOCATED(CoordSysData%m2)) THEN
   DEALLOCATE(CoordSysData%m2)
ENDIF
IF (ALLOCATED(CoordSysData%m3)) THEN
   DEALLOCATE(CoordSysData%m3)
ENDIF
IF (ALLOCATED(CoordSysData%n1)) THEN
   DEALLOCATE(CoordSysData%n1)
ENDIF
IF (ALLOCATED(CoordSysData%n2)) THEN
   DEALLOCATE(CoordSysData%n2)
ENDIF
IF (ALLOCATED(CoordSysData%n3)) THEN
   DEALLOCATE(CoordSysData%n3)
ENDIF
IF (ALLOCATED(CoordSysData%t1)) THEN
   DEALLOCATE(CoordSysData%t1)
ENDIF
IF (ALLOCATED(CoordSysData%t2)) THEN
   DEALLOCATE(CoordSysData%t2)
ENDIF
IF (ALLOCATED(CoordSysData%t3)) THEN
   DEALLOCATE(CoordSysData%t3)
ENDIF
IF (ALLOCATED(CoordSysData%te1)) THEN
   DEALLOCATE(CoordSysData%te1)
ENDIF
IF (ALLOCATED(CoordSysData%te2)) THEN
   DEALLOCATE(CoordSysData%te2)
ENDIF
IF (ALLOCATED(CoordSysData%te3)) THEN
   DEALLOCATE(CoordSysData%te3)
ENDIF
 END SUBROUTINE ED_DestroyCoordSys

 SUBROUTINE ED_PackCoordSys( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_CoordSys),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%a1 )  ! a1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%a2 )  ! a2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%a3 )  ! a3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b1 )  ! b1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b2 )  ! b2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%b3 )  ! b3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c1 )  ! c1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c2 )  ! c2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%c3 )  ! c3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d1 )  ! d1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d2 )  ! d2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%d3 )  ! d3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e1 )  ! e1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e2 )  ! e2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%e3 )  ! e3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f1 )  ! f1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f2 )  ! f2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%f3 )  ! f3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g1 )  ! g1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g2 )  ! g2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%g3 )  ! g3 
  IF ( ALLOCATED(InData%i1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%i1 )  ! i1 
  IF ( ALLOCATED(InData%i2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%i2 )  ! i2 
  IF ( ALLOCATED(InData%i3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%i3 )  ! i3 
  IF ( ALLOCATED(InData%j1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%j1 )  ! j1 
  IF ( ALLOCATED(InData%j2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%j2 )  ! j2 
  IF ( ALLOCATED(InData%j3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%j3 )  ! j3 
  IF ( ALLOCATED(InData%m1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%m1 )  ! m1 
  IF ( ALLOCATED(InData%m2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%m2 )  ! m2 
  IF ( ALLOCATED(InData%m3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%m3 )  ! m3 
  IF ( ALLOCATED(InData%n1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%n1 )  ! n1 
  IF ( ALLOCATED(InData%n2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%n2 )  ! n2 
  IF ( ALLOCATED(InData%n3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%n3 )  ! n3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p1 )  ! p1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p2 )  ! p2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%p3 )  ! p3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf1 )  ! rf1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf2 )  ! rf2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rf3 )  ! rf3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rfa )  ! rfa 
  IF ( ALLOCATED(InData%t1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%t1 )  ! t1 
  IF ( ALLOCATED(InData%t2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%t2 )  ! t2 
  IF ( ALLOCATED(InData%t3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%t3 )  ! t3 
  IF ( ALLOCATED(InData%te1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%te1 )  ! te1 
  IF ( ALLOCATED(InData%te2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%te2 )  ! te2 
  IF ( ALLOCATED(InData%te3) )   Re_BufSz    = Re_BufSz    + SIZE( InData%te3 )  ! te3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf1 )  ! tf1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf2 )  ! tf2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tf3 )  ! tf3 
  Re_BufSz    = Re_BufSz    + SIZE( InData%tfa )  ! tfa 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z1 )  ! z1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z2 )  ! z2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%z3 )  ! z3 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a1))-1 ) =  PACK(InData%a1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a2))-1 ) =  PACK(InData%a2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%a3))-1 ) =  PACK(InData%a3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%a3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b1))-1 ) =  PACK(InData%b1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b2))-1 ) =  PACK(InData%b2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%b3))-1 ) =  PACK(InData%b3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%b3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c1))-1 ) =  PACK(InData%c1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c2))-1 ) =  PACK(InData%c2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%c3))-1 ) =  PACK(InData%c3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%c3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d1))-1 ) =  PACK(InData%d1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d2))-1 ) =  PACK(InData%d2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%d3))-1 ) =  PACK(InData%d3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%d3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e1))-1 ) =  PACK(InData%e1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e2))-1 ) =  PACK(InData%e2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%e3))-1 ) =  PACK(InData%e3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%e3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f1))-1 ) =  PACK(InData%f1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f2))-1 ) =  PACK(InData%f2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%f3))-1 ) =  PACK(InData%f3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%f3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g1))-1 ) =  PACK(InData%g1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g2))-1 ) =  PACK(InData%g2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%g3))-1 ) =  PACK(InData%g3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%g3)
  IF ( ALLOCATED(InData%i1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i1))-1 ) =  PACK(InData%i1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i1)
  ENDIF
  IF ( ALLOCATED(InData%i2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i2))-1 ) =  PACK(InData%i2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i2)
  ENDIF
  IF ( ALLOCATED(InData%i3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%i3))-1 ) =  PACK(InData%i3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%i3)
  ENDIF
  IF ( ALLOCATED(InData%j1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j1))-1 ) =  PACK(InData%j1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j1)
  ENDIF
  IF ( ALLOCATED(InData%j2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j2))-1 ) =  PACK(InData%j2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j2)
  ENDIF
  IF ( ALLOCATED(InData%j3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%j3))-1 ) =  PACK(InData%j3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%j3)
  ENDIF
  IF ( ALLOCATED(InData%m1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m1))-1 ) =  PACK(InData%m1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m1)
  ENDIF
  IF ( ALLOCATED(InData%m2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m2))-1 ) =  PACK(InData%m2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m2)
  ENDIF
  IF ( ALLOCATED(InData%m3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%m3))-1 ) =  PACK(InData%m3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%m3)
  ENDIF
  IF ( ALLOCATED(InData%n1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n1))-1 ) =  PACK(InData%n1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n1)
  ENDIF
  IF ( ALLOCATED(InData%n2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n2))-1 ) =  PACK(InData%n2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n2)
  ENDIF
  IF ( ALLOCATED(InData%n3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%n3))-1 ) =  PACK(InData%n3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%n3)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p1))-1 ) =  PACK(InData%p1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p2))-1 ) =  PACK(InData%p2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%p3))-1 ) =  PACK(InData%p3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%p3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf1))-1 ) =  PACK(InData%rf1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf2))-1 ) =  PACK(InData%rf2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rf3))-1 ) =  PACK(InData%rf3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rf3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rfa))-1 ) =  PACK(InData%rfa ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rfa)
  IF ( ALLOCATED(InData%t1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t1))-1 ) =  PACK(InData%t1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t1)
  ENDIF
  IF ( ALLOCATED(InData%t2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t2))-1 ) =  PACK(InData%t2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t2)
  ENDIF
  IF ( ALLOCATED(InData%t3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%t3))-1 ) =  PACK(InData%t3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%t3)
  ENDIF
  IF ( ALLOCATED(InData%te1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te1))-1 ) =  PACK(InData%te1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te1)
  ENDIF
  IF ( ALLOCATED(InData%te2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te2))-1 ) =  PACK(InData%te2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te2)
  ENDIF
  IF ( ALLOCATED(InData%te3) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%te3))-1 ) =  PACK(InData%te3 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%te3)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf1))-1 ) =  PACK(InData%tf1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf2))-1 ) =  PACK(InData%tf2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tf3))-1 ) =  PACK(InData%tf3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tf3)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%tfa))-1 ) =  PACK(InData%tfa ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%tfa)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z1))-1 ) =  PACK(InData%z1 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z1)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z2))-1 ) =  PACK(InData%z2 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z2)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%z3))-1 ) =  PACK(InData%z3 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%z3)
 END SUBROUTINE ED_PackCoordSys

 SUBROUTINE ED_UnPackCoordSys( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_CoordSys), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%a1,1)))
  mask1 = .TRUE.
  OutData%a1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a1))-1 ),mask1,OutData%a1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a1)
  ALLOCATE(mask1(SIZE(OutData%a2,1)))
  mask1 = .TRUE.
  OutData%a2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a2))-1 ),mask1,OutData%a2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a2)
  ALLOCATE(mask1(SIZE(OutData%a3,1)))
  mask1 = .TRUE.
  OutData%a3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%a3))-1 ),mask1,OutData%a3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%a3)
  ALLOCATE(mask1(SIZE(OutData%b1,1)))
  mask1 = .TRUE.
  OutData%b1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b1))-1 ),mask1,OutData%b1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b1)
  ALLOCATE(mask1(SIZE(OutData%b2,1)))
  mask1 = .TRUE.
  OutData%b2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b2))-1 ),mask1,OutData%b2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b2)
  ALLOCATE(mask1(SIZE(OutData%b3,1)))
  mask1 = .TRUE.
  OutData%b3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%b3))-1 ),mask1,OutData%b3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%b3)
  ALLOCATE(mask1(SIZE(OutData%c1,1)))
  mask1 = .TRUE.
  OutData%c1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c1))-1 ),mask1,OutData%c1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c1)
  ALLOCATE(mask1(SIZE(OutData%c2,1)))
  mask1 = .TRUE.
  OutData%c2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c2))-1 ),mask1,OutData%c2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c2)
  ALLOCATE(mask1(SIZE(OutData%c3,1)))
  mask1 = .TRUE.
  OutData%c3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%c3))-1 ),mask1,OutData%c3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%c3)
  ALLOCATE(mask1(SIZE(OutData%d1,1)))
  mask1 = .TRUE.
  OutData%d1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d1))-1 ),mask1,OutData%d1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d1)
  ALLOCATE(mask1(SIZE(OutData%d2,1)))
  mask1 = .TRUE.
  OutData%d2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d2))-1 ),mask1,OutData%d2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d2)
  ALLOCATE(mask1(SIZE(OutData%d3,1)))
  mask1 = .TRUE.
  OutData%d3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%d3))-1 ),mask1,OutData%d3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%d3)
  ALLOCATE(mask1(SIZE(OutData%e1,1)))
  mask1 = .TRUE.
  OutData%e1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e1))-1 ),mask1,OutData%e1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e1)
  ALLOCATE(mask1(SIZE(OutData%e2,1)))
  mask1 = .TRUE.
  OutData%e2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e2))-1 ),mask1,OutData%e2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e2)
  ALLOCATE(mask1(SIZE(OutData%e3,1)))
  mask1 = .TRUE.
  OutData%e3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%e3))-1 ),mask1,OutData%e3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%e3)
  ALLOCATE(mask1(SIZE(OutData%f1,1)))
  mask1 = .TRUE.
  OutData%f1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f1))-1 ),mask1,OutData%f1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f1)
  ALLOCATE(mask1(SIZE(OutData%f2,1)))
  mask1 = .TRUE.
  OutData%f2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f2))-1 ),mask1,OutData%f2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f2)
  ALLOCATE(mask1(SIZE(OutData%f3,1)))
  mask1 = .TRUE.
  OutData%f3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%f3))-1 ),mask1,OutData%f3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%f3)
  ALLOCATE(mask1(SIZE(OutData%g1,1)))
  mask1 = .TRUE.
  OutData%g1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g1))-1 ),mask1,OutData%g1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g1)
  ALLOCATE(mask1(SIZE(OutData%g2,1)))
  mask1 = .TRUE.
  OutData%g2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g2))-1 ),mask1,OutData%g2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g2)
  ALLOCATE(mask1(SIZE(OutData%g3,1)))
  mask1 = .TRUE.
  OutData%g3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%g3))-1 ),mask1,OutData%g3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%g3)
  IF ( ALLOCATED(OutData%i1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i1,1),SIZE(OutData%i1,2)))
  mask2 = .TRUE.
    OutData%i1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i1))-1 ),mask2,OutData%i1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i1)
  ENDIF
  IF ( ALLOCATED(OutData%i2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i2,1),SIZE(OutData%i2,2)))
  mask2 = .TRUE.
    OutData%i2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i2))-1 ),mask2,OutData%i2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i2)
  ENDIF
  IF ( ALLOCATED(OutData%i3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%i3,1),SIZE(OutData%i3,2)))
  mask2 = .TRUE.
    OutData%i3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%i3))-1 ),mask2,OutData%i3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%i3)
  ENDIF
  IF ( ALLOCATED(OutData%j1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j1,1),SIZE(OutData%j1,2)))
  mask2 = .TRUE.
    OutData%j1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j1))-1 ),mask2,OutData%j1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j1)
  ENDIF
  IF ( ALLOCATED(OutData%j2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j2,1),SIZE(OutData%j2,2)))
  mask2 = .TRUE.
    OutData%j2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j2))-1 ),mask2,OutData%j2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j2)
  ENDIF
  IF ( ALLOCATED(OutData%j3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%j3,1),SIZE(OutData%j3,2)))
  mask2 = .TRUE.
    OutData%j3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%j3))-1 ),mask2,OutData%j3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%j3)
  ENDIF
  IF ( ALLOCATED(OutData%m1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m1,1),SIZE(OutData%m1,2),SIZE(OutData%m1,3)))
  mask3 = .TRUE.
    OutData%m1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m1))-1 ),mask3,OutData%m1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m1)
  ENDIF
  IF ( ALLOCATED(OutData%m2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m2,1),SIZE(OutData%m2,2),SIZE(OutData%m2,3)))
  mask3 = .TRUE.
    OutData%m2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m2))-1 ),mask3,OutData%m2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m2)
  ENDIF
  IF ( ALLOCATED(OutData%m3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%m3,1),SIZE(OutData%m3,2),SIZE(OutData%m3,3)))
  mask3 = .TRUE.
    OutData%m3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%m3))-1 ),mask3,OutData%m3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%m3)
  ENDIF
  IF ( ALLOCATED(OutData%n1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n1,1),SIZE(OutData%n1,2),SIZE(OutData%n1,3)))
  mask3 = .TRUE.
    OutData%n1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n1))-1 ),mask3,OutData%n1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n1)
  ENDIF
  IF ( ALLOCATED(OutData%n2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n2,1),SIZE(OutData%n2,2),SIZE(OutData%n2,3)))
  mask3 = .TRUE.
    OutData%n2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n2))-1 ),mask3,OutData%n2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n2)
  ENDIF
  IF ( ALLOCATED(OutData%n3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%n3,1),SIZE(OutData%n3,2),SIZE(OutData%n3,3)))
  mask3 = .TRUE.
    OutData%n3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%n3))-1 ),mask3,OutData%n3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%n3)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%p1,1)))
  mask1 = .TRUE.
  OutData%p1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p1))-1 ),mask1,OutData%p1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p1)
  ALLOCATE(mask1(SIZE(OutData%p2,1)))
  mask1 = .TRUE.
  OutData%p2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p2))-1 ),mask1,OutData%p2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p2)
  ALLOCATE(mask1(SIZE(OutData%p3,1)))
  mask1 = .TRUE.
  OutData%p3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%p3))-1 ),mask1,OutData%p3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%p3)
  ALLOCATE(mask1(SIZE(OutData%rf1,1)))
  mask1 = .TRUE.
  OutData%rf1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf1))-1 ),mask1,OutData%rf1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf1)
  ALLOCATE(mask1(SIZE(OutData%rf2,1)))
  mask1 = .TRUE.
  OutData%rf2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf2))-1 ),mask1,OutData%rf2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf2)
  ALLOCATE(mask1(SIZE(OutData%rf3,1)))
  mask1 = .TRUE.
  OutData%rf3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rf3))-1 ),mask1,OutData%rf3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rf3)
  ALLOCATE(mask1(SIZE(OutData%rfa,1)))
  mask1 = .TRUE.
  OutData%rfa = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rfa))-1 ),mask1,OutData%rfa)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rfa)
  IF ( ALLOCATED(OutData%t1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t1,1),SIZE(OutData%t1,2)))
  mask2 = .TRUE.
    OutData%t1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t1))-1 ),mask2,OutData%t1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t1)
  ENDIF
  IF ( ALLOCATED(OutData%t2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t2,1),SIZE(OutData%t2,2)))
  mask2 = .TRUE.
    OutData%t2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t2))-1 ),mask2,OutData%t2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t2)
  ENDIF
  IF ( ALLOCATED(OutData%t3) ) THEN
  ALLOCATE(mask2(SIZE(OutData%t3,1),SIZE(OutData%t3,2)))
  mask2 = .TRUE.
    OutData%t3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%t3))-1 ),mask2,OutData%t3)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%t3)
  ENDIF
  IF ( ALLOCATED(OutData%te1) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te1,1),SIZE(OutData%te1,2),SIZE(OutData%te1,3)))
  mask3 = .TRUE.
    OutData%te1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te1))-1 ),mask3,OutData%te1)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te1)
  ENDIF
  IF ( ALLOCATED(OutData%te2) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te2,1),SIZE(OutData%te2,2),SIZE(OutData%te2,3)))
  mask3 = .TRUE.
    OutData%te2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te2))-1 ),mask3,OutData%te2)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te2)
  ENDIF
  IF ( ALLOCATED(OutData%te3) ) THEN
  ALLOCATE(mask3(SIZE(OutData%te3,1),SIZE(OutData%te3,2),SIZE(OutData%te3,3)))
  mask3 = .TRUE.
    OutData%te3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%te3))-1 ),mask3,OutData%te3)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%te3)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%tf1,1)))
  mask1 = .TRUE.
  OutData%tf1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf1))-1 ),mask1,OutData%tf1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf1)
  ALLOCATE(mask1(SIZE(OutData%tf2,1)))
  mask1 = .TRUE.
  OutData%tf2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf2))-1 ),mask1,OutData%tf2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf2)
  ALLOCATE(mask1(SIZE(OutData%tf3,1)))
  mask1 = .TRUE.
  OutData%tf3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tf3))-1 ),mask1,OutData%tf3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tf3)
  ALLOCATE(mask1(SIZE(OutData%tfa,1)))
  mask1 = .TRUE.
  OutData%tfa = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%tfa))-1 ),mask1,OutData%tfa)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%tfa)
  ALLOCATE(mask1(SIZE(OutData%z1,1)))
  mask1 = .TRUE.
  OutData%z1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z1))-1 ),mask1,OutData%z1)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z1)
  ALLOCATE(mask1(SIZE(OutData%z2,1)))
  mask1 = .TRUE.
  OutData%z2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z2))-1 ),mask1,OutData%z2)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z2)
  ALLOCATE(mask1(SIZE(OutData%z3,1)))
  mask1 = .TRUE.
  OutData%z3 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%z3))-1 ),mask1,OutData%z3)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%z3)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackCoordSys

 SUBROUTINE ED_CopyActiveDOFs( SrcActiveDOFsData, DstActiveDOFsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_ActiveDOFs), INTENT(IN) :: SrcActiveDOFsData
   TYPE(ED_ActiveDOFs), INTENT(INOUT) :: DstActiveDOFsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstActiveDOFsData%NActvDOF = SrcActiveDOFsData%NActvDOF
   DstActiveDOFsData%NPCE = SrcActiveDOFsData%NPCE
   DstActiveDOFsData%NPDE = SrcActiveDOFsData%NPDE
   DstActiveDOFsData%NPIE = SrcActiveDOFsData%NPIE
   DstActiveDOFsData%NPTE = SrcActiveDOFsData%NPTE
   DstActiveDOFsData%NPTTE = SrcActiveDOFsData%NPTTE
IF (ALLOCATED(SrcActiveDOFsData%NPSBE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%NPSBE,1)
   i1_u = UBOUND(SrcActiveDOFsData%NPSBE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%NPSBE)) THEN 
      ALLOCATE(DstActiveDOFsData%NPSBE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%NPSBE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%NPSBE = SrcActiveDOFsData%NPSBE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%NPSE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%NPSE,1)
   i1_u = UBOUND(SrcActiveDOFsData%NPSE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%NPSE)) THEN 
      ALLOCATE(DstActiveDOFsData%NPSE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%NPSE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%NPSE = SrcActiveDOFsData%NPSE
ENDIF
   DstActiveDOFsData%NPUE = SrcActiveDOFsData%NPUE
   DstActiveDOFsData%NPYE = SrcActiveDOFsData%NPYE
IF (ALLOCATED(SrcActiveDOFsData%PCE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PCE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PCE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PCE)) THEN 
      ALLOCATE(DstActiveDOFsData%PCE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PCE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PCE = SrcActiveDOFsData%PCE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PDE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PDE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PDE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PDE)) THEN 
      ALLOCATE(DstActiveDOFsData%PDE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PDE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PDE = SrcActiveDOFsData%PDE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PIE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PIE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PIE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PIE)) THEN 
      ALLOCATE(DstActiveDOFsData%PIE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PIE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PIE = SrcActiveDOFsData%PIE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PTE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PTE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PTE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PTE)) THEN 
      ALLOCATE(DstActiveDOFsData%PTE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PTE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PTE = SrcActiveDOFsData%PTE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PTTE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PTTE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PTTE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PTTE)) THEN 
      ALLOCATE(DstActiveDOFsData%PTTE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PTTE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PTTE = SrcActiveDOFsData%PTTE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PS)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PS,1)
   i1_u = UBOUND(SrcActiveDOFsData%PS,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PS)) THEN 
      ALLOCATE(DstActiveDOFsData%PS(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PS.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PS = SrcActiveDOFsData%PS
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PSBE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PSBE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PSBE,1)
   i2_l = LBOUND(SrcActiveDOFsData%PSBE,2)
   i2_u = UBOUND(SrcActiveDOFsData%PSBE,2)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PSBE)) THEN 
      ALLOCATE(DstActiveDOFsData%PSBE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PSBE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PSBE = SrcActiveDOFsData%PSBE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PSE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PSE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PSE,1)
   i2_l = LBOUND(SrcActiveDOFsData%PSE,2)
   i2_u = UBOUND(SrcActiveDOFsData%PSE,2)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PSE)) THEN 
      ALLOCATE(DstActiveDOFsData%PSE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PSE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PSE = SrcActiveDOFsData%PSE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PUE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PUE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PUE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PUE)) THEN 
      ALLOCATE(DstActiveDOFsData%PUE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PUE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PUE = SrcActiveDOFsData%PUE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%PYE)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%PYE,1)
   i1_u = UBOUND(SrcActiveDOFsData%PYE,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%PYE)) THEN 
      ALLOCATE(DstActiveDOFsData%PYE(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%PYE.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%PYE = SrcActiveDOFsData%PYE
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%SrtPS)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%SrtPS,1)
   i1_u = UBOUND(SrcActiveDOFsData%SrtPS,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%SrtPS)) THEN 
      ALLOCATE(DstActiveDOFsData%SrtPS(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%SrtPS.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%SrtPS = SrcActiveDOFsData%SrtPS
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%SrtPSNAUG)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%SrtPSNAUG,1)
   i1_u = UBOUND(SrcActiveDOFsData%SrtPSNAUG,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%SrtPSNAUG)) THEN 
      ALLOCATE(DstActiveDOFsData%SrtPSNAUG(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%SrtPSNAUG.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%SrtPSNAUG = SrcActiveDOFsData%SrtPSNAUG
ENDIF
IF (ALLOCATED(SrcActiveDOFsData%Diag)) THEN
   i1_l = LBOUND(SrcActiveDOFsData%Diag,1)
   i1_u = UBOUND(SrcActiveDOFsData%Diag,1)
   IF (.NOT. ALLOCATED(DstActiveDOFsData%Diag)) THEN 
      ALLOCATE(DstActiveDOFsData%Diag(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstActiveDOFsData%Diag.', ErrStat, ErrMsg,'ED_CopyActiveDOFs')
         RETURN
      END IF
   END IF
   DstActiveDOFsData%Diag = SrcActiveDOFsData%Diag
ENDIF
 END SUBROUTINE ED_CopyActiveDOFs

 SUBROUTINE ED_DestroyActiveDOFs( ActiveDOFsData, ErrStat, ErrMsg )
  TYPE(ED_ActiveDOFs), INTENT(INOUT) :: ActiveDOFsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ActiveDOFsData%NPSBE)) THEN
   DEALLOCATE(ActiveDOFsData%NPSBE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%NPSE)) THEN
   DEALLOCATE(ActiveDOFsData%NPSE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PCE)) THEN
   DEALLOCATE(ActiveDOFsData%PCE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PDE)) THEN
   DEALLOCATE(ActiveDOFsData%PDE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PIE)) THEN
   DEALLOCATE(ActiveDOFsData%PIE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PTE)) THEN
   DEALLOCATE(ActiveDOFsData%PTE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PTTE)) THEN
   DEALLOCATE(ActiveDOFsData%PTTE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PS)) THEN
   DEALLOCATE(ActiveDOFsData%PS)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PSBE)) THEN
   DEALLOCATE(ActiveDOFsData%PSBE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PSE)) THEN
   DEALLOCATE(ActiveDOFsData%PSE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PUE)) THEN
   DEALLOCATE(ActiveDOFsData%PUE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%PYE)) THEN
   DEALLOCATE(ActiveDOFsData%PYE)
ENDIF
IF (ALLOCATED(ActiveDOFsData%SrtPS)) THEN
   DEALLOCATE(ActiveDOFsData%SrtPS)
ENDIF
IF (ALLOCATED(ActiveDOFsData%SrtPSNAUG)) THEN
   DEALLOCATE(ActiveDOFsData%SrtPSNAUG)
ENDIF
IF (ALLOCATED(ActiveDOFsData%Diag)) THEN
   DEALLOCATE(ActiveDOFsData%Diag)
ENDIF
 END SUBROUTINE ED_DestroyActiveDOFs

 SUBROUTINE ED_PackActiveDOFs( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_ActiveDOFs),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NActvDOF
  Int_BufSz  = Int_BufSz  + 1  ! NPCE
  Int_BufSz  = Int_BufSz  + 1  ! NPDE
  Int_BufSz  = Int_BufSz  + 1  ! NPIE
  Int_BufSz  = Int_BufSz  + 1  ! NPTE
  Int_BufSz  = Int_BufSz  + 1  ! NPTTE
  IF ( ALLOCATED(InData%NPSBE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NPSBE )  ! NPSBE 
  IF ( ALLOCATED(InData%NPSE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NPSE )  ! NPSE 
  Int_BufSz  = Int_BufSz  + 1  ! NPUE
  Int_BufSz  = Int_BufSz  + 1  ! NPYE
  IF ( ALLOCATED(InData%PCE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PCE )  ! PCE 
  IF ( ALLOCATED(InData%PDE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PDE )  ! PDE 
  IF ( ALLOCATED(InData%PIE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PIE )  ! PIE 
  IF ( ALLOCATED(InData%PTE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PTE )  ! PTE 
  IF ( ALLOCATED(InData%PTTE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PTTE )  ! PTTE 
  IF ( ALLOCATED(InData%PS) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PS )  ! PS 
  IF ( ALLOCATED(InData%PSBE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PSBE )  ! PSBE 
  IF ( ALLOCATED(InData%PSE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PSE )  ! PSE 
  IF ( ALLOCATED(InData%PUE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PUE )  ! PUE 
  IF ( ALLOCATED(InData%PYE) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PYE )  ! PYE 
  IF ( ALLOCATED(InData%SrtPS) )   Int_BufSz   = Int_BufSz   + SIZE( InData%SrtPS )  ! SrtPS 
  IF ( ALLOCATED(InData%SrtPSNAUG) )   Int_BufSz   = Int_BufSz   + SIZE( InData%SrtPSNAUG )  ! SrtPSNAUG 
  IF ( ALLOCATED(InData%Diag) )   Int_BufSz   = Int_BufSz   + SIZE( InData%Diag )  ! Diag 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NActvDOF )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPCE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPDE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPIE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPTE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPTTE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NPSBE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NPSBE))-1 ) = PACK(InData%NPSBE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NPSBE)
  ENDIF
  IF ( ALLOCATED(InData%NPSE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NPSE))-1 ) = PACK(InData%NPSE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NPSE)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPUE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPYE )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PCE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PCE))-1 ) = PACK(InData%PCE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PCE)
  ENDIF
  IF ( ALLOCATED(InData%PDE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PDE))-1 ) = PACK(InData%PDE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PDE)
  ENDIF
  IF ( ALLOCATED(InData%PIE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PIE))-1 ) = PACK(InData%PIE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PIE)
  ENDIF
  IF ( ALLOCATED(InData%PTE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PTE))-1 ) = PACK(InData%PTE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PTE)
  ENDIF
  IF ( ALLOCATED(InData%PTTE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PTTE))-1 ) = PACK(InData%PTTE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PTTE)
  ENDIF
  IF ( ALLOCATED(InData%PS) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PS))-1 ) = PACK(InData%PS ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PS)
  ENDIF
  IF ( ALLOCATED(InData%PSBE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PSBE))-1 ) = PACK(InData%PSBE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PSBE)
  ENDIF
  IF ( ALLOCATED(InData%PSE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PSE))-1 ) = PACK(InData%PSE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PSE)
  ENDIF
  IF ( ALLOCATED(InData%PUE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PUE))-1 ) = PACK(InData%PUE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PUE)
  ENDIF
  IF ( ALLOCATED(InData%PYE) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PYE))-1 ) = PACK(InData%PYE ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PYE)
  ENDIF
  IF ( ALLOCATED(InData%SrtPS) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SrtPS))-1 ) = PACK(InData%SrtPS ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%SrtPS)
  ENDIF
  IF ( ALLOCATED(InData%SrtPSNAUG) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SrtPSNAUG))-1 ) = PACK(InData%SrtPSNAUG ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%SrtPSNAUG)
  ENDIF
  IF ( ALLOCATED(InData%Diag) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%Diag))-1 ) = PACK(InData%Diag ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%Diag)
  ENDIF
 END SUBROUTINE ED_PackActiveDOFs

 SUBROUTINE ED_UnPackActiveDOFs( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_ActiveDOFs), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NActvDOF = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPCE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPDE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPIE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPTE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPTTE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NPSBE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NPSBE,1)))
  mask1 = .TRUE.
    OutData%NPSBE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NPSBE))-1 ),mask1,OutData%NPSBE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NPSBE)
  ENDIF
  IF ( ALLOCATED(OutData%NPSE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NPSE,1)))
  mask1 = .TRUE.
    OutData%NPSE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NPSE))-1 ),mask1,OutData%NPSE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NPSE)
  ENDIF
  OutData%NPUE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPYE = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PCE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PCE,1)))
  mask1 = .TRUE.
    OutData%PCE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PCE))-1 ),mask1,OutData%PCE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PCE)
  ENDIF
  IF ( ALLOCATED(OutData%PDE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PDE,1)))
  mask1 = .TRUE.
    OutData%PDE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PDE))-1 ),mask1,OutData%PDE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PDE)
  ENDIF
  IF ( ALLOCATED(OutData%PIE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PIE,1)))
  mask1 = .TRUE.
    OutData%PIE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PIE))-1 ),mask1,OutData%PIE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PIE)
  ENDIF
  IF ( ALLOCATED(OutData%PTE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PTE,1)))
  mask1 = .TRUE.
    OutData%PTE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PTE))-1 ),mask1,OutData%PTE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PTE)
  ENDIF
  IF ( ALLOCATED(OutData%PTTE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PTTE,1)))
  mask1 = .TRUE.
    OutData%PTTE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PTTE))-1 ),mask1,OutData%PTTE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PTTE)
  ENDIF
  IF ( ALLOCATED(OutData%PS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PS,1)))
  mask1 = .TRUE.
    OutData%PS = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PS))-1 ),mask1,OutData%PS)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PS)
  ENDIF
  IF ( ALLOCATED(OutData%PSBE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PSBE,1),SIZE(OutData%PSBE,2)))
  mask2 = .TRUE.
    OutData%PSBE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PSBE))-1 ),mask2,OutData%PSBE)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PSBE)
  ENDIF
  IF ( ALLOCATED(OutData%PSE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PSE,1),SIZE(OutData%PSE,2)))
  mask2 = .TRUE.
    OutData%PSE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PSE))-1 ),mask2,OutData%PSE)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PSE)
  ENDIF
  IF ( ALLOCATED(OutData%PUE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PUE,1)))
  mask1 = .TRUE.
    OutData%PUE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PUE))-1 ),mask1,OutData%PUE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PUE)
  ENDIF
  IF ( ALLOCATED(OutData%PYE) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PYE,1)))
  mask1 = .TRUE.
    OutData%PYE = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PYE))-1 ),mask1,OutData%PYE)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PYE)
  ENDIF
  IF ( ALLOCATED(OutData%SrtPS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SrtPS,1)))
  mask1 = .TRUE.
    OutData%SrtPS = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SrtPS))-1 ),mask1,OutData%SrtPS)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%SrtPS)
  ENDIF
  IF ( ALLOCATED(OutData%SrtPSNAUG) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SrtPSNAUG,1)))
  mask1 = .TRUE.
    OutData%SrtPSNAUG = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SrtPSNAUG))-1 ),mask1,OutData%SrtPSNAUG)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%SrtPSNAUG)
  ENDIF
  IF ( ALLOCATED(OutData%Diag) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Diag,1)))
  mask1 = .TRUE.
    OutData%Diag = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%Diag))-1 ),mask1,OutData%Diag)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%Diag)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackActiveDOFs

 SUBROUTINE ED_CopyRtHndSide( SrcRtHndSideData, DstRtHndSideData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_RtHndSide), INTENT(IN) :: SrcRtHndSideData
   TYPE(ED_RtHndSide), INTENT(INOUT) :: DstRtHndSideData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRtHndSideData%rO = SrcRtHndSideData%rO
IF (ALLOCATED(SrcRtHndSideData%rQS)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rQS,1)
   i1_u = UBOUND(SrcRtHndSideData%rQS,1)
   i2_l = LBOUND(SrcRtHndSideData%rQS,2)
   i2_u = UBOUND(SrcRtHndSideData%rQS,2)
   i3_l = LBOUND(SrcRtHndSideData%rQS,3)
   i3_u = UBOUND(SrcRtHndSideData%rQS,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rQS)) THEN 
      ALLOCATE(DstRtHndSideData%rQS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rQS.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rQS = SrcRtHndSideData%rQS
ENDIF
IF (ALLOCATED(SrcRtHndSideData%rS)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rS,1)
   i1_u = UBOUND(SrcRtHndSideData%rS,1)
   i2_l = LBOUND(SrcRtHndSideData%rS,2)
   i2_u = UBOUND(SrcRtHndSideData%rS,2)
   i3_l = LBOUND(SrcRtHndSideData%rS,3)
   i3_u = UBOUND(SrcRtHndSideData%rS,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rS)) THEN 
      ALLOCATE(DstRtHndSideData%rS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rS.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rS = SrcRtHndSideData%rS
ENDIF
IF (ALLOCATED(SrcRtHndSideData%rS0S)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rS0S,1)
   i1_u = UBOUND(SrcRtHndSideData%rS0S,1)
   i2_l = LBOUND(SrcRtHndSideData%rS0S,2)
   i2_u = UBOUND(SrcRtHndSideData%rS0S,2)
   i3_l = LBOUND(SrcRtHndSideData%rS0S,3)
   i3_u = UBOUND(SrcRtHndSideData%rS0S,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rS0S)) THEN 
      ALLOCATE(DstRtHndSideData%rS0S(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rS0S.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rS0S = SrcRtHndSideData%rS0S
ENDIF
IF (ALLOCATED(SrcRtHndSideData%rT)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rT,1)
   i1_u = UBOUND(SrcRtHndSideData%rT,1)
   i2_l = LBOUND(SrcRtHndSideData%rT,2)
   i2_u = UBOUND(SrcRtHndSideData%rT,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rT)) THEN 
      ALLOCATE(DstRtHndSideData%rT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rT.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rT = SrcRtHndSideData%rT
ENDIF
   DstRtHndSideData%rT0O = SrcRtHndSideData%rT0O
IF (ALLOCATED(SrcRtHndSideData%rT0T)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rT0T,1)
   i1_u = UBOUND(SrcRtHndSideData%rT0T,1)
   i2_l = LBOUND(SrcRtHndSideData%rT0T,2)
   i2_u = UBOUND(SrcRtHndSideData%rT0T,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rT0T)) THEN 
      ALLOCATE(DstRtHndSideData%rT0T(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rT0T.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rT0T = SrcRtHndSideData%rT0T
ENDIF
   DstRtHndSideData%rZ = SrcRtHndSideData%rZ
   DstRtHndSideData%rZO = SrcRtHndSideData%rZO
IF (ALLOCATED(SrcRtHndSideData%rZT)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rZT,1)
   i1_u = UBOUND(SrcRtHndSideData%rZT,1)
   i2_l = LBOUND(SrcRtHndSideData%rZT,2)
   i2_u = UBOUND(SrcRtHndSideData%rZT,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rZT)) THEN 
      ALLOCATE(DstRtHndSideData%rZT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rZT.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rZT = SrcRtHndSideData%rZT
ENDIF
   DstRtHndSideData%rPQ = SrcRtHndSideData%rPQ
   DstRtHndSideData%rP = SrcRtHndSideData%rP
   DstRtHndSideData%rV = SrcRtHndSideData%rV
   DstRtHndSideData%rZY = SrcRtHndSideData%rZY
   DstRtHndSideData%rOU = SrcRtHndSideData%rOU
   DstRtHndSideData%rOV = SrcRtHndSideData%rOV
   DstRtHndSideData%rVD = SrcRtHndSideData%rVD
   DstRtHndSideData%rOW = SrcRtHndSideData%rOW
   DstRtHndSideData%rPC = SrcRtHndSideData%rPC
IF (ALLOCATED(SrcRtHndSideData%rPS0)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rPS0,1)
   i1_u = UBOUND(SrcRtHndSideData%rPS0,1)
   i2_l = LBOUND(SrcRtHndSideData%rPS0,2)
   i2_u = UBOUND(SrcRtHndSideData%rPS0,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rPS0)) THEN 
      ALLOCATE(DstRtHndSideData%rPS0(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rPS0.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rPS0 = SrcRtHndSideData%rPS0
ENDIF
   DstRtHndSideData%rQ = SrcRtHndSideData%rQ
   DstRtHndSideData%rQC = SrcRtHndSideData%rQC
   DstRtHndSideData%rVIMU = SrcRtHndSideData%rVIMU
   DstRtHndSideData%rVP = SrcRtHndSideData%rVP
   DstRtHndSideData%rWI = SrcRtHndSideData%rWI
   DstRtHndSideData%rWJ = SrcRtHndSideData%rWJ
   DstRtHndSideData%rWK = SrcRtHndSideData%rWK
   DstRtHndSideData%rZT0 = SrcRtHndSideData%rZT0
IF (ALLOCATED(SrcRtHndSideData%AngPosEF)) THEN
   i1_l = LBOUND(SrcRtHndSideData%AngPosEF,1)
   i1_u = UBOUND(SrcRtHndSideData%AngPosEF,1)
   i2_l = LBOUND(SrcRtHndSideData%AngPosEF,2)
   i2_u = UBOUND(SrcRtHndSideData%AngPosEF,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%AngPosEF)) THEN 
      ALLOCATE(DstRtHndSideData%AngPosEF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%AngPosEF.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%AngPosEF = SrcRtHndSideData%AngPosEF
ENDIF
IF (ALLOCATED(SrcRtHndSideData%AngPosXF)) THEN
   i1_l = LBOUND(SrcRtHndSideData%AngPosXF,1)
   i1_u = UBOUND(SrcRtHndSideData%AngPosXF,1)
   i2_l = LBOUND(SrcRtHndSideData%AngPosXF,2)
   i2_u = UBOUND(SrcRtHndSideData%AngPosXF,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%AngPosXF)) THEN 
      ALLOCATE(DstRtHndSideData%AngPosXF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%AngPosXF.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%AngPosXF = SrcRtHndSideData%AngPosXF
ENDIF
IF (ALLOCATED(SrcRtHndSideData%AngPosHM)) THEN
   i1_l = LBOUND(SrcRtHndSideData%AngPosHM,1)
   i1_u = UBOUND(SrcRtHndSideData%AngPosHM,1)
   i2_l = LBOUND(SrcRtHndSideData%AngPosHM,2)
   i2_u = UBOUND(SrcRtHndSideData%AngPosHM,2)
   i3_l = LBOUND(SrcRtHndSideData%AngPosHM,3)
   i3_u = UBOUND(SrcRtHndSideData%AngPosHM,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%AngPosHM)) THEN 
      ALLOCATE(DstRtHndSideData%AngPosHM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%AngPosHM.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%AngPosHM = SrcRtHndSideData%AngPosHM
ENDIF
   DstRtHndSideData%AngPosXB = SrcRtHndSideData%AngPosXB
   DstRtHndSideData%AngPosEX = SrcRtHndSideData%AngPosEX
IF (ALLOCATED(SrcRtHndSideData%PAngVelEA)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEA,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEA,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEA,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEA,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEA,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEA,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEA)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEA.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEA = SrcRtHndSideData%PAngVelEA
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEF)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEF,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEF,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEF,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEF,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEF,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEF,3)
   i4_l = LBOUND(SrcRtHndSideData%PAngVelEF,4)
   i4_u = UBOUND(SrcRtHndSideData%PAngVelEF,4)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEF)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEF.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEF = SrcRtHndSideData%PAngVelEF
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEG)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEG,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEG,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEG,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEG,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEG,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEG,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEG)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEG(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEG.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEG = SrcRtHndSideData%PAngVelEG
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEH)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEH,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEH,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEH,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEH,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEH,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEH,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEH)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEH(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEH.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEH = SrcRtHndSideData%PAngVelEH
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEL)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEL,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEL,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEL,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEL,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEL,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEL,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEL)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEL.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEL = SrcRtHndSideData%PAngVelEL
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEM)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEM,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEM,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEM,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEM,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEM,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEM,3)
   i4_l = LBOUND(SrcRtHndSideData%PAngVelEM,4)
   i4_u = UBOUND(SrcRtHndSideData%PAngVelEM,4)
   i5_l = LBOUND(SrcRtHndSideData%PAngVelEM,5)
   i5_u = UBOUND(SrcRtHndSideData%PAngVelEM,5)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEM)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEM.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEM = SrcRtHndSideData%PAngVelEM
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEN)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEN,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEN,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEN,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEN,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEN,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEN,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEN)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEN(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEN.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEN = SrcRtHndSideData%PAngVelEN
ENDIF
   DstRtHndSideData%AngVelEA = SrcRtHndSideData%AngVelEA
IF (ALLOCATED(SrcRtHndSideData%PAngVelEB)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEB,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEB,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEB,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEB,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEB,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEB,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEB)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEB.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEB = SrcRtHndSideData%PAngVelEB
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelER)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelER,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelER,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelER,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelER,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelER,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelER,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelER)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelER(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelER.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelER = SrcRtHndSideData%PAngVelER
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PAngVelEX)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PAngVelEX,1)
   i1_u = UBOUND(SrcRtHndSideData%PAngVelEX,1)
   i2_l = LBOUND(SrcRtHndSideData%PAngVelEX,2)
   i2_u = UBOUND(SrcRtHndSideData%PAngVelEX,2)
   i3_l = LBOUND(SrcRtHndSideData%PAngVelEX,3)
   i3_u = UBOUND(SrcRtHndSideData%PAngVelEX,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PAngVelEX)) THEN 
      ALLOCATE(DstRtHndSideData%PAngVelEX(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PAngVelEX.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PAngVelEX = SrcRtHndSideData%PAngVelEX
ENDIF
   DstRtHndSideData%AngVelEG = SrcRtHndSideData%AngVelEG
   DstRtHndSideData%AngVelEH = SrcRtHndSideData%AngVelEH
   DstRtHndSideData%AngVelEL = SrcRtHndSideData%AngVelEL
   DstRtHndSideData%AngVelEN = SrcRtHndSideData%AngVelEN
   DstRtHndSideData%AngVelEB = SrcRtHndSideData%AngVelEB
   DstRtHndSideData%AngVelER = SrcRtHndSideData%AngVelER
   DstRtHndSideData%AngVelEX = SrcRtHndSideData%AngVelEX
   DstRtHndSideData%TeetAngVel = SrcRtHndSideData%TeetAngVel
   DstRtHndSideData%AngAccEBt = SrcRtHndSideData%AngAccEBt
   DstRtHndSideData%AngAccERt = SrcRtHndSideData%AngAccERt
   DstRtHndSideData%AngAccEXt = SrcRtHndSideData%AngAccEXt
IF (ALLOCATED(SrcRtHndSideData%AngAccEFt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%AngAccEFt,1)
   i1_u = UBOUND(SrcRtHndSideData%AngAccEFt,1)
   i2_l = LBOUND(SrcRtHndSideData%AngAccEFt,2)
   i2_u = UBOUND(SrcRtHndSideData%AngAccEFt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%AngAccEFt)) THEN 
      ALLOCATE(DstRtHndSideData%AngAccEFt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%AngAccEFt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%AngAccEFt = SrcRtHndSideData%AngAccEFt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%AngVelEF)) THEN
   i1_l = LBOUND(SrcRtHndSideData%AngVelEF,1)
   i1_u = UBOUND(SrcRtHndSideData%AngVelEF,1)
   i2_l = LBOUND(SrcRtHndSideData%AngVelEF,2)
   i2_u = UBOUND(SrcRtHndSideData%AngVelEF,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%AngVelEF)) THEN 
      ALLOCATE(DstRtHndSideData%AngVelEF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%AngVelEF.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%AngVelEF = SrcRtHndSideData%AngVelEF
ENDIF
   DstRtHndSideData%AngAccEAt = SrcRtHndSideData%AngAccEAt
   DstRtHndSideData%AngAccEGt = SrcRtHndSideData%AngAccEGt
   DstRtHndSideData%AngAccEHt = SrcRtHndSideData%AngAccEHt
   DstRtHndSideData%AngAccENt = SrcRtHndSideData%AngAccENt
   DstRtHndSideData%LinAccECt = SrcRtHndSideData%LinAccECt
   DstRtHndSideData%LinAccEDt = SrcRtHndSideData%LinAccEDt
   DstRtHndSideData%LinAccEIt = SrcRtHndSideData%LinAccEIt
   DstRtHndSideData%LinAccEJt = SrcRtHndSideData%LinAccEJt
   DstRtHndSideData%LinAccEUt = SrcRtHndSideData%LinAccEUt
   DstRtHndSideData%LinAccEYt = SrcRtHndSideData%LinAccEYt
IF (ALLOCATED(SrcRtHndSideData%LinVelES)) THEN
   i1_l = LBOUND(SrcRtHndSideData%LinVelES,1)
   i1_u = UBOUND(SrcRtHndSideData%LinVelES,1)
   i2_l = LBOUND(SrcRtHndSideData%LinVelES,2)
   i2_u = UBOUND(SrcRtHndSideData%LinVelES,2)
   i3_l = LBOUND(SrcRtHndSideData%LinVelES,3)
   i3_u = UBOUND(SrcRtHndSideData%LinVelES,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%LinVelES)) THEN 
      ALLOCATE(DstRtHndSideData%LinVelES(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%LinVelES.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%LinVelES = SrcRtHndSideData%LinVelES
ENDIF
IF (ALLOCATED(SrcRtHndSideData%LinVelET)) THEN
   i1_l = LBOUND(SrcRtHndSideData%LinVelET,1)
   i1_u = UBOUND(SrcRtHndSideData%LinVelET,1)
   i2_l = LBOUND(SrcRtHndSideData%LinVelET,2)
   i2_u = UBOUND(SrcRtHndSideData%LinVelET,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%LinVelET)) THEN 
      ALLOCATE(DstRtHndSideData%LinVelET(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%LinVelET.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%LinVelET = SrcRtHndSideData%LinVelET
ENDIF
IF (ALLOCATED(SrcRtHndSideData%LinVelESm2)) THEN
   i1_l = LBOUND(SrcRtHndSideData%LinVelESm2,1)
   i1_u = UBOUND(SrcRtHndSideData%LinVelESm2,1)
   IF (.NOT. ALLOCATED(DstRtHndSideData%LinVelESm2)) THEN 
      ALLOCATE(DstRtHndSideData%LinVelESm2(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%LinVelESm2.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%LinVelESm2 = SrcRtHndSideData%LinVelESm2
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEIMU)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEIMU,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEIMU,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEIMU,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEIMU,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEIMU,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEIMU,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEIMU)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEIMU(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEIMU.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEIMU = SrcRtHndSideData%PLinVelEIMU
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEO)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEO,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEO,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEO,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEO,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEO,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEO,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEO)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEO(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEO.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEO = SrcRtHndSideData%PLinVelEO
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelES)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelES,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelES,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelES,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelES,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelES,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelES,3)
   i4_l = LBOUND(SrcRtHndSideData%PLinVelES,4)
   i4_u = UBOUND(SrcRtHndSideData%PLinVelES,4)
   i5_l = LBOUND(SrcRtHndSideData%PLinVelES,5)
   i5_u = UBOUND(SrcRtHndSideData%PLinVelES,5)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelES)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelES(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelES.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelES = SrcRtHndSideData%PLinVelES
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelET)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelET,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelET,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelET,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelET,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelET,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelET,3)
   i4_l = LBOUND(SrcRtHndSideData%PLinVelET,4)
   i4_u = UBOUND(SrcRtHndSideData%PLinVelET,4)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelET)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelET(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelET.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelET = SrcRtHndSideData%PLinVelET
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEZ)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEZ,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEZ,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEZ,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEZ,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEZ,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEZ,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEZ)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEZ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEZ.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEZ = SrcRtHndSideData%PLinVelEZ
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEC)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEC,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEC,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEC,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEC,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEC,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEC,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEC)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEC.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEC = SrcRtHndSideData%PLinVelEC
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelED)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelED,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelED,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelED,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelED,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelED,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelED,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelED)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelED(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelED.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelED = SrcRtHndSideData%PLinVelED
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEI)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEI,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEI,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEI,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEI,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEI,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEI,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEI)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEI(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEI.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEI = SrcRtHndSideData%PLinVelEI
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEJ)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEJ,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEJ,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEJ,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEJ,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEJ,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEJ,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEJ)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEJ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEJ.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEJ = SrcRtHndSideData%PLinVelEJ
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEK)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEK,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEK,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEK,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEK,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEK,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEK,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEK)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEK(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEK.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEK = SrcRtHndSideData%PLinVelEK
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEP)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEP,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEP,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEP,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEP,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEP,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEP,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEP)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEP(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEP.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEP = SrcRtHndSideData%PLinVelEP
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEQ)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEQ,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEQ,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEQ,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEQ,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEQ,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEQ,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEQ)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEQ(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEQ.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEQ = SrcRtHndSideData%PLinVelEQ
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEU)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEU,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEU,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEU,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEU,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEU,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEU,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEU)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEU(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEU.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEU = SrcRtHndSideData%PLinVelEU
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEV)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEV,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEV,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEV,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEV,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEV,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEV,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEV)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEV(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEV.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEV = SrcRtHndSideData%PLinVelEV
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEW)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEW,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEW,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEW,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEW,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEW,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEW,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEW)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEW(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEW.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEW = SrcRtHndSideData%PLinVelEW
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PLinVelEY)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PLinVelEY,1)
   i1_u = UBOUND(SrcRtHndSideData%PLinVelEY,1)
   i2_l = LBOUND(SrcRtHndSideData%PLinVelEY,2)
   i2_u = UBOUND(SrcRtHndSideData%PLinVelEY,2)
   i3_l = LBOUND(SrcRtHndSideData%PLinVelEY,3)
   i3_u = UBOUND(SrcRtHndSideData%PLinVelEY,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PLinVelEY)) THEN 
      ALLOCATE(DstRtHndSideData%PLinVelEY(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PLinVelEY.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PLinVelEY = SrcRtHndSideData%PLinVelEY
ENDIF
   DstRtHndSideData%LinAccEIMUt = SrcRtHndSideData%LinAccEIMUt
   DstRtHndSideData%LinAccEOt = SrcRtHndSideData%LinAccEOt
IF (ALLOCATED(SrcRtHndSideData%LinAccESt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%LinAccESt,1)
   i1_u = UBOUND(SrcRtHndSideData%LinAccESt,1)
   i2_l = LBOUND(SrcRtHndSideData%LinAccESt,2)
   i2_u = UBOUND(SrcRtHndSideData%LinAccESt,2)
   i3_l = LBOUND(SrcRtHndSideData%LinAccESt,3)
   i3_u = UBOUND(SrcRtHndSideData%LinAccESt,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%LinAccESt)) THEN 
      ALLOCATE(DstRtHndSideData%LinAccESt(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%LinAccESt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%LinAccESt = SrcRtHndSideData%LinAccESt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%LinAccETt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%LinAccETt,1)
   i1_u = UBOUND(SrcRtHndSideData%LinAccETt,1)
   i2_l = LBOUND(SrcRtHndSideData%LinAccETt,2)
   i2_u = UBOUND(SrcRtHndSideData%LinAccETt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%LinAccETt)) THEN 
      ALLOCATE(DstRtHndSideData%LinAccETt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%LinAccETt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%LinAccETt = SrcRtHndSideData%LinAccETt
ENDIF
   DstRtHndSideData%LinAccEZt = SrcRtHndSideData%LinAccEZt
   DstRtHndSideData%LinVelEIMU = SrcRtHndSideData%LinVelEIMU
   DstRtHndSideData%LinVelEZ = SrcRtHndSideData%LinVelEZ
   DstRtHndSideData%LinVelEO = SrcRtHndSideData%LinVelEO
   DstRtHndSideData%FrcONcRtt = SrcRtHndSideData%FrcONcRtt
   DstRtHndSideData%FrcPRott = SrcRtHndSideData%FrcPRott
IF (ALLOCATED(SrcRtHndSideData%FrcS0Bt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%FrcS0Bt,1)
   i1_u = UBOUND(SrcRtHndSideData%FrcS0Bt,1)
   i2_l = LBOUND(SrcRtHndSideData%FrcS0Bt,2)
   i2_u = UBOUND(SrcRtHndSideData%FrcS0Bt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%FrcS0Bt)) THEN 
      ALLOCATE(DstRtHndSideData%FrcS0Bt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%FrcS0Bt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%FrcS0Bt = SrcRtHndSideData%FrcS0Bt
ENDIF
   DstRtHndSideData%FrcT0Trbt = SrcRtHndSideData%FrcT0Trbt
IF (ALLOCATED(SrcRtHndSideData%FSAero)) THEN
   i1_l = LBOUND(SrcRtHndSideData%FSAero,1)
   i1_u = UBOUND(SrcRtHndSideData%FSAero,1)
   i2_l = LBOUND(SrcRtHndSideData%FSAero,2)
   i2_u = UBOUND(SrcRtHndSideData%FSAero,2)
   i3_l = LBOUND(SrcRtHndSideData%FSAero,3)
   i3_u = UBOUND(SrcRtHndSideData%FSAero,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%FSAero)) THEN 
      ALLOCATE(DstRtHndSideData%FSAero(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%FSAero.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%FSAero = SrcRtHndSideData%FSAero
ENDIF
IF (ALLOCATED(SrcRtHndSideData%FSTipDrag)) THEN
   i1_l = LBOUND(SrcRtHndSideData%FSTipDrag,1)
   i1_u = UBOUND(SrcRtHndSideData%FSTipDrag,1)
   i2_l = LBOUND(SrcRtHndSideData%FSTipDrag,2)
   i2_u = UBOUND(SrcRtHndSideData%FSTipDrag,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%FSTipDrag)) THEN 
      ALLOCATE(DstRtHndSideData%FSTipDrag(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%FSTipDrag.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%FSTipDrag = SrcRtHndSideData%FSTipDrag
ENDIF
IF (ALLOCATED(SrcRtHndSideData%FTHydrot)) THEN
   i1_l = LBOUND(SrcRtHndSideData%FTHydrot,1)
   i1_u = UBOUND(SrcRtHndSideData%FTHydrot,1)
   i2_l = LBOUND(SrcRtHndSideData%FTHydrot,2)
   i2_u = UBOUND(SrcRtHndSideData%FTHydrot,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%FTHydrot)) THEN 
      ALLOCATE(DstRtHndSideData%FTHydrot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%FTHydrot.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%FTHydrot = SrcRtHndSideData%FTHydrot
ENDIF
   DstRtHndSideData%FZHydrot = SrcRtHndSideData%FZHydrot
IF (ALLOCATED(SrcRtHndSideData%MFHydrot)) THEN
   i1_l = LBOUND(SrcRtHndSideData%MFHydrot,1)
   i1_u = UBOUND(SrcRtHndSideData%MFHydrot,1)
   i2_l = LBOUND(SrcRtHndSideData%MFHydrot,2)
   i2_u = UBOUND(SrcRtHndSideData%MFHydrot,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%MFHydrot)) THEN 
      ALLOCATE(DstRtHndSideData%MFHydrot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%MFHydrot.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%MFHydrot = SrcRtHndSideData%MFHydrot
ENDIF
   DstRtHndSideData%MomBNcRtt = SrcRtHndSideData%MomBNcRtt
IF (ALLOCATED(SrcRtHndSideData%MomH0Bt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%MomH0Bt,1)
   i1_u = UBOUND(SrcRtHndSideData%MomH0Bt,1)
   i2_l = LBOUND(SrcRtHndSideData%MomH0Bt,2)
   i2_u = UBOUND(SrcRtHndSideData%MomH0Bt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%MomH0Bt)) THEN 
      ALLOCATE(DstRtHndSideData%MomH0Bt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%MomH0Bt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%MomH0Bt = SrcRtHndSideData%MomH0Bt
ENDIF
   DstRtHndSideData%MomLPRott = SrcRtHndSideData%MomLPRott
   DstRtHndSideData%MomNGnRtt = SrcRtHndSideData%MomNGnRtt
   DstRtHndSideData%MomNTailt = SrcRtHndSideData%MomNTailt
   DstRtHndSideData%MomX0Trbt = SrcRtHndSideData%MomX0Trbt
IF (ALLOCATED(SrcRtHndSideData%MMAero)) THEN
   i1_l = LBOUND(SrcRtHndSideData%MMAero,1)
   i1_u = UBOUND(SrcRtHndSideData%MMAero,1)
   i2_l = LBOUND(SrcRtHndSideData%MMAero,2)
   i2_u = UBOUND(SrcRtHndSideData%MMAero,2)
   i3_l = LBOUND(SrcRtHndSideData%MMAero,3)
   i3_u = UBOUND(SrcRtHndSideData%MMAero,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%MMAero)) THEN 
      ALLOCATE(DstRtHndSideData%MMAero(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%MMAero.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%MMAero = SrcRtHndSideData%MMAero
ENDIF
   DstRtHndSideData%MXHydrot = SrcRtHndSideData%MXHydrot
IF (ALLOCATED(SrcRtHndSideData%PFrcONcRt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcONcRt,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcONcRt,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcONcRt,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcONcRt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcONcRt)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcONcRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcONcRt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcONcRt = SrcRtHndSideData%PFrcONcRt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFrcPRot)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcPRot,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcPRot,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcPRot,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcPRot,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcPRot)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcPRot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcPRot.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcPRot = SrcRtHndSideData%PFrcPRot
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFrcS0B)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcS0B,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcS0B,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcS0B,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcS0B,2)
   i3_l = LBOUND(SrcRtHndSideData%PFrcS0B,3)
   i3_u = UBOUND(SrcRtHndSideData%PFrcS0B,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcS0B)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcS0B(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcS0B.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcS0B = SrcRtHndSideData%PFrcS0B
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFrcT0Trb)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcT0Trb,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcT0Trb,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcT0Trb,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcT0Trb,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcT0Trb)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcT0Trb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcT0Trb.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcT0Trb = SrcRtHndSideData%PFrcT0Trb
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFTHydro)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFTHydro,1)
   i1_u = UBOUND(SrcRtHndSideData%PFTHydro,1)
   i2_l = LBOUND(SrcRtHndSideData%PFTHydro,2)
   i2_u = UBOUND(SrcRtHndSideData%PFTHydro,2)
   i3_l = LBOUND(SrcRtHndSideData%PFTHydro,3)
   i3_u = UBOUND(SrcRtHndSideData%PFTHydro,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFTHydro)) THEN 
      ALLOCATE(DstRtHndSideData%PFTHydro(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFTHydro.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFTHydro = SrcRtHndSideData%PFTHydro
ENDIF
   DstRtHndSideData%PFZHydro = SrcRtHndSideData%PFZHydro
IF (ALLOCATED(SrcRtHndSideData%PMFHydro)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMFHydro,1)
   i1_u = UBOUND(SrcRtHndSideData%PMFHydro,1)
   i2_l = LBOUND(SrcRtHndSideData%PMFHydro,2)
   i2_u = UBOUND(SrcRtHndSideData%PMFHydro,2)
   i3_l = LBOUND(SrcRtHndSideData%PMFHydro,3)
   i3_u = UBOUND(SrcRtHndSideData%PMFHydro,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMFHydro)) THEN 
      ALLOCATE(DstRtHndSideData%PMFHydro(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMFHydro.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMFHydro = SrcRtHndSideData%PMFHydro
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomBNcRt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomBNcRt,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomBNcRt,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomBNcRt,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomBNcRt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomBNcRt)) THEN 
      ALLOCATE(DstRtHndSideData%PMomBNcRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomBNcRt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomBNcRt = SrcRtHndSideData%PMomBNcRt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomH0B)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomH0B,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomH0B,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomH0B,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomH0B,2)
   i3_l = LBOUND(SrcRtHndSideData%PMomH0B,3)
   i3_u = UBOUND(SrcRtHndSideData%PMomH0B,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomH0B)) THEN 
      ALLOCATE(DstRtHndSideData%PMomH0B(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomH0B.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomH0B = SrcRtHndSideData%PMomH0B
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomLPRot)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomLPRot,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomLPRot,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomLPRot,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomLPRot,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomLPRot)) THEN 
      ALLOCATE(DstRtHndSideData%PMomLPRot(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomLPRot.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomLPRot = SrcRtHndSideData%PMomLPRot
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomNGnRt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomNGnRt,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomNGnRt,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomNGnRt,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomNGnRt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomNGnRt)) THEN 
      ALLOCATE(DstRtHndSideData%PMomNGnRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomNGnRt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomNGnRt = SrcRtHndSideData%PMomNGnRt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomNTail)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomNTail,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomNTail,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomNTail,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomNTail,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomNTail)) THEN 
      ALLOCATE(DstRtHndSideData%PMomNTail(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomNTail.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomNTail = SrcRtHndSideData%PMomNTail
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomX0Trb)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomX0Trb,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomX0Trb,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomX0Trb,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomX0Trb,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomX0Trb)) THEN 
      ALLOCATE(DstRtHndSideData%PMomX0Trb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomX0Trb.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomX0Trb = SrcRtHndSideData%PMomX0Trb
ENDIF
   DstRtHndSideData%PMXHydro = SrcRtHndSideData%PMXHydro
   DstRtHndSideData%TeetAng = SrcRtHndSideData%TeetAng
   DstRtHndSideData%FrcVGnRtt = SrcRtHndSideData%FrcVGnRtt
   DstRtHndSideData%FrcWTailt = SrcRtHndSideData%FrcWTailt
   DstRtHndSideData%FrcZAllt = SrcRtHndSideData%FrcZAllt
   DstRtHndSideData%MomXAllt = SrcRtHndSideData%MomXAllt
IF (ALLOCATED(SrcRtHndSideData%PFrcVGnRt)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcVGnRt,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcVGnRt,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcVGnRt,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcVGnRt,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcVGnRt)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcVGnRt(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcVGnRt.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcVGnRt = SrcRtHndSideData%PFrcVGnRt
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFrcWTail)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcWTail,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcWTail,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcWTail,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcWTail,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcWTail)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcWTail(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcWTail.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcWTail = SrcRtHndSideData%PFrcWTail
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PFrcZAll)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PFrcZAll,1)
   i1_u = UBOUND(SrcRtHndSideData%PFrcZAll,1)
   i2_l = LBOUND(SrcRtHndSideData%PFrcZAll,2)
   i2_u = UBOUND(SrcRtHndSideData%PFrcZAll,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PFrcZAll)) THEN 
      ALLOCATE(DstRtHndSideData%PFrcZAll(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PFrcZAll.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PFrcZAll = SrcRtHndSideData%PFrcZAll
ENDIF
IF (ALLOCATED(SrcRtHndSideData%PMomXAll)) THEN
   i1_l = LBOUND(SrcRtHndSideData%PMomXAll,1)
   i1_u = UBOUND(SrcRtHndSideData%PMomXAll,1)
   i2_l = LBOUND(SrcRtHndSideData%PMomXAll,2)
   i2_u = UBOUND(SrcRtHndSideData%PMomXAll,2)
   IF (.NOT. ALLOCATED(DstRtHndSideData%PMomXAll)) THEN 
      ALLOCATE(DstRtHndSideData%PMomXAll(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%PMomXAll.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%PMomXAll = SrcRtHndSideData%PMomXAll
ENDIF
   DstRtHndSideData%TeetMom = SrcRtHndSideData%TeetMom
   DstRtHndSideData%TFrlMom = SrcRtHndSideData%TFrlMom
   DstRtHndSideData%RFrlMom = SrcRtHndSideData%RFrlMom
   DstRtHndSideData%GBoxEffFac = SrcRtHndSideData%GBoxEffFac
IF (ALLOCATED(SrcRtHndSideData%rSAerCen)) THEN
   i1_l = LBOUND(SrcRtHndSideData%rSAerCen,1)
   i1_u = UBOUND(SrcRtHndSideData%rSAerCen,1)
   i2_l = LBOUND(SrcRtHndSideData%rSAerCen,2)
   i2_u = UBOUND(SrcRtHndSideData%rSAerCen,2)
   i3_l = LBOUND(SrcRtHndSideData%rSAerCen,3)
   i3_u = UBOUND(SrcRtHndSideData%rSAerCen,3)
   IF (.NOT. ALLOCATED(DstRtHndSideData%rSAerCen)) THEN 
      ALLOCATE(DstRtHndSideData%rSAerCen(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstRtHndSideData%rSAerCen.', ErrStat, ErrMsg,'ED_CopyRtHndSide')
         RETURN
      END IF
   END IF
   DstRtHndSideData%rSAerCen = SrcRtHndSideData%rSAerCen
ENDIF
 END SUBROUTINE ED_CopyRtHndSide

 SUBROUTINE ED_DestroyRtHndSide( RtHndSideData, ErrStat, ErrMsg )
  TYPE(ED_RtHndSide), INTENT(INOUT) :: RtHndSideData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(RtHndSideData%rQS)) THEN
   DEALLOCATE(RtHndSideData%rQS)
ENDIF
IF (ALLOCATED(RtHndSideData%rS)) THEN
   DEALLOCATE(RtHndSideData%rS)
ENDIF
IF (ALLOCATED(RtHndSideData%rS0S)) THEN
   DEALLOCATE(RtHndSideData%rS0S)
ENDIF
IF (ALLOCATED(RtHndSideData%rT)) THEN
   DEALLOCATE(RtHndSideData%rT)
ENDIF
IF (ALLOCATED(RtHndSideData%rT0T)) THEN
   DEALLOCATE(RtHndSideData%rT0T)
ENDIF
IF (ALLOCATED(RtHndSideData%rZT)) THEN
   DEALLOCATE(RtHndSideData%rZT)
ENDIF
IF (ALLOCATED(RtHndSideData%rPS0)) THEN
   DEALLOCATE(RtHndSideData%rPS0)
ENDIF
IF (ALLOCATED(RtHndSideData%AngPosEF)) THEN
   DEALLOCATE(RtHndSideData%AngPosEF)
ENDIF
IF (ALLOCATED(RtHndSideData%AngPosXF)) THEN
   DEALLOCATE(RtHndSideData%AngPosXF)
ENDIF
IF (ALLOCATED(RtHndSideData%AngPosHM)) THEN
   DEALLOCATE(RtHndSideData%AngPosHM)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEA)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEA)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEF)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEF)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEG)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEG)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEH)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEH)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEL)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEL)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEM)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEM)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEN)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEN)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEB)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEB)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelER)) THEN
   DEALLOCATE(RtHndSideData%PAngVelER)
ENDIF
IF (ALLOCATED(RtHndSideData%PAngVelEX)) THEN
   DEALLOCATE(RtHndSideData%PAngVelEX)
ENDIF
IF (ALLOCATED(RtHndSideData%AngAccEFt)) THEN
   DEALLOCATE(RtHndSideData%AngAccEFt)
ENDIF
IF (ALLOCATED(RtHndSideData%AngVelEF)) THEN
   DEALLOCATE(RtHndSideData%AngVelEF)
ENDIF
IF (ALLOCATED(RtHndSideData%LinVelES)) THEN
   DEALLOCATE(RtHndSideData%LinVelES)
ENDIF
IF (ALLOCATED(RtHndSideData%LinVelET)) THEN
   DEALLOCATE(RtHndSideData%LinVelET)
ENDIF
IF (ALLOCATED(RtHndSideData%LinVelESm2)) THEN
   DEALLOCATE(RtHndSideData%LinVelESm2)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEIMU)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEIMU)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEO)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEO)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelES)) THEN
   DEALLOCATE(RtHndSideData%PLinVelES)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelET)) THEN
   DEALLOCATE(RtHndSideData%PLinVelET)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEZ)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEZ)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEC)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEC)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelED)) THEN
   DEALLOCATE(RtHndSideData%PLinVelED)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEI)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEI)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEJ)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEJ)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEK)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEK)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEP)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEP)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEQ)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEQ)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEU)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEU)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEV)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEV)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEW)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEW)
ENDIF
IF (ALLOCATED(RtHndSideData%PLinVelEY)) THEN
   DEALLOCATE(RtHndSideData%PLinVelEY)
ENDIF
IF (ALLOCATED(RtHndSideData%LinAccESt)) THEN
   DEALLOCATE(RtHndSideData%LinAccESt)
ENDIF
IF (ALLOCATED(RtHndSideData%LinAccETt)) THEN
   DEALLOCATE(RtHndSideData%LinAccETt)
ENDIF
IF (ALLOCATED(RtHndSideData%FrcS0Bt)) THEN
   DEALLOCATE(RtHndSideData%FrcS0Bt)
ENDIF
IF (ALLOCATED(RtHndSideData%FSAero)) THEN
   DEALLOCATE(RtHndSideData%FSAero)
ENDIF
IF (ALLOCATED(RtHndSideData%FSTipDrag)) THEN
   DEALLOCATE(RtHndSideData%FSTipDrag)
ENDIF
IF (ALLOCATED(RtHndSideData%FTHydrot)) THEN
   DEALLOCATE(RtHndSideData%FTHydrot)
ENDIF
IF (ALLOCATED(RtHndSideData%MFHydrot)) THEN
   DEALLOCATE(RtHndSideData%MFHydrot)
ENDIF
IF (ALLOCATED(RtHndSideData%MomH0Bt)) THEN
   DEALLOCATE(RtHndSideData%MomH0Bt)
ENDIF
IF (ALLOCATED(RtHndSideData%MMAero)) THEN
   DEALLOCATE(RtHndSideData%MMAero)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcONcRt)) THEN
   DEALLOCATE(RtHndSideData%PFrcONcRt)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcPRot)) THEN
   DEALLOCATE(RtHndSideData%PFrcPRot)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcS0B)) THEN
   DEALLOCATE(RtHndSideData%PFrcS0B)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcT0Trb)) THEN
   DEALLOCATE(RtHndSideData%PFrcT0Trb)
ENDIF
IF (ALLOCATED(RtHndSideData%PFTHydro)) THEN
   DEALLOCATE(RtHndSideData%PFTHydro)
ENDIF
IF (ALLOCATED(RtHndSideData%PMFHydro)) THEN
   DEALLOCATE(RtHndSideData%PMFHydro)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomBNcRt)) THEN
   DEALLOCATE(RtHndSideData%PMomBNcRt)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomH0B)) THEN
   DEALLOCATE(RtHndSideData%PMomH0B)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomLPRot)) THEN
   DEALLOCATE(RtHndSideData%PMomLPRot)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomNGnRt)) THEN
   DEALLOCATE(RtHndSideData%PMomNGnRt)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomNTail)) THEN
   DEALLOCATE(RtHndSideData%PMomNTail)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomX0Trb)) THEN
   DEALLOCATE(RtHndSideData%PMomX0Trb)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcVGnRt)) THEN
   DEALLOCATE(RtHndSideData%PFrcVGnRt)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcWTail)) THEN
   DEALLOCATE(RtHndSideData%PFrcWTail)
ENDIF
IF (ALLOCATED(RtHndSideData%PFrcZAll)) THEN
   DEALLOCATE(RtHndSideData%PFrcZAll)
ENDIF
IF (ALLOCATED(RtHndSideData%PMomXAll)) THEN
   DEALLOCATE(RtHndSideData%PMomXAll)
ENDIF
IF (ALLOCATED(RtHndSideData%rSAerCen)) THEN
   DEALLOCATE(RtHndSideData%rSAerCen)
ENDIF
 END SUBROUTINE ED_DestroyRtHndSide

 SUBROUTINE ED_PackRtHndSide( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_RtHndSide),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%rO )  ! rO 
  IF ( ALLOCATED(InData%rQS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rQS )  ! rQS 
  IF ( ALLOCATED(InData%rS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rS )  ! rS 
  IF ( ALLOCATED(InData%rS0S) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rS0S )  ! rS0S 
  IF ( ALLOCATED(InData%rT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rT )  ! rT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rT0O )  ! rT0O 
  IF ( ALLOCATED(InData%rT0T) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rT0T )  ! rT0T 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZ )  ! rZ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZO )  ! rZO 
  IF ( ALLOCATED(InData%rZT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rZT )  ! rZT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rPQ )  ! rPQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rP )  ! rP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rV )  ! rV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZY )  ! rZY 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOU )  ! rOU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOV )  ! rOV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVD )  ! rVD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rOW )  ! rOW 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rPC )  ! rPC 
  IF ( ALLOCATED(InData%rPS0) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rPS0 )  ! rPS0 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rQ )  ! rQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rQC )  ! rQC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVIMU )  ! rVIMU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rVP )  ! rVP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWI )  ! rWI 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWJ )  ! rWJ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rWK )  ! rWK 
  Re_BufSz    = Re_BufSz    + SIZE( InData%rZT0 )  ! rZT0 
  IF ( ALLOCATED(InData%AngPosEF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosEF )  ! AngPosEF 
  IF ( ALLOCATED(InData%AngPosXF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosXF )  ! AngPosXF 
  IF ( ALLOCATED(InData%AngPosHM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosHM )  ! AngPosHM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosXB )  ! AngPosXB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngPosEX )  ! AngPosEX 
  IF ( ALLOCATED(InData%PAngVelEA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEA )  ! PAngVelEA 
  IF ( ALLOCATED(InData%PAngVelEF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEF )  ! PAngVelEF 
  IF ( ALLOCATED(InData%PAngVelEG) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEG )  ! PAngVelEG 
  IF ( ALLOCATED(InData%PAngVelEH) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEH )  ! PAngVelEH 
  IF ( ALLOCATED(InData%PAngVelEL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEL )  ! PAngVelEL 
  IF ( ALLOCATED(InData%PAngVelEM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEM )  ! PAngVelEM 
  IF ( ALLOCATED(InData%PAngVelEN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEN )  ! PAngVelEN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEA )  ! AngVelEA 
  IF ( ALLOCATED(InData%PAngVelEB) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEB )  ! PAngVelEB 
  IF ( ALLOCATED(InData%PAngVelER) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelER )  ! PAngVelER 
  IF ( ALLOCATED(InData%PAngVelEX) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PAngVelEX )  ! PAngVelEX 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEG )  ! AngVelEG 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEH )  ! AngVelEH 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEL )  ! AngVelEL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEN )  ! AngVelEN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEB )  ! AngVelEB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelER )  ! AngVelER 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEX )  ! AngVelEX 
  Re_BufSz   = Re_BufSz   + 1  ! TeetAngVel
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEBt )  ! AngAccEBt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccERt )  ! AngAccERt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEXt )  ! AngAccEXt 
  IF ( ALLOCATED(InData%AngAccEFt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEFt )  ! AngAccEFt 
  IF ( ALLOCATED(InData%AngVelEF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AngVelEF )  ! AngVelEF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEAt )  ! AngAccEAt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEGt )  ! AngAccEGt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccEHt )  ! AngAccEHt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AngAccENt )  ! AngAccENt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccECt )  ! LinAccECt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEDt )  ! LinAccEDt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEIt )  ! LinAccEIt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEJt )  ! LinAccEJt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEUt )  ! LinAccEUt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEYt )  ! LinAccEYt 
  IF ( ALLOCATED(InData%LinVelES) )   Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelES )  ! LinVelES 
  IF ( ALLOCATED(InData%LinVelET) )   Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelET )  ! LinVelET 
  IF ( ALLOCATED(InData%LinVelESm2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelESm2 )  ! LinVelESm2 
  IF ( ALLOCATED(InData%PLinVelEIMU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEIMU )  ! PLinVelEIMU 
  IF ( ALLOCATED(InData%PLinVelEO) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEO )  ! PLinVelEO 
  IF ( ALLOCATED(InData%PLinVelES) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelES )  ! PLinVelES 
  IF ( ALLOCATED(InData%PLinVelET) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelET )  ! PLinVelET 
  IF ( ALLOCATED(InData%PLinVelEZ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEZ )  ! PLinVelEZ 
  IF ( ALLOCATED(InData%PLinVelEC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEC )  ! PLinVelEC 
  IF ( ALLOCATED(InData%PLinVelED) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelED )  ! PLinVelED 
  IF ( ALLOCATED(InData%PLinVelEI) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEI )  ! PLinVelEI 
  IF ( ALLOCATED(InData%PLinVelEJ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEJ )  ! PLinVelEJ 
  IF ( ALLOCATED(InData%PLinVelEK) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEK )  ! PLinVelEK 
  IF ( ALLOCATED(InData%PLinVelEP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEP )  ! PLinVelEP 
  IF ( ALLOCATED(InData%PLinVelEQ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEQ )  ! PLinVelEQ 
  IF ( ALLOCATED(InData%PLinVelEU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEU )  ! PLinVelEU 
  IF ( ALLOCATED(InData%PLinVelEV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEV )  ! PLinVelEV 
  IF ( ALLOCATED(InData%PLinVelEW) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEW )  ! PLinVelEW 
  IF ( ALLOCATED(InData%PLinVelEY) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PLinVelEY )  ! PLinVelEY 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEIMUt )  ! LinAccEIMUt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEOt )  ! LinAccEOt 
  IF ( ALLOCATED(InData%LinAccESt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccESt )  ! LinAccESt 
  IF ( ALLOCATED(InData%LinAccETt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccETt )  ! LinAccETt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinAccEZt )  ! LinAccEZt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelEIMU )  ! LinVelEIMU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelEZ )  ! LinVelEZ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%LinVelEO )  ! LinVelEO 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcONcRtt )  ! FrcONcRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcPRott )  ! FrcPRott 
  IF ( ALLOCATED(InData%FrcS0Bt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FrcS0Bt )  ! FrcS0Bt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcT0Trbt )  ! FrcT0Trbt 
  IF ( ALLOCATED(InData%FSAero) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSAero )  ! FSAero 
  IF ( ALLOCATED(InData%FSTipDrag) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSTipDrag )  ! FSTipDrag 
  IF ( ALLOCATED(InData%FTHydrot) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FTHydrot )  ! FTHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FZHydrot )  ! FZHydrot 
  IF ( ALLOCATED(InData%MFHydrot) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MFHydrot )  ! MFHydrot 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomBNcRtt )  ! MomBNcRtt 
  IF ( ALLOCATED(InData%MomH0Bt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MomH0Bt )  ! MomH0Bt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomLPRott )  ! MomLPRott 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomNGnRtt )  ! MomNGnRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomNTailt )  ! MomNTailt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomX0Trbt )  ! MomX0Trbt 
  IF ( ALLOCATED(InData%MMAero) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MMAero )  ! MMAero 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MXHydrot )  ! MXHydrot 
  IF ( ALLOCATED(InData%PFrcONcRt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcONcRt )  ! PFrcONcRt 
  IF ( ALLOCATED(InData%PFrcPRot) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcPRot )  ! PFrcPRot 
  IF ( ALLOCATED(InData%PFrcS0B) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcS0B )  ! PFrcS0B 
  IF ( ALLOCATED(InData%PFrcT0Trb) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcT0Trb )  ! PFrcT0Trb 
  IF ( ALLOCATED(InData%PFTHydro) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFTHydro )  ! PFTHydro 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PFZHydro )  ! PFZHydro 
  IF ( ALLOCATED(InData%PMFHydro) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMFHydro )  ! PMFHydro 
  IF ( ALLOCATED(InData%PMomBNcRt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomBNcRt )  ! PMomBNcRt 
  IF ( ALLOCATED(InData%PMomH0B) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomH0B )  ! PMomH0B 
  IF ( ALLOCATED(InData%PMomLPRot) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomLPRot )  ! PMomLPRot 
  IF ( ALLOCATED(InData%PMomNGnRt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomNGnRt )  ! PMomNGnRt 
  IF ( ALLOCATED(InData%PMomNTail) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomNTail )  ! PMomNTail 
  IF ( ALLOCATED(InData%PMomX0Trb) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomX0Trb )  ! PMomX0Trb 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMXHydro )  ! PMXHydro 
  Re_BufSz   = Re_BufSz   + 1  ! TeetAng
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcVGnRtt )  ! FrcVGnRtt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcWTailt )  ! FrcWTailt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FrcZAllt )  ! FrcZAllt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MomXAllt )  ! MomXAllt 
  IF ( ALLOCATED(InData%PFrcVGnRt) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcVGnRt )  ! PFrcVGnRt 
  IF ( ALLOCATED(InData%PFrcWTail) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcWTail )  ! PFrcWTail 
  IF ( ALLOCATED(InData%PFrcZAll) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PFrcZAll )  ! PFrcZAll 
  IF ( ALLOCATED(InData%PMomXAll) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMomXAll )  ! PMomXAll 
  Re_BufSz   = Re_BufSz   + 1  ! TeetMom
  Re_BufSz   = Re_BufSz   + 1  ! TFrlMom
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMom
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEffFac
  IF ( ALLOCATED(InData%rSAerCen) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rSAerCen )  ! rSAerCen 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rO))-1 ) =  PACK(InData%rO ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rO)
  IF ( ALLOCATED(InData%rQS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rQS))-1 ) =  PACK(InData%rQS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rQS)
  ENDIF
  IF ( ALLOCATED(InData%rS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rS))-1 ) =  PACK(InData%rS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rS)
  ENDIF
  IF ( ALLOCATED(InData%rS0S) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rS0S))-1 ) =  PACK(InData%rS0S ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rS0S)
  ENDIF
  IF ( ALLOCATED(InData%rT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT))-1 ) =  PACK(InData%rT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rT)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT0O))-1 ) =  PACK(InData%rT0O ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rT0O)
  IF ( ALLOCATED(InData%rT0T) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rT0T))-1 ) =  PACK(InData%rT0T ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rT0T)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZ))-1 ) =  PACK(InData%rZ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZO))-1 ) =  PACK(InData%rZO ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZO)
  IF ( ALLOCATED(InData%rZT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZT))-1 ) =  PACK(InData%rZT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rZT)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPQ))-1 ) =  PACK(InData%rPQ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rPQ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rP))-1 ) =  PACK(InData%rP ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rP)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rV))-1 ) =  PACK(InData%rV ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rV)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZY))-1 ) =  PACK(InData%rZY ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZY)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOU))-1 ) =  PACK(InData%rOU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOV))-1 ) =  PACK(InData%rOV ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOV)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVD))-1 ) =  PACK(InData%rVD ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVD)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rOW))-1 ) =  PACK(InData%rOW ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rOW)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPC))-1 ) =  PACK(InData%rPC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rPC)
  IF ( ALLOCATED(InData%rPS0) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rPS0))-1 ) =  PACK(InData%rPS0 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rPS0)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rQ))-1 ) =  PACK(InData%rQ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rQ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rQC))-1 ) =  PACK(InData%rQC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rQC)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVIMU))-1 ) =  PACK(InData%rVIMU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVIMU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rVP))-1 ) =  PACK(InData%rVP ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rVP)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWI))-1 ) =  PACK(InData%rWI ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWI)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWJ))-1 ) =  PACK(InData%rWJ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWJ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rWK))-1 ) =  PACK(InData%rWK ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rWK)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rZT0))-1 ) =  PACK(InData%rZT0 ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%rZT0)
  IF ( ALLOCATED(InData%AngPosEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosEF))-1 ) =  PACK(InData%AngPosEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosEF)
  ENDIF
  IF ( ALLOCATED(InData%AngPosXF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosXF))-1 ) =  PACK(InData%AngPosXF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosXF)
  ENDIF
  IF ( ALLOCATED(InData%AngPosHM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosHM))-1 ) =  PACK(InData%AngPosHM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosHM)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosXB))-1 ) =  PACK(InData%AngPosXB ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosXB)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngPosEX))-1 ) =  PACK(InData%AngPosEX ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngPosEX)
  IF ( ALLOCATED(InData%PAngVelEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEA))-1 ) =  PACK(InData%PAngVelEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEA)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEF))-1 ) =  PACK(InData%PAngVelEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEF)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEG) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEG))-1 ) =  PACK(InData%PAngVelEG ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEG)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEH) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEH))-1 ) =  PACK(InData%PAngVelEH ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEH)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEL))-1 ) =  PACK(InData%PAngVelEL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEL)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEM))-1 ) =  PACK(InData%PAngVelEM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEM)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEN))-1 ) =  PACK(InData%PAngVelEN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEN)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEA))-1 ) =  PACK(InData%AngVelEA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEA)
  IF ( ALLOCATED(InData%PAngVelEB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEB))-1 ) =  PACK(InData%PAngVelEB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEB)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelER) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelER))-1 ) =  PACK(InData%PAngVelER ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelER)
  ENDIF
  IF ( ALLOCATED(InData%PAngVelEX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PAngVelEX))-1 ) =  PACK(InData%PAngVelEX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PAngVelEX)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEG))-1 ) =  PACK(InData%AngVelEG ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEG)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEH))-1 ) =  PACK(InData%AngVelEH ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEH)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEL))-1 ) =  PACK(InData%AngVelEL ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEL)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEN))-1 ) =  PACK(InData%AngVelEN ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEN)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEB))-1 ) =  PACK(InData%AngVelEB ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEB)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelER))-1 ) =  PACK(InData%AngVelER ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelER)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEX))-1 ) =  PACK(InData%AngVelEX ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEX)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetAngVel )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEBt))-1 ) =  PACK(InData%AngAccEBt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEBt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccERt))-1 ) =  PACK(InData%AngAccERt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccERt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEXt))-1 ) =  PACK(InData%AngAccEXt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEXt)
  IF ( ALLOCATED(InData%AngAccEFt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEFt))-1 ) =  PACK(InData%AngAccEFt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEFt)
  ENDIF
  IF ( ALLOCATED(InData%AngVelEF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngVelEF))-1 ) =  PACK(InData%AngVelEF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AngVelEF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEAt))-1 ) =  PACK(InData%AngAccEAt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEAt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEGt))-1 ) =  PACK(InData%AngAccEGt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEGt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccEHt))-1 ) =  PACK(InData%AngAccEHt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccEHt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AngAccENt))-1 ) =  PACK(InData%AngAccENt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%AngAccENt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccECt))-1 ) =  PACK(InData%LinAccECt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccECt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEDt))-1 ) =  PACK(InData%LinAccEDt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEDt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEIt))-1 ) =  PACK(InData%LinAccEIt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEIt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEJt))-1 ) =  PACK(InData%LinAccEJt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEJt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEUt))-1 ) =  PACK(InData%LinAccEUt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEUt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEYt))-1 ) =  PACK(InData%LinAccEYt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEYt)
  IF ( ALLOCATED(InData%LinVelES) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelES))-1 ) =  PACK(InData%LinVelES ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelES)
  ENDIF
  IF ( ALLOCATED(InData%LinVelET) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelET))-1 ) =  PACK(InData%LinVelET ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelET)
  ENDIF
  IF ( ALLOCATED(InData%LinVelESm2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelESm2))-1 ) =  PACK(InData%LinVelESm2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelESm2)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEIMU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEIMU))-1 ) =  PACK(InData%PLinVelEIMU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEIMU)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEO) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEO))-1 ) =  PACK(InData%PLinVelEO ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEO)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelES) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelES))-1 ) =  PACK(InData%PLinVelES ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelES)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelET) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelET))-1 ) =  PACK(InData%PLinVelET ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelET)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEZ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEZ))-1 ) =  PACK(InData%PLinVelEZ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEZ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEC))-1 ) =  PACK(InData%PLinVelEC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEC)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelED) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelED))-1 ) =  PACK(InData%PLinVelED ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelED)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEI) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEI))-1 ) =  PACK(InData%PLinVelEI ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEI)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEJ))-1 ) =  PACK(InData%PLinVelEJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEJ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEK) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEK))-1 ) =  PACK(InData%PLinVelEK ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEK)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEP))-1 ) =  PACK(InData%PLinVelEP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEP)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEQ))-1 ) =  PACK(InData%PLinVelEQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEQ)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEU))-1 ) =  PACK(InData%PLinVelEU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEU)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEV))-1 ) =  PACK(InData%PLinVelEV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEV)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEW) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEW))-1 ) =  PACK(InData%PLinVelEW ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEW)
  ENDIF
  IF ( ALLOCATED(InData%PLinVelEY) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PLinVelEY))-1 ) =  PACK(InData%PLinVelEY ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PLinVelEY)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEIMUt))-1 ) =  PACK(InData%LinAccEIMUt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEIMUt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEOt))-1 ) =  PACK(InData%LinAccEOt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEOt)
  IF ( ALLOCATED(InData%LinAccESt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccESt))-1 ) =  PACK(InData%LinAccESt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccESt)
  ENDIF
  IF ( ALLOCATED(InData%LinAccETt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccETt))-1 ) =  PACK(InData%LinAccETt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccETt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinAccEZt))-1 ) =  PACK(InData%LinAccEZt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinAccEZt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelEIMU))-1 ) =  PACK(InData%LinVelEIMU ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelEIMU)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelEZ))-1 ) =  PACK(InData%LinVelEZ ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelEZ)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%LinVelEO))-1 ) =  PACK(InData%LinVelEO ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%LinVelEO)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcONcRtt))-1 ) =  PACK(InData%FrcONcRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcONcRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcPRott))-1 ) =  PACK(InData%FrcPRott ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcPRott)
  IF ( ALLOCATED(InData%FrcS0Bt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcS0Bt))-1 ) =  PACK(InData%FrcS0Bt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FrcS0Bt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcT0Trbt))-1 ) =  PACK(InData%FrcT0Trbt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcT0Trbt)
  IF ( ALLOCATED(InData%FSAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSAero))-1 ) =  PACK(InData%FSAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSAero)
  ENDIF
  IF ( ALLOCATED(InData%FSTipDrag) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSTipDrag))-1 ) =  PACK(InData%FSTipDrag ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSTipDrag)
  ENDIF
  IF ( ALLOCATED(InData%FTHydrot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTHydrot))-1 ) =  PACK(InData%FTHydrot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTHydrot)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FZHydrot))-1 ) =  PACK(InData%FZHydrot ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FZHydrot)
  IF ( ALLOCATED(InData%MFHydrot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MFHydrot))-1 ) =  PACK(InData%MFHydrot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MFHydrot)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomBNcRtt))-1 ) =  PACK(InData%MomBNcRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomBNcRtt)
  IF ( ALLOCATED(InData%MomH0Bt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomH0Bt))-1 ) =  PACK(InData%MomH0Bt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MomH0Bt)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomLPRott))-1 ) =  PACK(InData%MomLPRott ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomLPRott)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomNGnRtt))-1 ) =  PACK(InData%MomNGnRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomNGnRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomNTailt))-1 ) =  PACK(InData%MomNTailt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomNTailt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomX0Trbt))-1 ) =  PACK(InData%MomX0Trbt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomX0Trbt)
  IF ( ALLOCATED(InData%MMAero) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MMAero))-1 ) =  PACK(InData%MMAero ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MMAero)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MXHydrot))-1 ) =  PACK(InData%MXHydrot ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MXHydrot)
  IF ( ALLOCATED(InData%PFrcONcRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcONcRt))-1 ) =  PACK(InData%PFrcONcRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcONcRt)
  ENDIF
  IF ( ALLOCATED(InData%PFrcPRot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcPRot))-1 ) =  PACK(InData%PFrcPRot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcPRot)
  ENDIF
  IF ( ALLOCATED(InData%PFrcS0B) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcS0B))-1 ) =  PACK(InData%PFrcS0B ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcS0B)
  ENDIF
  IF ( ALLOCATED(InData%PFrcT0Trb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcT0Trb))-1 ) =  PACK(InData%PFrcT0Trb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcT0Trb)
  ENDIF
  IF ( ALLOCATED(InData%PFTHydro) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFTHydro))-1 ) =  PACK(InData%PFTHydro ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFTHydro)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFZHydro))-1 ) =  PACK(InData%PFZHydro ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PFZHydro)
  IF ( ALLOCATED(InData%PMFHydro) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMFHydro))-1 ) =  PACK(InData%PMFHydro ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMFHydro)
  ENDIF
  IF ( ALLOCATED(InData%PMomBNcRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomBNcRt))-1 ) =  PACK(InData%PMomBNcRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomBNcRt)
  ENDIF
  IF ( ALLOCATED(InData%PMomH0B) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomH0B))-1 ) =  PACK(InData%PMomH0B ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomH0B)
  ENDIF
  IF ( ALLOCATED(InData%PMomLPRot) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomLPRot))-1 ) =  PACK(InData%PMomLPRot ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomLPRot)
  ENDIF
  IF ( ALLOCATED(InData%PMomNGnRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomNGnRt))-1 ) =  PACK(InData%PMomNGnRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomNGnRt)
  ENDIF
  IF ( ALLOCATED(InData%PMomNTail) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomNTail))-1 ) =  PACK(InData%PMomNTail ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomNTail)
  ENDIF
  IF ( ALLOCATED(InData%PMomX0Trb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomX0Trb))-1 ) =  PACK(InData%PMomX0Trb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomX0Trb)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMXHydro))-1 ) =  PACK(InData%PMXHydro ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PMXHydro)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetAng )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcVGnRtt))-1 ) =  PACK(InData%FrcVGnRtt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcVGnRtt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcWTailt))-1 ) =  PACK(InData%FrcWTailt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcWTailt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FrcZAllt))-1 ) =  PACK(InData%FrcZAllt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FrcZAllt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MomXAllt))-1 ) =  PACK(InData%MomXAllt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%MomXAllt)
  IF ( ALLOCATED(InData%PFrcVGnRt) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcVGnRt))-1 ) =  PACK(InData%PFrcVGnRt ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcVGnRt)
  ENDIF
  IF ( ALLOCATED(InData%PFrcWTail) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcWTail))-1 ) =  PACK(InData%PFrcWTail ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcWTail)
  ENDIF
  IF ( ALLOCATED(InData%PFrcZAll) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PFrcZAll))-1 ) =  PACK(InData%PFrcZAll ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PFrcZAll)
  ENDIF
  IF ( ALLOCATED(InData%PMomXAll) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMomXAll))-1 ) =  PACK(InData%PMomXAll ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMomXAll)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEffFac )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%rSAerCen) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rSAerCen))-1 ) =  PACK(InData%rSAerCen ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rSAerCen)
  ENDIF
 END SUBROUTINE ED_PackRtHndSide

 SUBROUTINE ED_UnPackRtHndSide( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_RtHndSide), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%rO,1)))
  mask1 = .TRUE.
  OutData%rO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rO))-1 ),mask1,OutData%rO)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rO)
  IF ( ALLOCATED(OutData%rQS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rQS,1),SIZE(OutData%rQS,2),SIZE(OutData%rQS,3)))
  mask3 = .TRUE.
    OutData%rQS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rQS))-1 ),mask3,OutData%rQS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rQS)
  ENDIF
  IF ( ALLOCATED(OutData%rS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rS,1),SIZE(OutData%rS,2),SIZE(OutData%rS,3)))
  mask3 = .TRUE.
    OutData%rS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rS))-1 ),mask3,OutData%rS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rS)
  ENDIF
  IF ( ALLOCATED(OutData%rS0S) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rS0S,1),SIZE(OutData%rS0S,2),SIZE(OutData%rS0S,3)))
  mask3 = .TRUE.
    OutData%rS0S = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rS0S))-1 ),mask3,OutData%rS0S)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rS0S)
  ENDIF
  IF ( ALLOCATED(OutData%rT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rT,1),SIZE(OutData%rT,2)))
  mask2 = .TRUE.
    OutData%rT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT))-1 ),mask2,OutData%rT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rT)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rT0O,1)))
  mask1 = .TRUE.
  OutData%rT0O = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT0O))-1 ),mask1,OutData%rT0O)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rT0O)
  IF ( ALLOCATED(OutData%rT0T) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rT0T,1),SIZE(OutData%rT0T,2)))
  mask2 = .TRUE.
    OutData%rT0T = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rT0T))-1 ),mask2,OutData%rT0T)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rT0T)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rZ,1)))
  mask1 = .TRUE.
  OutData%rZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZ))-1 ),mask1,OutData%rZ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZ)
  ALLOCATE(mask1(SIZE(OutData%rZO,1)))
  mask1 = .TRUE.
  OutData%rZO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZO))-1 ),mask1,OutData%rZO)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZO)
  IF ( ALLOCATED(OutData%rZT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rZT,1),SIZE(OutData%rZT,2)))
  mask2 = .TRUE.
    OutData%rZT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZT))-1 ),mask2,OutData%rZT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rZT)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rPQ,1)))
  mask1 = .TRUE.
  OutData%rPQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPQ))-1 ),mask1,OutData%rPQ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rPQ)
  ALLOCATE(mask1(SIZE(OutData%rP,1)))
  mask1 = .TRUE.
  OutData%rP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rP))-1 ),mask1,OutData%rP)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rP)
  ALLOCATE(mask1(SIZE(OutData%rV,1)))
  mask1 = .TRUE.
  OutData%rV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rV))-1 ),mask1,OutData%rV)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rV)
  ALLOCATE(mask1(SIZE(OutData%rZY,1)))
  mask1 = .TRUE.
  OutData%rZY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZY))-1 ),mask1,OutData%rZY)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZY)
  ALLOCATE(mask1(SIZE(OutData%rOU,1)))
  mask1 = .TRUE.
  OutData%rOU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOU))-1 ),mask1,OutData%rOU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOU)
  ALLOCATE(mask1(SIZE(OutData%rOV,1)))
  mask1 = .TRUE.
  OutData%rOV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOV))-1 ),mask1,OutData%rOV)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOV)
  ALLOCATE(mask1(SIZE(OutData%rVD,1)))
  mask1 = .TRUE.
  OutData%rVD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVD))-1 ),mask1,OutData%rVD)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVD)
  ALLOCATE(mask1(SIZE(OutData%rOW,1)))
  mask1 = .TRUE.
  OutData%rOW = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rOW))-1 ),mask1,OutData%rOW)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rOW)
  ALLOCATE(mask1(SIZE(OutData%rPC,1)))
  mask1 = .TRUE.
  OutData%rPC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPC))-1 ),mask1,OutData%rPC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rPC)
  IF ( ALLOCATED(OutData%rPS0) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rPS0,1),SIZE(OutData%rPS0,2)))
  mask2 = .TRUE.
    OutData%rPS0 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rPS0))-1 ),mask2,OutData%rPS0)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rPS0)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%rQ,1)))
  mask1 = .TRUE.
  OutData%rQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rQ))-1 ),mask1,OutData%rQ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rQ)
  ALLOCATE(mask1(SIZE(OutData%rQC,1)))
  mask1 = .TRUE.
  OutData%rQC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rQC))-1 ),mask1,OutData%rQC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rQC)
  ALLOCATE(mask1(SIZE(OutData%rVIMU,1)))
  mask1 = .TRUE.
  OutData%rVIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVIMU))-1 ),mask1,OutData%rVIMU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVIMU)
  ALLOCATE(mask1(SIZE(OutData%rVP,1)))
  mask1 = .TRUE.
  OutData%rVP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rVP))-1 ),mask1,OutData%rVP)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rVP)
  ALLOCATE(mask1(SIZE(OutData%rWI,1)))
  mask1 = .TRUE.
  OutData%rWI = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWI))-1 ),mask1,OutData%rWI)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWI)
  ALLOCATE(mask1(SIZE(OutData%rWJ,1)))
  mask1 = .TRUE.
  OutData%rWJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWJ))-1 ),mask1,OutData%rWJ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWJ)
  ALLOCATE(mask1(SIZE(OutData%rWK,1)))
  mask1 = .TRUE.
  OutData%rWK = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rWK))-1 ),mask1,OutData%rWK)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rWK)
  ALLOCATE(mask1(SIZE(OutData%rZT0,1)))
  mask1 = .TRUE.
  OutData%rZT0 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rZT0))-1 ),mask1,OutData%rZT0)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%rZT0)
  IF ( ALLOCATED(OutData%AngPosEF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngPosEF,1),SIZE(OutData%AngPosEF,2)))
  mask2 = .TRUE.
    OutData%AngPosEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosEF))-1 ),mask2,OutData%AngPosEF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosEF)
  ENDIF
  IF ( ALLOCATED(OutData%AngPosXF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngPosXF,1),SIZE(OutData%AngPosXF,2)))
  mask2 = .TRUE.
    OutData%AngPosXF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosXF))-1 ),mask2,OutData%AngPosXF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosXF)
  ENDIF
  IF ( ALLOCATED(OutData%AngPosHM) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AngPosHM,1),SIZE(OutData%AngPosHM,2),SIZE(OutData%AngPosHM,3)))
  mask3 = .TRUE.
    OutData%AngPosHM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosHM))-1 ),mask3,OutData%AngPosHM)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosHM)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngPosXB,1)))
  mask1 = .TRUE.
  OutData%AngPosXB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosXB))-1 ),mask1,OutData%AngPosXB)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosXB)
  ALLOCATE(mask1(SIZE(OutData%AngPosEX,1)))
  mask1 = .TRUE.
  OutData%AngPosEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngPosEX))-1 ),mask1,OutData%AngPosEX)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngPosEX)
  IF ( ALLOCATED(OutData%PAngVelEA) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEA,1),SIZE(OutData%PAngVelEA,2),SIZE(OutData%PAngVelEA,3)))
  mask3 = .TRUE.
    OutData%PAngVelEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEA))-1 ),mask3,OutData%PAngVelEA)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEA)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEF) ) THEN
  ALLOCATE(mask4(SIZE(OutData%PAngVelEF,1),SIZE(OutData%PAngVelEF,2),SIZE(OutData%PAngVelEF,3),SIZE(OutData%PAngVelEF,4)))
  mask4 = .TRUE.
    OutData%PAngVelEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEF))-1 ),mask4,OutData%PAngVelEF)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEF)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEG) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEG,1),SIZE(OutData%PAngVelEG,2),SIZE(OutData%PAngVelEG,3)))
  mask3 = .TRUE.
    OutData%PAngVelEG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEG))-1 ),mask3,OutData%PAngVelEG)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEG)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEH) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEH,1),SIZE(OutData%PAngVelEH,2),SIZE(OutData%PAngVelEH,3)))
  mask3 = .TRUE.
    OutData%PAngVelEH = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEH))-1 ),mask3,OutData%PAngVelEH)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEH)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEL) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEL,1),SIZE(OutData%PAngVelEL,2),SIZE(OutData%PAngVelEL,3)))
  mask3 = .TRUE.
    OutData%PAngVelEL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEL))-1 ),mask3,OutData%PAngVelEL)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEL)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEM) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PAngVelEM,1),SIZE(OutData%PAngVelEM,2),SIZE(OutData%PAngVelEM,3),SIZE(OutData%PAngVelEM,4),SIZE(OutData%PAngVelEM,5)))
  mask5 = .TRUE.
    OutData%PAngVelEM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEM))-1 ),mask5,OutData%PAngVelEM)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEM)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEN) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEN,1),SIZE(OutData%PAngVelEN,2),SIZE(OutData%PAngVelEN,3)))
  mask3 = .TRUE.
    OutData%PAngVelEN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEN))-1 ),mask3,OutData%PAngVelEN)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEN)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngVelEA,1)))
  mask1 = .TRUE.
  OutData%AngVelEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEA))-1 ),mask1,OutData%AngVelEA)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEA)
  IF ( ALLOCATED(OutData%PAngVelEB) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEB,1),SIZE(OutData%PAngVelEB,2),SIZE(OutData%PAngVelEB,3)))
  mask3 = .TRUE.
    OutData%PAngVelEB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEB))-1 ),mask3,OutData%PAngVelEB)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEB)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelER) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelER,1),SIZE(OutData%PAngVelER,2),SIZE(OutData%PAngVelER,3)))
  mask3 = .TRUE.
    OutData%PAngVelER = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelER))-1 ),mask3,OutData%PAngVelER)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelER)
  ENDIF
  IF ( ALLOCATED(OutData%PAngVelEX) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PAngVelEX,1),SIZE(OutData%PAngVelEX,2),SIZE(OutData%PAngVelEX,3)))
  mask3 = .TRUE.
    OutData%PAngVelEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PAngVelEX))-1 ),mask3,OutData%PAngVelEX)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PAngVelEX)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngVelEG,1)))
  mask1 = .TRUE.
  OutData%AngVelEG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEG))-1 ),mask1,OutData%AngVelEG)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEG)
  ALLOCATE(mask1(SIZE(OutData%AngVelEH,1)))
  mask1 = .TRUE.
  OutData%AngVelEH = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEH))-1 ),mask1,OutData%AngVelEH)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEH)
  ALLOCATE(mask1(SIZE(OutData%AngVelEL,1)))
  mask1 = .TRUE.
  OutData%AngVelEL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEL))-1 ),mask1,OutData%AngVelEL)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEL)
  ALLOCATE(mask1(SIZE(OutData%AngVelEN,1)))
  mask1 = .TRUE.
  OutData%AngVelEN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEN))-1 ),mask1,OutData%AngVelEN)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEN)
  ALLOCATE(mask1(SIZE(OutData%AngVelEB,1)))
  mask1 = .TRUE.
  OutData%AngVelEB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEB))-1 ),mask1,OutData%AngVelEB)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEB)
  ALLOCATE(mask1(SIZE(OutData%AngVelER,1)))
  mask1 = .TRUE.
  OutData%AngVelER = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelER))-1 ),mask1,OutData%AngVelER)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelER)
  ALLOCATE(mask1(SIZE(OutData%AngVelEX,1)))
  mask1 = .TRUE.
  OutData%AngVelEX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEX))-1 ),mask1,OutData%AngVelEX)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEX)
  OutData%TeetAngVel = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%AngAccEBt,1)))
  mask1 = .TRUE.
  OutData%AngAccEBt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEBt))-1 ),mask1,OutData%AngAccEBt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEBt)
  ALLOCATE(mask1(SIZE(OutData%AngAccERt,1)))
  mask1 = .TRUE.
  OutData%AngAccERt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccERt))-1 ),mask1,OutData%AngAccERt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccERt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEXt,1)))
  mask1 = .TRUE.
  OutData%AngAccEXt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEXt))-1 ),mask1,OutData%AngAccEXt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEXt)
  IF ( ALLOCATED(OutData%AngAccEFt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngAccEFt,1),SIZE(OutData%AngAccEFt,2)))
  mask2 = .TRUE.
    OutData%AngAccEFt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEFt))-1 ),mask2,OutData%AngAccEFt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEFt)
  ENDIF
  IF ( ALLOCATED(OutData%AngVelEF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AngVelEF,1),SIZE(OutData%AngVelEF,2)))
  mask2 = .TRUE.
    OutData%AngVelEF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngVelEF))-1 ),mask2,OutData%AngVelEF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AngVelEF)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%AngAccEAt,1)))
  mask1 = .TRUE.
  OutData%AngAccEAt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEAt))-1 ),mask1,OutData%AngAccEAt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEAt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEGt,1)))
  mask1 = .TRUE.
  OutData%AngAccEGt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEGt))-1 ),mask1,OutData%AngAccEGt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEGt)
  ALLOCATE(mask1(SIZE(OutData%AngAccEHt,1)))
  mask1 = .TRUE.
  OutData%AngAccEHt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccEHt))-1 ),mask1,OutData%AngAccEHt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccEHt)
  ALLOCATE(mask1(SIZE(OutData%AngAccENt,1)))
  mask1 = .TRUE.
  OutData%AngAccENt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AngAccENt))-1 ),mask1,OutData%AngAccENt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%AngAccENt)
  ALLOCATE(mask1(SIZE(OutData%LinAccECt,1)))
  mask1 = .TRUE.
  OutData%LinAccECt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccECt))-1 ),mask1,OutData%LinAccECt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccECt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEDt,1)))
  mask1 = .TRUE.
  OutData%LinAccEDt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEDt))-1 ),mask1,OutData%LinAccEDt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEDt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEIt,1)))
  mask1 = .TRUE.
  OutData%LinAccEIt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEIt))-1 ),mask1,OutData%LinAccEIt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEIt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEJt,1)))
  mask1 = .TRUE.
  OutData%LinAccEJt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEJt))-1 ),mask1,OutData%LinAccEJt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEJt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEUt,1)))
  mask1 = .TRUE.
  OutData%LinAccEUt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEUt))-1 ),mask1,OutData%LinAccEUt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEUt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEYt,1)))
  mask1 = .TRUE.
  OutData%LinAccEYt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEYt))-1 ),mask1,OutData%LinAccEYt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEYt)
  IF ( ALLOCATED(OutData%LinVelES) ) THEN
  ALLOCATE(mask3(SIZE(OutData%LinVelES,1),SIZE(OutData%LinVelES,2),SIZE(OutData%LinVelES,3)))
  mask3 = .TRUE.
    OutData%LinVelES = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelES))-1 ),mask3,OutData%LinVelES)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelES)
  ENDIF
  IF ( ALLOCATED(OutData%LinVelET) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LinVelET,1),SIZE(OutData%LinVelET,2)))
  mask2 = .TRUE.
    OutData%LinVelET = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelET))-1 ),mask2,OutData%LinVelET)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelET)
  ENDIF
  IF ( ALLOCATED(OutData%LinVelESm2) ) THEN
  ALLOCATE(mask1(SIZE(OutData%LinVelESm2,1)))
  mask1 = .TRUE.
    OutData%LinVelESm2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelESm2))-1 ),mask1,OutData%LinVelESm2)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelESm2)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEIMU) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEIMU,1),SIZE(OutData%PLinVelEIMU,2),SIZE(OutData%PLinVelEIMU,3)))
  mask3 = .TRUE.
    OutData%PLinVelEIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEIMU))-1 ),mask3,OutData%PLinVelEIMU)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEIMU)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEO) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEO,1),SIZE(OutData%PLinVelEO,2),SIZE(OutData%PLinVelEO,3)))
  mask3 = .TRUE.
    OutData%PLinVelEO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEO))-1 ),mask3,OutData%PLinVelEO)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEO)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelES) ) THEN
  ALLOCATE(mask5(SIZE(OutData%PLinVelES,1),SIZE(OutData%PLinVelES,2),SIZE(OutData%PLinVelES,3),SIZE(OutData%PLinVelES,4),SIZE(OutData%PLinVelES,5)))
  mask5 = .TRUE.
    OutData%PLinVelES = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelES))-1 ),mask5,OutData%PLinVelES)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelES)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelET) ) THEN
  ALLOCATE(mask4(SIZE(OutData%PLinVelET,1),SIZE(OutData%PLinVelET,2),SIZE(OutData%PLinVelET,3),SIZE(OutData%PLinVelET,4)))
  mask4 = .TRUE.
    OutData%PLinVelET = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelET))-1 ),mask4,OutData%PLinVelET)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelET)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEZ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEZ,1),SIZE(OutData%PLinVelEZ,2),SIZE(OutData%PLinVelEZ,3)))
  mask3 = .TRUE.
    OutData%PLinVelEZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEZ))-1 ),mask3,OutData%PLinVelEZ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEZ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEC) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEC,1),SIZE(OutData%PLinVelEC,2),SIZE(OutData%PLinVelEC,3)))
  mask3 = .TRUE.
    OutData%PLinVelEC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEC))-1 ),mask3,OutData%PLinVelEC)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEC)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelED) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelED,1),SIZE(OutData%PLinVelED,2),SIZE(OutData%PLinVelED,3)))
  mask3 = .TRUE.
    OutData%PLinVelED = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelED))-1 ),mask3,OutData%PLinVelED)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelED)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEI) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEI,1),SIZE(OutData%PLinVelEI,2),SIZE(OutData%PLinVelEI,3)))
  mask3 = .TRUE.
    OutData%PLinVelEI = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEI))-1 ),mask3,OutData%PLinVelEI)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEI)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEJ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEJ,1),SIZE(OutData%PLinVelEJ,2),SIZE(OutData%PLinVelEJ,3)))
  mask3 = .TRUE.
    OutData%PLinVelEJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEJ))-1 ),mask3,OutData%PLinVelEJ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEJ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEK) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEK,1),SIZE(OutData%PLinVelEK,2),SIZE(OutData%PLinVelEK,3)))
  mask3 = .TRUE.
    OutData%PLinVelEK = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEK))-1 ),mask3,OutData%PLinVelEK)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEK)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEP) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEP,1),SIZE(OutData%PLinVelEP,2),SIZE(OutData%PLinVelEP,3)))
  mask3 = .TRUE.
    OutData%PLinVelEP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEP))-1 ),mask3,OutData%PLinVelEP)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEP)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEQ) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEQ,1),SIZE(OutData%PLinVelEQ,2),SIZE(OutData%PLinVelEQ,3)))
  mask3 = .TRUE.
    OutData%PLinVelEQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEQ))-1 ),mask3,OutData%PLinVelEQ)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEQ)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEU) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEU,1),SIZE(OutData%PLinVelEU,2),SIZE(OutData%PLinVelEU,3)))
  mask3 = .TRUE.
    OutData%PLinVelEU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEU))-1 ),mask3,OutData%PLinVelEU)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEU)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEV) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEV,1),SIZE(OutData%PLinVelEV,2),SIZE(OutData%PLinVelEV,3)))
  mask3 = .TRUE.
    OutData%PLinVelEV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEV))-1 ),mask3,OutData%PLinVelEV)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEV)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEW) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEW,1),SIZE(OutData%PLinVelEW,2),SIZE(OutData%PLinVelEW,3)))
  mask3 = .TRUE.
    OutData%PLinVelEW = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEW))-1 ),mask3,OutData%PLinVelEW)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEW)
  ENDIF
  IF ( ALLOCATED(OutData%PLinVelEY) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PLinVelEY,1),SIZE(OutData%PLinVelEY,2),SIZE(OutData%PLinVelEY,3)))
  mask3 = .TRUE.
    OutData%PLinVelEY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PLinVelEY))-1 ),mask3,OutData%PLinVelEY)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PLinVelEY)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%LinAccEIMUt,1)))
  mask1 = .TRUE.
  OutData%LinAccEIMUt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEIMUt))-1 ),mask1,OutData%LinAccEIMUt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEIMUt)
  ALLOCATE(mask1(SIZE(OutData%LinAccEOt,1)))
  mask1 = .TRUE.
  OutData%LinAccEOt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEOt))-1 ),mask1,OutData%LinAccEOt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEOt)
  IF ( ALLOCATED(OutData%LinAccESt) ) THEN
  ALLOCATE(mask3(SIZE(OutData%LinAccESt,1),SIZE(OutData%LinAccESt,2),SIZE(OutData%LinAccESt,3)))
  mask3 = .TRUE.
    OutData%LinAccESt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccESt))-1 ),mask3,OutData%LinAccESt)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccESt)
  ENDIF
  IF ( ALLOCATED(OutData%LinAccETt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%LinAccETt,1),SIZE(OutData%LinAccETt,2)))
  mask2 = .TRUE.
    OutData%LinAccETt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccETt))-1 ),mask2,OutData%LinAccETt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccETt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%LinAccEZt,1)))
  mask1 = .TRUE.
  OutData%LinAccEZt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinAccEZt))-1 ),mask1,OutData%LinAccEZt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinAccEZt)
  ALLOCATE(mask1(SIZE(OutData%LinVelEIMU,1)))
  mask1 = .TRUE.
  OutData%LinVelEIMU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelEIMU))-1 ),mask1,OutData%LinVelEIMU)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelEIMU)
  ALLOCATE(mask1(SIZE(OutData%LinVelEZ,1)))
  mask1 = .TRUE.
  OutData%LinVelEZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelEZ))-1 ),mask1,OutData%LinVelEZ)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelEZ)
  ALLOCATE(mask1(SIZE(OutData%LinVelEO,1)))
  mask1 = .TRUE.
  OutData%LinVelEO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%LinVelEO))-1 ),mask1,OutData%LinVelEO)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%LinVelEO)
  ALLOCATE(mask1(SIZE(OutData%FrcONcRtt,1)))
  mask1 = .TRUE.
  OutData%FrcONcRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcONcRtt))-1 ),mask1,OutData%FrcONcRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcONcRtt)
  ALLOCATE(mask1(SIZE(OutData%FrcPRott,1)))
  mask1 = .TRUE.
  OutData%FrcPRott = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcPRott))-1 ),mask1,OutData%FrcPRott)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcPRott)
  IF ( ALLOCATED(OutData%FrcS0Bt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FrcS0Bt,1),SIZE(OutData%FrcS0Bt,2)))
  mask2 = .TRUE.
    OutData%FrcS0Bt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcS0Bt))-1 ),mask2,OutData%FrcS0Bt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcS0Bt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%FrcT0Trbt,1)))
  mask1 = .TRUE.
  OutData%FrcT0Trbt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcT0Trbt))-1 ),mask1,OutData%FrcT0Trbt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcT0Trbt)
  IF ( ALLOCATED(OutData%FSAero) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FSAero,1),SIZE(OutData%FSAero,2),SIZE(OutData%FSAero,3)))
  mask3 = .TRUE.
    OutData%FSAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSAero))-1 ),mask3,OutData%FSAero)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSAero)
  ENDIF
  IF ( ALLOCATED(OutData%FSTipDrag) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSTipDrag,1),SIZE(OutData%FSTipDrag,2)))
  mask2 = .TRUE.
    OutData%FSTipDrag = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSTipDrag))-1 ),mask2,OutData%FSTipDrag)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSTipDrag)
  ENDIF
  IF ( ALLOCATED(OutData%FTHydrot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FTHydrot,1),SIZE(OutData%FTHydrot,2)))
  mask2 = .TRUE.
    OutData%FTHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTHydrot))-1 ),mask2,OutData%FTHydrot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTHydrot)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%FZHydrot,1)))
  mask1 = .TRUE.
  OutData%FZHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FZHydrot))-1 ),mask1,OutData%FZHydrot)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FZHydrot)
  IF ( ALLOCATED(OutData%MFHydrot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MFHydrot,1),SIZE(OutData%MFHydrot,2)))
  mask2 = .TRUE.
    OutData%MFHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MFHydrot))-1 ),mask2,OutData%MFHydrot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MFHydrot)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MomBNcRtt,1)))
  mask1 = .TRUE.
  OutData%MomBNcRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomBNcRtt))-1 ),mask1,OutData%MomBNcRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomBNcRtt)
  IF ( ALLOCATED(OutData%MomH0Bt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MomH0Bt,1),SIZE(OutData%MomH0Bt,2)))
  mask2 = .TRUE.
    OutData%MomH0Bt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomH0Bt))-1 ),mask2,OutData%MomH0Bt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MomH0Bt)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MomLPRott,1)))
  mask1 = .TRUE.
  OutData%MomLPRott = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomLPRott))-1 ),mask1,OutData%MomLPRott)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomLPRott)
  ALLOCATE(mask1(SIZE(OutData%MomNGnRtt,1)))
  mask1 = .TRUE.
  OutData%MomNGnRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomNGnRtt))-1 ),mask1,OutData%MomNGnRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomNGnRtt)
  ALLOCATE(mask1(SIZE(OutData%MomNTailt,1)))
  mask1 = .TRUE.
  OutData%MomNTailt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomNTailt))-1 ),mask1,OutData%MomNTailt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomNTailt)
  ALLOCATE(mask1(SIZE(OutData%MomX0Trbt,1)))
  mask1 = .TRUE.
  OutData%MomX0Trbt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomX0Trbt))-1 ),mask1,OutData%MomX0Trbt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomX0Trbt)
  IF ( ALLOCATED(OutData%MMAero) ) THEN
  ALLOCATE(mask3(SIZE(OutData%MMAero,1),SIZE(OutData%MMAero,2),SIZE(OutData%MMAero,3)))
  mask3 = .TRUE.
    OutData%MMAero = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MMAero))-1 ),mask3,OutData%MMAero)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MMAero)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%MXHydrot,1)))
  mask1 = .TRUE.
  OutData%MXHydrot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MXHydrot))-1 ),mask1,OutData%MXHydrot)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MXHydrot)
  IF ( ALLOCATED(OutData%PFrcONcRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcONcRt,1),SIZE(OutData%PFrcONcRt,2)))
  mask2 = .TRUE.
    OutData%PFrcONcRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcONcRt))-1 ),mask2,OutData%PFrcONcRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcONcRt)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcPRot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcPRot,1),SIZE(OutData%PFrcPRot,2)))
  mask2 = .TRUE.
    OutData%PFrcPRot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcPRot))-1 ),mask2,OutData%PFrcPRot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcPRot)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcS0B) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PFrcS0B,1),SIZE(OutData%PFrcS0B,2),SIZE(OutData%PFrcS0B,3)))
  mask3 = .TRUE.
    OutData%PFrcS0B = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcS0B))-1 ),mask3,OutData%PFrcS0B)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcS0B)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcT0Trb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcT0Trb,1),SIZE(OutData%PFrcT0Trb,2)))
  mask2 = .TRUE.
    OutData%PFrcT0Trb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcT0Trb))-1 ),mask2,OutData%PFrcT0Trb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcT0Trb)
  ENDIF
  IF ( ALLOCATED(OutData%PFTHydro) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PFTHydro,1),SIZE(OutData%PFTHydro,2),SIZE(OutData%PFTHydro,3)))
  mask3 = .TRUE.
    OutData%PFTHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFTHydro))-1 ),mask3,OutData%PFTHydro)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFTHydro)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PFZHydro,1),SIZE(OutData%PFZHydro,2)))
  mask2 = .TRUE.
  OutData%PFZHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFZHydro))-1 ),mask2,OutData%PFZHydro)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PFZHydro)
  IF ( ALLOCATED(OutData%PMFHydro) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PMFHydro,1),SIZE(OutData%PMFHydro,2),SIZE(OutData%PMFHydro,3)))
  mask3 = .TRUE.
    OutData%PMFHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMFHydro))-1 ),mask3,OutData%PMFHydro)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMFHydro)
  ENDIF
  IF ( ALLOCATED(OutData%PMomBNcRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomBNcRt,1),SIZE(OutData%PMomBNcRt,2)))
  mask2 = .TRUE.
    OutData%PMomBNcRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomBNcRt))-1 ),mask2,OutData%PMomBNcRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomBNcRt)
  ENDIF
  IF ( ALLOCATED(OutData%PMomH0B) ) THEN
  ALLOCATE(mask3(SIZE(OutData%PMomH0B,1),SIZE(OutData%PMomH0B,2),SIZE(OutData%PMomH0B,3)))
  mask3 = .TRUE.
    OutData%PMomH0B = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomH0B))-1 ),mask3,OutData%PMomH0B)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomH0B)
  ENDIF
  IF ( ALLOCATED(OutData%PMomLPRot) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomLPRot,1),SIZE(OutData%PMomLPRot,2)))
  mask2 = .TRUE.
    OutData%PMomLPRot = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomLPRot))-1 ),mask2,OutData%PMomLPRot)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomLPRot)
  ENDIF
  IF ( ALLOCATED(OutData%PMomNGnRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomNGnRt,1),SIZE(OutData%PMomNGnRt,2)))
  mask2 = .TRUE.
    OutData%PMomNGnRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomNGnRt))-1 ),mask2,OutData%PMomNGnRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomNGnRt)
  ENDIF
  IF ( ALLOCATED(OutData%PMomNTail) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomNTail,1),SIZE(OutData%PMomNTail,2)))
  mask2 = .TRUE.
    OutData%PMomNTail = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomNTail))-1 ),mask2,OutData%PMomNTail)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomNTail)
  ENDIF
  IF ( ALLOCATED(OutData%PMomX0Trb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomX0Trb,1),SIZE(OutData%PMomX0Trb,2)))
  mask2 = .TRUE.
    OutData%PMomX0Trb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomX0Trb))-1 ),mask2,OutData%PMomX0Trb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomX0Trb)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PMXHydro,1),SIZE(OutData%PMXHydro,2)))
  mask2 = .TRUE.
  OutData%PMXHydro = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMXHydro))-1 ),mask2,OutData%PMXHydro)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PMXHydro)
  OutData%TeetAng = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%FrcVGnRtt,1)))
  mask1 = .TRUE.
  OutData%FrcVGnRtt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcVGnRtt))-1 ),mask1,OutData%FrcVGnRtt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcVGnRtt)
  ALLOCATE(mask1(SIZE(OutData%FrcWTailt,1)))
  mask1 = .TRUE.
  OutData%FrcWTailt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcWTailt))-1 ),mask1,OutData%FrcWTailt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcWTailt)
  ALLOCATE(mask1(SIZE(OutData%FrcZAllt,1)))
  mask1 = .TRUE.
  OutData%FrcZAllt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FrcZAllt))-1 ),mask1,OutData%FrcZAllt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FrcZAllt)
  ALLOCATE(mask1(SIZE(OutData%MomXAllt,1)))
  mask1 = .TRUE.
  OutData%MomXAllt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MomXAllt))-1 ),mask1,OutData%MomXAllt)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%MomXAllt)
  IF ( ALLOCATED(OutData%PFrcVGnRt) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcVGnRt,1),SIZE(OutData%PFrcVGnRt,2)))
  mask2 = .TRUE.
    OutData%PFrcVGnRt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcVGnRt))-1 ),mask2,OutData%PFrcVGnRt)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcVGnRt)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcWTail) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcWTail,1),SIZE(OutData%PFrcWTail,2)))
  mask2 = .TRUE.
    OutData%PFrcWTail = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcWTail))-1 ),mask2,OutData%PFrcWTail)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcWTail)
  ENDIF
  IF ( ALLOCATED(OutData%PFrcZAll) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PFrcZAll,1),SIZE(OutData%PFrcZAll,2)))
  mask2 = .TRUE.
    OutData%PFrcZAll = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PFrcZAll))-1 ),mask2,OutData%PFrcZAll)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PFrcZAll)
  ENDIF
  IF ( ALLOCATED(OutData%PMomXAll) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PMomXAll,1),SIZE(OutData%PMomXAll,2)))
  mask2 = .TRUE.
    OutData%PMomXAll = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMomXAll))-1 ),mask2,OutData%PMomXAll)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMomXAll)
  ENDIF
  OutData%TeetMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEffFac = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%rSAerCen) ) THEN
  ALLOCATE(mask3(SIZE(OutData%rSAerCen,1),SIZE(OutData%rSAerCen,2),SIZE(OutData%rSAerCen,3)))
  mask3 = .TRUE.
    OutData%rSAerCen = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rSAerCen))-1 ),mask3,OutData%rSAerCen)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rSAerCen)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackRtHndSide

 SUBROUTINE ED_CopyContState( SrcContStateData, DstContStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_ContinuousStateType), INTENT(IN) :: SrcContStateData
   TYPE(ED_ContinuousStateType), INTENT(INOUT) :: DstContStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcContStateData%QT)) THEN
   i1_l = LBOUND(SrcContStateData%QT,1)
   i1_u = UBOUND(SrcContStateData%QT,1)
   IF (.NOT. ALLOCATED(DstContStateData%QT)) THEN 
      ALLOCATE(DstContStateData%QT(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstContStateData%QT.', ErrStat, ErrMsg,'ED_CopyContState')
         RETURN
      END IF
   END IF
   DstContStateData%QT = SrcContStateData%QT
ENDIF
IF (ALLOCATED(SrcContStateData%QDT)) THEN
   i1_l = LBOUND(SrcContStateData%QDT,1)
   i1_u = UBOUND(SrcContStateData%QDT,1)
   IF (.NOT. ALLOCATED(DstContStateData%QDT)) THEN 
      ALLOCATE(DstContStateData%QDT(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstContStateData%QDT.', ErrStat, ErrMsg,'ED_CopyContState')
         RETURN
      END IF
   END IF
   DstContStateData%QDT = SrcContStateData%QDT
ENDIF
 END SUBROUTINE ED_CopyContState

 SUBROUTINE ED_DestroyContState( ContStateData, ErrStat, ErrMsg )
  TYPE(ED_ContinuousStateType), INTENT(INOUT) :: ContStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ContStateData%QT)) THEN
   DEALLOCATE(ContStateData%QT)
ENDIF
IF (ALLOCATED(ContStateData%QDT)) THEN
   DEALLOCATE(ContStateData%QDT)
ENDIF
 END SUBROUTINE ED_DestroyContState

 SUBROUTINE ED_PackContState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_ContinuousStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%QT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QT )  ! QT 
  IF ( ALLOCATED(InData%QDT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QDT )  ! QDT 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%QT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QT))-1 ) =  PACK(InData%QT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QT)
  ENDIF
  IF ( ALLOCATED(InData%QDT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QDT))-1 ) =  PACK(InData%QDT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QDT)
  ENDIF
 END SUBROUTINE ED_PackContState

 SUBROUTINE ED_UnPackContState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_ContinuousStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%QT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QT,1)))
  mask1 = .TRUE.
    OutData%QT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QT))-1 ),mask1,OutData%QT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QT)
  ENDIF
  IF ( ALLOCATED(OutData%QDT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QDT,1)))
  mask1 = .TRUE.
    OutData%QDT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QDT))-1 ),mask1,OutData%QDT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QDT)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackContState

 SUBROUTINE ED_CopyDiscState( SrcDiscStateData, DstDiscStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_DiscreteStateType), INTENT(IN) :: SrcDiscStateData
   TYPE(ED_DiscreteStateType), INTENT(INOUT) :: DstDiscStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDiscStateData%DummyDiscState = SrcDiscStateData%DummyDiscState
 END SUBROUTINE ED_CopyDiscState

 SUBROUTINE ED_DestroyDiscState( DiscStateData, ErrStat, ErrMsg )
  TYPE(ED_DiscreteStateType), INTENT(INOUT) :: DiscStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyDiscState

 SUBROUTINE ED_PackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_DiscreteStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyDiscState
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyDiscState )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackDiscState

 SUBROUTINE ED_UnPackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_DiscreteStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyDiscState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackDiscState

 SUBROUTINE ED_CopyConstrState( SrcConstrStateData, DstConstrStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_ConstraintStateType), INTENT(IN) :: SrcConstrStateData
   TYPE(ED_ConstraintStateType), INTENT(INOUT) :: DstConstrStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstConstrStateData%DummyConstrState = SrcConstrStateData%DummyConstrState
 END SUBROUTINE ED_CopyConstrState

 SUBROUTINE ED_DestroyConstrState( ConstrStateData, ErrStat, ErrMsg )
  TYPE(ED_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE ED_DestroyConstrState

 SUBROUTINE ED_PackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_ConstraintStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyConstrState
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyConstrState )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackConstrState

 SUBROUTINE ED_UnPackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_ConstraintStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyConstrState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackConstrState

 SUBROUTINE ED_CopyOtherState( SrcOtherStateData, DstOtherStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_OtherStateType), INTENT(IN) :: SrcOtherStateData
   TYPE(ED_OtherStateType), INTENT(INOUT) :: DstOtherStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL ED_Copycoordsys( SrcOtherStateData%CoordSys, DstOtherStateData%CoordSys, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOtherState:CoordSys')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL ED_Copyrthndside( SrcOtherStateData%RtHS, DstOtherStateData%RtHS, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOtherState:RtHS')
         IF (ErrStat>=AbortErrLev) RETURN
   DstOtherStateData%n = SrcOtherStateData%n
   DO i1 = LBOUND(SrcOtherStateData%xdot,1), UBOUND(SrcOtherStateData%xdot,1)
      CALL ED_CopyContState( SrcOtherStateData%xdot(i1), DstOtherStateData%xdot(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOtherState:xdot(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
IF (ALLOCATED(SrcOtherStateData%IC)) THEN
   i1_l = LBOUND(SrcOtherStateData%IC,1)
   i1_u = UBOUND(SrcOtherStateData%IC,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%IC)) THEN 
      ALLOCATE(DstOtherStateData%IC(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%IC.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%IC = SrcOtherStateData%IC
ENDIF
IF (ALLOCATED(SrcOtherStateData%QD2T)) THEN
   i1_l = LBOUND(SrcOtherStateData%QD2T,1)
   i1_u = UBOUND(SrcOtherStateData%QD2T,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%QD2T)) THEN 
      ALLOCATE(DstOtherStateData%QD2T(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%QD2T.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%QD2T = SrcOtherStateData%QD2T
ENDIF
IF (ALLOCATED(SrcOtherStateData%BlPitch)) THEN
   i1_l = LBOUND(SrcOtherStateData%BlPitch,1)
   i1_u = UBOUND(SrcOtherStateData%BlPitch,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%BlPitch)) THEN 
      ALLOCATE(DstOtherStateData%BlPitch(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%BlPitch.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%BlPitch = SrcOtherStateData%BlPitch
ENDIF
IF (ALLOCATED(SrcOtherStateData%AugMat)) THEN
   i1_l = LBOUND(SrcOtherStateData%AugMat,1)
   i1_u = UBOUND(SrcOtherStateData%AugMat,1)
   i2_l = LBOUND(SrcOtherStateData%AugMat,2)
   i2_u = UBOUND(SrcOtherStateData%AugMat,2)
   IF (.NOT. ALLOCATED(DstOtherStateData%AugMat)) THEN 
      ALLOCATE(DstOtherStateData%AugMat(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%AugMat.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%AugMat = SrcOtherStateData%AugMat
ENDIF
IF (ALLOCATED(SrcOtherStateData%AugMat_factor)) THEN
   i1_l = LBOUND(SrcOtherStateData%AugMat_factor,1)
   i1_u = UBOUND(SrcOtherStateData%AugMat_factor,1)
   i2_l = LBOUND(SrcOtherStateData%AugMat_factor,2)
   i2_u = UBOUND(SrcOtherStateData%AugMat_factor,2)
   IF (.NOT. ALLOCATED(DstOtherStateData%AugMat_factor)) THEN 
      ALLOCATE(DstOtherStateData%AugMat_factor(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%AugMat_factor.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%AugMat_factor = SrcOtherStateData%AugMat_factor
ENDIF
IF (ALLOCATED(SrcOtherStateData%SolnVec)) THEN
   i1_l = LBOUND(SrcOtherStateData%SolnVec,1)
   i1_u = UBOUND(SrcOtherStateData%SolnVec,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%SolnVec)) THEN 
      ALLOCATE(DstOtherStateData%SolnVec(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%SolnVec.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%SolnVec = SrcOtherStateData%SolnVec
ENDIF
IF (ALLOCATED(SrcOtherStateData%AugMat_pivot)) THEN
   i1_l = LBOUND(SrcOtherStateData%AugMat_pivot,1)
   i1_u = UBOUND(SrcOtherStateData%AugMat_pivot,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%AugMat_pivot)) THEN 
      ALLOCATE(DstOtherStateData%AugMat_pivot(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%AugMat_pivot.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%AugMat_pivot = SrcOtherStateData%AugMat_pivot
ENDIF
IF (ALLOCATED(SrcOtherStateData%AllOuts)) THEN
   i1_l = LBOUND(SrcOtherStateData%AllOuts,1)
   i1_u = UBOUND(SrcOtherStateData%AllOuts,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%AllOuts)) THEN 
      ALLOCATE(DstOtherStateData%AllOuts(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%AllOuts.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%AllOuts = SrcOtherStateData%AllOuts
ENDIF
   DstOtherStateData%HSSBrTrq = SrcOtherStateData%HSSBrTrq
   DstOtherStateData%HSSBrTrqC = SrcOtherStateData%HSSBrTrqC
IF (ALLOCATED(SrcOtherStateData%OgnlGeAzRo)) THEN
   i1_l = LBOUND(SrcOtherStateData%OgnlGeAzRo,1)
   i1_u = UBOUND(SrcOtherStateData%OgnlGeAzRo,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%OgnlGeAzRo)) THEN 
      ALLOCATE(DstOtherStateData%OgnlGeAzRo(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%OgnlGeAzRo.', ErrStat, ErrMsg,'ED_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%OgnlGeAzRo = SrcOtherStateData%OgnlGeAzRo
ENDIF
   DstOtherStateData%SgnPrvLSTQ = SrcOtherStateData%SgnPrvLSTQ
   DstOtherStateData%SgnLSTQ = SrcOtherStateData%SgnLSTQ
 END SUBROUTINE ED_CopyOtherState

 SUBROUTINE ED_DestroyOtherState( OtherStateData, ErrStat, ErrMsg )
  TYPE(ED_OtherStateType), INTENT(INOUT) :: OtherStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL ED_Destroycoordsys( OtherStateData%CoordSys, ErrStat, ErrMsg )
  CALL ED_Destroyrthndside( OtherStateData%RtHS, ErrStat, ErrMsg )
DO i1 = LBOUND(OtherStateData%xdot,1), UBOUND(OtherStateData%xdot,1)
  CALL ED_DestroyContState( OtherStateData%xdot(i1), ErrStat, ErrMsg )
ENDDO
IF (ALLOCATED(OtherStateData%IC)) THEN
   DEALLOCATE(OtherStateData%IC)
ENDIF
IF (ALLOCATED(OtherStateData%QD2T)) THEN
   DEALLOCATE(OtherStateData%QD2T)
ENDIF
IF (ALLOCATED(OtherStateData%BlPitch)) THEN
   DEALLOCATE(OtherStateData%BlPitch)
ENDIF
IF (ALLOCATED(OtherStateData%AugMat)) THEN
   DEALLOCATE(OtherStateData%AugMat)
ENDIF
IF (ALLOCATED(OtherStateData%AugMat_factor)) THEN
   DEALLOCATE(OtherStateData%AugMat_factor)
ENDIF
IF (ALLOCATED(OtherStateData%SolnVec)) THEN
   DEALLOCATE(OtherStateData%SolnVec)
ENDIF
IF (ALLOCATED(OtherStateData%AugMat_pivot)) THEN
   DEALLOCATE(OtherStateData%AugMat_pivot)
ENDIF
IF (ALLOCATED(OtherStateData%AllOuts)) THEN
   DEALLOCATE(OtherStateData%AllOuts)
ENDIF
IF (ALLOCATED(OtherStateData%OgnlGeAzRo)) THEN
   DEALLOCATE(OtherStateData%OgnlGeAzRo)
ENDIF
 END SUBROUTINE ED_DestroyOtherState

 SUBROUTINE ED_PackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_OtherStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_CoordSys_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_CoordSys_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_CoordSys_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RtHS_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RtHS_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RtHS_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_xdot_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_xdot_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_xdot_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, InData%CoordSys, ErrStat, ErrMsg, .TRUE. ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_CoordSys_Buf  ) ! CoordSys
  IF(ALLOCATED(Db_CoordSys_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_CoordSys_Buf  ) ! CoordSys
  IF(ALLOCATED(Int_CoordSys_Buf))Int_BufSz = Int_BufSz + SIZE( Int_CoordSys_Buf ) ! CoordSys
  IF(ALLOCATED(Re_CoordSys_Buf))  DEALLOCATE(Re_CoordSys_Buf)
  IF(ALLOCATED(Db_CoordSys_Buf))  DEALLOCATE(Db_CoordSys_Buf)
  IF(ALLOCATED(Int_CoordSys_Buf)) DEALLOCATE(Int_CoordSys_Buf)
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, InData%RtHS, ErrStat, ErrMsg, .TRUE. ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RtHS_Buf  ) ! RtHS
  IF(ALLOCATED(Db_RtHS_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RtHS_Buf  ) ! RtHS
  IF(ALLOCATED(Int_RtHS_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RtHS_Buf ) ! RtHS
  IF(ALLOCATED(Re_RtHS_Buf))  DEALLOCATE(Re_RtHS_Buf)
  IF(ALLOCATED(Db_RtHS_Buf))  DEALLOCATE(Db_RtHS_Buf)
  IF(ALLOCATED(Int_RtHS_Buf)) DEALLOCATE(Int_RtHS_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! n
DO i1 = LBOUND(InData%xdot,1), UBOUND(InData%xdot,1)
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, InData%xdot(i1), ErrStat, ErrMsg, .TRUE. ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_xdot_Buf  ) ! xdot
  IF(ALLOCATED(Db_xdot_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_xdot_Buf  ) ! xdot
  IF(ALLOCATED(Int_xdot_Buf))Int_BufSz = Int_BufSz + SIZE( Int_xdot_Buf ) ! xdot
  IF(ALLOCATED(Re_xdot_Buf))  DEALLOCATE(Re_xdot_Buf)
  IF(ALLOCATED(Db_xdot_Buf))  DEALLOCATE(Db_xdot_Buf)
  IF(ALLOCATED(Int_xdot_Buf)) DEALLOCATE(Int_xdot_Buf)
ENDDO
  IF ( ALLOCATED(InData%IC) )   Int_BufSz   = Int_BufSz   + SIZE( InData%IC )  ! IC 
  IF ( ALLOCATED(InData%QD2T) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QD2T )  ! QD2T 
  IF ( ALLOCATED(InData%BlPitch) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  IF ( ALLOCATED(InData%AugMat) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AugMat )  ! AugMat 
  IF ( ALLOCATED(InData%AugMat_factor) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AugMat_factor )  ! AugMat_factor 
  IF ( ALLOCATED(InData%SolnVec) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SolnVec )  ! SolnVec 
  IF ( ALLOCATED(InData%AugMat_pivot) )   Int_BufSz   = Int_BufSz   + SIZE( InData%AugMat_pivot )  ! AugMat_pivot 
  IF ( ALLOCATED(InData%AllOuts) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AllOuts )  ! AllOuts 
  Re_BufSz   = Re_BufSz   + 1  ! HSSBrTrq
  Re_BufSz   = Re_BufSz   + 1  ! HSSBrTrqC
  IF ( ALLOCATED(InData%OgnlGeAzRo) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OgnlGeAzRo )  ! OgnlGeAzRo 
  Int_BufSz  = Int_BufSz  + 1  ! SgnPrvLSTQ
  Int_BufSz   = Int_BufSz   + SIZE( InData%SgnLSTQ )  ! SgnLSTQ 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, InData%CoordSys, ErrStat, ErrMsg, OnlySize ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_CoordSys_Buf)-1 ) = Re_CoordSys_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Db_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_CoordSys_Buf)-1 ) = Db_CoordSys_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Int_CoordSys_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_CoordSys_Buf)-1 ) = Int_CoordSys_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_CoordSys_Buf)
  ENDIF
  IF( ALLOCATED(Re_CoordSys_Buf) )  DEALLOCATE(Re_CoordSys_Buf)
  IF( ALLOCATED(Db_CoordSys_Buf) )  DEALLOCATE(Db_CoordSys_Buf)
  IF( ALLOCATED(Int_CoordSys_Buf) ) DEALLOCATE(Int_CoordSys_Buf)
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, InData%RtHS, ErrStat, ErrMsg, OnlySize ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RtHS_Buf)-1 ) = Re_RtHS_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Db_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RtHS_Buf)-1 ) = Db_RtHS_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Int_RtHS_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RtHS_Buf)-1 ) = Int_RtHS_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RtHS_Buf)
  ENDIF
  IF( ALLOCATED(Re_RtHS_Buf) )  DEALLOCATE(Re_RtHS_Buf)
  IF( ALLOCATED(Db_RtHS_Buf) )  DEALLOCATE(Db_RtHS_Buf)
  IF( ALLOCATED(Int_RtHS_Buf) ) DEALLOCATE(Int_RtHS_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%n )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(InData%xdot,1), UBOUND(InData%xdot,1)
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, InData%xdot(i1), ErrStat, ErrMsg, OnlySize ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xdot_Buf)-1 ) = Re_xdot_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Db_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xdot_Buf)-1 ) = Db_xdot_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Int_xdot_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xdot_Buf)-1 ) = Int_xdot_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_xdot_Buf)
  ENDIF
  IF( ALLOCATED(Re_xdot_Buf) )  DEALLOCATE(Re_xdot_Buf)
  IF( ALLOCATED(Db_xdot_Buf) )  DEALLOCATE(Db_xdot_Buf)
  IF( ALLOCATED(Int_xdot_Buf) ) DEALLOCATE(Int_xdot_Buf)
ENDDO
  IF ( ALLOCATED(InData%IC) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%IC))-1 ) = PACK(InData%IC ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%IC)
  ENDIF
  IF ( ALLOCATED(InData%QD2T) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QD2T))-1 ) =  PACK(InData%QD2T ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QD2T)
  ENDIF
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( ALLOCATED(InData%AugMat) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AugMat))-1 ) =  PACK(InData%AugMat ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AugMat)
  ENDIF
  IF ( ALLOCATED(InData%AugMat_factor) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AugMat_factor))-1 ) =  PACK(InData%AugMat_factor ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AugMat_factor)
  ENDIF
  IF ( ALLOCATED(InData%SolnVec) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SolnVec))-1 ) =  PACK(InData%SolnVec ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SolnVec)
  ENDIF
  IF ( ALLOCATED(InData%AugMat_pivot) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%AugMat_pivot))-1 ) = PACK(InData%AugMat_pivot ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%AugMat_pivot)
  ENDIF
  IF ( ALLOCATED(InData%AllOuts) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AllOuts))-1 ) =  PACK(InData%AllOuts ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AllOuts)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSSBrTrq )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSSBrTrqC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%OgnlGeAzRo) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OgnlGeAzRo))-1 ) =  PACK(InData%OgnlGeAzRo ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OgnlGeAzRo)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%SgnPrvLSTQ )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%SgnLSTQ))-1 ) = PACK(InData%SgnLSTQ ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%SgnLSTQ)
 END SUBROUTINE ED_PackOtherState

 SUBROUTINE ED_UnPackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_OtherStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_CoordSys_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_CoordSys_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_CoordSys_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RtHS_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RtHS_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RtHS_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_xdot_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_xdot_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_xdot_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call ED_Packcoordsys to get correctly sized buffers for unpacking
  CALL ED_Packcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, OutData%CoordSys, ErrStat, ErrMsg, .TRUE. ) ! CoordSys 
  IF(ALLOCATED(Re_CoordSys_Buf)) THEN
    Re_CoordSys_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_CoordSys_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Db_CoordSys_Buf)) THEN
    Db_CoordSys_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_CoordSys_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_CoordSys_Buf)
  ENDIF
  IF(ALLOCATED(Int_CoordSys_Buf)) THEN
    Int_CoordSys_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_CoordSys_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_CoordSys_Buf)
  ENDIF
  CALL ED_UnPackcoordsys( Re_CoordSys_Buf, Db_CoordSys_Buf, Int_CoordSys_Buf, OutData%CoordSys, ErrStat, ErrMsg ) ! CoordSys 
 ! first call ED_Packrthndside to get correctly sized buffers for unpacking
  CALL ED_Packrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, OutData%RtHS, ErrStat, ErrMsg, .TRUE. ) ! RtHS 
  IF(ALLOCATED(Re_RtHS_Buf)) THEN
    Re_RtHS_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RtHS_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Db_RtHS_Buf)) THEN
    Db_RtHS_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RtHS_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RtHS_Buf)
  ENDIF
  IF(ALLOCATED(Int_RtHS_Buf)) THEN
    Int_RtHS_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RtHS_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RtHS_Buf)
  ENDIF
  CALL ED_UnPackrthndside( Re_RtHS_Buf, Db_RtHS_Buf, Int_RtHS_Buf, OutData%RtHS, ErrStat, ErrMsg ) ! RtHS 
  OutData%n = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(OutData%xdot,1), UBOUND(OutData%xdot,1)
 ! first call ED_PackContState to get correctly sized buffers for unpacking
  CALL ED_PackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, OutData%xdot(i1), ErrStat, ErrMsg, .TRUE. ) ! xdot 
  IF(ALLOCATED(Re_xdot_Buf)) THEN
    Re_xdot_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_xdot_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Db_xdot_Buf)) THEN
    Db_xdot_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_xdot_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_xdot_Buf)
  ENDIF
  IF(ALLOCATED(Int_xdot_Buf)) THEN
    Int_xdot_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_xdot_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_xdot_Buf)
  ENDIF
  CALL ED_UnPackContState( Re_xdot_Buf, Db_xdot_Buf, Int_xdot_Buf, OutData%xdot(i1), ErrStat, ErrMsg ) ! xdot 
ENDDO
  IF ( ALLOCATED(OutData%IC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%IC,1)))
  mask1 = .TRUE.
    OutData%IC = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%IC))-1 ),mask1,OutData%IC)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%IC)
  ENDIF
  IF ( ALLOCATED(OutData%QD2T) ) THEN
  ALLOCATE(mask1(SIZE(OutData%QD2T,1)))
  mask1 = .TRUE.
    OutData%QD2T = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QD2T))-1 ),mask1,OutData%QD2T)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QD2T)
  ENDIF
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1)))
  mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  IF ( ALLOCATED(OutData%AugMat) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AugMat,1),SIZE(OutData%AugMat,2)))
  mask2 = .TRUE.
    OutData%AugMat = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AugMat))-1 ),mask2,OutData%AugMat)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AugMat)
  ENDIF
  IF ( ALLOCATED(OutData%AugMat_factor) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AugMat_factor,1),SIZE(OutData%AugMat_factor,2)))
  mask2 = .TRUE.
    OutData%AugMat_factor = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AugMat_factor))-1 ),mask2,OutData%AugMat_factor)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AugMat_factor)
  ENDIF
  IF ( ALLOCATED(OutData%SolnVec) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SolnVec,1)))
  mask1 = .TRUE.
    OutData%SolnVec = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SolnVec))-1 ),mask1,OutData%SolnVec)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SolnVec)
  ENDIF
  IF ( ALLOCATED(OutData%AugMat_pivot) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AugMat_pivot,1)))
  mask1 = .TRUE.
    OutData%AugMat_pivot = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%AugMat_pivot))-1 ),mask1,OutData%AugMat_pivot)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%AugMat_pivot)
  ENDIF
  IF ( ALLOCATED(OutData%AllOuts) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AllOuts,1)))
  mask1 = .TRUE.
    OutData%AllOuts = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AllOuts))-1 ),mask1,OutData%AllOuts)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AllOuts)
  ENDIF
  OutData%HSSBrTrq = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HSSBrTrqC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%OgnlGeAzRo) ) THEN
  ALLOCATE(mask1(SIZE(OutData%OgnlGeAzRo,1)))
  mask1 = .TRUE.
    OutData%OgnlGeAzRo = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OgnlGeAzRo))-1 ),mask1,OutData%OgnlGeAzRo)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OgnlGeAzRo)
  ENDIF
  OutData%SgnPrvLSTQ = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%SgnLSTQ,1)))
  mask1 = .TRUE.
  OutData%SgnLSTQ = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%SgnLSTQ))-1 ),mask1,OutData%SgnLSTQ)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%SgnLSTQ)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackOtherState

 SUBROUTINE ED_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_ParameterType), INTENT(IN) :: SrcParamData
   TYPE(ED_ParameterType), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: i4, i4_l, i4_u  !  bounds (upper/lower) for an array dimension 4
   INTEGER(IntKi)                 :: i5, i5_l, i5_u  !  bounds (upper/lower) for an array dimension 5
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%DT = SrcParamData%DT
   DstParamData%DT24 = SrcParamData%DT24
   DstParamData%BldNodes = SrcParamData%BldNodes
   DstParamData%TipNode = SrcParamData%TipNode
   DstParamData%NDOF = SrcParamData%NDOF
   DstParamData%TwoPiNB = SrcParamData%TwoPiNB
   DstParamData%NAug = SrcParamData%NAug
   DstParamData%NPH = SrcParamData%NPH
IF (ALLOCATED(SrcParamData%PH)) THEN
   i1_l = LBOUND(SrcParamData%PH,1)
   i1_u = UBOUND(SrcParamData%PH,1)
   IF (.NOT. ALLOCATED(DstParamData%PH)) THEN 
      ALLOCATE(DstParamData%PH(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%PH.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%PH = SrcParamData%PH
ENDIF
   DstParamData%NPM = SrcParamData%NPM
IF (ALLOCATED(SrcParamData%PM)) THEN
   i1_l = LBOUND(SrcParamData%PM,1)
   i1_u = UBOUND(SrcParamData%PM,1)
   i2_l = LBOUND(SrcParamData%PM,2)
   i2_u = UBOUND(SrcParamData%PM,2)
   IF (.NOT. ALLOCATED(DstParamData%PM)) THEN 
      ALLOCATE(DstParamData%PM(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%PM.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%PM = SrcParamData%PM
ENDIF
IF (ALLOCATED(SrcParamData%DOF_Flag)) THEN
   i1_l = LBOUND(SrcParamData%DOF_Flag,1)
   i1_u = UBOUND(SrcParamData%DOF_Flag,1)
   IF (.NOT. ALLOCATED(DstParamData%DOF_Flag)) THEN 
      ALLOCATE(DstParamData%DOF_Flag(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%DOF_Flag.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%DOF_Flag = SrcParamData%DOF_Flag
ENDIF
IF (ALLOCATED(SrcParamData%DOF_Desc)) THEN
   i1_l = LBOUND(SrcParamData%DOF_Desc,1)
   i1_u = UBOUND(SrcParamData%DOF_Desc,1)
   IF (.NOT. ALLOCATED(DstParamData%DOF_Desc)) THEN 
      ALLOCATE(DstParamData%DOF_Desc(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%DOF_Desc.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%DOF_Desc = SrcParamData%DOF_Desc
ENDIF
      CALL ED_Copyactivedofs( SrcParamData%DOFs, DstParamData%DOFs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyParam:DOFs')
         IF (ErrStat>=AbortErrLev) RETURN
   DstParamData%NumOuts = SrcParamData%NumOuts
   DstParamData%OutFmt = SrcParamData%OutFmt
   DstParamData%NBlGages = SrcParamData%NBlGages
   DstParamData%NTwGages = SrcParamData%NTwGages
IF (ALLOCATED(SrcParamData%OutParam)) THEN
   i1_l = LBOUND(SrcParamData%OutParam,1)
   i1_u = UBOUND(SrcParamData%OutParam,1)
   IF (.NOT. ALLOCATED(DstParamData%OutParam)) THEN 
      ALLOCATE(DstParamData%OutParam(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%OutParam.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcParamData%OutParam,1), UBOUND(SrcParamData%OutParam,1)
      CALL NWTC_Library_Copyoutparmtype( SrcParamData%OutParam(i1), DstParamData%OutParam(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyParam:OutParam(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
   DstParamData%Delim = SrcParamData%Delim
   DstParamData%AvgNrmTpRd = SrcParamData%AvgNrmTpRd
   DstParamData%AzimB1Up = SrcParamData%AzimB1Up
   DstParamData%CosDel3 = SrcParamData%CosDel3
IF (ALLOCATED(SrcParamData%CosPreC)) THEN
   i1_l = LBOUND(SrcParamData%CosPreC,1)
   i1_u = UBOUND(SrcParamData%CosPreC,1)
   IF (.NOT. ALLOCATED(DstParamData%CosPreC)) THEN 
      ALLOCATE(DstParamData%CosPreC(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%CosPreC.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%CosPreC = SrcParamData%CosPreC
ENDIF
   DstParamData%CRFrlSkew = SrcParamData%CRFrlSkew
   DstParamData%CRFrlSkw2 = SrcParamData%CRFrlSkw2
   DstParamData%CRFrlTilt = SrcParamData%CRFrlTilt
   DstParamData%CRFrlTlt2 = SrcParamData%CRFrlTlt2
   DstParamData%CShftSkew = SrcParamData%CShftSkew
   DstParamData%CShftTilt = SrcParamData%CShftTilt
   DstParamData%CSRFrlSkw = SrcParamData%CSRFrlSkw
   DstParamData%CSRFrlTlt = SrcParamData%CSRFrlTlt
   DstParamData%CSTFrlSkw = SrcParamData%CSTFrlSkw
   DstParamData%CSTFrlTlt = SrcParamData%CSTFrlTlt
   DstParamData%CTFinBank = SrcParamData%CTFinBank
   DstParamData%CTFinSkew = SrcParamData%CTFinSkew
   DstParamData%CTFinTilt = SrcParamData%CTFinTilt
   DstParamData%CTFrlSkew = SrcParamData%CTFrlSkew
   DstParamData%CTFrlSkw2 = SrcParamData%CTFrlSkw2
   DstParamData%CTFrlTilt = SrcParamData%CTFrlTilt
   DstParamData%CTFrlTlt2 = SrcParamData%CTFrlTlt2
   DstParamData%HubHt = SrcParamData%HubHt
   DstParamData%HubCM = SrcParamData%HubCM
   DstParamData%HubRad = SrcParamData%HubRad
   DstParamData%NacCMxn = SrcParamData%NacCMxn
   DstParamData%NacCMyn = SrcParamData%NacCMyn
   DstParamData%NacCMzn = SrcParamData%NacCMzn
   DstParamData%OverHang = SrcParamData%OverHang
   DstParamData%ProjArea = SrcParamData%ProjArea
   DstParamData%PtfmRefzt = SrcParamData%PtfmRefzt
   DstParamData%RefTwrHt = SrcParamData%RefTwrHt
   DstParamData%RFrlPntxn = SrcParamData%RFrlPntxn
   DstParamData%RFrlPntyn = SrcParamData%RFrlPntyn
   DstParamData%RFrlPntzn = SrcParamData%RFrlPntzn
   DstParamData%rVDxn = SrcParamData%rVDxn
   DstParamData%rVDyn = SrcParamData%rVDyn
   DstParamData%rVDzn = SrcParamData%rVDzn
   DstParamData%rVIMUxn = SrcParamData%rVIMUxn
   DstParamData%rVIMUyn = SrcParamData%rVIMUyn
   DstParamData%rVIMUzn = SrcParamData%rVIMUzn
   DstParamData%rVPxn = SrcParamData%rVPxn
   DstParamData%rVPyn = SrcParamData%rVPyn
   DstParamData%rVPzn = SrcParamData%rVPzn
   DstParamData%rWIxn = SrcParamData%rWIxn
   DstParamData%rWIyn = SrcParamData%rWIyn
   DstParamData%rWIzn = SrcParamData%rWIzn
   DstParamData%rWJxn = SrcParamData%rWJxn
   DstParamData%rWJyn = SrcParamData%rWJyn
   DstParamData%rWJzn = SrcParamData%rWJzn
   DstParamData%rWKxn = SrcParamData%rWKxn
   DstParamData%rWKyn = SrcParamData%rWKyn
   DstParamData%rWKzn = SrcParamData%rWKzn
   DstParamData%rZT0zt = SrcParamData%rZT0zt
   DstParamData%rZYzt = SrcParamData%rZYzt
   DstParamData%SinDel3 = SrcParamData%SinDel3
IF (ALLOCATED(SrcParamData%SinPreC)) THEN
   i1_l = LBOUND(SrcParamData%SinPreC,1)
   i1_u = UBOUND(SrcParamData%SinPreC,1)
   IF (.NOT. ALLOCATED(DstParamData%SinPreC)) THEN 
      ALLOCATE(DstParamData%SinPreC(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%SinPreC.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%SinPreC = SrcParamData%SinPreC
ENDIF
   DstParamData%SRFrlSkew = SrcParamData%SRFrlSkew
   DstParamData%SRFrlSkw2 = SrcParamData%SRFrlSkw2
   DstParamData%SRFrlTilt = SrcParamData%SRFrlTilt
   DstParamData%SRFrlTlt2 = SrcParamData%SRFrlTlt2
   DstParamData%SShftSkew = SrcParamData%SShftSkew
   DstParamData%SShftTilt = SrcParamData%SShftTilt
   DstParamData%STFinBank = SrcParamData%STFinBank
   DstParamData%STFinSkew = SrcParamData%STFinSkew
   DstParamData%STFinTilt = SrcParamData%STFinTilt
   DstParamData%STFrlSkew = SrcParamData%STFrlSkew
   DstParamData%STFrlSkw2 = SrcParamData%STFrlSkw2
   DstParamData%STFrlTilt = SrcParamData%STFrlTilt
   DstParamData%STFrlTlt2 = SrcParamData%STFrlTlt2
   DstParamData%TFrlPntxn = SrcParamData%TFrlPntxn
   DstParamData%TFrlPntyn = SrcParamData%TFrlPntyn
   DstParamData%TFrlPntzn = SrcParamData%TFrlPntzn
   DstParamData%TipRad = SrcParamData%TipRad
   DstParamData%TowerHt = SrcParamData%TowerHt
   DstParamData%TowerBsHt = SrcParamData%TowerBsHt
   DstParamData%UndSling = SrcParamData%UndSling
   DstParamData%NumBl = SrcParamData%NumBl
IF (ALLOCATED(SrcParamData%AxRedTFA)) THEN
   i1_l = LBOUND(SrcParamData%AxRedTFA,1)
   i1_u = UBOUND(SrcParamData%AxRedTFA,1)
   i2_l = LBOUND(SrcParamData%AxRedTFA,2)
   i2_u = UBOUND(SrcParamData%AxRedTFA,2)
   i3_l = LBOUND(SrcParamData%AxRedTFA,3)
   i3_u = UBOUND(SrcParamData%AxRedTFA,3)
   IF (.NOT. ALLOCATED(DstParamData%AxRedTFA)) THEN 
      ALLOCATE(DstParamData%AxRedTFA(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%AxRedTFA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%AxRedTFA = SrcParamData%AxRedTFA
ENDIF
IF (ALLOCATED(SrcParamData%AxRedTSS)) THEN
   i1_l = LBOUND(SrcParamData%AxRedTSS,1)
   i1_u = UBOUND(SrcParamData%AxRedTSS,1)
   i2_l = LBOUND(SrcParamData%AxRedTSS,2)
   i2_u = UBOUND(SrcParamData%AxRedTSS,2)
   i3_l = LBOUND(SrcParamData%AxRedTSS,3)
   i3_u = UBOUND(SrcParamData%AxRedTSS,3)
   IF (.NOT. ALLOCATED(DstParamData%AxRedTSS)) THEN 
      ALLOCATE(DstParamData%AxRedTSS(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%AxRedTSS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%AxRedTSS = SrcParamData%AxRedTSS
ENDIF
   DstParamData%CTFA = SrcParamData%CTFA
   DstParamData%CTSS = SrcParamData%CTSS
IF (ALLOCATED(SrcParamData%DHNodes)) THEN
   i1_l = LBOUND(SrcParamData%DHNodes,1)
   i1_u = UBOUND(SrcParamData%DHNodes,1)
   IF (.NOT. ALLOCATED(DstParamData%DHNodes)) THEN 
      ALLOCATE(DstParamData%DHNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%DHNodes.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%DHNodes = SrcParamData%DHNodes
ENDIF
IF (ALLOCATED(SrcParamData%HNodes)) THEN
   i1_l = LBOUND(SrcParamData%HNodes,1)
   i1_u = UBOUND(SrcParamData%HNodes,1)
   IF (.NOT. ALLOCATED(DstParamData%HNodes)) THEN 
      ALLOCATE(DstParamData%HNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%HNodes.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%HNodes = SrcParamData%HNodes
ENDIF
IF (ALLOCATED(SrcParamData%HNodesNorm)) THEN
   i1_l = LBOUND(SrcParamData%HNodesNorm,1)
   i1_u = UBOUND(SrcParamData%HNodesNorm,1)
   IF (.NOT. ALLOCATED(DstParamData%HNodesNorm)) THEN 
      ALLOCATE(DstParamData%HNodesNorm(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%HNodesNorm.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%HNodesNorm = SrcParamData%HNodesNorm
ENDIF
   DstParamData%KTFA = SrcParamData%KTFA
   DstParamData%KTSS = SrcParamData%KTSS
IF (ALLOCATED(SrcParamData%MassT)) THEN
   i1_l = LBOUND(SrcParamData%MassT,1)
   i1_u = UBOUND(SrcParamData%MassT,1)
   IF (.NOT. ALLOCATED(DstParamData%MassT)) THEN 
      ALLOCATE(DstParamData%MassT(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%MassT.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%MassT = SrcParamData%MassT
ENDIF
IF (ALLOCATED(SrcParamData%StiffTSS)) THEN
   i1_l = LBOUND(SrcParamData%StiffTSS,1)
   i1_u = UBOUND(SrcParamData%StiffTSS,1)
   IF (.NOT. ALLOCATED(DstParamData%StiffTSS)) THEN 
      ALLOCATE(DstParamData%StiffTSS(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffTSS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffTSS = SrcParamData%StiffTSS
ENDIF
IF (ALLOCATED(SrcParamData%TwrFASF)) THEN
   i1_l = LBOUND(SrcParamData%TwrFASF,1)
   i1_u = UBOUND(SrcParamData%TwrFASF,1)
   i2_l = LBOUND(SrcParamData%TwrFASF,2)
   i2_u = UBOUND(SrcParamData%TwrFASF,2)
   i3_l = LBOUND(SrcParamData%TwrFASF,3)
   i3_u = UBOUND(SrcParamData%TwrFASF,3)
   IF (.NOT. ALLOCATED(DstParamData%TwrFASF)) THEN 
      ALLOCATE(DstParamData%TwrFASF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%TwrFASF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%TwrFASF = SrcParamData%TwrFASF
ENDIF
   DstParamData%TwrFlexL = SrcParamData%TwrFlexL
IF (ALLOCATED(SrcParamData%TwrSSSF)) THEN
   i1_l = LBOUND(SrcParamData%TwrSSSF,1)
   i1_u = UBOUND(SrcParamData%TwrSSSF,1)
   i2_l = LBOUND(SrcParamData%TwrSSSF,2)
   i2_u = UBOUND(SrcParamData%TwrSSSF,2)
   i3_l = LBOUND(SrcParamData%TwrSSSF,3)
   i3_u = UBOUND(SrcParamData%TwrSSSF,3)
   IF (.NOT. ALLOCATED(DstParamData%TwrSSSF)) THEN 
      ALLOCATE(DstParamData%TwrSSSF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%TwrSSSF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%TwrSSSF = SrcParamData%TwrSSSF
ENDIF
   DstParamData%TTopNode = SrcParamData%TTopNode
   DstParamData%TwrNodes = SrcParamData%TwrNodes
IF (ALLOCATED(SrcParamData%InerTFA)) THEN
   i1_l = LBOUND(SrcParamData%InerTFA,1)
   i1_u = UBOUND(SrcParamData%InerTFA,1)
   IF (.NOT. ALLOCATED(DstParamData%InerTFA)) THEN 
      ALLOCATE(DstParamData%InerTFA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%InerTFA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%InerTFA = SrcParamData%InerTFA
ENDIF
IF (ALLOCATED(SrcParamData%InerTSS)) THEN
   i1_l = LBOUND(SrcParamData%InerTSS,1)
   i1_u = UBOUND(SrcParamData%InerTSS,1)
   IF (.NOT. ALLOCATED(DstParamData%InerTSS)) THEN 
      ALLOCATE(DstParamData%InerTSS(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%InerTSS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%InerTSS = SrcParamData%InerTSS
ENDIF
IF (ALLOCATED(SrcParamData%StiffTGJ)) THEN
   i1_l = LBOUND(SrcParamData%StiffTGJ,1)
   i1_u = UBOUND(SrcParamData%StiffTGJ,1)
   IF (.NOT. ALLOCATED(DstParamData%StiffTGJ)) THEN 
      ALLOCATE(DstParamData%StiffTGJ(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffTGJ.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffTGJ = SrcParamData%StiffTGJ
ENDIF
IF (ALLOCATED(SrcParamData%StiffTEA)) THEN
   i1_l = LBOUND(SrcParamData%StiffTEA,1)
   i1_u = UBOUND(SrcParamData%StiffTEA,1)
   IF (.NOT. ALLOCATED(DstParamData%StiffTEA)) THEN 
      ALLOCATE(DstParamData%StiffTEA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffTEA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffTEA = SrcParamData%StiffTEA
ENDIF
IF (ALLOCATED(SrcParamData%StiffTFA)) THEN
   i1_l = LBOUND(SrcParamData%StiffTFA,1)
   i1_u = UBOUND(SrcParamData%StiffTFA,1)
   IF (.NOT. ALLOCATED(DstParamData%StiffTFA)) THEN 
      ALLOCATE(DstParamData%StiffTFA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffTFA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffTFA = SrcParamData%StiffTFA
ENDIF
IF (ALLOCATED(SrcParamData%cgOffTFA)) THEN
   i1_l = LBOUND(SrcParamData%cgOffTFA,1)
   i1_u = UBOUND(SrcParamData%cgOffTFA,1)
   IF (.NOT. ALLOCATED(DstParamData%cgOffTFA)) THEN 
      ALLOCATE(DstParamData%cgOffTFA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%cgOffTFA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%cgOffTFA = SrcParamData%cgOffTFA
ENDIF
IF (ALLOCATED(SrcParamData%cgOffTSS)) THEN
   i1_l = LBOUND(SrcParamData%cgOffTSS,1)
   i1_u = UBOUND(SrcParamData%cgOffTSS,1)
   IF (.NOT. ALLOCATED(DstParamData%cgOffTSS)) THEN 
      ALLOCATE(DstParamData%cgOffTSS(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%cgOffTSS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%cgOffTSS = SrcParamData%cgOffTSS
ENDIF
   DstParamData%AtfaIner = SrcParamData%AtfaIner
IF (ALLOCATED(SrcParamData%BldCG)) THEN
   i1_l = LBOUND(SrcParamData%BldCG,1)
   i1_u = UBOUND(SrcParamData%BldCG,1)
   IF (.NOT. ALLOCATED(DstParamData%BldCG)) THEN 
      ALLOCATE(DstParamData%BldCG(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldCG.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldCG = SrcParamData%BldCG
ENDIF
IF (ALLOCATED(SrcParamData%BldMass)) THEN
   i1_l = LBOUND(SrcParamData%BldMass,1)
   i1_u = UBOUND(SrcParamData%BldMass,1)
   IF (.NOT. ALLOCATED(DstParamData%BldMass)) THEN 
      ALLOCATE(DstParamData%BldMass(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldMass.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldMass = SrcParamData%BldMass
ENDIF
   DstParamData%BoomMass = SrcParamData%BoomMass
IF (ALLOCATED(SrcParamData%FirstMom)) THEN
   i1_l = LBOUND(SrcParamData%FirstMom,1)
   i1_u = UBOUND(SrcParamData%FirstMom,1)
   IF (.NOT. ALLOCATED(DstParamData%FirstMom)) THEN 
      ALLOCATE(DstParamData%FirstMom(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%FirstMom.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%FirstMom = SrcParamData%FirstMom
ENDIF
   DstParamData%GenIner = SrcParamData%GenIner
   DstParamData%Hubg1Iner = SrcParamData%Hubg1Iner
   DstParamData%Hubg2Iner = SrcParamData%Hubg2Iner
   DstParamData%HubMass = SrcParamData%HubMass
   DstParamData%Nacd2Iner = SrcParamData%Nacd2Iner
   DstParamData%NacMass = SrcParamData%NacMass
   DstParamData%PtfmMass = SrcParamData%PtfmMass
   DstParamData%PtfmPIner = SrcParamData%PtfmPIner
   DstParamData%PtfmRIner = SrcParamData%PtfmRIner
   DstParamData%PtfmYIner = SrcParamData%PtfmYIner
   DstParamData%RFrlMass = SrcParamData%RFrlMass
   DstParamData%RotIner = SrcParamData%RotIner
   DstParamData%RotMass = SrcParamData%RotMass
   DstParamData%RrfaIner = SrcParamData%RrfaIner
IF (ALLOCATED(SrcParamData%SecondMom)) THEN
   i1_l = LBOUND(SrcParamData%SecondMom,1)
   i1_u = UBOUND(SrcParamData%SecondMom,1)
   IF (.NOT. ALLOCATED(DstParamData%SecondMom)) THEN 
      ALLOCATE(DstParamData%SecondMom(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%SecondMom.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%SecondMom = SrcParamData%SecondMom
ENDIF
   DstParamData%TFinMass = SrcParamData%TFinMass
   DstParamData%TFrlIner = SrcParamData%TFrlIner
IF (ALLOCATED(SrcParamData%TipMass)) THEN
   i1_l = LBOUND(SrcParamData%TipMass,1)
   i1_u = UBOUND(SrcParamData%TipMass,1)
   IF (.NOT. ALLOCATED(DstParamData%TipMass)) THEN 
      ALLOCATE(DstParamData%TipMass(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%TipMass.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%TipMass = SrcParamData%TipMass
ENDIF
   DstParamData%TurbMass = SrcParamData%TurbMass
   DstParamData%TwrMass = SrcParamData%TwrMass
   DstParamData%TwrTpMass = SrcParamData%TwrTpMass
   DstParamData%YawBrMass = SrcParamData%YawBrMass
   DstParamData%Gravity = SrcParamData%Gravity
IF (ALLOCATED(SrcParamData%PitchAxis)) THEN
   i1_l = LBOUND(SrcParamData%PitchAxis,1)
   i1_u = UBOUND(SrcParamData%PitchAxis,1)
   i2_l = LBOUND(SrcParamData%PitchAxis,2)
   i2_u = UBOUND(SrcParamData%PitchAxis,2)
   IF (.NOT. ALLOCATED(DstParamData%PitchAxis)) THEN 
      ALLOCATE(DstParamData%PitchAxis(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%PitchAxis.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%PitchAxis = SrcParamData%PitchAxis
ENDIF
IF (ALLOCATED(SrcParamData%AeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%AeroTwst,1)
   i1_u = UBOUND(SrcParamData%AeroTwst,1)
   IF (.NOT. ALLOCATED(DstParamData%AeroTwst)) THEN 
      ALLOCATE(DstParamData%AeroTwst(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%AeroTwst.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%AeroTwst = SrcParamData%AeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%AxRedBld)) THEN
   i1_l = LBOUND(SrcParamData%AxRedBld,1)
   i1_u = UBOUND(SrcParamData%AxRedBld,1)
   i2_l = LBOUND(SrcParamData%AxRedBld,2)
   i2_u = UBOUND(SrcParamData%AxRedBld,2)
   i3_l = LBOUND(SrcParamData%AxRedBld,3)
   i3_u = UBOUND(SrcParamData%AxRedBld,3)
   i4_l = LBOUND(SrcParamData%AxRedBld,4)
   i4_u = UBOUND(SrcParamData%AxRedBld,4)
   IF (.NOT. ALLOCATED(DstParamData%AxRedBld)) THEN 
      ALLOCATE(DstParamData%AxRedBld(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%AxRedBld.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%AxRedBld = SrcParamData%AxRedBld
ENDIF
IF (ALLOCATED(SrcParamData%BAlpha)) THEN
   i1_l = LBOUND(SrcParamData%BAlpha,1)
   i1_u = UBOUND(SrcParamData%BAlpha,1)
   i2_l = LBOUND(SrcParamData%BAlpha,2)
   i2_u = UBOUND(SrcParamData%BAlpha,2)
   IF (.NOT. ALLOCATED(DstParamData%BAlpha)) THEN 
      ALLOCATE(DstParamData%BAlpha(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BAlpha.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BAlpha = SrcParamData%BAlpha
ENDIF
IF (ALLOCATED(SrcParamData%BldEDamp)) THEN
   i1_l = LBOUND(SrcParamData%BldEDamp,1)
   i1_u = UBOUND(SrcParamData%BldEDamp,1)
   i2_l = LBOUND(SrcParamData%BldEDamp,2)
   i2_u = UBOUND(SrcParamData%BldEDamp,2)
   IF (.NOT. ALLOCATED(DstParamData%BldEDamp)) THEN 
      ALLOCATE(DstParamData%BldEDamp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldEDamp.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldEDamp = SrcParamData%BldEDamp
ENDIF
IF (ALLOCATED(SrcParamData%BldFDamp)) THEN
   i1_l = LBOUND(SrcParamData%BldFDamp,1)
   i1_u = UBOUND(SrcParamData%BldFDamp,1)
   i2_l = LBOUND(SrcParamData%BldFDamp,2)
   i2_u = UBOUND(SrcParamData%BldFDamp,2)
   IF (.NOT. ALLOCATED(DstParamData%BldFDamp)) THEN 
      ALLOCATE(DstParamData%BldFDamp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldFDamp.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldFDamp = SrcParamData%BldFDamp
ENDIF
   DstParamData%BldFlexL = SrcParamData%BldFlexL
IF (ALLOCATED(SrcParamData%CAeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%CAeroTwst,1)
   i1_u = UBOUND(SrcParamData%CAeroTwst,1)
   IF (.NOT. ALLOCATED(DstParamData%CAeroTwst)) THEN 
      ALLOCATE(DstParamData%CAeroTwst(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%CAeroTwst.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%CAeroTwst = SrcParamData%CAeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%CBE)) THEN
   i1_l = LBOUND(SrcParamData%CBE,1)
   i1_u = UBOUND(SrcParamData%CBE,1)
   i2_l = LBOUND(SrcParamData%CBE,2)
   i2_u = UBOUND(SrcParamData%CBE,2)
   i3_l = LBOUND(SrcParamData%CBE,3)
   i3_u = UBOUND(SrcParamData%CBE,3)
   IF (.NOT. ALLOCATED(DstParamData%CBE)) THEN 
      ALLOCATE(DstParamData%CBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%CBE.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%CBE = SrcParamData%CBE
ENDIF
IF (ALLOCATED(SrcParamData%CBF)) THEN
   i1_l = LBOUND(SrcParamData%CBF,1)
   i1_u = UBOUND(SrcParamData%CBF,1)
   i2_l = LBOUND(SrcParamData%CBF,2)
   i2_u = UBOUND(SrcParamData%CBF,2)
   i3_l = LBOUND(SrcParamData%CBF,3)
   i3_u = UBOUND(SrcParamData%CBF,3)
   IF (.NOT. ALLOCATED(DstParamData%CBF)) THEN 
      ALLOCATE(DstParamData%CBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%CBF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%CBF = SrcParamData%CBF
ENDIF
IF (ALLOCATED(SrcParamData%cgOffBEdg)) THEN
   i1_l = LBOUND(SrcParamData%cgOffBEdg,1)
   i1_u = UBOUND(SrcParamData%cgOffBEdg,1)
   i2_l = LBOUND(SrcParamData%cgOffBEdg,2)
   i2_u = UBOUND(SrcParamData%cgOffBEdg,2)
   IF (.NOT. ALLOCATED(DstParamData%cgOffBEdg)) THEN 
      ALLOCATE(DstParamData%cgOffBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%cgOffBEdg.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%cgOffBEdg = SrcParamData%cgOffBEdg
ENDIF
IF (ALLOCATED(SrcParamData%cgOffBFlp)) THEN
   i1_l = LBOUND(SrcParamData%cgOffBFlp,1)
   i1_u = UBOUND(SrcParamData%cgOffBFlp,1)
   i2_l = LBOUND(SrcParamData%cgOffBFlp,2)
   i2_u = UBOUND(SrcParamData%cgOffBFlp,2)
   IF (.NOT. ALLOCATED(DstParamData%cgOffBFlp)) THEN 
      ALLOCATE(DstParamData%cgOffBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%cgOffBFlp.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%cgOffBFlp = SrcParamData%cgOffBFlp
ENDIF
IF (ALLOCATED(SrcParamData%Chord)) THEN
   i1_l = LBOUND(SrcParamData%Chord,1)
   i1_u = UBOUND(SrcParamData%Chord,1)
   IF (.NOT. ALLOCATED(DstParamData%Chord)) THEN 
      ALLOCATE(DstParamData%Chord(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%Chord.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%Chord = SrcParamData%Chord
ENDIF
IF (ALLOCATED(SrcParamData%CThetaS)) THEN
   i1_l = LBOUND(SrcParamData%CThetaS,1)
   i1_u = UBOUND(SrcParamData%CThetaS,1)
   i2_l = LBOUND(SrcParamData%CThetaS,2)
   i2_u = UBOUND(SrcParamData%CThetaS,2)
   IF (.NOT. ALLOCATED(DstParamData%CThetaS)) THEN 
      ALLOCATE(DstParamData%CThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%CThetaS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%CThetaS = SrcParamData%CThetaS
ENDIF
IF (ALLOCATED(SrcParamData%DRNodes)) THEN
   i1_l = LBOUND(SrcParamData%DRNodes,1)
   i1_u = UBOUND(SrcParamData%DRNodes,1)
   IF (.NOT. ALLOCATED(DstParamData%DRNodes)) THEN 
      ALLOCATE(DstParamData%DRNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%DRNodes.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%DRNodes = SrcParamData%DRNodes
ENDIF
IF (ALLOCATED(SrcParamData%EAOffBEdg)) THEN
   i1_l = LBOUND(SrcParamData%EAOffBEdg,1)
   i1_u = UBOUND(SrcParamData%EAOffBEdg,1)
   i2_l = LBOUND(SrcParamData%EAOffBEdg,2)
   i2_u = UBOUND(SrcParamData%EAOffBEdg,2)
   IF (.NOT. ALLOCATED(DstParamData%EAOffBEdg)) THEN 
      ALLOCATE(DstParamData%EAOffBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%EAOffBEdg.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%EAOffBEdg = SrcParamData%EAOffBEdg
ENDIF
IF (ALLOCATED(SrcParamData%EAOffBFlp)) THEN
   i1_l = LBOUND(SrcParamData%EAOffBFlp,1)
   i1_u = UBOUND(SrcParamData%EAOffBFlp,1)
   i2_l = LBOUND(SrcParamData%EAOffBFlp,2)
   i2_u = UBOUND(SrcParamData%EAOffBFlp,2)
   IF (.NOT. ALLOCATED(DstParamData%EAOffBFlp)) THEN 
      ALLOCATE(DstParamData%EAOffBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%EAOffBFlp.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%EAOffBFlp = SrcParamData%EAOffBFlp
ENDIF
IF (ALLOCATED(SrcParamData%FStTunr)) THEN
   i1_l = LBOUND(SrcParamData%FStTunr,1)
   i1_u = UBOUND(SrcParamData%FStTunr,1)
   i2_l = LBOUND(SrcParamData%FStTunr,2)
   i2_u = UBOUND(SrcParamData%FStTunr,2)
   IF (.NOT. ALLOCATED(DstParamData%FStTunr)) THEN 
      ALLOCATE(DstParamData%FStTunr(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%FStTunr.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%FStTunr = SrcParamData%FStTunr
ENDIF
IF (ALLOCATED(SrcParamData%InerBEdg)) THEN
   i1_l = LBOUND(SrcParamData%InerBEdg,1)
   i1_u = UBOUND(SrcParamData%InerBEdg,1)
   i2_l = LBOUND(SrcParamData%InerBEdg,2)
   i2_u = UBOUND(SrcParamData%InerBEdg,2)
   IF (.NOT. ALLOCATED(DstParamData%InerBEdg)) THEN 
      ALLOCATE(DstParamData%InerBEdg(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%InerBEdg.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%InerBEdg = SrcParamData%InerBEdg
ENDIF
IF (ALLOCATED(SrcParamData%InerBFlp)) THEN
   i1_l = LBOUND(SrcParamData%InerBFlp,1)
   i1_u = UBOUND(SrcParamData%InerBFlp,1)
   i2_l = LBOUND(SrcParamData%InerBFlp,2)
   i2_u = UBOUND(SrcParamData%InerBFlp,2)
   IF (.NOT. ALLOCATED(DstParamData%InerBFlp)) THEN 
      ALLOCATE(DstParamData%InerBFlp(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%InerBFlp.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%InerBFlp = SrcParamData%InerBFlp
ENDIF
IF (ALLOCATED(SrcParamData%KBE)) THEN
   i1_l = LBOUND(SrcParamData%KBE,1)
   i1_u = UBOUND(SrcParamData%KBE,1)
   i2_l = LBOUND(SrcParamData%KBE,2)
   i2_u = UBOUND(SrcParamData%KBE,2)
   i3_l = LBOUND(SrcParamData%KBE,3)
   i3_u = UBOUND(SrcParamData%KBE,3)
   IF (.NOT. ALLOCATED(DstParamData%KBE)) THEN 
      ALLOCATE(DstParamData%KBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%KBE.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%KBE = SrcParamData%KBE
ENDIF
IF (ALLOCATED(SrcParamData%KBF)) THEN
   i1_l = LBOUND(SrcParamData%KBF,1)
   i1_u = UBOUND(SrcParamData%KBF,1)
   i2_l = LBOUND(SrcParamData%KBF,2)
   i2_u = UBOUND(SrcParamData%KBF,2)
   i3_l = LBOUND(SrcParamData%KBF,3)
   i3_u = UBOUND(SrcParamData%KBF,3)
   IF (.NOT. ALLOCATED(DstParamData%KBF)) THEN 
      ALLOCATE(DstParamData%KBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%KBF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%KBF = SrcParamData%KBF
ENDIF
IF (ALLOCATED(SrcParamData%MassB)) THEN
   i1_l = LBOUND(SrcParamData%MassB,1)
   i1_u = UBOUND(SrcParamData%MassB,1)
   i2_l = LBOUND(SrcParamData%MassB,2)
   i2_u = UBOUND(SrcParamData%MassB,2)
   IF (.NOT. ALLOCATED(DstParamData%MassB)) THEN 
      ALLOCATE(DstParamData%MassB(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%MassB.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%MassB = SrcParamData%MassB
ENDIF
IF (ALLOCATED(SrcParamData%RefAxisxb)) THEN
   i1_l = LBOUND(SrcParamData%RefAxisxb,1)
   i1_u = UBOUND(SrcParamData%RefAxisxb,1)
   i2_l = LBOUND(SrcParamData%RefAxisxb,2)
   i2_u = UBOUND(SrcParamData%RefAxisxb,2)
   IF (.NOT. ALLOCATED(DstParamData%RefAxisxb)) THEN 
      ALLOCATE(DstParamData%RefAxisxb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%RefAxisxb.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%RefAxisxb = SrcParamData%RefAxisxb
ENDIF
IF (ALLOCATED(SrcParamData%RefAxisyb)) THEN
   i1_l = LBOUND(SrcParamData%RefAxisyb,1)
   i1_u = UBOUND(SrcParamData%RefAxisyb,1)
   i2_l = LBOUND(SrcParamData%RefAxisyb,2)
   i2_u = UBOUND(SrcParamData%RefAxisyb,2)
   IF (.NOT. ALLOCATED(DstParamData%RefAxisyb)) THEN 
      ALLOCATE(DstParamData%RefAxisyb(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%RefAxisyb.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%RefAxisyb = SrcParamData%RefAxisyb
ENDIF
IF (ALLOCATED(SrcParamData%RNodes)) THEN
   i1_l = LBOUND(SrcParamData%RNodes,1)
   i1_u = UBOUND(SrcParamData%RNodes,1)
   IF (.NOT. ALLOCATED(DstParamData%RNodes)) THEN 
      ALLOCATE(DstParamData%RNodes(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%RNodes.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%RNodes = SrcParamData%RNodes
ENDIF
IF (ALLOCATED(SrcParamData%RNodesNorm)) THEN
   i1_l = LBOUND(SrcParamData%RNodesNorm,1)
   i1_u = UBOUND(SrcParamData%RNodesNorm,1)
   IF (.NOT. ALLOCATED(DstParamData%RNodesNorm)) THEN 
      ALLOCATE(DstParamData%RNodesNorm(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%RNodesNorm.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%RNodesNorm = SrcParamData%RNodesNorm
ENDIF
IF (ALLOCATED(SrcParamData%rSAerCenn1)) THEN
   i1_l = LBOUND(SrcParamData%rSAerCenn1,1)
   i1_u = UBOUND(SrcParamData%rSAerCenn1,1)
   i2_l = LBOUND(SrcParamData%rSAerCenn1,2)
   i2_u = UBOUND(SrcParamData%rSAerCenn1,2)
   IF (.NOT. ALLOCATED(DstParamData%rSAerCenn1)) THEN 
      ALLOCATE(DstParamData%rSAerCenn1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%rSAerCenn1.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%rSAerCenn1 = SrcParamData%rSAerCenn1
ENDIF
IF (ALLOCATED(SrcParamData%rSAerCenn2)) THEN
   i1_l = LBOUND(SrcParamData%rSAerCenn2,1)
   i1_u = UBOUND(SrcParamData%rSAerCenn2,1)
   i2_l = LBOUND(SrcParamData%rSAerCenn2,2)
   i2_u = UBOUND(SrcParamData%rSAerCenn2,2)
   IF (.NOT. ALLOCATED(DstParamData%rSAerCenn2)) THEN 
      ALLOCATE(DstParamData%rSAerCenn2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%rSAerCenn2.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%rSAerCenn2 = SrcParamData%rSAerCenn2
ENDIF
IF (ALLOCATED(SrcParamData%SAeroTwst)) THEN
   i1_l = LBOUND(SrcParamData%SAeroTwst,1)
   i1_u = UBOUND(SrcParamData%SAeroTwst,1)
   IF (.NOT. ALLOCATED(DstParamData%SAeroTwst)) THEN 
      ALLOCATE(DstParamData%SAeroTwst(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%SAeroTwst.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%SAeroTwst = SrcParamData%SAeroTwst
ENDIF
IF (ALLOCATED(SrcParamData%StiffBE)) THEN
   i1_l = LBOUND(SrcParamData%StiffBE,1)
   i1_u = UBOUND(SrcParamData%StiffBE,1)
   i2_l = LBOUND(SrcParamData%StiffBE,2)
   i2_u = UBOUND(SrcParamData%StiffBE,2)
   IF (.NOT. ALLOCATED(DstParamData%StiffBE)) THEN 
      ALLOCATE(DstParamData%StiffBE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffBE.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffBE = SrcParamData%StiffBE
ENDIF
IF (ALLOCATED(SrcParamData%StiffBEA)) THEN
   i1_l = LBOUND(SrcParamData%StiffBEA,1)
   i1_u = UBOUND(SrcParamData%StiffBEA,1)
   i2_l = LBOUND(SrcParamData%StiffBEA,2)
   i2_u = UBOUND(SrcParamData%StiffBEA,2)
   IF (.NOT. ALLOCATED(DstParamData%StiffBEA)) THEN 
      ALLOCATE(DstParamData%StiffBEA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffBEA.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffBEA = SrcParamData%StiffBEA
ENDIF
IF (ALLOCATED(SrcParamData%StiffBF)) THEN
   i1_l = LBOUND(SrcParamData%StiffBF,1)
   i1_u = UBOUND(SrcParamData%StiffBF,1)
   i2_l = LBOUND(SrcParamData%StiffBF,2)
   i2_u = UBOUND(SrcParamData%StiffBF,2)
   IF (.NOT. ALLOCATED(DstParamData%StiffBF)) THEN 
      ALLOCATE(DstParamData%StiffBF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffBF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffBF = SrcParamData%StiffBF
ENDIF
IF (ALLOCATED(SrcParamData%StiffBGJ)) THEN
   i1_l = LBOUND(SrcParamData%StiffBGJ,1)
   i1_u = UBOUND(SrcParamData%StiffBGJ,1)
   i2_l = LBOUND(SrcParamData%StiffBGJ,2)
   i2_u = UBOUND(SrcParamData%StiffBGJ,2)
   IF (.NOT. ALLOCATED(DstParamData%StiffBGJ)) THEN 
      ALLOCATE(DstParamData%StiffBGJ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%StiffBGJ.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%StiffBGJ = SrcParamData%StiffBGJ
ENDIF
IF (ALLOCATED(SrcParamData%SThetaS)) THEN
   i1_l = LBOUND(SrcParamData%SThetaS,1)
   i1_u = UBOUND(SrcParamData%SThetaS,1)
   i2_l = LBOUND(SrcParamData%SThetaS,2)
   i2_u = UBOUND(SrcParamData%SThetaS,2)
   IF (.NOT. ALLOCATED(DstParamData%SThetaS)) THEN 
      ALLOCATE(DstParamData%SThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%SThetaS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%SThetaS = SrcParamData%SThetaS
ENDIF
IF (ALLOCATED(SrcParamData%ThetaS)) THEN
   i1_l = LBOUND(SrcParamData%ThetaS,1)
   i1_u = UBOUND(SrcParamData%ThetaS,1)
   i2_l = LBOUND(SrcParamData%ThetaS,2)
   i2_u = UBOUND(SrcParamData%ThetaS,2)
   IF (.NOT. ALLOCATED(DstParamData%ThetaS)) THEN 
      ALLOCATE(DstParamData%ThetaS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%ThetaS.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%ThetaS = SrcParamData%ThetaS
ENDIF
IF (ALLOCATED(SrcParamData%TwistedSF)) THEN
   i1_l = LBOUND(SrcParamData%TwistedSF,1)
   i1_u = UBOUND(SrcParamData%TwistedSF,1)
   i2_l = LBOUND(SrcParamData%TwistedSF,2)
   i2_u = UBOUND(SrcParamData%TwistedSF,2)
   i3_l = LBOUND(SrcParamData%TwistedSF,3)
   i3_u = UBOUND(SrcParamData%TwistedSF,3)
   i4_l = LBOUND(SrcParamData%TwistedSF,4)
   i4_u = UBOUND(SrcParamData%TwistedSF,4)
   i5_l = LBOUND(SrcParamData%TwistedSF,5)
   i5_u = UBOUND(SrcParamData%TwistedSF,5)
   IF (.NOT. ALLOCATED(DstParamData%TwistedSF)) THEN 
      ALLOCATE(DstParamData%TwistedSF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u,i4_l:i4_u,i5_l:i5_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%TwistedSF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%TwistedSF = SrcParamData%TwistedSF
ENDIF
IF (ALLOCATED(SrcParamData%BldFl1Sh)) THEN
   i1_l = LBOUND(SrcParamData%BldFl1Sh,1)
   i1_u = UBOUND(SrcParamData%BldFl1Sh,1)
   i2_l = LBOUND(SrcParamData%BldFl1Sh,2)
   i2_u = UBOUND(SrcParamData%BldFl1Sh,2)
   IF (.NOT. ALLOCATED(DstParamData%BldFl1Sh)) THEN 
      ALLOCATE(DstParamData%BldFl1Sh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldFl1Sh.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldFl1Sh = SrcParamData%BldFl1Sh
ENDIF
IF (ALLOCATED(SrcParamData%BldFl2Sh)) THEN
   i1_l = LBOUND(SrcParamData%BldFl2Sh,1)
   i1_u = UBOUND(SrcParamData%BldFl2Sh,1)
   i2_l = LBOUND(SrcParamData%BldFl2Sh,2)
   i2_u = UBOUND(SrcParamData%BldFl2Sh,2)
   IF (.NOT. ALLOCATED(DstParamData%BldFl2Sh)) THEN 
      ALLOCATE(DstParamData%BldFl2Sh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldFl2Sh.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldFl2Sh = SrcParamData%BldFl2Sh
ENDIF
IF (ALLOCATED(SrcParamData%BldEdgSh)) THEN
   i1_l = LBOUND(SrcParamData%BldEdgSh,1)
   i1_u = UBOUND(SrcParamData%BldEdgSh,1)
   i2_l = LBOUND(SrcParamData%BldEdgSh,2)
   i2_u = UBOUND(SrcParamData%BldEdgSh,2)
   IF (.NOT. ALLOCATED(DstParamData%BldEdgSh)) THEN 
      ALLOCATE(DstParamData%BldEdgSh(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BldEdgSh.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BldEdgSh = SrcParamData%BldEdgSh
ENDIF
IF (ALLOCATED(SrcParamData%FreqBE)) THEN
   i1_l = LBOUND(SrcParamData%FreqBE,1)
   i1_u = UBOUND(SrcParamData%FreqBE,1)
   i2_l = LBOUND(SrcParamData%FreqBE,2)
   i2_u = UBOUND(SrcParamData%FreqBE,2)
   i3_l = LBOUND(SrcParamData%FreqBE,3)
   i3_u = UBOUND(SrcParamData%FreqBE,3)
   IF (.NOT. ALLOCATED(DstParamData%FreqBE)) THEN 
      ALLOCATE(DstParamData%FreqBE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%FreqBE.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%FreqBE = SrcParamData%FreqBE
ENDIF
IF (ALLOCATED(SrcParamData%FreqBF)) THEN
   i1_l = LBOUND(SrcParamData%FreqBF,1)
   i1_u = UBOUND(SrcParamData%FreqBF,1)
   i2_l = LBOUND(SrcParamData%FreqBF,2)
   i2_u = UBOUND(SrcParamData%FreqBF,2)
   i3_l = LBOUND(SrcParamData%FreqBF,3)
   i3_u = UBOUND(SrcParamData%FreqBF,3)
   IF (.NOT. ALLOCATED(DstParamData%FreqBF)) THEN 
      ALLOCATE(DstParamData%FreqBF(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%FreqBF.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%FreqBF = SrcParamData%FreqBF
ENDIF
   DstParamData%FreqTFA = SrcParamData%FreqTFA
   DstParamData%FreqTSS = SrcParamData%FreqTSS
   DstParamData%TeetCDmp = SrcParamData%TeetCDmp
   DstParamData%TeetDmp = SrcParamData%TeetDmp
   DstParamData%TeetDmpP = SrcParamData%TeetDmpP
   DstParamData%TeetHSSp = SrcParamData%TeetHSSp
   DstParamData%TeetHStP = SrcParamData%TeetHStP
   DstParamData%TeetSSSp = SrcParamData%TeetSSSp
   DstParamData%TeetSStP = SrcParamData%TeetSStP
   DstParamData%TeetMod = SrcParamData%TeetMod
   DstParamData%TFrlCDmp = SrcParamData%TFrlCDmp
   DstParamData%TFrlDmp = SrcParamData%TFrlDmp
   DstParamData%TFrlDSDmp = SrcParamData%TFrlDSDmp
   DstParamData%TFrlDSDP = SrcParamData%TFrlDSDP
   DstParamData%TFrlDSSP = SrcParamData%TFrlDSSP
   DstParamData%TFrlDSSpr = SrcParamData%TFrlDSSpr
   DstParamData%TFrlSpr = SrcParamData%TFrlSpr
   DstParamData%TFrlUSDmp = SrcParamData%TFrlUSDmp
   DstParamData%TFrlUSDP = SrcParamData%TFrlUSDP
   DstParamData%TFrlUSSP = SrcParamData%TFrlUSSP
   DstParamData%TFrlUSSpr = SrcParamData%TFrlUSSpr
   DstParamData%TFrlMod = SrcParamData%TFrlMod
   DstParamData%RFrlCDmp = SrcParamData%RFrlCDmp
   DstParamData%RFrlDmp = SrcParamData%RFrlDmp
   DstParamData%RFrlDSDmp = SrcParamData%RFrlDSDmp
   DstParamData%RFrlDSDP = SrcParamData%RFrlDSDP
   DstParamData%RFrlDSSP = SrcParamData%RFrlDSSP
   DstParamData%RFrlDSSpr = SrcParamData%RFrlDSSpr
   DstParamData%RFrlSpr = SrcParamData%RFrlSpr
   DstParamData%RFrlUSDmp = SrcParamData%RFrlUSDmp
   DstParamData%RFrlUSDP = SrcParamData%RFrlUSDP
   DstParamData%RFrlUSSP = SrcParamData%RFrlUSSP
   DstParamData%RFrlUSSpr = SrcParamData%RFrlUSSpr
   DstParamData%RFrlMod = SrcParamData%RFrlMod
   DstParamData%ShftGagL = SrcParamData%ShftGagL
   DstParamData%BldGagNd = SrcParamData%BldGagNd
   DstParamData%TwrGagNd = SrcParamData%TwrGagNd
   DstParamData%TStart = SrcParamData%TStart
   DstParamData%DTTorDmp = SrcParamData%DTTorDmp
   DstParamData%DTTorSpr = SrcParamData%DTTorSpr
   DstParamData%GBRatio = SrcParamData%GBRatio
   DstParamData%GBoxEff = SrcParamData%GBoxEff
   DstParamData%RotSpeed = SrcParamData%RotSpeed
   DstParamData%RootName = SrcParamData%RootName
IF (ALLOCATED(SrcParamData%BElmntMass)) THEN
   i1_l = LBOUND(SrcParamData%BElmntMass,1)
   i1_u = UBOUND(SrcParamData%BElmntMass,1)
   i2_l = LBOUND(SrcParamData%BElmntMass,2)
   i2_u = UBOUND(SrcParamData%BElmntMass,2)
   IF (.NOT. ALLOCATED(DstParamData%BElmntMass)) THEN 
      ALLOCATE(DstParamData%BElmntMass(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%BElmntMass.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%BElmntMass = SrcParamData%BElmntMass
ENDIF
IF (ALLOCATED(SrcParamData%TElmntMass)) THEN
   i1_l = LBOUND(SrcParamData%TElmntMass,1)
   i1_u = UBOUND(SrcParamData%TElmntMass,1)
   IF (.NOT. ALLOCATED(DstParamData%TElmntMass)) THEN 
      ALLOCATE(DstParamData%TElmntMass(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstParamData%TElmntMass.', ErrStat, ErrMsg,'ED_CopyParam')
         RETURN
      END IF
   END IF
   DstParamData%TElmntMass = SrcParamData%TElmntMass
ENDIF
   DstParamData%method = SrcParamData%method
   DstParamData%PtfmCMxt = SrcParamData%PtfmCMxt
   DstParamData%PtfmCMyt = SrcParamData%PtfmCMyt
   DstParamData%BD4Blades = SrcParamData%BD4Blades
 END SUBROUTINE ED_CopyParam

 SUBROUTINE ED_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(ED_ParameterType), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ParamData%PH)) THEN
   DEALLOCATE(ParamData%PH)
ENDIF
IF (ALLOCATED(ParamData%PM)) THEN
   DEALLOCATE(ParamData%PM)
ENDIF
IF (ALLOCATED(ParamData%DOF_Flag)) THEN
   DEALLOCATE(ParamData%DOF_Flag)
ENDIF
IF (ALLOCATED(ParamData%DOF_Desc)) THEN
   DEALLOCATE(ParamData%DOF_Desc)
ENDIF
  CALL ED_Destroyactivedofs( ParamData%DOFs, ErrStat, ErrMsg )
IF (ALLOCATED(ParamData%OutParam)) THEN
DO i1 = LBOUND(ParamData%OutParam,1), UBOUND(ParamData%OutParam,1)
  CALL NWTC_Library_Destroyoutparmtype( ParamData%OutParam(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(ParamData%OutParam)
ENDIF
IF (ALLOCATED(ParamData%CosPreC)) THEN
   DEALLOCATE(ParamData%CosPreC)
ENDIF
IF (ALLOCATED(ParamData%SinPreC)) THEN
   DEALLOCATE(ParamData%SinPreC)
ENDIF
IF (ALLOCATED(ParamData%AxRedTFA)) THEN
   DEALLOCATE(ParamData%AxRedTFA)
ENDIF
IF (ALLOCATED(ParamData%AxRedTSS)) THEN
   DEALLOCATE(ParamData%AxRedTSS)
ENDIF
IF (ALLOCATED(ParamData%DHNodes)) THEN
   DEALLOCATE(ParamData%DHNodes)
ENDIF
IF (ALLOCATED(ParamData%HNodes)) THEN
   DEALLOCATE(ParamData%HNodes)
ENDIF
IF (ALLOCATED(ParamData%HNodesNorm)) THEN
   DEALLOCATE(ParamData%HNodesNorm)
ENDIF
IF (ALLOCATED(ParamData%MassT)) THEN
   DEALLOCATE(ParamData%MassT)
ENDIF
IF (ALLOCATED(ParamData%StiffTSS)) THEN
   DEALLOCATE(ParamData%StiffTSS)
ENDIF
IF (ALLOCATED(ParamData%TwrFASF)) THEN
   DEALLOCATE(ParamData%TwrFASF)
ENDIF
IF (ALLOCATED(ParamData%TwrSSSF)) THEN
   DEALLOCATE(ParamData%TwrSSSF)
ENDIF
IF (ALLOCATED(ParamData%InerTFA)) THEN
   DEALLOCATE(ParamData%InerTFA)
ENDIF
IF (ALLOCATED(ParamData%InerTSS)) THEN
   DEALLOCATE(ParamData%InerTSS)
ENDIF
IF (ALLOCATED(ParamData%StiffTGJ)) THEN
   DEALLOCATE(ParamData%StiffTGJ)
ENDIF
IF (ALLOCATED(ParamData%StiffTEA)) THEN
   DEALLOCATE(ParamData%StiffTEA)
ENDIF
IF (ALLOCATED(ParamData%StiffTFA)) THEN
   DEALLOCATE(ParamData%StiffTFA)
ENDIF
IF (ALLOCATED(ParamData%cgOffTFA)) THEN
   DEALLOCATE(ParamData%cgOffTFA)
ENDIF
IF (ALLOCATED(ParamData%cgOffTSS)) THEN
   DEALLOCATE(ParamData%cgOffTSS)
ENDIF
IF (ALLOCATED(ParamData%BldCG)) THEN
   DEALLOCATE(ParamData%BldCG)
ENDIF
IF (ALLOCATED(ParamData%BldMass)) THEN
   DEALLOCATE(ParamData%BldMass)
ENDIF
IF (ALLOCATED(ParamData%FirstMom)) THEN
   DEALLOCATE(ParamData%FirstMom)
ENDIF
IF (ALLOCATED(ParamData%SecondMom)) THEN
   DEALLOCATE(ParamData%SecondMom)
ENDIF
IF (ALLOCATED(ParamData%TipMass)) THEN
   DEALLOCATE(ParamData%TipMass)
ENDIF
IF (ALLOCATED(ParamData%PitchAxis)) THEN
   DEALLOCATE(ParamData%PitchAxis)
ENDIF
IF (ALLOCATED(ParamData%AeroTwst)) THEN
   DEALLOCATE(ParamData%AeroTwst)
ENDIF
IF (ALLOCATED(ParamData%AxRedBld)) THEN
   DEALLOCATE(ParamData%AxRedBld)
ENDIF
IF (ALLOCATED(ParamData%BAlpha)) THEN
   DEALLOCATE(ParamData%BAlpha)
ENDIF
IF (ALLOCATED(ParamData%BldEDamp)) THEN
   DEALLOCATE(ParamData%BldEDamp)
ENDIF
IF (ALLOCATED(ParamData%BldFDamp)) THEN
   DEALLOCATE(ParamData%BldFDamp)
ENDIF
IF (ALLOCATED(ParamData%CAeroTwst)) THEN
   DEALLOCATE(ParamData%CAeroTwst)
ENDIF
IF (ALLOCATED(ParamData%CBE)) THEN
   DEALLOCATE(ParamData%CBE)
ENDIF
IF (ALLOCATED(ParamData%CBF)) THEN
   DEALLOCATE(ParamData%CBF)
ENDIF
IF (ALLOCATED(ParamData%cgOffBEdg)) THEN
   DEALLOCATE(ParamData%cgOffBEdg)
ENDIF
IF (ALLOCATED(ParamData%cgOffBFlp)) THEN
   DEALLOCATE(ParamData%cgOffBFlp)
ENDIF
IF (ALLOCATED(ParamData%Chord)) THEN
   DEALLOCATE(ParamData%Chord)
ENDIF
IF (ALLOCATED(ParamData%CThetaS)) THEN
   DEALLOCATE(ParamData%CThetaS)
ENDIF
IF (ALLOCATED(ParamData%DRNodes)) THEN
   DEALLOCATE(ParamData%DRNodes)
ENDIF
IF (ALLOCATED(ParamData%EAOffBEdg)) THEN
   DEALLOCATE(ParamData%EAOffBEdg)
ENDIF
IF (ALLOCATED(ParamData%EAOffBFlp)) THEN
   DEALLOCATE(ParamData%EAOffBFlp)
ENDIF
IF (ALLOCATED(ParamData%FStTunr)) THEN
   DEALLOCATE(ParamData%FStTunr)
ENDIF
IF (ALLOCATED(ParamData%InerBEdg)) THEN
   DEALLOCATE(ParamData%InerBEdg)
ENDIF
IF (ALLOCATED(ParamData%InerBFlp)) THEN
   DEALLOCATE(ParamData%InerBFlp)
ENDIF
IF (ALLOCATED(ParamData%KBE)) THEN
   DEALLOCATE(ParamData%KBE)
ENDIF
IF (ALLOCATED(ParamData%KBF)) THEN
   DEALLOCATE(ParamData%KBF)
ENDIF
IF (ALLOCATED(ParamData%MassB)) THEN
   DEALLOCATE(ParamData%MassB)
ENDIF
IF (ALLOCATED(ParamData%RefAxisxb)) THEN
   DEALLOCATE(ParamData%RefAxisxb)
ENDIF
IF (ALLOCATED(ParamData%RefAxisyb)) THEN
   DEALLOCATE(ParamData%RefAxisyb)
ENDIF
IF (ALLOCATED(ParamData%RNodes)) THEN
   DEALLOCATE(ParamData%RNodes)
ENDIF
IF (ALLOCATED(ParamData%RNodesNorm)) THEN
   DEALLOCATE(ParamData%RNodesNorm)
ENDIF
IF (ALLOCATED(ParamData%rSAerCenn1)) THEN
   DEALLOCATE(ParamData%rSAerCenn1)
ENDIF
IF (ALLOCATED(ParamData%rSAerCenn2)) THEN
   DEALLOCATE(ParamData%rSAerCenn2)
ENDIF
IF (ALLOCATED(ParamData%SAeroTwst)) THEN
   DEALLOCATE(ParamData%SAeroTwst)
ENDIF
IF (ALLOCATED(ParamData%StiffBE)) THEN
   DEALLOCATE(ParamData%StiffBE)
ENDIF
IF (ALLOCATED(ParamData%StiffBEA)) THEN
   DEALLOCATE(ParamData%StiffBEA)
ENDIF
IF (ALLOCATED(ParamData%StiffBF)) THEN
   DEALLOCATE(ParamData%StiffBF)
ENDIF
IF (ALLOCATED(ParamData%StiffBGJ)) THEN
   DEALLOCATE(ParamData%StiffBGJ)
ENDIF
IF (ALLOCATED(ParamData%SThetaS)) THEN
   DEALLOCATE(ParamData%SThetaS)
ENDIF
IF (ALLOCATED(ParamData%ThetaS)) THEN
   DEALLOCATE(ParamData%ThetaS)
ENDIF
IF (ALLOCATED(ParamData%TwistedSF)) THEN
   DEALLOCATE(ParamData%TwistedSF)
ENDIF
IF (ALLOCATED(ParamData%BldFl1Sh)) THEN
   DEALLOCATE(ParamData%BldFl1Sh)
ENDIF
IF (ALLOCATED(ParamData%BldFl2Sh)) THEN
   DEALLOCATE(ParamData%BldFl2Sh)
ENDIF
IF (ALLOCATED(ParamData%BldEdgSh)) THEN
   DEALLOCATE(ParamData%BldEdgSh)
ENDIF
IF (ALLOCATED(ParamData%FreqBE)) THEN
   DEALLOCATE(ParamData%FreqBE)
ENDIF
IF (ALLOCATED(ParamData%FreqBF)) THEN
   DEALLOCATE(ParamData%FreqBF)
ENDIF
IF (ALLOCATED(ParamData%BElmntMass)) THEN
   DEALLOCATE(ParamData%BElmntMass)
ENDIF
IF (ALLOCATED(ParamData%TElmntMass)) THEN
   DEALLOCATE(ParamData%TElmntMass)
ENDIF
 END SUBROUTINE ED_DestroyParam

 SUBROUTINE ED_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_ParameterType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_DOFs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DOFs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DOFs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_OutParam_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OutParam_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OutParam_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Db_BufSz   = Db_BufSz   + 1  ! DT24
  Int_BufSz  = Int_BufSz  + 1  ! BldNodes
  Int_BufSz  = Int_BufSz  + 1  ! TipNode
  Int_BufSz  = Int_BufSz  + 1  ! NDOF
  Re_BufSz   = Re_BufSz   + 1  ! TwoPiNB
  Int_BufSz  = Int_BufSz  + 1  ! NAug
  Int_BufSz  = Int_BufSz  + 1  ! NPH
  IF ( ALLOCATED(InData%PH) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PH )  ! PH 
  Int_BufSz  = Int_BufSz  + 1  ! NPM
  IF ( ALLOCATED(InData%PM) )   Int_BufSz   = Int_BufSz   + SIZE( InData%PM )  ! PM 
  IF ( ALLOCATED(InData%DOF_Flag) )   Int_BufSz   = Int_BufSz   + SIZE( InData%DOF_Flag )  ! DOF_Flag 
!  missing buffer for DOF_Desc
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, InData%DOFs, ErrStat, ErrMsg, .TRUE. ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DOFs_Buf  ) ! DOFs
  IF(ALLOCATED(Db_DOFs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DOFs_Buf  ) ! DOFs
  IF(ALLOCATED(Int_DOFs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DOFs_Buf ) ! DOFs
  IF(ALLOCATED(Re_DOFs_Buf))  DEALLOCATE(Re_DOFs_Buf)
  IF(ALLOCATED(Db_DOFs_Buf))  DEALLOCATE(Db_DOFs_Buf)
  IF(ALLOCATED(Int_DOFs_Buf)) DEALLOCATE(Int_DOFs_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumOuts
!  missing buffer for OutFmt
  Int_BufSz  = Int_BufSz  + 1  ! NBlGages
  Int_BufSz  = Int_BufSz  + 1  ! NTwGages
DO i1 = LBOUND(InData%OutParam,1), UBOUND(InData%OutParam,1)
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, InData%OutParam(i1), ErrStat, ErrMsg, .TRUE. ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OutParam_Buf  ) ! OutParam
  IF(ALLOCATED(Db_OutParam_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OutParam_Buf  ) ! OutParam
  IF(ALLOCATED(Int_OutParam_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OutParam_Buf ) ! OutParam
  IF(ALLOCATED(Re_OutParam_Buf))  DEALLOCATE(Re_OutParam_Buf)
  IF(ALLOCATED(Db_OutParam_Buf))  DEALLOCATE(Db_OutParam_Buf)
  IF(ALLOCATED(Int_OutParam_Buf)) DEALLOCATE(Int_OutParam_Buf)
ENDDO
!  missing buffer for Delim
  Re_BufSz   = Re_BufSz   + 1  ! AvgNrmTpRd
  Re_BufSz   = Re_BufSz   + 1  ! AzimB1Up
  Re_BufSz   = Re_BufSz   + 1  ! CosDel3
  IF ( ALLOCATED(InData%CosPreC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CosPreC )  ! CosPreC 
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! CRFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! CShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! CShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! CSRFrlSkw
  Re_BufSz   = Re_BufSz   + 1  ! CSRFrlTlt
  Re_BufSz   = Re_BufSz   + 1  ! CSTFrlSkw
  Re_BufSz   = Re_BufSz   + 1  ! CSTFrlTlt
  Re_BufSz   = Re_BufSz   + 1  ! CTFinBank
  Re_BufSz   = Re_BufSz   + 1  ! CTFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! CTFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! CTFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! HubHt
  Re_BufSz   = Re_BufSz   + 1  ! HubCM
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Re_BufSz   = Re_BufSz   + 1  ! NacCMxn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMyn
  Re_BufSz   = Re_BufSz   + 1  ! NacCMzn
  Re_BufSz   = Re_BufSz   + 1  ! OverHang
  Re_BufSz   = Re_BufSz   + 1  ! ProjArea
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRefzt
  Re_BufSz   = Re_BufSz   + 1  ! RefTwrHt
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! RFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! rVDxn
  Re_BufSz   = Re_BufSz   + 1  ! rVDyn
  Re_BufSz   = Re_BufSz   + 1  ! rVDzn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUxn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUyn
  Re_BufSz   = Re_BufSz   + 1  ! rVIMUzn
  Re_BufSz   = Re_BufSz   + 1  ! rVPxn
  Re_BufSz   = Re_BufSz   + 1  ! rVPyn
  Re_BufSz   = Re_BufSz   + 1  ! rVPzn
  Re_BufSz   = Re_BufSz   + 1  ! rWIxn
  Re_BufSz   = Re_BufSz   + 1  ! rWIyn
  Re_BufSz   = Re_BufSz   + 1  ! rWIzn
  Re_BufSz   = Re_BufSz   + 1  ! rWJxn
  Re_BufSz   = Re_BufSz   + 1  ! rWJyn
  Re_BufSz   = Re_BufSz   + 1  ! rWJzn
  Re_BufSz   = Re_BufSz   + 1  ! rWKxn
  Re_BufSz   = Re_BufSz   + 1  ! rWKyn
  Re_BufSz   = Re_BufSz   + 1  ! rWKzn
  Re_BufSz   = Re_BufSz   + 1  ! rZT0zt
  Re_BufSz   = Re_BufSz   + 1  ! rZYzt
  Re_BufSz   = Re_BufSz   + 1  ! SinDel3
  IF ( ALLOCATED(InData%SinPreC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SinPreC )  ! SinPreC 
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! SRFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! SShftSkew
  Re_BufSz   = Re_BufSz   + 1  ! SShftTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFinBank
  Re_BufSz   = Re_BufSz   + 1  ! STFinSkew
  Re_BufSz   = Re_BufSz   + 1  ! STFinTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFrlSkew
  Re_BufSz   = Re_BufSz   + 1  ! STFrlSkw2
  Re_BufSz   = Re_BufSz   + 1  ! STFrlTilt
  Re_BufSz   = Re_BufSz   + 1  ! STFrlTlt2
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntxn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntyn
  Re_BufSz   = Re_BufSz   + 1  ! TFrlPntzn
  Re_BufSz   = Re_BufSz   + 1  ! TipRad
  Re_BufSz   = Re_BufSz   + 1  ! TowerHt
  Re_BufSz   = Re_BufSz   + 1  ! TowerBsHt
  Re_BufSz   = Re_BufSz   + 1  ! UndSling
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  IF ( ALLOCATED(InData%AxRedTFA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedTFA )  ! AxRedTFA 
  IF ( ALLOCATED(InData%AxRedTSS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedTSS )  ! AxRedTSS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CTFA )  ! CTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CTSS )  ! CTSS 
  IF ( ALLOCATED(InData%DHNodes) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DHNodes )  ! DHNodes 
  IF ( ALLOCATED(InData%HNodes) )   Re_BufSz    = Re_BufSz    + SIZE( InData%HNodes )  ! HNodes 
  IF ( ALLOCATED(InData%HNodesNorm) )   Re_BufSz    = Re_BufSz    + SIZE( InData%HNodesNorm )  ! HNodesNorm 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KTFA )  ! KTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%KTSS )  ! KTSS 
  IF ( ALLOCATED(InData%MassT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MassT )  ! MassT 
  IF ( ALLOCATED(InData%StiffTSS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTSS )  ! StiffTSS 
  IF ( ALLOCATED(InData%TwrFASF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrFASF )  ! TwrFASF 
  Re_BufSz   = Re_BufSz   + 1  ! TwrFlexL
  IF ( ALLOCATED(InData%TwrSSSF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrSSSF )  ! TwrSSSF 
  Int_BufSz  = Int_BufSz  + 1  ! TTopNode
  Int_BufSz  = Int_BufSz  + 1  ! TwrNodes
  IF ( ALLOCATED(InData%InerTFA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%InerTFA )  ! InerTFA 
  IF ( ALLOCATED(InData%InerTSS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%InerTSS )  ! InerTSS 
  IF ( ALLOCATED(InData%StiffTGJ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTGJ )  ! StiffTGJ 
  IF ( ALLOCATED(InData%StiffTEA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTEA )  ! StiffTEA 
  IF ( ALLOCATED(InData%StiffTFA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffTFA )  ! StiffTFA 
  IF ( ALLOCATED(InData%cgOffTFA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffTFA )  ! cgOffTFA 
  IF ( ALLOCATED(InData%cgOffTSS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffTSS )  ! cgOffTSS 
  Re_BufSz   = Re_BufSz   + 1  ! AtfaIner
  IF ( ALLOCATED(InData%BldCG) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldCG )  ! BldCG 
  IF ( ALLOCATED(InData%BldMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldMass )  ! BldMass 
  Re_BufSz   = Re_BufSz   + 1  ! BoomMass
  IF ( ALLOCATED(InData%FirstMom) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FirstMom )  ! FirstMom 
  Re_BufSz   = Re_BufSz   + 1  ! GenIner
  Re_BufSz   = Re_BufSz   + 1  ! Hubg1Iner
  Re_BufSz   = Re_BufSz   + 1  ! Hubg2Iner
  Re_BufSz   = Re_BufSz   + 1  ! HubMass
  Re_BufSz   = Re_BufSz   + 1  ! Nacd2Iner
  Re_BufSz   = Re_BufSz   + 1  ! NacMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmMass
  Re_BufSz   = Re_BufSz   + 1  ! PtfmPIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmRIner
  Re_BufSz   = Re_BufSz   + 1  ! PtfmYIner
  Re_BufSz   = Re_BufSz   + 1  ! RFrlMass
  Re_BufSz   = Re_BufSz   + 1  ! RotIner
  Re_BufSz   = Re_BufSz   + 1  ! RotMass
  Re_BufSz   = Re_BufSz   + 1  ! RrfaIner
  IF ( ALLOCATED(InData%SecondMom) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SecondMom )  ! SecondMom 
  Re_BufSz   = Re_BufSz   + 1  ! TFinMass
  Re_BufSz   = Re_BufSz   + 1  ! TFrlIner
  IF ( ALLOCATED(InData%TipMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TipMass )  ! TipMass 
  Re_BufSz   = Re_BufSz   + 1  ! TurbMass
  Re_BufSz   = Re_BufSz   + 1  ! TwrMass
  Re_BufSz   = Re_BufSz   + 1  ! TwrTpMass
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMass
  Re_BufSz   = Re_BufSz   + 1  ! Gravity
  IF ( ALLOCATED(InData%PitchAxis) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PitchAxis )  ! PitchAxis 
  IF ( ALLOCATED(InData%AeroTwst) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AeroTwst )  ! AeroTwst 
  IF ( ALLOCATED(InData%AxRedBld) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AxRedBld )  ! AxRedBld 
  IF ( ALLOCATED(InData%BAlpha) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BAlpha )  ! BAlpha 
  IF ( ALLOCATED(InData%BldEDamp) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldEDamp )  ! BldEDamp 
  IF ( ALLOCATED(InData%BldFDamp) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldFDamp )  ! BldFDamp 
  Re_BufSz   = Re_BufSz   + 1  ! BldFlexL
  IF ( ALLOCATED(InData%CAeroTwst) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CAeroTwst )  ! CAeroTwst 
  IF ( ALLOCATED(InData%CBE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CBE )  ! CBE 
  IF ( ALLOCATED(InData%CBF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CBF )  ! CBF 
  IF ( ALLOCATED(InData%cgOffBEdg) )   Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffBEdg )  ! cgOffBEdg 
  IF ( ALLOCATED(InData%cgOffBFlp) )   Re_BufSz    = Re_BufSz    + SIZE( InData%cgOffBFlp )  ! cgOffBFlp 
  IF ( ALLOCATED(InData%Chord) )   Re_BufSz    = Re_BufSz    + SIZE( InData%Chord )  ! Chord 
  IF ( ALLOCATED(InData%CThetaS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CThetaS )  ! CThetaS 
  IF ( ALLOCATED(InData%DRNodes) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DRNodes )  ! DRNodes 
  IF ( ALLOCATED(InData%EAOffBEdg) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EAOffBEdg )  ! EAOffBEdg 
  IF ( ALLOCATED(InData%EAOffBFlp) )   Re_BufSz    = Re_BufSz    + SIZE( InData%EAOffBFlp )  ! EAOffBFlp 
  IF ( ALLOCATED(InData%FStTunr) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FStTunr )  ! FStTunr 
  IF ( ALLOCATED(InData%InerBEdg) )   Re_BufSz    = Re_BufSz    + SIZE( InData%InerBEdg )  ! InerBEdg 
  IF ( ALLOCATED(InData%InerBFlp) )   Re_BufSz    = Re_BufSz    + SIZE( InData%InerBFlp )  ! InerBFlp 
  IF ( ALLOCATED(InData%KBE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%KBE )  ! KBE 
  IF ( ALLOCATED(InData%KBF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%KBF )  ! KBF 
  IF ( ALLOCATED(InData%MassB) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MassB )  ! MassB 
  IF ( ALLOCATED(InData%RefAxisxb) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RefAxisxb )  ! RefAxisxb 
  IF ( ALLOCATED(InData%RefAxisyb) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RefAxisyb )  ! RefAxisyb 
  IF ( ALLOCATED(InData%RNodes) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RNodes )  ! RNodes 
  IF ( ALLOCATED(InData%RNodesNorm) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RNodesNorm )  ! RNodesNorm 
  IF ( ALLOCATED(InData%rSAerCenn1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rSAerCenn1 )  ! rSAerCenn1 
  IF ( ALLOCATED(InData%rSAerCenn2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%rSAerCenn2 )  ! rSAerCenn2 
  IF ( ALLOCATED(InData%SAeroTwst) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SAeroTwst )  ! SAeroTwst 
  IF ( ALLOCATED(InData%StiffBE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBE )  ! StiffBE 
  IF ( ALLOCATED(InData%StiffBEA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBEA )  ! StiffBEA 
  IF ( ALLOCATED(InData%StiffBF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBF )  ! StiffBF 
  IF ( ALLOCATED(InData%StiffBGJ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StiffBGJ )  ! StiffBGJ 
  IF ( ALLOCATED(InData%SThetaS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SThetaS )  ! SThetaS 
  IF ( ALLOCATED(InData%ThetaS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ThetaS )  ! ThetaS 
  IF ( ALLOCATED(InData%TwistedSF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwistedSF )  ! TwistedSF 
  IF ( ALLOCATED(InData%BldFl1Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl1Sh )  ! BldFl1Sh 
  IF ( ALLOCATED(InData%BldFl2Sh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldFl2Sh )  ! BldFl2Sh 
  IF ( ALLOCATED(InData%BldEdgSh) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BldEdgSh )  ! BldEdgSh 
  IF ( ALLOCATED(InData%FreqBE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FreqBE )  ! FreqBE 
  IF ( ALLOCATED(InData%FreqBF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FreqBF )  ! FreqBF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqTFA )  ! FreqTFA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FreqTSS )  ! FreqTSS 
  Re_BufSz   = Re_BufSz   + 1  ! TeetCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmp
  Re_BufSz   = Re_BufSz   + 1  ! TeetDmpP
  Re_BufSz   = Re_BufSz   + 1  ! TeetHSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetHStP
  Re_BufSz   = Re_BufSz   + 1  ! TeetSSSp
  Re_BufSz   = Re_BufSz   + 1  ! TeetSStP
  Int_BufSz  = Int_BufSz  + 1  ! TeetMod
  Re_BufSz   = Re_BufSz   + 1  ! TFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! TFrlUSSpr
  Int_BufSz  = Int_BufSz  + 1  ! TFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! RFrlCDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlDSSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlSpr
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDmp
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSDP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSP
  Re_BufSz   = Re_BufSz   + 1  ! RFrlUSSpr
  Int_BufSz  = Int_BufSz  + 1  ! RFrlMod
  Re_BufSz   = Re_BufSz   + 1  ! ShftGagL
  Int_BufSz   = Int_BufSz   + SIZE( InData%BldGagNd )  ! BldGagNd 
  Int_BufSz   = Int_BufSz   + SIZE( InData%TwrGagNd )  ! TwrGagNd 
  Db_BufSz   = Db_BufSz   + 1  ! TStart
  Re_BufSz   = Re_BufSz   + 1  ! DTTorDmp
  Re_BufSz   = Re_BufSz   + 1  ! DTTorSpr
  Re_BufSz   = Re_BufSz   + 1  ! GBRatio
  Re_BufSz   = Re_BufSz   + 1  ! GBoxEff
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
!  missing buffer for RootName
  IF ( ALLOCATED(InData%BElmntMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BElmntMass )  ! BElmntMass 
  IF ( ALLOCATED(InData%TElmntMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TElmntMass )  ! TElmntMass 
  Int_BufSz  = Int_BufSz  + 1  ! method
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMxt
  Re_BufSz   = Re_BufSz   + 1  ! PtfmCMyt
  Int_BufSz  = Int_BufSz  + 1  ! BD4Blades
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT24 )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%BldNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TipNode )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NDOF )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwoPiNB )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NAug )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPH )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PH) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PH))-1 ) = PACK(InData%PH ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PH)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NPM )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%PM) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%PM))-1 ) = PACK(InData%PM ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%PM)
  ENDIF
  IF ( ALLOCATED(InData%DOF_Flag) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%DOF_Flag))-1 ) = TRANSFER( PACK(InData%DOF_Flag ,.TRUE.), IntKiBuf(1), 1)
    Int_Xferred   = Int_Xferred   + SIZE(InData%DOF_Flag)
  ENDIF
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, InData%DOFs, ErrStat, ErrMsg, OnlySize ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DOFs_Buf)-1 ) = Re_DOFs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DOFs_Buf)-1 ) = Db_DOFs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DOFs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DOFs_Buf)-1 ) = Int_DOFs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DOFs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DOFs_Buf) )  DEALLOCATE(Re_DOFs_Buf)
  IF( ALLOCATED(Db_DOFs_Buf) )  DEALLOCATE(Db_DOFs_Buf)
  IF( ALLOCATED(Int_DOFs_Buf) ) DEALLOCATE(Int_DOFs_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumOuts )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlGages )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwGages )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(InData%OutParam,1), UBOUND(InData%OutParam,1)
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, InData%OutParam(i1), ErrStat, ErrMsg, OnlySize ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutParam_Buf)-1 ) = Re_OutParam_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutParam_Buf)-1 ) = Db_OutParam_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutParam_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutParam_Buf)-1 ) = Int_OutParam_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OutParam_Buf)
  ENDIF
  IF( ALLOCATED(Re_OutParam_Buf) )  DEALLOCATE(Re_OutParam_Buf)
  IF( ALLOCATED(Db_OutParam_Buf) )  DEALLOCATE(Db_OutParam_Buf)
  IF( ALLOCATED(Int_OutParam_Buf) ) DEALLOCATE(Int_OutParam_Buf)
ENDDO
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AvgNrmTpRd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AzimB1Up )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CosDel3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CosPreC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CosPreC))-1 ) =  PACK(InData%CosPreC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CosPreC)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CRFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSRFrlSkw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSRFrlTlt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSTFrlSkw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CSTFrlTlt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubCM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacCMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%OverHang )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ProjArea )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRefzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RefTwrHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVDzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVIMUzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rVPzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWIzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWJzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rWKzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rZT0zt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%rZYzt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SinDel3 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%SinPreC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SinPreC))-1 ) =  PACK(InData%SinPreC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SinPreC)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SRFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SShftSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SShftTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinBank )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFinTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlSkew )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlSkw2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlTilt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STFrlTlt2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntxn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlPntzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TowerBsHt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%UndSling )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%AxRedTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedTFA))-1 ) =  PACK(InData%AxRedTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedTFA)
  ENDIF
  IF ( ALLOCATED(InData%AxRedTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedTSS))-1 ) =  PACK(InData%AxRedTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedTSS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTFA))-1 ) =  PACK(InData%CTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%CTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTSS))-1 ) =  PACK(InData%CTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%CTSS)
  IF ( ALLOCATED(InData%DHNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DHNodes))-1 ) =  PACK(InData%DHNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DHNodes)
  ENDIF
  IF ( ALLOCATED(InData%HNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HNodes))-1 ) =  PACK(InData%HNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HNodes)
  ENDIF
  IF ( ALLOCATED(InData%HNodesNorm) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HNodesNorm))-1 ) =  PACK(InData%HNodesNorm ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HNodesNorm)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KTFA))-1 ) =  PACK(InData%KTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%KTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KTSS))-1 ) =  PACK(InData%KTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%KTSS)
  IF ( ALLOCATED(InData%MassT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MassT))-1 ) =  PACK(InData%MassT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MassT)
  ENDIF
  IF ( ALLOCATED(InData%StiffTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTSS))-1 ) =  PACK(InData%StiffTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTSS)
  ENDIF
  IF ( ALLOCATED(InData%TwrFASF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrFASF))-1 ) =  PACK(InData%TwrFASF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrFASF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrFlexL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TwrSSSF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrSSSF))-1 ) =  PACK(InData%TwrSSSF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrSSSF)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TTopNode )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%InerTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerTFA))-1 ) =  PACK(InData%InerTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerTFA)
  ENDIF
  IF ( ALLOCATED(InData%InerTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerTSS))-1 ) =  PACK(InData%InerTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerTSS)
  ENDIF
  IF ( ALLOCATED(InData%StiffTGJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTGJ))-1 ) =  PACK(InData%StiffTGJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTGJ)
  ENDIF
  IF ( ALLOCATED(InData%StiffTEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTEA))-1 ) =  PACK(InData%StiffTEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTEA)
  ENDIF
  IF ( ALLOCATED(InData%StiffTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffTFA))-1 ) =  PACK(InData%StiffTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffTFA)
  ENDIF
  IF ( ALLOCATED(InData%cgOffTFA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffTFA))-1 ) =  PACK(InData%cgOffTFA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffTFA)
  ENDIF
  IF ( ALLOCATED(InData%cgOffTSS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffTSS))-1 ) =  PACK(InData%cgOffTSS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffTSS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AtfaIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BldCG) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldCG))-1 ) =  PACK(InData%BldCG ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldCG)
  ENDIF
  IF ( ALLOCATED(InData%BldMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldMass))-1 ) =  PACK(InData%BldMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BoomMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%FirstMom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FirstMom))-1 ) =  PACK(InData%FirstMom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FirstMom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Hubg1Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Hubg2Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Nacd2Iner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NacMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmPIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmRIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmYIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RrfaIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%SecondMom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SecondMom))-1 ) =  PACK(InData%SecondMom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SecondMom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFinMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlIner )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%TipMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TipMass))-1 ) =  PACK(InData%TipMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TipMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TurbMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrTpMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMass )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Gravity )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%PitchAxis) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PitchAxis))-1 ) =  PACK(InData%PitchAxis ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PitchAxis)
  ENDIF
  IF ( ALLOCATED(InData%AeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AeroTwst))-1 ) =  PACK(InData%AeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%AxRedBld) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AxRedBld))-1 ) =  PACK(InData%AxRedBld ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AxRedBld)
  ENDIF
  IF ( ALLOCATED(InData%BAlpha) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BAlpha))-1 ) =  PACK(InData%BAlpha ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BAlpha)
  ENDIF
  IF ( ALLOCATED(InData%BldEDamp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEDamp))-1 ) =  PACK(InData%BldEDamp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEDamp)
  ENDIF
  IF ( ALLOCATED(InData%BldFDamp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFDamp))-1 ) =  PACK(InData%BldFDamp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFDamp)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BldFlexL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CAeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CAeroTwst))-1 ) =  PACK(InData%CAeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CAeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%CBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CBE))-1 ) =  PACK(InData%CBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CBE)
  ENDIF
  IF ( ALLOCATED(InData%CBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CBF))-1 ) =  PACK(InData%CBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CBF)
  ENDIF
  IF ( ALLOCATED(InData%cgOffBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffBEdg))-1 ) =  PACK(InData%cgOffBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffBEdg)
  ENDIF
  IF ( ALLOCATED(InData%cgOffBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%cgOffBFlp))-1 ) =  PACK(InData%cgOffBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%cgOffBFlp)
  ENDIF
  IF ( ALLOCATED(InData%Chord) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Chord))-1 ) =  PACK(InData%Chord ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%Chord)
  ENDIF
  IF ( ALLOCATED(InData%CThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CThetaS))-1 ) =  PACK(InData%CThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CThetaS)
  ENDIF
  IF ( ALLOCATED(InData%DRNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DRNodes))-1 ) =  PACK(InData%DRNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DRNodes)
  ENDIF
  IF ( ALLOCATED(InData%EAOffBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAOffBEdg))-1 ) =  PACK(InData%EAOffBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAOffBEdg)
  ENDIF
  IF ( ALLOCATED(InData%EAOffBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%EAOffBFlp))-1 ) =  PACK(InData%EAOffBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%EAOffBFlp)
  ENDIF
  IF ( ALLOCATED(InData%FStTunr) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FStTunr))-1 ) =  PACK(InData%FStTunr ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FStTunr)
  ENDIF
  IF ( ALLOCATED(InData%InerBEdg) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerBEdg))-1 ) =  PACK(InData%InerBEdg ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerBEdg)
  ENDIF
  IF ( ALLOCATED(InData%InerBFlp) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%InerBFlp))-1 ) =  PACK(InData%InerBFlp ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%InerBFlp)
  ENDIF
  IF ( ALLOCATED(InData%KBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KBE))-1 ) =  PACK(InData%KBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%KBE)
  ENDIF
  IF ( ALLOCATED(InData%KBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%KBF))-1 ) =  PACK(InData%KBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%KBF)
  ENDIF
  IF ( ALLOCATED(InData%MassB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MassB))-1 ) =  PACK(InData%MassB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MassB)
  ENDIF
  IF ( ALLOCATED(InData%RefAxisxb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RefAxisxb))-1 ) =  PACK(InData%RefAxisxb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RefAxisxb)
  ENDIF
  IF ( ALLOCATED(InData%RefAxisyb) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RefAxisyb))-1 ) =  PACK(InData%RefAxisyb ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RefAxisyb)
  ENDIF
  IF ( ALLOCATED(InData%RNodes) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodes))-1 ) =  PACK(InData%RNodes ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodes)
  ENDIF
  IF ( ALLOCATED(InData%RNodesNorm) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RNodesNorm))-1 ) =  PACK(InData%RNodesNorm ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RNodesNorm)
  ENDIF
  IF ( ALLOCATED(InData%rSAerCenn1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rSAerCenn1))-1 ) =  PACK(InData%rSAerCenn1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rSAerCenn1)
  ENDIF
  IF ( ALLOCATED(InData%rSAerCenn2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%rSAerCenn2))-1 ) =  PACK(InData%rSAerCenn2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%rSAerCenn2)
  ENDIF
  IF ( ALLOCATED(InData%SAeroTwst) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SAeroTwst))-1 ) =  PACK(InData%SAeroTwst ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SAeroTwst)
  ENDIF
  IF ( ALLOCATED(InData%StiffBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBE))-1 ) =  PACK(InData%StiffBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBE)
  ENDIF
  IF ( ALLOCATED(InData%StiffBEA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBEA))-1 ) =  PACK(InData%StiffBEA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBEA)
  ENDIF
  IF ( ALLOCATED(InData%StiffBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBF))-1 ) =  PACK(InData%StiffBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBF)
  ENDIF
  IF ( ALLOCATED(InData%StiffBGJ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StiffBGJ))-1 ) =  PACK(InData%StiffBGJ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StiffBGJ)
  ENDIF
  IF ( ALLOCATED(InData%SThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SThetaS))-1 ) =  PACK(InData%SThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SThetaS)
  ENDIF
  IF ( ALLOCATED(InData%ThetaS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ThetaS))-1 ) =  PACK(InData%ThetaS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ThetaS)
  ENDIF
  IF ( ALLOCATED(InData%TwistedSF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwistedSF))-1 ) =  PACK(InData%TwistedSF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwistedSF)
  ENDIF
  IF ( ALLOCATED(InData%BldFl1Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl1Sh))-1 ) =  PACK(InData%BldFl1Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldFl2Sh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldFl2Sh))-1 ) =  PACK(InData%BldFl2Sh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(InData%BldEdgSh) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BldEdgSh))-1 ) =  PACK(InData%BldEdgSh ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BldEdgSh)
  ENDIF
  IF ( ALLOCATED(InData%FreqBE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqBE))-1 ) =  PACK(InData%FreqBE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FreqBE)
  ENDIF
  IF ( ALLOCATED(InData%FreqBF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqBF))-1 ) =  PACK(InData%FreqBF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FreqBF)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqTFA))-1 ) =  PACK(InData%FreqTFA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FreqTFA)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FreqTSS))-1 ) =  PACK(InData%FreqTSS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%FreqTSS)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetDmpP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetHStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSSSp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TeetSStP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TeetMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%TFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlCDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlDSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSDP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RFrlUSSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%RFrlMod )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShftGagL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BldGagNd))-1 ) = PACK(InData%BldGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%BldGagNd)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%TwrGagNd))-1 ) = PACK(InData%TwrGagNd ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%TwrGagNd)
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%TStart )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorDmp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTTorSpr )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBRatio )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GBoxEff )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%BElmntMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BElmntMass))-1 ) =  PACK(InData%BElmntMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BElmntMass)
  ENDIF
  IF ( ALLOCATED(InData%TElmntMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TElmntMass))-1 ) =  PACK(InData%TElmntMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TElmntMass)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%method )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMxt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PtfmCMyt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%BD4Blades ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE ED_PackParam

 SUBROUTINE ED_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_ParameterType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_DOFs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DOFs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DOFs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_OutParam_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OutParam_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OutParam_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DT24 = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%BldNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TipNode = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NDOF = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TwoPiNB = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NAug = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NPH = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PH) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PH,1)))
  mask1 = .TRUE.
    OutData%PH = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PH))-1 ),mask1,OutData%PH)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PH)
  ENDIF
  OutData%NPM = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%PM) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PM,1),SIZE(OutData%PM,2)))
  mask2 = .TRUE.
    OutData%PM = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%PM))-1 ),mask2,OutData%PM)
  DEALLOCATE(mask2)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%PM)
  ENDIF
  IF ( ALLOCATED(OutData%DOF_Flag) ) THEN
  ENDIF
 ! first call ED_Packactivedofs to get correctly sized buffers for unpacking
  CALL ED_Packactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, OutData%DOFs, ErrStat, ErrMsg, .TRUE. ) ! DOFs 
  IF(ALLOCATED(Re_DOFs_Buf)) THEN
    Re_DOFs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DOFs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DOFs_Buf)) THEN
    Db_DOFs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DOFs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DOFs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DOFs_Buf)) THEN
    Int_DOFs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DOFs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DOFs_Buf)
  ENDIF
  CALL ED_UnPackactivedofs( Re_DOFs_Buf, Db_DOFs_Buf, Int_DOFs_Buf, OutData%DOFs, ErrStat, ErrMsg ) ! DOFs 
  OutData%NumOuts = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NBlGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwGages = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
DO i1 = LBOUND(OutData%OutParam,1), UBOUND(OutData%OutParam,1)
 ! first call NWTC_Library_Packoutparmtype to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, OutData%OutParam(i1), ErrStat, ErrMsg, .TRUE. ) ! OutParam 
  IF(ALLOCATED(Re_OutParam_Buf)) THEN
    Re_OutParam_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutParam_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutParam_Buf)) THEN
    Db_OutParam_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutParam_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OutParam_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutParam_Buf)) THEN
    Int_OutParam_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutParam_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OutParam_Buf)
  ENDIF
  CALL NWTC_Library_UnPackoutparmtype( Re_OutParam_Buf, Db_OutParam_Buf, Int_OutParam_Buf, OutData%OutParam(i1), ErrStat, ErrMsg ) ! OutParam 
ENDDO
  OutData%AvgNrmTpRd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%AzimB1Up = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CosDel3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CosPreC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CosPreC,1)))
  mask1 = .TRUE.
    OutData%CosPreC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CosPreC))-1 ),mask1,OutData%CosPreC)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CosPreC)
  ENDIF
  OutData%CRFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CRFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSRFrlSkw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSRFrlTlt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSTFrlSkw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CSTFrlTlt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubCM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacCMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%OverHang = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%ProjArea = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRefzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RefTwrHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVDzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVIMUzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rVPzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWIzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWJzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rWKzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rZT0zt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%rZYzt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SinDel3 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%SinPreC) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SinPreC,1)))
  mask1 = .TRUE.
    OutData%SinPreC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SinPreC))-1 ),mask1,OutData%SinPreC)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SinPreC)
  ENDIF
  OutData%SRFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SRFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SShftSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SShftTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinBank = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFinTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlSkew = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlSkw2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlTilt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STFrlTlt2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntxn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlPntzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TowerBsHt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UndSling = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%AxRedTFA) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AxRedTFA,1),SIZE(OutData%AxRedTFA,2),SIZE(OutData%AxRedTFA,3)))
  mask3 = .TRUE.
    OutData%AxRedTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedTFA))-1 ),mask3,OutData%AxRedTFA)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedTFA)
  ENDIF
  IF ( ALLOCATED(OutData%AxRedTSS) ) THEN
  ALLOCATE(mask3(SIZE(OutData%AxRedTSS,1),SIZE(OutData%AxRedTSS,2),SIZE(OutData%AxRedTSS,3)))
  mask3 = .TRUE.
    OutData%AxRedTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedTSS))-1 ),mask3,OutData%AxRedTSS)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedTSS)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%CTFA,1),SIZE(OutData%CTFA,2)))
  mask2 = .TRUE.
  OutData%CTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTFA))-1 ),mask2,OutData%CTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%CTFA)
  ALLOCATE(mask2(SIZE(OutData%CTSS,1),SIZE(OutData%CTSS,2)))
  mask2 = .TRUE.
  OutData%CTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTSS))-1 ),mask2,OutData%CTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%CTSS)
  IF ( ALLOCATED(OutData%DHNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DHNodes,1)))
  mask1 = .TRUE.
    OutData%DHNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DHNodes))-1 ),mask1,OutData%DHNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DHNodes)
  ENDIF
  IF ( ALLOCATED(OutData%HNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HNodes,1)))
  mask1 = .TRUE.
    OutData%HNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HNodes))-1 ),mask1,OutData%HNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HNodes)
  ENDIF
  IF ( ALLOCATED(OutData%HNodesNorm) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HNodesNorm,1)))
  mask1 = .TRUE.
    OutData%HNodesNorm = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HNodesNorm))-1 ),mask1,OutData%HNodesNorm)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HNodesNorm)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%KTFA,1),SIZE(OutData%KTFA,2)))
  mask2 = .TRUE.
  OutData%KTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KTFA))-1 ),mask2,OutData%KTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%KTFA)
  ALLOCATE(mask2(SIZE(OutData%KTSS,1),SIZE(OutData%KTSS,2)))
  mask2 = .TRUE.
  OutData%KTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KTSS))-1 ),mask2,OutData%KTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%KTSS)
  IF ( ALLOCATED(OutData%MassT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%MassT,1)))
  mask1 = .TRUE.
    OutData%MassT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MassT))-1 ),mask1,OutData%MassT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MassT)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTSS,1)))
  mask1 = .TRUE.
    OutData%StiffTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTSS))-1 ),mask1,OutData%StiffTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTSS)
  ENDIF
  IF ( ALLOCATED(OutData%TwrFASF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrFASF,1),SIZE(OutData%TwrFASF,2),SIZE(OutData%TwrFASF,3)))
  mask3 = .TRUE.
    OutData%TwrFASF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrFASF))-1 ),mask3,OutData%TwrFASF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrFASF)
  ENDIF
  OutData%TwrFlexL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrSSSF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrSSSF,1),SIZE(OutData%TwrSSSF,2),SIZE(OutData%TwrSSSF,3)))
  mask3 = .TRUE.
    OutData%TwrSSSF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrSSSF))-1 ),mask3,OutData%TwrSSSF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrSSSF)
  ENDIF
  OutData%TTopNode = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%InerTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InerTFA,1)))
  mask1 = .TRUE.
    OutData%InerTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerTFA))-1 ),mask1,OutData%InerTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerTFA)
  ENDIF
  IF ( ALLOCATED(OutData%InerTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%InerTSS,1)))
  mask1 = .TRUE.
    OutData%InerTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerTSS))-1 ),mask1,OutData%InerTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerTSS)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTGJ) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTGJ,1)))
  mask1 = .TRUE.
    OutData%StiffTGJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTGJ))-1 ),mask1,OutData%StiffTGJ)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTGJ)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTEA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTEA,1)))
  mask1 = .TRUE.
    OutData%StiffTEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTEA))-1 ),mask1,OutData%StiffTEA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTEA)
  ENDIF
  IF ( ALLOCATED(OutData%StiffTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%StiffTFA,1)))
  mask1 = .TRUE.
    OutData%StiffTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffTFA))-1 ),mask1,OutData%StiffTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffTFA)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffTFA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%cgOffTFA,1)))
  mask1 = .TRUE.
    OutData%cgOffTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffTFA))-1 ),mask1,OutData%cgOffTFA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffTFA)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffTSS) ) THEN
  ALLOCATE(mask1(SIZE(OutData%cgOffTSS,1)))
  mask1 = .TRUE.
    OutData%cgOffTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffTSS))-1 ),mask1,OutData%cgOffTSS)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffTSS)
  ENDIF
  OutData%AtfaIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BldCG) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldCG,1)))
  mask1 = .TRUE.
    OutData%BldCG = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldCG))-1 ),mask1,OutData%BldCG)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldCG)
  ENDIF
  IF ( ALLOCATED(OutData%BldMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BldMass,1)))
  mask1 = .TRUE.
    OutData%BldMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldMass))-1 ),mask1,OutData%BldMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldMass)
  ENDIF
  OutData%BoomMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%FirstMom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%FirstMom,1)))
  mask1 = .TRUE.
    OutData%FirstMom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FirstMom))-1 ),mask1,OutData%FirstMom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FirstMom)
  ENDIF
  OutData%GenIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Hubg1Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Hubg2Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HubMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Nacd2Iner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NacMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmPIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmRIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmYIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RrfaIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%SecondMom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SecondMom,1)))
  mask1 = .TRUE.
    OutData%SecondMom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SecondMom))-1 ),mask1,OutData%SecondMom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SecondMom)
  ENDIF
  OutData%TFinMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlIner = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%TipMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TipMass,1)))
  mask1 = .TRUE.
    OutData%TipMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TipMass))-1 ),mask1,OutData%TipMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TipMass)
  ENDIF
  OutData%TurbMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrTpMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMass = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Gravity = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%PitchAxis) ) THEN
  ALLOCATE(mask2(SIZE(OutData%PitchAxis,1),SIZE(OutData%PitchAxis,2)))
  mask2 = .TRUE.
    OutData%PitchAxis = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PitchAxis))-1 ),mask2,OutData%PitchAxis)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PitchAxis)
  ENDIF
  IF ( ALLOCATED(OutData%AeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AeroTwst,1)))
  mask1 = .TRUE.
    OutData%AeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AeroTwst))-1 ),mask1,OutData%AeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%AxRedBld) ) THEN
  ALLOCATE(mask4(SIZE(OutData%AxRedBld,1),SIZE(OutData%AxRedBld,2),SIZE(OutData%AxRedBld,3),SIZE(OutData%AxRedBld,4)))
  mask4 = .TRUE.
    OutData%AxRedBld = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AxRedBld))-1 ),mask4,OutData%AxRedBld)
  DEALLOCATE(mask4)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AxRedBld)
  ENDIF
  IF ( ALLOCATED(OutData%BAlpha) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BAlpha,1),SIZE(OutData%BAlpha,2)))
  mask2 = .TRUE.
    OutData%BAlpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BAlpha))-1 ),mask2,OutData%BAlpha)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BAlpha)
  ENDIF
  IF ( ALLOCATED(OutData%BldEDamp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldEDamp,1),SIZE(OutData%BldEDamp,2)))
  mask2 = .TRUE.
    OutData%BldEDamp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEDamp))-1 ),mask2,OutData%BldEDamp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEDamp)
  ENDIF
  IF ( ALLOCATED(OutData%BldFDamp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFDamp,1),SIZE(OutData%BldFDamp,2)))
  mask2 = .TRUE.
    OutData%BldFDamp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFDamp))-1 ),mask2,OutData%BldFDamp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFDamp)
  ENDIF
  OutData%BldFlexL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CAeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CAeroTwst,1)))
  mask1 = .TRUE.
    OutData%CAeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CAeroTwst))-1 ),mask1,OutData%CAeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CAeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%CBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CBE,1),SIZE(OutData%CBE,2),SIZE(OutData%CBE,3)))
  mask3 = .TRUE.
    OutData%CBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CBE))-1 ),mask3,OutData%CBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CBE)
  ENDIF
  IF ( ALLOCATED(OutData%CBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CBF,1),SIZE(OutData%CBF,2),SIZE(OutData%CBF,3)))
  mask3 = .TRUE.
    OutData%CBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CBF))-1 ),mask3,OutData%CBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CBF)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%cgOffBEdg,1),SIZE(OutData%cgOffBEdg,2)))
  mask2 = .TRUE.
    OutData%cgOffBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffBEdg))-1 ),mask2,OutData%cgOffBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%cgOffBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%cgOffBFlp,1),SIZE(OutData%cgOffBFlp,2)))
  mask2 = .TRUE.
    OutData%cgOffBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%cgOffBFlp))-1 ),mask2,OutData%cgOffBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%cgOffBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%Chord) ) THEN
  ALLOCATE(mask1(SIZE(OutData%Chord,1)))
  mask1 = .TRUE.
    OutData%Chord = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Chord))-1 ),mask1,OutData%Chord)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%Chord)
  ENDIF
  IF ( ALLOCATED(OutData%CThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CThetaS,1),SIZE(OutData%CThetaS,2)))
  mask2 = .TRUE.
    OutData%CThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CThetaS))-1 ),mask2,OutData%CThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%DRNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DRNodes,1)))
  mask1 = .TRUE.
    OutData%DRNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DRNodes))-1 ),mask1,OutData%DRNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DRNodes)
  ENDIF
  IF ( ALLOCATED(OutData%EAOffBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%EAOffBEdg,1),SIZE(OutData%EAOffBEdg,2)))
  mask2 = .TRUE.
    OutData%EAOffBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAOffBEdg))-1 ),mask2,OutData%EAOffBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAOffBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%EAOffBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%EAOffBFlp,1),SIZE(OutData%EAOffBFlp,2)))
  mask2 = .TRUE.
    OutData%EAOffBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%EAOffBFlp))-1 ),mask2,OutData%EAOffBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%EAOffBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%FStTunr) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FStTunr,1),SIZE(OutData%FStTunr,2)))
  mask2 = .TRUE.
    OutData%FStTunr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FStTunr))-1 ),mask2,OutData%FStTunr)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FStTunr)
  ENDIF
  IF ( ALLOCATED(OutData%InerBEdg) ) THEN
  ALLOCATE(mask2(SIZE(OutData%InerBEdg,1),SIZE(OutData%InerBEdg,2)))
  mask2 = .TRUE.
    OutData%InerBEdg = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerBEdg))-1 ),mask2,OutData%InerBEdg)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerBEdg)
  ENDIF
  IF ( ALLOCATED(OutData%InerBFlp) ) THEN
  ALLOCATE(mask2(SIZE(OutData%InerBFlp,1),SIZE(OutData%InerBFlp,2)))
  mask2 = .TRUE.
    OutData%InerBFlp = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%InerBFlp))-1 ),mask2,OutData%InerBFlp)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%InerBFlp)
  ENDIF
  IF ( ALLOCATED(OutData%KBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%KBE,1),SIZE(OutData%KBE,2),SIZE(OutData%KBE,3)))
  mask3 = .TRUE.
    OutData%KBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KBE))-1 ),mask3,OutData%KBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%KBE)
  ENDIF
  IF ( ALLOCATED(OutData%KBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%KBF,1),SIZE(OutData%KBF,2),SIZE(OutData%KBF,3)))
  mask3 = .TRUE.
    OutData%KBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%KBF))-1 ),mask3,OutData%KBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%KBF)
  ENDIF
  IF ( ALLOCATED(OutData%MassB) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MassB,1),SIZE(OutData%MassB,2)))
  mask2 = .TRUE.
    OutData%MassB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MassB))-1 ),mask2,OutData%MassB)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MassB)
  ENDIF
  IF ( ALLOCATED(OutData%RefAxisxb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%RefAxisxb,1),SIZE(OutData%RefAxisxb,2)))
  mask2 = .TRUE.
    OutData%RefAxisxb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RefAxisxb))-1 ),mask2,OutData%RefAxisxb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RefAxisxb)
  ENDIF
  IF ( ALLOCATED(OutData%RefAxisyb) ) THEN
  ALLOCATE(mask2(SIZE(OutData%RefAxisyb,1),SIZE(OutData%RefAxisyb,2)))
  mask2 = .TRUE.
    OutData%RefAxisyb = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RefAxisyb))-1 ),mask2,OutData%RefAxisyb)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RefAxisyb)
  ENDIF
  IF ( ALLOCATED(OutData%RNodes) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodes,1)))
  mask1 = .TRUE.
    OutData%RNodes = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodes))-1 ),mask1,OutData%RNodes)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodes)
  ENDIF
  IF ( ALLOCATED(OutData%RNodesNorm) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RNodesNorm,1)))
  mask1 = .TRUE.
    OutData%RNodesNorm = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RNodesNorm))-1 ),mask1,OutData%RNodesNorm)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RNodesNorm)
  ENDIF
  IF ( ALLOCATED(OutData%rSAerCenn1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rSAerCenn1,1),SIZE(OutData%rSAerCenn1,2)))
  mask2 = .TRUE.
    OutData%rSAerCenn1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rSAerCenn1))-1 ),mask2,OutData%rSAerCenn1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rSAerCenn1)
  ENDIF
  IF ( ALLOCATED(OutData%rSAerCenn2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%rSAerCenn2,1),SIZE(OutData%rSAerCenn2,2)))
  mask2 = .TRUE.
    OutData%rSAerCenn2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%rSAerCenn2))-1 ),mask2,OutData%rSAerCenn2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%rSAerCenn2)
  ENDIF
  IF ( ALLOCATED(OutData%SAeroTwst) ) THEN
  ALLOCATE(mask1(SIZE(OutData%SAeroTwst,1)))
  mask1 = .TRUE.
    OutData%SAeroTwst = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SAeroTwst))-1 ),mask1,OutData%SAeroTwst)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SAeroTwst)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBE,1),SIZE(OutData%StiffBE,2)))
  mask2 = .TRUE.
    OutData%StiffBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBE))-1 ),mask2,OutData%StiffBE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBE)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBEA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBEA,1),SIZE(OutData%StiffBEA,2)))
  mask2 = .TRUE.
    OutData%StiffBEA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBEA))-1 ),mask2,OutData%StiffBEA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBEA)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBF,1),SIZE(OutData%StiffBF,2)))
  mask2 = .TRUE.
    OutData%StiffBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBF))-1 ),mask2,OutData%StiffBF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBF)
  ENDIF
  IF ( ALLOCATED(OutData%StiffBGJ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%StiffBGJ,1),SIZE(OutData%StiffBGJ,2)))
  mask2 = .TRUE.
    OutData%StiffBGJ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StiffBGJ))-1 ),mask2,OutData%StiffBGJ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StiffBGJ)
  ENDIF
  IF ( ALLOCATED(OutData%SThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SThetaS,1),SIZE(OutData%SThetaS,2)))
  mask2 = .TRUE.
    OutData%SThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SThetaS))-1 ),mask2,OutData%SThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%ThetaS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ThetaS,1),SIZE(OutData%ThetaS,2)))
  mask2 = .TRUE.
    OutData%ThetaS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ThetaS))-1 ),mask2,OutData%ThetaS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ThetaS)
  ENDIF
  IF ( ALLOCATED(OutData%TwistedSF) ) THEN
  ALLOCATE(mask5(SIZE(OutData%TwistedSF,1),SIZE(OutData%TwistedSF,2),SIZE(OutData%TwistedSF,3),SIZE(OutData%TwistedSF,4),SIZE(OutData%TwistedSF,5)))
  mask5 = .TRUE.
    OutData%TwistedSF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwistedSF))-1 ),mask5,OutData%TwistedSF)
  DEALLOCATE(mask5)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwistedSF)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl1Sh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFl1Sh,1),SIZE(OutData%BldFl1Sh,2)))
  mask2 = .TRUE.
    OutData%BldFl1Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl1Sh))-1 ),mask2,OutData%BldFl1Sh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl1Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldFl2Sh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldFl2Sh,1),SIZE(OutData%BldFl2Sh,2)))
  mask2 = .TRUE.
    OutData%BldFl2Sh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldFl2Sh))-1 ),mask2,OutData%BldFl2Sh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldFl2Sh)
  ENDIF
  IF ( ALLOCATED(OutData%BldEdgSh) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BldEdgSh,1),SIZE(OutData%BldEdgSh,2)))
  mask2 = .TRUE.
    OutData%BldEdgSh = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BldEdgSh))-1 ),mask2,OutData%BldEdgSh)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BldEdgSh)
  ENDIF
  IF ( ALLOCATED(OutData%FreqBE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FreqBE,1),SIZE(OutData%FreqBE,2),SIZE(OutData%FreqBE,3)))
  mask3 = .TRUE.
    OutData%FreqBE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqBE))-1 ),mask3,OutData%FreqBE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqBE)
  ENDIF
  IF ( ALLOCATED(OutData%FreqBF) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FreqBF,1),SIZE(OutData%FreqBF,2),SIZE(OutData%FreqBF,3)))
  mask3 = .TRUE.
    OutData%FreqBF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqBF))-1 ),mask3,OutData%FreqBF)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqBF)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%FreqTFA,1),SIZE(OutData%FreqTFA,2)))
  mask2 = .TRUE.
  OutData%FreqTFA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqTFA))-1 ),mask2,OutData%FreqTFA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqTFA)
  ALLOCATE(mask2(SIZE(OutData%FreqTSS,1),SIZE(OutData%FreqTSS,2)))
  mask2 = .TRUE.
  OutData%FreqTSS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FreqTSS))-1 ),mask2,OutData%FreqTSS)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%FreqTSS)
  OutData%TeetCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetDmpP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetHStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSSSp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetSStP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TeetMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%TFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%RFrlCDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlDSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSDP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlUSSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RFrlMod = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ShftGagL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%BldGagNd,1)))
  mask1 = .TRUE.
  OutData%BldGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%BldGagNd))-1 ),mask1,OutData%BldGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%BldGagNd)
  ALLOCATE(mask1(SIZE(OutData%TwrGagNd,1)))
  mask1 = .TRUE.
  OutData%TwrGagNd = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%TwrGagNd))-1 ),mask1,OutData%TwrGagNd)
  DEALLOCATE(mask1)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%TwrGagNd)
  OutData%TStart = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%DTTorDmp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%DTTorSpr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBRatio = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GBoxEff = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%BElmntMass) ) THEN
  ALLOCATE(mask2(SIZE(OutData%BElmntMass,1),SIZE(OutData%BElmntMass,2)))
  mask2 = .TRUE.
    OutData%BElmntMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BElmntMass))-1 ),mask2,OutData%BElmntMass)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BElmntMass)
  ENDIF
  IF ( ALLOCATED(OutData%TElmntMass) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TElmntMass,1)))
  mask1 = .TRUE.
    OutData%TElmntMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TElmntMass))-1 ),mask1,OutData%TElmntMass)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TElmntMass)
  ENDIF
  OutData%method = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%PtfmCMxt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%PtfmCMyt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackParam

 SUBROUTINE ED_CopyInput( SrcInputData, DstInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_InputType), INTENT(INOUT) :: SrcInputData
   TYPE(ED_InputType), INTENT(INOUT) :: DstInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInputData%BladeLn2Mesh)) THEN
   i1_l = LBOUND(SrcInputData%BladeLn2Mesh,1)
   i1_u = UBOUND(SrcInputData%BladeLn2Mesh,1)
   IF (.NOT. ALLOCATED(DstInputData%BladeLn2Mesh)) THEN 
      ALLOCATE(DstInputData%BladeLn2Mesh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%BladeLn2Mesh.', ErrStat, ErrMsg,'ED_CopyInput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputData%BladeLn2Mesh,1), UBOUND(SrcInputData%BladeLn2Mesh,1)
     CALL MeshCopy( SrcInputData%BladeLn2Mesh(i1), DstInputData%BladeLn2Mesh(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInput:BladeLn2Mesh(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcInputData%PlatformPtMesh, DstInputData%PlatformPtMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInput:PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcInputData%TowerLn2Mesh, DstInputData%TowerLn2Mesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInput:TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcInputData%NacelleLoads, DstInputData%NacelleLoads, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyInput:NacelleLoads')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcInputData%TwrAddedMass)) THEN
   i1_l = LBOUND(SrcInputData%TwrAddedMass,1)
   i1_u = UBOUND(SrcInputData%TwrAddedMass,1)
   i2_l = LBOUND(SrcInputData%TwrAddedMass,2)
   i2_u = UBOUND(SrcInputData%TwrAddedMass,2)
   i3_l = LBOUND(SrcInputData%TwrAddedMass,3)
   i3_u = UBOUND(SrcInputData%TwrAddedMass,3)
   IF (.NOT. ALLOCATED(DstInputData%TwrAddedMass)) THEN 
      ALLOCATE(DstInputData%TwrAddedMass(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%TwrAddedMass.', ErrStat, ErrMsg,'ED_CopyInput')
         RETURN
      END IF
   END IF
   DstInputData%TwrAddedMass = SrcInputData%TwrAddedMass
ENDIF
   DstInputData%PtfmAddedMass = SrcInputData%PtfmAddedMass
IF (ALLOCATED(SrcInputData%BlPitchCom)) THEN
   i1_l = LBOUND(SrcInputData%BlPitchCom,1)
   i1_u = UBOUND(SrcInputData%BlPitchCom,1)
   IF (.NOT. ALLOCATED(DstInputData%BlPitchCom)) THEN 
      ALLOCATE(DstInputData%BlPitchCom(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%BlPitchCom.', ErrStat, ErrMsg,'ED_CopyInput')
         RETURN
      END IF
   END IF
   DstInputData%BlPitchCom = SrcInputData%BlPitchCom
ENDIF
   DstInputData%YawMom = SrcInputData%YawMom
   DstInputData%GenTrq = SrcInputData%GenTrq
   DstInputData%HSSBrTrqC = SrcInputData%HSSBrTrqC
 END SUBROUTINE ED_CopyInput

 SUBROUTINE ED_DestroyInput( InputData, ErrStat, ErrMsg )
  TYPE(ED_InputType), INTENT(INOUT) :: InputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InputData%BladeLn2Mesh)) THEN
DO i1 = LBOUND(InputData%BladeLn2Mesh,1), UBOUND(InputData%BladeLn2Mesh,1)
  CALL MeshDestroy( InputData%BladeLn2Mesh(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputData%BladeLn2Mesh)
ENDIF
  CALL MeshDestroy( InputData%PlatformPtMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( InputData%TowerLn2Mesh, ErrStat, ErrMsg )
  CALL MeshDestroy( InputData%NacelleLoads, ErrStat, ErrMsg )
IF (ALLOCATED(InputData%TwrAddedMass)) THEN
   DEALLOCATE(InputData%TwrAddedMass)
ENDIF
IF (ALLOCATED(InputData%BlPitchCom)) THEN
   DEALLOCATE(InputData%BlPitchCom)
ENDIF
 END SUBROUTINE ED_DestroyInput

 SUBROUTINE ED_PackInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_InputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_BladeLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_BladeLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_BladeLn2Mesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_NacelleLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_NacelleLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_NacelleLoads_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%BladeLn2Mesh,1), UBOUND(InData%BladeLn2Mesh,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_BladeLn2Mesh_Buf  ) ! BladeLn2Mesh
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_BladeLn2Mesh_Buf  ) ! BladeLn2Mesh
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_BladeLn2Mesh_Buf ) ! BladeLn2Mesh
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf))  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf))  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Int_PlatformPtMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_PlatformPtMesh_Buf ) ! PlatformPtMesh
  IF(ALLOCATED(Re_PlatformPtMesh_Buf))  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF(ALLOCATED(Db_PlatformPtMesh_Buf))  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TowerLn2Mesh_Buf ) ! TowerLn2Mesh
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf))  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf))  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( InData%NacelleLoads, Re_NacelleLoads_Buf, Db_NacelleLoads_Buf, Int_NacelleLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! NacelleLoads 
  IF(ALLOCATED(Re_NacelleLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_NacelleLoads_Buf  ) ! NacelleLoads
  IF(ALLOCATED(Db_NacelleLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_NacelleLoads_Buf  ) ! NacelleLoads
  IF(ALLOCATED(Int_NacelleLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_NacelleLoads_Buf ) ! NacelleLoads
  IF(ALLOCATED(Re_NacelleLoads_Buf))  DEALLOCATE(Re_NacelleLoads_Buf)
  IF(ALLOCATED(Db_NacelleLoads_Buf))  DEALLOCATE(Db_NacelleLoads_Buf)
  IF(ALLOCATED(Int_NacelleLoads_Buf)) DEALLOCATE(Int_NacelleLoads_Buf)
  IF ( ALLOCATED(InData%TwrAddedMass) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrAddedMass )  ! TwrAddedMass 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PtfmAddedMass )  ! PtfmAddedMass 
  IF ( ALLOCATED(InData%BlPitchCom) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitchCom )  ! BlPitchCom 
  Re_BufSz   = Re_BufSz   + 1  ! YawMom
  Re_BufSz   = Re_BufSz   + 1  ! GenTrq
  Re_BufSz   = Re_BufSz   + 1  ! HSSBrTrqC
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%BladeLn2Mesh,1), UBOUND(InData%BladeLn2Mesh,1)
  CALL MeshPack( InData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeLn2Mesh_Buf)-1 ) = Re_BladeLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeLn2Mesh_Buf)-1 ) = Db_BladeLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeLn2Mesh_Buf)-1 ) = Int_BladeLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_BladeLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_BladeLn2Mesh_Buf) )  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Db_BladeLn2Mesh_Buf) )  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Int_BladeLn2Mesh_Buf) ) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 ) = Re_PlatformPtMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 ) = Db_PlatformPtMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 ) = Int_PlatformPtMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 ) = Re_TowerLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 ) = Db_TowerLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 ) = Int_TowerLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( InData%NacelleLoads, Re_NacelleLoads_Buf, Db_NacelleLoads_Buf, Int_NacelleLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! NacelleLoads 
  IF(ALLOCATED(Re_NacelleLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_NacelleLoads_Buf)-1 ) = Re_NacelleLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_NacelleLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_NacelleLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_NacelleLoads_Buf)-1 ) = Db_NacelleLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_NacelleLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_NacelleLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_NacelleLoads_Buf)-1 ) = Int_NacelleLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_NacelleLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_NacelleLoads_Buf) )  DEALLOCATE(Re_NacelleLoads_Buf)
  IF( ALLOCATED(Db_NacelleLoads_Buf) )  DEALLOCATE(Db_NacelleLoads_Buf)
  IF( ALLOCATED(Int_NacelleLoads_Buf) ) DEALLOCATE(Int_NacelleLoads_Buf)
  IF ( ALLOCATED(InData%TwrAddedMass) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrAddedMass))-1 ) =  PACK(InData%TwrAddedMass ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrAddedMass)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PtfmAddedMass))-1 ) =  PACK(InData%PtfmAddedMass ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PtfmAddedMass)
  IF ( ALLOCATED(InData%BlPitchCom) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitchCom))-1 ) =  PACK(InData%BlPitchCom ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitchCom)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawMom )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%GenTrq )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSSBrTrqC )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackInput

 SUBROUTINE ED_UnPackInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_InputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_BladeLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_BladeLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_BladeLn2Mesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_NacelleLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_NacelleLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_NacelleLoads_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%BladeLn2Mesh,1), UBOUND(OutData%BladeLn2Mesh,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) THEN
    Re_BladeLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) THEN
    Db_BladeLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) THEN
    Int_BladeLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_BladeLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg ) ! BladeLn2Mesh 
  IF( ALLOCATED(Re_BladeLn2Mesh_Buf) )  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Db_BladeLn2Mesh_Buf) )  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Int_BladeLn2Mesh_Buf) ) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    Re_PlatformPtMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    Db_PlatformPtMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    Int_PlatformPtMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg ) ! PlatformPtMesh 
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    Re_TowerLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    Db_TowerLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    Int_TowerLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg ) ! TowerLn2Mesh 
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( OutData%NacelleLoads, Re_NacelleLoads_Buf, Db_NacelleLoads_Buf, Int_NacelleLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! NacelleLoads 
  IF(ALLOCATED(Re_NacelleLoads_Buf)) THEN
    Re_NacelleLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_NacelleLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_NacelleLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_NacelleLoads_Buf)) THEN
    Db_NacelleLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_NacelleLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_NacelleLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_NacelleLoads_Buf)) THEN
    Int_NacelleLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_NacelleLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_NacelleLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%NacelleLoads, Re_NacelleLoads_Buf, Db_NacelleLoads_Buf, Int_NacelleLoads_Buf, ErrStat, ErrMsg ) ! NacelleLoads 
  IF( ALLOCATED(Re_NacelleLoads_Buf) )  DEALLOCATE(Re_NacelleLoads_Buf)
  IF( ALLOCATED(Db_NacelleLoads_Buf) )  DEALLOCATE(Db_NacelleLoads_Buf)
  IF( ALLOCATED(Int_NacelleLoads_Buf) ) DEALLOCATE(Int_NacelleLoads_Buf)
  IF ( ALLOCATED(OutData%TwrAddedMass) ) THEN
  ALLOCATE(mask3(SIZE(OutData%TwrAddedMass,1),SIZE(OutData%TwrAddedMass,2),SIZE(OutData%TwrAddedMass,3)))
  mask3 = .TRUE.
    OutData%TwrAddedMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrAddedMass))-1 ),mask3,OutData%TwrAddedMass)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrAddedMass)
  ENDIF
  ALLOCATE(mask2(SIZE(OutData%PtfmAddedMass,1),SIZE(OutData%PtfmAddedMass,2)))
  mask2 = .TRUE.
  OutData%PtfmAddedMass = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PtfmAddedMass))-1 ),mask2,OutData%PtfmAddedMass)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PtfmAddedMass)
  IF ( ALLOCATED(OutData%BlPitchCom) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitchCom,1)))
  mask1 = .TRUE.
    OutData%BlPitchCom = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitchCom))-1 ),mask1,OutData%BlPitchCom)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitchCom)
  ENDIF
  OutData%YawMom = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%GenTrq = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HSSBrTrqC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackInput

 SUBROUTINE ED_CopyOutput( SrcOutputData, DstOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ED_OutputType), INTENT(INOUT) :: SrcOutputData
   TYPE(ED_OutputType), INTENT(INOUT) :: DstOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcOutputData%BladeLn2Mesh)) THEN
   i1_l = LBOUND(SrcOutputData%BladeLn2Mesh,1)
   i1_u = UBOUND(SrcOutputData%BladeLn2Mesh,1)
   IF (.NOT. ALLOCATED(DstOutputData%BladeLn2Mesh)) THEN 
      ALLOCATE(DstOutputData%BladeLn2Mesh(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputData%BladeLn2Mesh.', ErrStat, ErrMsg,'ED_CopyOutput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcOutputData%BladeLn2Mesh,1), UBOUND(SrcOutputData%BladeLn2Mesh,1)
     CALL MeshCopy( SrcOutputData%BladeLn2Mesh(i1), DstOutputData%BladeLn2Mesh(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:BladeLn2Mesh(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcOutputData%PlatformPtMesh, DstOutputData%PlatformPtMesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%TowerLn2Mesh, DstOutputData%TowerLn2Mesh, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%RotorApexMotion, DstOutputData%RotorApexMotion, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:RotorApexMotion')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%HubPtMotion, DstOutputData%HubPtMotion, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:HubPtMotion')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%BladeRootMotions, DstOutputData%BladeRootMotions, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:BladeRootMotions')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%RotorFurlMotion, DstOutputData%RotorFurlMotion, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:RotorFurlMotion')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%NacelleMotion, DstOutputData%NacelleMotion, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:NacelleMotion')
         IF (ErrStat>=AbortErrLev) RETURN
     CALL MeshCopy( SrcOutputData%TowerMotion, DstOutputData%TowerMotion, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_CopyOutput:TowerMotion')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcOutputData%WriteOutput)) THEN
   i1_l = LBOUND(SrcOutputData%WriteOutput,1)
   i1_u = UBOUND(SrcOutputData%WriteOutput,1)
   IF (.NOT. ALLOCATED(DstOutputData%WriteOutput)) THEN 
      ALLOCATE(DstOutputData%WriteOutput(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputData%WriteOutput.', ErrStat, ErrMsg,'ED_CopyOutput')
         RETURN
      END IF
   END IF
   DstOutputData%WriteOutput = SrcOutputData%WriteOutput
ENDIF
IF (ALLOCATED(SrcOutputData%BlPitch)) THEN
   i1_l = LBOUND(SrcOutputData%BlPitch,1)
   i1_u = UBOUND(SrcOutputData%BlPitch,1)
   IF (.NOT. ALLOCATED(DstOutputData%BlPitch)) THEN 
      ALLOCATE(DstOutputData%BlPitch(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputData%BlPitch.', ErrStat, ErrMsg,'ED_CopyOutput')
         RETURN
      END IF
   END IF
   DstOutputData%BlPitch = SrcOutputData%BlPitch
ENDIF
   DstOutputData%Yaw = SrcOutputData%Yaw
   DstOutputData%YawRate = SrcOutputData%YawRate
   DstOutputData%LSS_Spd = SrcOutputData%LSS_Spd
   DstOutputData%HSS_Spd = SrcOutputData%HSS_Spd
   DstOutputData%RotSpeed = SrcOutputData%RotSpeed
   DstOutputData%TwrAccel = SrcOutputData%TwrAccel
   DstOutputData%YawAngle = SrcOutputData%YawAngle
   DstOutputData%RootMyc = SrcOutputData%RootMyc
   DstOutputData%YawBrTAxp = SrcOutputData%YawBrTAxp
   DstOutputData%YawBrTAyp = SrcOutputData%YawBrTAyp
   DstOutputData%LSSTipPxa = SrcOutputData%LSSTipPxa
   DstOutputData%RootMxc = SrcOutputData%RootMxc
   DstOutputData%LSSTipMya = SrcOutputData%LSSTipMya
   DstOutputData%LSSTipMza = SrcOutputData%LSSTipMza
   DstOutputData%LSSTipMys = SrcOutputData%LSSTipMys
   DstOutputData%LSSTipMzs = SrcOutputData%LSSTipMzs
   DstOutputData%YawBrMyn = SrcOutputData%YawBrMyn
   DstOutputData%YawBrMzn = SrcOutputData%YawBrMzn
   DstOutputData%NcIMURAxs = SrcOutputData%NcIMURAxs
   DstOutputData%NcIMURAys = SrcOutputData%NcIMURAys
   DstOutputData%NcIMURAzs = SrcOutputData%NcIMURAzs
   DstOutputData%RotPwr = SrcOutputData%RotPwr
 END SUBROUTINE ED_CopyOutput

 SUBROUTINE ED_DestroyOutput( OutputData, ErrStat, ErrMsg )
  TYPE(ED_OutputType), INTENT(INOUT) :: OutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OutputData%BladeLn2Mesh)) THEN
DO i1 = LBOUND(OutputData%BladeLn2Mesh,1), UBOUND(OutputData%BladeLn2Mesh,1)
  CALL MeshDestroy( OutputData%BladeLn2Mesh(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(OutputData%BladeLn2Mesh)
ENDIF
  CALL MeshDestroy( OutputData%PlatformPtMesh, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%TowerLn2Mesh, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%RotorApexMotion, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%HubPtMotion, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%BladeRootMotions, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%RotorFurlMotion, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%NacelleMotion, ErrStat, ErrMsg )
  CALL MeshDestroy( OutputData%TowerMotion, ErrStat, ErrMsg )
IF (ALLOCATED(OutputData%WriteOutput)) THEN
   DEALLOCATE(OutputData%WriteOutput)
ENDIF
IF (ALLOCATED(OutputData%BlPitch)) THEN
   DEALLOCATE(OutputData%BlPitch)
ENDIF
 END SUBROUTINE ED_DestroyOutput

 SUBROUTINE ED_PackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ED_OutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_BladeLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_BladeLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_BladeLn2Mesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RotorApexMotion_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RotorApexMotion_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RotorApexMotion_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_HubPtMotion_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_HubPtMotion_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_HubPtMotion_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_BladeRootMotions_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_BladeRootMotions_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_BladeRootMotions_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RotorFurlMotion_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RotorFurlMotion_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RotorFurlMotion_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_NacelleMotion_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_NacelleMotion_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_NacelleMotion_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TowerMotion_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TowerMotion_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TowerMotion_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%BladeLn2Mesh,1), UBOUND(InData%BladeLn2Mesh,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_BladeLn2Mesh_Buf  ) ! BladeLn2Mesh
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_BladeLn2Mesh_Buf  ) ! BladeLn2Mesh
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_BladeLn2Mesh_Buf ) ! BladeLn2Mesh
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf))  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf))  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_PlatformPtMesh_Buf  ) ! PlatformPtMesh
  IF(ALLOCATED(Int_PlatformPtMesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_PlatformPtMesh_Buf ) ! PlatformPtMesh
  IF(ALLOCATED(Re_PlatformPtMesh_Buf))  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF(ALLOCATED(Db_PlatformPtMesh_Buf))  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TowerLn2Mesh_Buf  ) ! TowerLn2Mesh
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TowerLn2Mesh_Buf ) ! TowerLn2Mesh
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf))  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf))  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( InData%RotorApexMotion, Re_RotorApexMotion_Buf, Db_RotorApexMotion_Buf, Int_RotorApexMotion_Buf, ErrStat, ErrMsg, .TRUE. ) ! RotorApexMotion 
  IF(ALLOCATED(Re_RotorApexMotion_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RotorApexMotion_Buf  ) ! RotorApexMotion
  IF(ALLOCATED(Db_RotorApexMotion_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RotorApexMotion_Buf  ) ! RotorApexMotion
  IF(ALLOCATED(Int_RotorApexMotion_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RotorApexMotion_Buf ) ! RotorApexMotion
  IF(ALLOCATED(Re_RotorApexMotion_Buf))  DEALLOCATE(Re_RotorApexMotion_Buf)
  IF(ALLOCATED(Db_RotorApexMotion_Buf))  DEALLOCATE(Db_RotorApexMotion_Buf)
  IF(ALLOCATED(Int_RotorApexMotion_Buf)) DEALLOCATE(Int_RotorApexMotion_Buf)
  CALL MeshPack( InData%HubPtMotion, Re_HubPtMotion_Buf, Db_HubPtMotion_Buf, Int_HubPtMotion_Buf, ErrStat, ErrMsg, .TRUE. ) ! HubPtMotion 
  IF(ALLOCATED(Re_HubPtMotion_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_HubPtMotion_Buf  ) ! HubPtMotion
  IF(ALLOCATED(Db_HubPtMotion_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_HubPtMotion_Buf  ) ! HubPtMotion
  IF(ALLOCATED(Int_HubPtMotion_Buf))Int_BufSz = Int_BufSz + SIZE( Int_HubPtMotion_Buf ) ! HubPtMotion
  IF(ALLOCATED(Re_HubPtMotion_Buf))  DEALLOCATE(Re_HubPtMotion_Buf)
  IF(ALLOCATED(Db_HubPtMotion_Buf))  DEALLOCATE(Db_HubPtMotion_Buf)
  IF(ALLOCATED(Int_HubPtMotion_Buf)) DEALLOCATE(Int_HubPtMotion_Buf)
  CALL MeshPack( InData%BladeRootMotions, Re_BladeRootMotions_Buf, Db_BladeRootMotions_Buf, Int_BladeRootMotions_Buf, ErrStat, ErrMsg, .TRUE. ) ! BladeRootMotions 
  IF(ALLOCATED(Re_BladeRootMotions_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_BladeRootMotions_Buf  ) ! BladeRootMotions
  IF(ALLOCATED(Db_BladeRootMotions_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_BladeRootMotions_Buf  ) ! BladeRootMotions
  IF(ALLOCATED(Int_BladeRootMotions_Buf))Int_BufSz = Int_BufSz + SIZE( Int_BladeRootMotions_Buf ) ! BladeRootMotions
  IF(ALLOCATED(Re_BladeRootMotions_Buf))  DEALLOCATE(Re_BladeRootMotions_Buf)
  IF(ALLOCATED(Db_BladeRootMotions_Buf))  DEALLOCATE(Db_BladeRootMotions_Buf)
  IF(ALLOCATED(Int_BladeRootMotions_Buf)) DEALLOCATE(Int_BladeRootMotions_Buf)
  CALL MeshPack( InData%RotorFurlMotion, Re_RotorFurlMotion_Buf, Db_RotorFurlMotion_Buf, Int_RotorFurlMotion_Buf, ErrStat, ErrMsg, .TRUE. ) ! RotorFurlMotion 
  IF(ALLOCATED(Re_RotorFurlMotion_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RotorFurlMotion_Buf  ) ! RotorFurlMotion
  IF(ALLOCATED(Db_RotorFurlMotion_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RotorFurlMotion_Buf  ) ! RotorFurlMotion
  IF(ALLOCATED(Int_RotorFurlMotion_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RotorFurlMotion_Buf ) ! RotorFurlMotion
  IF(ALLOCATED(Re_RotorFurlMotion_Buf))  DEALLOCATE(Re_RotorFurlMotion_Buf)
  IF(ALLOCATED(Db_RotorFurlMotion_Buf))  DEALLOCATE(Db_RotorFurlMotion_Buf)
  IF(ALLOCATED(Int_RotorFurlMotion_Buf)) DEALLOCATE(Int_RotorFurlMotion_Buf)
  CALL MeshPack( InData%NacelleMotion, Re_NacelleMotion_Buf, Db_NacelleMotion_Buf, Int_NacelleMotion_Buf, ErrStat, ErrMsg, .TRUE. ) ! NacelleMotion 
  IF(ALLOCATED(Re_NacelleMotion_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_NacelleMotion_Buf  ) ! NacelleMotion
  IF(ALLOCATED(Db_NacelleMotion_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_NacelleMotion_Buf  ) ! NacelleMotion
  IF(ALLOCATED(Int_NacelleMotion_Buf))Int_BufSz = Int_BufSz + SIZE( Int_NacelleMotion_Buf ) ! NacelleMotion
  IF(ALLOCATED(Re_NacelleMotion_Buf))  DEALLOCATE(Re_NacelleMotion_Buf)
  IF(ALLOCATED(Db_NacelleMotion_Buf))  DEALLOCATE(Db_NacelleMotion_Buf)
  IF(ALLOCATED(Int_NacelleMotion_Buf)) DEALLOCATE(Int_NacelleMotion_Buf)
  CALL MeshPack( InData%TowerMotion, Re_TowerMotion_Buf, Db_TowerMotion_Buf, Int_TowerMotion_Buf, ErrStat, ErrMsg, .TRUE. ) ! TowerMotion 
  IF(ALLOCATED(Re_TowerMotion_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TowerMotion_Buf  ) ! TowerMotion
  IF(ALLOCATED(Db_TowerMotion_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TowerMotion_Buf  ) ! TowerMotion
  IF(ALLOCATED(Int_TowerMotion_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TowerMotion_Buf ) ! TowerMotion
  IF(ALLOCATED(Re_TowerMotion_Buf))  DEALLOCATE(Re_TowerMotion_Buf)
  IF(ALLOCATED(Db_TowerMotion_Buf))  DEALLOCATE(Db_TowerMotion_Buf)
  IF(ALLOCATED(Int_TowerMotion_Buf)) DEALLOCATE(Int_TowerMotion_Buf)
  IF ( ALLOCATED(InData%WriteOutput) )   Re_BufSz    = Re_BufSz    + SIZE( InData%WriteOutput )  ! WriteOutput 
  IF ( ALLOCATED(InData%BlPitch) )   Re_BufSz    = Re_BufSz    + SIZE( InData%BlPitch )  ! BlPitch 
  Re_BufSz   = Re_BufSz   + 1  ! Yaw
  Re_BufSz   = Re_BufSz   + 1  ! YawRate
  Re_BufSz   = Re_BufSz   + 1  ! LSS_Spd
  Re_BufSz   = Re_BufSz   + 1  ! HSS_Spd
  Re_BufSz   = Re_BufSz   + 1  ! RotSpeed
  Re_BufSz   = Re_BufSz   + 1  ! TwrAccel
  Re_BufSz   = Re_BufSz   + 1  ! YawAngle
  Re_BufSz    = Re_BufSz    + SIZE( InData%RootMyc )  ! RootMyc 
  Re_BufSz   = Re_BufSz   + 1  ! YawBrTAxp
  Re_BufSz   = Re_BufSz   + 1  ! YawBrTAyp
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipPxa
  Re_BufSz    = Re_BufSz    + SIZE( InData%RootMxc )  ! RootMxc 
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMya
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMza
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMys
  Re_BufSz   = Re_BufSz   + 1  ! LSSTipMzs
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMyn
  Re_BufSz   = Re_BufSz   + 1  ! YawBrMzn
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAxs
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAys
  Re_BufSz   = Re_BufSz   + 1  ! NcIMURAzs
  Re_BufSz   = Re_BufSz   + 1  ! RotPwr
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%BladeLn2Mesh,1), UBOUND(InData%BladeLn2Mesh,1)
  CALL MeshPack( InData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeLn2Mesh_Buf)-1 ) = Re_BladeLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeLn2Mesh_Buf)-1 ) = Db_BladeLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeLn2Mesh_Buf)-1 ) = Int_BladeLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_BladeLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_BladeLn2Mesh_Buf) )  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Db_BladeLn2Mesh_Buf) )  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Int_BladeLn2Mesh_Buf) ) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( InData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg, OnlySize ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 ) = Re_PlatformPtMesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 ) = Db_PlatformPtMesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 ) = Int_PlatformPtMesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( InData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg, OnlySize ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 ) = Re_TowerLn2Mesh_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 ) = Db_TowerLn2Mesh_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 ) = Int_TowerLn2Mesh_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( InData%RotorApexMotion, Re_RotorApexMotion_Buf, Db_RotorApexMotion_Buf, Int_RotorApexMotion_Buf, ErrStat, ErrMsg, OnlySize ) ! RotorApexMotion 
  IF(ALLOCATED(Re_RotorApexMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorApexMotion_Buf)-1 ) = Re_RotorApexMotion_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RotorApexMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorApexMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorApexMotion_Buf)-1 ) = Db_RotorApexMotion_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RotorApexMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorApexMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorApexMotion_Buf)-1 ) = Int_RotorApexMotion_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RotorApexMotion_Buf)
  ENDIF
  IF( ALLOCATED(Re_RotorApexMotion_Buf) )  DEALLOCATE(Re_RotorApexMotion_Buf)
  IF( ALLOCATED(Db_RotorApexMotion_Buf) )  DEALLOCATE(Db_RotorApexMotion_Buf)
  IF( ALLOCATED(Int_RotorApexMotion_Buf) ) DEALLOCATE(Int_RotorApexMotion_Buf)
  CALL MeshPack( InData%HubPtMotion, Re_HubPtMotion_Buf, Db_HubPtMotion_Buf, Int_HubPtMotion_Buf, ErrStat, ErrMsg, OnlySize ) ! HubPtMotion 
  IF(ALLOCATED(Re_HubPtMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HubPtMotion_Buf)-1 ) = Re_HubPtMotion_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_HubPtMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_HubPtMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HubPtMotion_Buf)-1 ) = Db_HubPtMotion_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_HubPtMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_HubPtMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HubPtMotion_Buf)-1 ) = Int_HubPtMotion_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_HubPtMotion_Buf)
  ENDIF
  IF( ALLOCATED(Re_HubPtMotion_Buf) )  DEALLOCATE(Re_HubPtMotion_Buf)
  IF( ALLOCATED(Db_HubPtMotion_Buf) )  DEALLOCATE(Db_HubPtMotion_Buf)
  IF( ALLOCATED(Int_HubPtMotion_Buf) ) DEALLOCATE(Int_HubPtMotion_Buf)
  CALL MeshPack( InData%BladeRootMotions, Re_BladeRootMotions_Buf, Db_BladeRootMotions_Buf, Int_BladeRootMotions_Buf, ErrStat, ErrMsg, OnlySize ) ! BladeRootMotions 
  IF(ALLOCATED(Re_BladeRootMotions_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeRootMotions_Buf)-1 ) = Re_BladeRootMotions_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_BladeRootMotions_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeRootMotions_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeRootMotions_Buf)-1 ) = Db_BladeRootMotions_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_BladeRootMotions_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeRootMotions_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeRootMotions_Buf)-1 ) = Int_BladeRootMotions_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_BladeRootMotions_Buf)
  ENDIF
  IF( ALLOCATED(Re_BladeRootMotions_Buf) )  DEALLOCATE(Re_BladeRootMotions_Buf)
  IF( ALLOCATED(Db_BladeRootMotions_Buf) )  DEALLOCATE(Db_BladeRootMotions_Buf)
  IF( ALLOCATED(Int_BladeRootMotions_Buf) ) DEALLOCATE(Int_BladeRootMotions_Buf)
  CALL MeshPack( InData%RotorFurlMotion, Re_RotorFurlMotion_Buf, Db_RotorFurlMotion_Buf, Int_RotorFurlMotion_Buf, ErrStat, ErrMsg, OnlySize ) ! RotorFurlMotion 
  IF(ALLOCATED(Re_RotorFurlMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurlMotion_Buf)-1 ) = Re_RotorFurlMotion_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurlMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurlMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurlMotion_Buf)-1 ) = Db_RotorFurlMotion_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurlMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurlMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurlMotion_Buf)-1 ) = Int_RotorFurlMotion_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurlMotion_Buf)
  ENDIF
  IF( ALLOCATED(Re_RotorFurlMotion_Buf) )  DEALLOCATE(Re_RotorFurlMotion_Buf)
  IF( ALLOCATED(Db_RotorFurlMotion_Buf) )  DEALLOCATE(Db_RotorFurlMotion_Buf)
  IF( ALLOCATED(Int_RotorFurlMotion_Buf) ) DEALLOCATE(Int_RotorFurlMotion_Buf)
  CALL MeshPack( InData%NacelleMotion, Re_NacelleMotion_Buf, Db_NacelleMotion_Buf, Int_NacelleMotion_Buf, ErrStat, ErrMsg, OnlySize ) ! NacelleMotion 
  IF(ALLOCATED(Re_NacelleMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_NacelleMotion_Buf)-1 ) = Re_NacelleMotion_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_NacelleMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_NacelleMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_NacelleMotion_Buf)-1 ) = Db_NacelleMotion_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_NacelleMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_NacelleMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_NacelleMotion_Buf)-1 ) = Int_NacelleMotion_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_NacelleMotion_Buf)
  ENDIF
  IF( ALLOCATED(Re_NacelleMotion_Buf) )  DEALLOCATE(Re_NacelleMotion_Buf)
  IF( ALLOCATED(Db_NacelleMotion_Buf) )  DEALLOCATE(Db_NacelleMotion_Buf)
  IF( ALLOCATED(Int_NacelleMotion_Buf) ) DEALLOCATE(Int_NacelleMotion_Buf)
  CALL MeshPack( InData%TowerMotion, Re_TowerMotion_Buf, Db_TowerMotion_Buf, Int_TowerMotion_Buf, ErrStat, ErrMsg, OnlySize ) ! TowerMotion 
  IF(ALLOCATED(Re_TowerMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerMotion_Buf)-1 ) = Re_TowerMotion_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TowerMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerMotion_Buf)-1 ) = Db_TowerMotion_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TowerMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerMotion_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerMotion_Buf)-1 ) = Int_TowerMotion_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TowerMotion_Buf)
  ENDIF
  IF( ALLOCATED(Re_TowerMotion_Buf) )  DEALLOCATE(Re_TowerMotion_Buf)
  IF( ALLOCATED(Db_TowerMotion_Buf) )  DEALLOCATE(Db_TowerMotion_Buf)
  IF( ALLOCATED(Int_TowerMotion_Buf) ) DEALLOCATE(Int_TowerMotion_Buf)
  IF ( ALLOCATED(InData%WriteOutput) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%WriteOutput))-1 ) =  PACK(InData%WriteOutput ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%WriteOutput)
  ENDIF
  IF ( ALLOCATED(InData%BlPitch) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%BlPitch))-1 ) =  PACK(InData%BlPitch ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%BlPitch)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Yaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawRate )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSS_Spd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HSS_Spd )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrAccel )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawAngle )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RootMyc))-1 ) =  PACK(InData%RootMyc ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RootMyc)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrTAxp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrTAyp )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipPxa )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RootMxc))-1 ) =  PACK(InData%RootMxc ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RootMxc)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMya )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMza )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMys )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%LSSTipMzs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMyn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawBrMzn )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAxs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAys )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%NcIMURAzs )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%RotPwr )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE ED_PackOutput

 SUBROUTINE ED_UnPackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ED_OutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_BladeLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_BladeLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_BladeLn2Mesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_PlatformPtMesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_PlatformPtMesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_PlatformPtMesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TowerLn2Mesh_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TowerLn2Mesh_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TowerLn2Mesh_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RotorApexMotion_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RotorApexMotion_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RotorApexMotion_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_HubPtMotion_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_HubPtMotion_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_HubPtMotion_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_BladeRootMotions_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_BladeRootMotions_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_BladeRootMotions_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RotorFurlMotion_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RotorFurlMotion_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RotorFurlMotion_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_NacelleMotion_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_NacelleMotion_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_NacelleMotion_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TowerMotion_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TowerMotion_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TowerMotion_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%BladeLn2Mesh,1), UBOUND(OutData%BladeLn2Mesh,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! BladeLn2Mesh 
  IF(ALLOCATED(Re_BladeLn2Mesh_Buf)) THEN
    Re_BladeLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeLn2Mesh_Buf)) THEN
    Db_BladeLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_BladeLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeLn2Mesh_Buf)) THEN
    Int_BladeLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_BladeLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%BladeLn2Mesh(i1), Re_BladeLn2Mesh_Buf, Db_BladeLn2Mesh_Buf, Int_BladeLn2Mesh_Buf, ErrStat, ErrMsg ) ! BladeLn2Mesh 
  IF( ALLOCATED(Re_BladeLn2Mesh_Buf) )  DEALLOCATE(Re_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Db_BladeLn2Mesh_Buf) )  DEALLOCATE(Db_BladeLn2Mesh_Buf)
  IF( ALLOCATED(Int_BladeLn2Mesh_Buf) ) DEALLOCATE(Int_BladeLn2Mesh_Buf)
ENDDO
  CALL MeshPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! PlatformPtMesh 
  IF(ALLOCATED(Re_PlatformPtMesh_Buf)) THEN
    Re_PlatformPtMesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_PlatformPtMesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_PlatformPtMesh_Buf)) THEN
    Db_PlatformPtMesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_PlatformPtMesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_PlatformPtMesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_PlatformPtMesh_Buf)) THEN
    Int_PlatformPtMesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_PlatformPtMesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_PlatformPtMesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%PlatformPtMesh, Re_PlatformPtMesh_Buf, Db_PlatformPtMesh_Buf, Int_PlatformPtMesh_Buf, ErrStat, ErrMsg ) ! PlatformPtMesh 
  IF( ALLOCATED(Re_PlatformPtMesh_Buf) )  DEALLOCATE(Re_PlatformPtMesh_Buf)
  IF( ALLOCATED(Db_PlatformPtMesh_Buf) )  DEALLOCATE(Db_PlatformPtMesh_Buf)
  IF( ALLOCATED(Int_PlatformPtMesh_Buf) ) DEALLOCATE(Int_PlatformPtMesh_Buf)
  CALL MeshPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg , .TRUE. ) ! TowerLn2Mesh 
  IF(ALLOCATED(Re_TowerLn2Mesh_Buf)) THEN
    Re_TowerLn2Mesh_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerLn2Mesh_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerLn2Mesh_Buf)) THEN
    Db_TowerLn2Mesh_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerLn2Mesh_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TowerLn2Mesh_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerLn2Mesh_Buf)) THEN
    Int_TowerLn2Mesh_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerLn2Mesh_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TowerLn2Mesh_Buf)
  ENDIF
  CALL MeshUnPack( OutData%TowerLn2Mesh, Re_TowerLn2Mesh_Buf, Db_TowerLn2Mesh_Buf, Int_TowerLn2Mesh_Buf, ErrStat, ErrMsg ) ! TowerLn2Mesh 
  IF( ALLOCATED(Re_TowerLn2Mesh_Buf) )  DEALLOCATE(Re_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Db_TowerLn2Mesh_Buf) )  DEALLOCATE(Db_TowerLn2Mesh_Buf)
  IF( ALLOCATED(Int_TowerLn2Mesh_Buf) ) DEALLOCATE(Int_TowerLn2Mesh_Buf)
  CALL MeshPack( OutData%RotorApexMotion, Re_RotorApexMotion_Buf, Db_RotorApexMotion_Buf, Int_RotorApexMotion_Buf, ErrStat, ErrMsg , .TRUE. ) ! RotorApexMotion 
  IF(ALLOCATED(Re_RotorApexMotion_Buf)) THEN
    Re_RotorApexMotion_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorApexMotion_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RotorApexMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorApexMotion_Buf)) THEN
    Db_RotorApexMotion_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorApexMotion_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RotorApexMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorApexMotion_Buf)) THEN
    Int_RotorApexMotion_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorApexMotion_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RotorApexMotion_Buf)
  ENDIF
  CALL MeshUnPack( OutData%RotorApexMotion, Re_RotorApexMotion_Buf, Db_RotorApexMotion_Buf, Int_RotorApexMotion_Buf, ErrStat, ErrMsg ) ! RotorApexMotion 
  IF( ALLOCATED(Re_RotorApexMotion_Buf) )  DEALLOCATE(Re_RotorApexMotion_Buf)
  IF( ALLOCATED(Db_RotorApexMotion_Buf) )  DEALLOCATE(Db_RotorApexMotion_Buf)
  IF( ALLOCATED(Int_RotorApexMotion_Buf) ) DEALLOCATE(Int_RotorApexMotion_Buf)
  CALL MeshPack( OutData%HubPtMotion, Re_HubPtMotion_Buf, Db_HubPtMotion_Buf, Int_HubPtMotion_Buf, ErrStat, ErrMsg , .TRUE. ) ! HubPtMotion 
  IF(ALLOCATED(Re_HubPtMotion_Buf)) THEN
    Re_HubPtMotion_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_HubPtMotion_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_HubPtMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_HubPtMotion_Buf)) THEN
    Db_HubPtMotion_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_HubPtMotion_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_HubPtMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_HubPtMotion_Buf)) THEN
    Int_HubPtMotion_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_HubPtMotion_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_HubPtMotion_Buf)
  ENDIF
  CALL MeshUnPack( OutData%HubPtMotion, Re_HubPtMotion_Buf, Db_HubPtMotion_Buf, Int_HubPtMotion_Buf, ErrStat, ErrMsg ) ! HubPtMotion 
  IF( ALLOCATED(Re_HubPtMotion_Buf) )  DEALLOCATE(Re_HubPtMotion_Buf)
  IF( ALLOCATED(Db_HubPtMotion_Buf) )  DEALLOCATE(Db_HubPtMotion_Buf)
  IF( ALLOCATED(Int_HubPtMotion_Buf) ) DEALLOCATE(Int_HubPtMotion_Buf)
  CALL MeshPack( OutData%BladeRootMotions, Re_BladeRootMotions_Buf, Db_BladeRootMotions_Buf, Int_BladeRootMotions_Buf, ErrStat, ErrMsg , .TRUE. ) ! BladeRootMotions 
  IF(ALLOCATED(Re_BladeRootMotions_Buf)) THEN
    Re_BladeRootMotions_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_BladeRootMotions_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_BladeRootMotions_Buf)
  ENDIF
  IF(ALLOCATED(Db_BladeRootMotions_Buf)) THEN
    Db_BladeRootMotions_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_BladeRootMotions_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_BladeRootMotions_Buf)
  ENDIF
  IF(ALLOCATED(Int_BladeRootMotions_Buf)) THEN
    Int_BladeRootMotions_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_BladeRootMotions_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_BladeRootMotions_Buf)
  ENDIF
  CALL MeshUnPack( OutData%BladeRootMotions, Re_BladeRootMotions_Buf, Db_BladeRootMotions_Buf, Int_BladeRootMotions_Buf, ErrStat, ErrMsg ) ! BladeRootMotions 
  IF( ALLOCATED(Re_BladeRootMotions_Buf) )  DEALLOCATE(Re_BladeRootMotions_Buf)
  IF( ALLOCATED(Db_BladeRootMotions_Buf) )  DEALLOCATE(Db_BladeRootMotions_Buf)
  IF( ALLOCATED(Int_BladeRootMotions_Buf) ) DEALLOCATE(Int_BladeRootMotions_Buf)
  CALL MeshPack( OutData%RotorFurlMotion, Re_RotorFurlMotion_Buf, Db_RotorFurlMotion_Buf, Int_RotorFurlMotion_Buf, ErrStat, ErrMsg , .TRUE. ) ! RotorFurlMotion 
  IF(ALLOCATED(Re_RotorFurlMotion_Buf)) THEN
    Re_RotorFurlMotion_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurlMotion_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurlMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurlMotion_Buf)) THEN
    Db_RotorFurlMotion_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurlMotion_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurlMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurlMotion_Buf)) THEN
    Int_RotorFurlMotion_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurlMotion_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurlMotion_Buf)
  ENDIF
  CALL MeshUnPack( OutData%RotorFurlMotion, Re_RotorFurlMotion_Buf, Db_RotorFurlMotion_Buf, Int_RotorFurlMotion_Buf, ErrStat, ErrMsg ) ! RotorFurlMotion 
  IF( ALLOCATED(Re_RotorFurlMotion_Buf) )  DEALLOCATE(Re_RotorFurlMotion_Buf)
  IF( ALLOCATED(Db_RotorFurlMotion_Buf) )  DEALLOCATE(Db_RotorFurlMotion_Buf)
  IF( ALLOCATED(Int_RotorFurlMotion_Buf) ) DEALLOCATE(Int_RotorFurlMotion_Buf)
  CALL MeshPack( OutData%NacelleMotion, Re_NacelleMotion_Buf, Db_NacelleMotion_Buf, Int_NacelleMotion_Buf, ErrStat, ErrMsg , .TRUE. ) ! NacelleMotion 
  IF(ALLOCATED(Re_NacelleMotion_Buf)) THEN
    Re_NacelleMotion_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_NacelleMotion_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_NacelleMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_NacelleMotion_Buf)) THEN
    Db_NacelleMotion_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_NacelleMotion_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_NacelleMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_NacelleMotion_Buf)) THEN
    Int_NacelleMotion_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_NacelleMotion_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_NacelleMotion_Buf)
  ENDIF
  CALL MeshUnPack( OutData%NacelleMotion, Re_NacelleMotion_Buf, Db_NacelleMotion_Buf, Int_NacelleMotion_Buf, ErrStat, ErrMsg ) ! NacelleMotion 
  IF( ALLOCATED(Re_NacelleMotion_Buf) )  DEALLOCATE(Re_NacelleMotion_Buf)
  IF( ALLOCATED(Db_NacelleMotion_Buf) )  DEALLOCATE(Db_NacelleMotion_Buf)
  IF( ALLOCATED(Int_NacelleMotion_Buf) ) DEALLOCATE(Int_NacelleMotion_Buf)
  CALL MeshPack( OutData%TowerMotion, Re_TowerMotion_Buf, Db_TowerMotion_Buf, Int_TowerMotion_Buf, ErrStat, ErrMsg , .TRUE. ) ! TowerMotion 
  IF(ALLOCATED(Re_TowerMotion_Buf)) THEN
    Re_TowerMotion_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TowerMotion_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TowerMotion_Buf)
  ENDIF
  IF(ALLOCATED(Db_TowerMotion_Buf)) THEN
    Db_TowerMotion_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TowerMotion_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TowerMotion_Buf)
  ENDIF
  IF(ALLOCATED(Int_TowerMotion_Buf)) THEN
    Int_TowerMotion_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TowerMotion_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TowerMotion_Buf)
  ENDIF
  CALL MeshUnPack( OutData%TowerMotion, Re_TowerMotion_Buf, Db_TowerMotion_Buf, Int_TowerMotion_Buf, ErrStat, ErrMsg ) ! TowerMotion 
  IF( ALLOCATED(Re_TowerMotion_Buf) )  DEALLOCATE(Re_TowerMotion_Buf)
  IF( ALLOCATED(Db_TowerMotion_Buf) )  DEALLOCATE(Db_TowerMotion_Buf)
  IF( ALLOCATED(Int_TowerMotion_Buf) ) DEALLOCATE(Int_TowerMotion_Buf)
  IF ( ALLOCATED(OutData%WriteOutput) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WriteOutput,1)))
  mask1 = .TRUE.
    OutData%WriteOutput = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%WriteOutput))-1 ),mask1,OutData%WriteOutput)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%WriteOutput)
  ENDIF
  IF ( ALLOCATED(OutData%BlPitch) ) THEN
  ALLOCATE(mask1(SIZE(OutData%BlPitch,1)))
  mask1 = .TRUE.
    OutData%BlPitch = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%BlPitch))-1 ),mask1,OutData%BlPitch)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%BlPitch)
  ENDIF
  OutData%Yaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawRate = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSS_Spd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%HSS_Spd = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrAccel = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawAngle = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%RootMyc,1)))
  mask1 = .TRUE.
  OutData%RootMyc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RootMyc))-1 ),mask1,OutData%RootMyc)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RootMyc)
  OutData%YawBrTAxp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrTAyp = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipPxa = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%RootMxc,1)))
  mask1 = .TRUE.
  OutData%RootMxc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RootMxc))-1 ),mask1,OutData%RootMxc)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RootMxc)
  OutData%LSSTipMya = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMza = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMys = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%LSSTipMzs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMyn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawBrMzn = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAxs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAys = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NcIMURAzs = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%RotPwr = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE ED_UnPackOutput


 SUBROUTINE ED_Input_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(ED_inputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(ED_inputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: b3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: c3       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in ED_Input_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshCopy(u(1)%BladeLn2Mesh(i01), u_out%BladeLn2Mesh(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%PlatformPtMesh, u_out%PlatformPtMesh, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%TowerLn2Mesh, u_out%TowerLn2Mesh, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%NacelleLoads, u_out%NacelleLoads, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%NacelleLoads')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  u_out%TwrAddedMass = u(1)%TwrAddedMass
END IF ! check if allocated
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  u_out%BlPitchCom = u(1)%BlPitchCom
END IF ! check if allocated
  u_out%YawMom = u(1)%YawMom
  u_out%GenTrq = u(1)%GenTrq
  u_out%HSSBrTrqC = u(1)%HSSBrTrqC
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshExtrapInterp1(u(1)%BladeLn2Mesh(i01), u(2)%BladeLn2Mesh(i01), tin, u_out%BladeLn2Mesh(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%NacelleLoads, u(2)%NacelleLoads, tin, u_out%NacelleLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%NacelleLoads')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  ALLOCATE(b3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  ALLOCATE(c3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  b3 = -(u(1)%TwrAddedMass - u(2)%TwrAddedMass)/t(2)
  u_out%TwrAddedMass = u(1)%TwrAddedMass + b3 * t_out
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
  ALLOCATE(b2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  ALLOCATE(c2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  b2 = -(u(1)%PtfmAddedMass - u(2)%PtfmAddedMass)/t(2)
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitchCom,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitchCom,1)))
  b1 = -(u(1)%BlPitchCom - u(2)%BlPitchCom)/t(2)
  u_out%BlPitchCom = u(1)%BlPitchCom + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = -(u(1)%YawMom - u(2)%YawMom)/t(2)
  u_out%YawMom = u(1)%YawMom + b0 * t_out
  b0 = -(u(1)%GenTrq - u(2)%GenTrq)/t(2)
  u_out%GenTrq = u(1)%GenTrq + b0 * t_out
  b0 = -(u(1)%HSSBrTrqC - u(2)%HSSBrTrqC)/t(2)
  u_out%HSSBrTrqC = u(1)%HSSBrTrqC + b0 * t_out
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Input_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshExtrapInterp2(u(1)%BladeLn2Mesh(i01), u(2)%BladeLn2Mesh(i01), u(3)%BladeLn2Mesh(i01), tin, u_out%BladeLn2Mesh(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, u(3)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, u(3)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%NacelleLoads, u(2)%NacelleLoads, u(3)%NacelleLoads, tin, u_out%NacelleLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Input_ExtrapInterp:%NacelleLoads')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TwrAddedMass) .AND. ALLOCATED(u(1)%TwrAddedMass)) THEN
  ALLOCATE(b3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  ALLOCATE(c3(SIZE(u_out%TwrAddedMass,1),SIZE(u_out%TwrAddedMass,2), &
              SIZE(u_out%TwrAddedMass,3)                     ))
  b3 = (t(3)**2*(u(1)%TwrAddedMass - u(2)%TwrAddedMass) + t(2)**2*(-u(1)%TwrAddedMass + u(3)%TwrAddedMass))/(t(2)*t(3)*(t(2) - t(3)))
  c3 = ( (t(2)-t(3))*u(1)%TwrAddedMass + t(3)*u(2)%TwrAddedMass - t(2)*u(3)%TwrAddedMass ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TwrAddedMass = u(1)%TwrAddedMass + b3 * t_out + c3 * t_out**2
  DEALLOCATE(b3)
  DEALLOCATE(c3)
END IF ! check if allocated
  ALLOCATE(b2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  ALLOCATE(c2(SIZE(u_out%PtfmAddedMass,1),SIZE(u_out%PtfmAddedMass,2) ))
  b2 = (t(3)**2*(u(1)%PtfmAddedMass - u(2)%PtfmAddedMass) + t(2)**2*(-u(1)%PtfmAddedMass + u(3)%PtfmAddedMass))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%PtfmAddedMass + t(3)*u(2)%PtfmAddedMass - t(2)*u(3)%PtfmAddedMass ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%PtfmAddedMass = u(1)%PtfmAddedMass + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
IF (ALLOCATED(u_out%BlPitchCom) .AND. ALLOCATED(u(1)%BlPitchCom)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitchCom,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitchCom,1)))
  b1 = (t(3)**2*(u(1)%BlPitchCom - u(2)%BlPitchCom) + t(2)**2*(-u(1)%BlPitchCom + u(3)%BlPitchCom))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%BlPitchCom + t(3)*u(2)%BlPitchCom - t(2)*u(3)%BlPitchCom ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%BlPitchCom = u(1)%BlPitchCom + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = (t(3)**2*(u(1)%YawMom - u(2)%YawMom) + t(2)**2*(-u(1)%YawMom + u(3)%YawMom))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawMom + t(3)*u(2)%YawMom - t(2)*u(3)%YawMom ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawMom = u(1)%YawMom + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%GenTrq - u(2)%GenTrq) + t(2)**2*(-u(1)%GenTrq + u(3)%GenTrq))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%GenTrq + t(3)*u(2)%GenTrq - t(2)*u(3)%GenTrq ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%GenTrq = u(1)%GenTrq + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%HSSBrTrqC - u(2)%HSSBrTrqC) + t(2)**2*(-u(1)%HSSBrTrqC + u(3)%HSSBrTrqC))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%HSSBrTrqC + t(3)*u(2)%HSSBrTrqC - t(2)*u(3)%HSSBrTrqC ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%HSSBrTrqC = u(1)%HSSBrTrqC + b0 * t_out + c0 * t_out**2
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in ED_Input_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE ED_Input_ExtrapInterp


 SUBROUTINE ED_Output_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(ED_outputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(ED_outputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in ED_Output_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshCopy(u(1)%BladeLn2Mesh(i01), u_out%BladeLn2Mesh(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%PlatformPtMesh, u_out%PlatformPtMesh, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%TowerLn2Mesh, u_out%TowerLn2Mesh, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%RotorApexMotion, u_out%RotorApexMotion, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorApexMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%HubPtMotion, u_out%HubPtMotion, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%HubPtMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%BladeRootMotions, u_out%BladeRootMotions, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeRootMotions')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%RotorFurlMotion, u_out%RotorFurlMotion, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorFurlMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%NacelleMotion, u_out%NacelleMotion, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%NacelleMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshCopy(u(1)%TowerMotion, u_out%TowerMotion, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerMotion')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  u_out%WriteOutput = u(1)%WriteOutput
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  u_out%BlPitch = u(1)%BlPitch
END IF ! check if allocated
  u_out%Yaw = u(1)%Yaw
  u_out%YawRate = u(1)%YawRate
  u_out%LSS_Spd = u(1)%LSS_Spd
  u_out%HSS_Spd = u(1)%HSS_Spd
  u_out%RotSpeed = u(1)%RotSpeed
  u_out%TwrAccel = u(1)%TwrAccel
  u_out%YawAngle = u(1)%YawAngle
  u_out%RootMyc = u(1)%RootMyc
  u_out%YawBrTAxp = u(1)%YawBrTAxp
  u_out%YawBrTAyp = u(1)%YawBrTAyp
  u_out%LSSTipPxa = u(1)%LSSTipPxa
  u_out%RootMxc = u(1)%RootMxc
  u_out%LSSTipMya = u(1)%LSSTipMya
  u_out%LSSTipMza = u(1)%LSSTipMza
  u_out%LSSTipMys = u(1)%LSSTipMys
  u_out%LSSTipMzs = u(1)%LSSTipMzs
  u_out%YawBrMyn = u(1)%YawBrMyn
  u_out%YawBrMzn = u(1)%YawBrMzn
  u_out%NcIMURAxs = u(1)%NcIMURAxs
  u_out%NcIMURAys = u(1)%NcIMURAys
  u_out%NcIMURAzs = u(1)%NcIMURAzs
  u_out%RotPwr = u(1)%RotPwr
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshExtrapInterp1(u(1)%BladeLn2Mesh(i01), u(2)%BladeLn2Mesh(i01), tin, u_out%BladeLn2Mesh(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%RotorApexMotion, u(2)%RotorApexMotion, tin, u_out%RotorApexMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorApexMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%HubPtMotion, u(2)%HubPtMotion, tin, u_out%HubPtMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%HubPtMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%BladeRootMotions, u(2)%BladeRootMotions, tin, u_out%BladeRootMotions, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeRootMotions')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%RotorFurlMotion, u(2)%RotorFurlMotion, tin, u_out%RotorFurlMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorFurlMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%NacelleMotion, u(2)%NacelleMotion, tin, u_out%NacelleMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%NacelleMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp1(u(1)%TowerMotion, u(2)%TowerMotion, tin, u_out%TowerMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerMotion')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  ALLOCATE(b1(SIZE(u_out%WriteOutput,1)))
  ALLOCATE(c1(SIZE(u_out%WriteOutput,1)))
  b1 = -(u(1)%WriteOutput - u(2)%WriteOutput)/t(2)
  u_out%WriteOutput = u(1)%WriteOutput + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitch,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitch,1)))
  b1 = -(u(1)%BlPitch - u(2)%BlPitch)/t(2)
  u_out%BlPitch = u(1)%BlPitch + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = -(u(1)%Yaw - u(2)%Yaw)/t(2)
  u_out%Yaw = u(1)%Yaw + b0 * t_out
  b0 = -(u(1)%YawRate - u(2)%YawRate)/t(2)
  u_out%YawRate = u(1)%YawRate + b0 * t_out
  b0 = -(u(1)%LSS_Spd - u(2)%LSS_Spd)/t(2)
  u_out%LSS_Spd = u(1)%LSS_Spd + b0 * t_out
  b0 = -(u(1)%HSS_Spd - u(2)%HSS_Spd)/t(2)
  u_out%HSS_Spd = u(1)%HSS_Spd + b0 * t_out
  b0 = -(u(1)%RotSpeed - u(2)%RotSpeed)/t(2)
  u_out%RotSpeed = u(1)%RotSpeed + b0 * t_out
  b0 = -(u(1)%TwrAccel - u(2)%TwrAccel)/t(2)
  u_out%TwrAccel = u(1)%TwrAccel + b0 * t_out
  b0 = -(u(1)%YawAngle - u(2)%YawAngle)/t(2)
  u_out%YawAngle = u(1)%YawAngle + b0 * t_out
  ALLOCATE(b1(SIZE(u_out%RootMyc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMyc,1)))
  b1 = -(u(1)%RootMyc - u(2)%RootMyc)/t(2)
  u_out%RootMyc = u(1)%RootMyc + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%YawBrTAxp - u(2)%YawBrTAxp)/t(2)
  u_out%YawBrTAxp = u(1)%YawBrTAxp + b0 * t_out
  b0 = -(u(1)%YawBrTAyp - u(2)%YawBrTAyp)/t(2)
  u_out%YawBrTAyp = u(1)%YawBrTAyp + b0 * t_out
  b0 = -(u(1)%LSSTipPxa - u(2)%LSSTipPxa)/t(2)
  u_out%LSSTipPxa = u(1)%LSSTipPxa + b0 * t_out
  ALLOCATE(b1(SIZE(u_out%RootMxc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMxc,1)))
  b1 = -(u(1)%RootMxc - u(2)%RootMxc)/t(2)
  u_out%RootMxc = u(1)%RootMxc + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%LSSTipMya - u(2)%LSSTipMya)/t(2)
  u_out%LSSTipMya = u(1)%LSSTipMya + b0 * t_out
  b0 = -(u(1)%LSSTipMza - u(2)%LSSTipMza)/t(2)
  u_out%LSSTipMza = u(1)%LSSTipMza + b0 * t_out
  b0 = -(u(1)%LSSTipMys - u(2)%LSSTipMys)/t(2)
  u_out%LSSTipMys = u(1)%LSSTipMys + b0 * t_out
  b0 = -(u(1)%LSSTipMzs - u(2)%LSSTipMzs)/t(2)
  u_out%LSSTipMzs = u(1)%LSSTipMzs + b0 * t_out
  b0 = -(u(1)%YawBrMyn - u(2)%YawBrMyn)/t(2)
  u_out%YawBrMyn = u(1)%YawBrMyn + b0 * t_out
  b0 = -(u(1)%YawBrMzn - u(2)%YawBrMzn)/t(2)
  u_out%YawBrMzn = u(1)%YawBrMzn + b0 * t_out
  b0 = -(u(1)%NcIMURAxs - u(2)%NcIMURAxs)/t(2)
  u_out%NcIMURAxs = u(1)%NcIMURAxs + b0 * t_out
  b0 = -(u(1)%NcIMURAys - u(2)%NcIMURAys)/t(2)
  u_out%NcIMURAys = u(1)%NcIMURAys + b0 * t_out
  b0 = -(u(1)%NcIMURAzs - u(2)%NcIMURAzs)/t(2)
  u_out%NcIMURAzs = u(1)%NcIMURAzs + b0 * t_out
  b0 = -(u(1)%RotPwr - u(2)%RotPwr)/t(2)
  u_out%RotPwr = u(1)%RotPwr + b0 * t_out
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in ED_Output_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%BladeLn2Mesh) .AND. ALLOCATED(u(1)%BladeLn2Mesh)) THEN
  DO i01 = LBOUND(u_out%BladeLn2Mesh,1),UBOUND(u_out%BladeLn2Mesh,1)
  CALL MeshExtrapInterp2(u(1)%BladeLn2Mesh(i01), u(2)%BladeLn2Mesh(i01), u(3)%BladeLn2Mesh(i01), tin, u_out%BladeLn2Mesh(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeLn2Mesh(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%PlatformPtMesh, u(2)%PlatformPtMesh, u(3)%PlatformPtMesh, tin, u_out%PlatformPtMesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%PlatformPtMesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%TowerLn2Mesh, u(2)%TowerLn2Mesh, u(3)%TowerLn2Mesh, tin, u_out%TowerLn2Mesh, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerLn2Mesh')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%RotorApexMotion, u(2)%RotorApexMotion, u(3)%RotorApexMotion, tin, u_out%RotorApexMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorApexMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%HubPtMotion, u(2)%HubPtMotion, u(3)%HubPtMotion, tin, u_out%HubPtMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%HubPtMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%BladeRootMotions, u(2)%BladeRootMotions, u(3)%BladeRootMotions, tin, u_out%BladeRootMotions, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%BladeRootMotions')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%RotorFurlMotion, u(2)%RotorFurlMotion, u(3)%RotorFurlMotion, tin, u_out%RotorFurlMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%RotorFurlMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%NacelleMotion, u(2)%NacelleMotion, u(3)%NacelleMotion, tin, u_out%NacelleMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%NacelleMotion')
         IF (ErrStat>=AbortErrLev) RETURN
  CALL MeshExtrapInterp2(u(1)%TowerMotion, u(2)%TowerMotion, u(3)%TowerMotion, tin, u_out%TowerMotion, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'ED_Output_ExtrapInterp:%TowerMotion')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%WriteOutput) .AND. ALLOCATED(u(1)%WriteOutput)) THEN
  ALLOCATE(b1(SIZE(u_out%WriteOutput,1)))
  ALLOCATE(c1(SIZE(u_out%WriteOutput,1)))
  b1 = (t(3)**2*(u(1)%WriteOutput - u(2)%WriteOutput) + t(2)**2*(-u(1)%WriteOutput + u(3)%WriteOutput))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%WriteOutput + t(3)*u(2)%WriteOutput - t(2)*u(3)%WriteOutput ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%WriteOutput = u(1)%WriteOutput + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
IF (ALLOCATED(u_out%BlPitch) .AND. ALLOCATED(u(1)%BlPitch)) THEN
  ALLOCATE(b1(SIZE(u_out%BlPitch,1)))
  ALLOCATE(c1(SIZE(u_out%BlPitch,1)))
  b1 = (t(3)**2*(u(1)%BlPitch - u(2)%BlPitch) + t(2)**2*(-u(1)%BlPitch + u(3)%BlPitch))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%BlPitch + t(3)*u(2)%BlPitch - t(2)*u(3)%BlPitch ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%BlPitch = u(1)%BlPitch + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
END IF ! check if allocated
  b0 = (t(3)**2*(u(1)%Yaw - u(2)%Yaw) + t(2)**2*(-u(1)%Yaw + u(3)%Yaw))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%Yaw + t(3)*u(2)%Yaw - t(2)*u(3)%Yaw ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%Yaw = u(1)%Yaw + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawRate - u(2)%YawRate) + t(2)**2*(-u(1)%YawRate + u(3)%YawRate))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawRate + t(3)*u(2)%YawRate - t(2)*u(3)%YawRate ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawRate = u(1)%YawRate + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSS_Spd - u(2)%LSS_Spd) + t(2)**2*(-u(1)%LSS_Spd + u(3)%LSS_Spd))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSS_Spd + t(3)*u(2)%LSS_Spd - t(2)*u(3)%LSS_Spd ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSS_Spd = u(1)%LSS_Spd + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%HSS_Spd - u(2)%HSS_Spd) + t(2)**2*(-u(1)%HSS_Spd + u(3)%HSS_Spd))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%HSS_Spd + t(3)*u(2)%HSS_Spd - t(2)*u(3)%HSS_Spd ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%HSS_Spd = u(1)%HSS_Spd + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%RotSpeed - u(2)%RotSpeed) + t(2)**2*(-u(1)%RotSpeed + u(3)%RotSpeed))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%RotSpeed + t(3)*u(2)%RotSpeed - t(2)*u(3)%RotSpeed ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RotSpeed = u(1)%RotSpeed + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%TwrAccel - u(2)%TwrAccel) + t(2)**2*(-u(1)%TwrAccel + u(3)%TwrAccel))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%TwrAccel + t(3)*u(2)%TwrAccel - t(2)*u(3)%TwrAccel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TwrAccel = u(1)%TwrAccel + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawAngle - u(2)%YawAngle) + t(2)**2*(-u(1)%YawAngle + u(3)%YawAngle))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawAngle + t(3)*u(2)%YawAngle - t(2)*u(3)%YawAngle ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawAngle = u(1)%YawAngle + b0 * t_out + c0 * t_out**2
  ALLOCATE(b1(SIZE(u_out%RootMyc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMyc,1)))
  b1 = (t(3)**2*(u(1)%RootMyc - u(2)%RootMyc) + t(2)**2*(-u(1)%RootMyc + u(3)%RootMyc))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%RootMyc + t(3)*u(2)%RootMyc - t(2)*u(3)%RootMyc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RootMyc = u(1)%RootMyc + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%YawBrTAxp - u(2)%YawBrTAxp) + t(2)**2*(-u(1)%YawBrTAxp + u(3)%YawBrTAxp))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrTAxp + t(3)*u(2)%YawBrTAxp - t(2)*u(3)%YawBrTAxp ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrTAxp = u(1)%YawBrTAxp + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrTAyp - u(2)%YawBrTAyp) + t(2)**2*(-u(1)%YawBrTAyp + u(3)%YawBrTAyp))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrTAyp + t(3)*u(2)%YawBrTAyp - t(2)*u(3)%YawBrTAyp ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrTAyp = u(1)%YawBrTAyp + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipPxa - u(2)%LSSTipPxa) + t(2)**2*(-u(1)%LSSTipPxa + u(3)%LSSTipPxa))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipPxa + t(3)*u(2)%LSSTipPxa - t(2)*u(3)%LSSTipPxa ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipPxa = u(1)%LSSTipPxa + b0 * t_out + c0 * t_out**2
  ALLOCATE(b1(SIZE(u_out%RootMxc,1)))
  ALLOCATE(c1(SIZE(u_out%RootMxc,1)))
  b1 = (t(3)**2*(u(1)%RootMxc - u(2)%RootMxc) + t(2)**2*(-u(1)%RootMxc + u(3)%RootMxc))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%RootMxc + t(3)*u(2)%RootMxc - t(2)*u(3)%RootMxc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RootMxc = u(1)%RootMxc + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%LSSTipMya - u(2)%LSSTipMya) + t(2)**2*(-u(1)%LSSTipMya + u(3)%LSSTipMya))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMya + t(3)*u(2)%LSSTipMya - t(2)*u(3)%LSSTipMya ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMya = u(1)%LSSTipMya + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMza - u(2)%LSSTipMza) + t(2)**2*(-u(1)%LSSTipMza + u(3)%LSSTipMza))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMza + t(3)*u(2)%LSSTipMza - t(2)*u(3)%LSSTipMza ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMza = u(1)%LSSTipMza + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMys - u(2)%LSSTipMys) + t(2)**2*(-u(1)%LSSTipMys + u(3)%LSSTipMys))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMys + t(3)*u(2)%LSSTipMys - t(2)*u(3)%LSSTipMys ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMys = u(1)%LSSTipMys + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%LSSTipMzs - u(2)%LSSTipMzs) + t(2)**2*(-u(1)%LSSTipMzs + u(3)%LSSTipMzs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%LSSTipMzs + t(3)*u(2)%LSSTipMzs - t(2)*u(3)%LSSTipMzs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%LSSTipMzs = u(1)%LSSTipMzs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrMyn - u(2)%YawBrMyn) + t(2)**2*(-u(1)%YawBrMyn + u(3)%YawBrMyn))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrMyn + t(3)*u(2)%YawBrMyn - t(2)*u(3)%YawBrMyn ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrMyn = u(1)%YawBrMyn + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%YawBrMzn - u(2)%YawBrMzn) + t(2)**2*(-u(1)%YawBrMzn + u(3)%YawBrMzn))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%YawBrMzn + t(3)*u(2)%YawBrMzn - t(2)*u(3)%YawBrMzn ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%YawBrMzn = u(1)%YawBrMzn + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAxs - u(2)%NcIMURAxs) + t(2)**2*(-u(1)%NcIMURAxs + u(3)%NcIMURAxs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAxs + t(3)*u(2)%NcIMURAxs - t(2)*u(3)%NcIMURAxs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAxs = u(1)%NcIMURAxs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAys - u(2)%NcIMURAys) + t(2)**2*(-u(1)%NcIMURAys + u(3)%NcIMURAys))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAys + t(3)*u(2)%NcIMURAys - t(2)*u(3)%NcIMURAys ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAys = u(1)%NcIMURAys + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%NcIMURAzs - u(2)%NcIMURAzs) + t(2)**2*(-u(1)%NcIMURAzs + u(3)%NcIMURAzs))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%NcIMURAzs + t(3)*u(2)%NcIMURAzs - t(2)*u(3)%NcIMURAzs ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%NcIMURAzs = u(1)%NcIMURAzs + b0 * t_out + c0 * t_out**2
  b0 = (t(3)**2*(u(1)%RotPwr - u(2)%RotPwr) + t(2)**2*(-u(1)%RotPwr + u(3)%RotPwr))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%RotPwr + t(3)*u(2)%RotPwr - t(2)*u(3)%RotPwr ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%RotPwr = u(1)%RotPwr + b0 * t_out + c0 * t_out**2
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in ED_Output_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE ED_Output_ExtrapInterp

END MODULE ElastoDyn_Types
!ENDOFREGISTRYGENERATEDFILE
